{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":0,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":0,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/anime.min.js","path":"lib/anime.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":0,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/all.min.css","path":"lib/font-awesome/css/all.min.css","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-brands-400.woff2","path":"lib/font-awesome/webfonts/fa-brands-400.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-regular-400.woff2","path":"lib/font-awesome/webfonts/fa-regular-400.woff2","modified":0,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-solid-900.woff2","path":"lib/font-awesome/webfonts/fa-solid-900.woff2","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/postgresql-optimizer-outline-1.md","hash":"ccb4d8a426b4ca8a11da8960cf456c605796ee69","modified":1596329852000},{"_id":"source/_posts/postgresql-optimizer-outline-2.md","hash":"caff7c412fb258307664f7bc5d1f678f80d78fa7","modified":1596332606000},{"_id":"source/_posts/postgresql-optimizer-outline-3.md","hash":"da8bb9ec39a5f72843a2e9a571aa7a1bb4028c94","modified":1596333291000},{"_id":"source/about/index.md","hash":"d61fe42c8566ae29da7831bda1e50e9eaba884a8","modified":1626738918000},{"_id":"source/.DS_Store","hash":"db36e4842436bc92b1e74de244af8ecf702c28b9","modified":1612599070000},{"_id":"source/_posts/.DS_Store","hash":"29a3cdafe44f8e7a9a2b2809821a5ff8db3839f2","modified":1628178048000},{"_id":"source/CNAME","hash":"1abf4ed9424d03bbf169fb354620f024705bde24","modified":1596323598000},{"_id":"source/_posts/postgresql-optimizer-outline-2/1.jpg","hash":"7dd5636eac16621f1e2923c163c18983a64bf590","modified":1596331070000},{"_id":"source/_posts/postgresql-optimizer-outline-2/2.jpg","hash":"8f1628d4fd45d15e91cf12ae9f5793cacbb0423c","modified":1596331070000},{"_id":"themes/next/.DS_Store","hash":"34aaf2afd98560146e0116b4cea9df723a75bf6b","modified":1612599042000},{"_id":"themes/next/.editorconfig","hash":"8570735a8d8d034a3a175afd1dd40b39140b3e6a","modified":1596297190000},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1596297190000},{"_id":"themes/next/.travis.yml","hash":"ecca3b919a5b15886e3eca58aa84aafc395590da","modified":1596297190000},{"_id":"themes/next/.stylintrc","hash":"2cf4d637b56d8eb423f59656a11f6403aa90f550","modified":1596297190000},{"_id":"themes/next/_config.yml","hash":"ce09b154d140763df464cdb536ac01b2f3f2ea3e","modified":1596931447000},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1596297190000},{"_id":"themes/next/README.md","hash":"9b4b7d66aca47f9c65d6321b14eef48d95c4dff1","modified":1596297190000},{"_id":"themes/next/package.json","hash":"62fad6de02adbbba9fb096cbe2dcc15fe25f2435","modified":1596297190000},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1596297190000},{"_id":"themes/next/gulpfile.js","hash":"1b4fc262b89948937b9e3794de812a7c1f2f3592","modified":1596297190000},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1596297190000},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"c7a994b9542040317d8f99affa1405c143a94a38","modified":1596297190000},{"_id":"themes/next/docs/AUTHORS.md","hash":"10135a2f78ac40e9f46b3add3e360c025400752f","modified":1596297190000},{"_id":"themes/next/docs/INSTALLATION.md","hash":"af88bcce035780aaa061261ed9d0d6c697678618","modified":1596297190000},{"_id":"themes/next/docs/DATA-FILES.md","hash":"cddbdc91ee9e65c37a50bec12194f93d36161616","modified":1596297190000},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"8b6e4b2c9cfcb969833092bdeaed78534082e3e6","modified":1596297190000},{"_id":"themes/next/docs/MATH.md","hash":"d645b025ec7fb9fbf799b9bb76af33b9f5b9ed93","modified":1596297190000},{"_id":"themes/next/languages/ar.yml","hash":"9815e84e53d750c8bcbd9193c2d44d8d910e3444","modified":1596297190000},{"_id":"themes/next/languages/default.yml","hash":"45bc5118828bdc72dcaa25282cd367c8622758cb","modified":1596297190000},{"_id":"themes/next/languages/de.yml","hash":"74c59f2744217003b717b59d96e275b54635abf5","modified":1596297190000},{"_id":"themes/next/languages/en.yml","hash":"45bc5118828bdc72dcaa25282cd367c8622758cb","modified":1596297190000},{"_id":"themes/next/languages/es.yml","hash":"c64cf05f356096f1464b4b1439da3c6c9b941062","modified":1596297190000},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1596297190000},{"_id":"themes/next/languages/fa.yml","hash":"3676b32fda37e122f3c1a655085a1868fb6ad66b","modified":1596297190000},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"94dc3404ccb0e5f663af2aa883c1af1d6eae553d","modified":1596297190000},{"_id":"themes/next/languages/fr.yml","hash":"752bf309f46a2cd43890b82300b342d7218d625f","modified":1596297190000},{"_id":"themes/next/languages/hu.yml","hash":"b1ebb77a5fd101195b79f94de293bcf9001d996f","modified":1596297190000},{"_id":"themes/next/languages/id.yml","hash":"572ed855d47aafe26f58c73b1394530754881ec2","modified":1596297190000},{"_id":"themes/next/languages/it.yml","hash":"44759f779ce9c260b895532de1d209ad4bd144bf","modified":1596297190000},{"_id":"themes/next/languages/ja.yml","hash":"0cf0baa663d530f22ff380a051881216d6adcdd8","modified":1596297190000},{"_id":"themes/next/languages/ko.yml","hash":"0feea9e43cd399f3610b94d755a39fff1d371e97","modified":1596297190000},{"_id":"themes/next/languages/nl.yml","hash":"5af3473d9f22897204afabc08bb984b247493330","modified":1596297190000},{"_id":"themes/next/languages/pt-BR.yml","hash":"67555b1ba31a0242b12fc6ce3add28531160e35b","modified":1596297190000},{"_id":"themes/next/languages/pt.yml","hash":"718d131f42f214842337776e1eaddd1e9a584054","modified":1596297190000},{"_id":"themes/next/languages/ru.yml","hash":"e993d5ca072f7f6887e30fc0c19b4da791ca7a88","modified":1596297190000},{"_id":"themes/next/languages/tr.yml","hash":"fe793f4c2608e3f85f0b872fd0ac1fb93e6155e2","modified":1596297190000},{"_id":"themes/next/languages/uk.yml","hash":"3a6d635b1035423b22fc86d9455dba9003724de9","modified":1596297190000},{"_id":"themes/next/languages/vi.yml","hash":"93393b01df148dcbf0863f6eee8e404e2d94ef9e","modified":1596297190000},{"_id":"themes/next/languages/zh-CN.yml","hash":"a1f15571ee7e1e84e3cc0985c3ec4ba1a113f6f8","modified":1596297190000},{"_id":"themes/next/languages/zh-HK.yml","hash":"3789f94010f948e9f23e21235ef422a191753c65","modified":1596297190000},{"_id":"themes/next/languages/zh-TW.yml","hash":"8c09da7c4ec3fca2c6ee897b2eea260596a2baa1","modified":1596297190000},{"_id":"themes/next/layout/_layout.swig","hash":"6a6e92a4664cdb981890a27ac11fd057f44de1d5","modified":1596297190000},{"_id":"themes/next/layout/archive.swig","hash":"e4e31317a8df68f23156cfc49e9b1aa9a12ad2ed","modified":1596297190000},{"_id":"themes/next/layout/category.swig","hash":"1bde61cf4d2d171647311a0ac2c5c7933f6a53b0","modified":1596297190000},{"_id":"themes/next/layout/index.swig","hash":"7f403a18a68e6d662ae3e154b2c1d3bbe0801a23","modified":1596297190000},{"_id":"themes/next/layout/page.swig","hash":"db581bdeac5c75fabb0f17d7c5e746e47f2a9168","modified":1596297190000},{"_id":"themes/next/layout/post.swig","hash":"2f6d992ced7e067521fdce05ffe4fd75481f41c5","modified":1596297190000},{"_id":"themes/next/layout/tag.swig","hash":"0dfb653bd5de980426d55a0606d1ab122bd8c017","modified":1596297190000},{"_id":"themes/next/scripts/renderer.js","hash":"49a65df2028a1bc24814dc72fa50d52231ca4f05","modified":1596297190000},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"0bd2d696f62a997a11a7d84fec0130122234174e","modified":1596297190000},{"_id":"themes/next/source/.DS_Store","hash":"42a735759b4eff69f4200db39d8094082ee38bf7","modified":1596335943000},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"9c4fe2873123bf9ceacab5c50d17d8a0f1baef27","modified":1596297190000},{"_id":"themes/next/docs/ru/README.md","hash":"85dd68ed1250897a8e4a444a53a68c1d49eb7e11","modified":1596297190000},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"5237a368ab99123749d724b6c379415f2c142a96","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"34b88784ec120dfdc20fa82aadeb5f64ef614d14","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"fb23b85db6f7d8279d73ae1f41631f92f64fc864","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"d3f03be036b75dc71cf3c366cd75aee7c127c874","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"ca1030efdfca5e20f9db2e7a428998e66a24c0d0","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"579c7bd8341873fb8be4732476d412814f1a3df7","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"8b18f84503a361fc712b0fe4d4568e2f086ca97d","modified":1596297190000},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"9c8dc0b8170679cdc1ee9ee8dbcbaebf3f42897b","modified":1596297190000},{"_id":"themes/next/layout/_macro/post.swig","hash":"090b5a9b6fca8e968178004cbd6cff205b7eba57","modified":1596297190000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"71655ca21907e9061b6e8ac52d0d8fbf54d0062b","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"b92585d251f1f9ebe401abb5d932cb920f9b8b10","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/README.md","hash":"c038629ff8f3f24e8593c4c8ecf0bef3a35c750d","modified":1596297190000},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"d9ce7331c1236bbe0a551d56cef2405e47e65325","modified":1596297190000},{"_id":"themes/next/layout/_partials/comments.swig","hash":"db6ab5421b5f4b7cb32ac73ad0e053fdf065f83e","modified":1596297190000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"e5a2bdf45fde7cea9cb03993f5a0fd960326ed5d","modified":1596297190000},{"_id":"themes/next/layout/_partials/languages.swig","hash":"ba9e272f1065b8f0e8848648caa7dea3f02c6be1","modified":1596297190000},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1596297190000},{"_id":"themes/next/layout/_partials/widgets.swig","hash":"83a40ce83dfd5cada417444fb2d6f5470aae6bb0","modified":1596297190000},{"_id":"themes/next/layout/_scripts/index.swig","hash":"cea942b450bcb0f352da78d76dc6d6f1d23d5029","modified":1596297190000},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"d1f2bfde6f1da51a2b35a7ab9e7e8eb6eefd1c6b","modified":1596297190000},{"_id":"themes/next/layout/_scripts/pjax.swig","hash":"4d2c93c66e069852bb0e3ea2e268d213d07bfa3f","modified":1596297190000},{"_id":"themes/next/layout/_scripts/three.swig","hash":"a4f42f2301866bd25a784a2281069d8b66836d0b","modified":1596297190000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"ef38c213679e7b6d2a4116f56c9e55d678446069","modified":1596297190000},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"b782eb2e34c0c15440837040b5d65b093ab6ec04","modified":1596297190000},{"_id":"themes/next/layout/_third-party/index.swig","hash":"70c3c01dd181de81270c57f3d99b6d8f4c723404","modified":1596297190000},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"311e5eceec9e949f1ea8d623b083cec0b8700ff2","modified":1596297190000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"2731e262a6b88eaee2a3ca61e6a3583a7f594702","modified":1596297190000},{"_id":"themes/next/scripts/events/index.js","hash":"5743cde07f3d2aa11532a168a652e52ec28514fd","modified":1596297190000},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"aec50ed57b9d5d3faf2db3c88374f107203617e0","modified":1596297190000},{"_id":"themes/next/scripts/filters/front-matter.js","hash":"703bdd142a671b4b67d3d9dfb4a19d1dd7e7e8f7","modified":1596297190000},{"_id":"themes/next/scripts/filters/locals.js","hash":"b193a936ee63451f09f8886343dcfdca577c0141","modified":1596297190000},{"_id":"themes/next/scripts/filters/minify.js","hash":"19985723b9f677ff775f3b17dcebf314819a76ac","modified":1596297190000},{"_id":"themes/next/scripts/filters/post.js","hash":"44ba9b1c0bdda57590b53141306bb90adf0678db","modified":1596297190000},{"_id":"themes/next/scripts/helpers/engine.js","hash":"bdb424c3cc0d145bd0c6015bb1d2443c8a9c6cda","modified":1596297190000},{"_id":"themes/next/scripts/helpers/font.js","hash":"40cf00e9f2b7aa6e5f33d412e03ed10304b15fd7","modified":1596297190000},{"_id":"themes/next/scripts/helpers/next-config.js","hash":"5e11f30ddb5093a88a687446617a46b048fa02e5","modified":1596297190000},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"958e86b2bd24e4fdfcbf9ce73e998efe3491a71f","modified":1596297190000},{"_id":"themes/next/scripts/tags/button.js","hash":"8c6b45f36e324820c919a822674703769e6da32c","modified":1596297190000},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"94e0bbc7999b359baa42fa3731bdcf89c79ae2b3","modified":1596297190000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"f1826ade2d135e2f60e2d95cb035383685b3370c","modified":1596297190000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"d902fd313e8d35c3cc36f237607c2a0536c9edf1","modified":1596297190000},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1596297190000},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1596297190000},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1596297190000},{"_id":"themes/next/scripts/tags/pdf.js","hash":"8c613b39e7bff735473e35244b5629d02ee20618","modified":1596297190000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"93d8a734a3035c1d3f04933167b500517557ba3e","modified":1596297190000},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1596297190000},{"_id":"themes/next/source/css/_colors.styl","hash":"a8442520f719d3d7a19811cb3b85bcfd4a596e1f","modified":1596297190000},{"_id":"themes/next/source/css/_mixins.styl","hash":"e31a557f8879c2f4d8d5567ee1800b3e03f91f6e","modified":1596297190000},{"_id":"themes/next/source/css/main.styl","hash":"a3a3bbb5a973052f0186b3523911cb2539ff7b88","modified":1596297190000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"c98146a0f81666956272fe692c1958fd1cf3d9a1","modified":1596335419000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1596297190000},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1596297190000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1596297190000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1596297190000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1596297190000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1596297190000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1596297190000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"ab599db2348f43f2cd71995e4d27e784847605aa","modified":1596335571000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1596297190000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1596297190000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"25dffea8b5603caf2ea77feb90bd9c1e86738713","modified":1596335608000},{"_id":"themes/next/source/js/motion.js","hash":"72df86f6dfa29cce22abeff9d814c9dddfcf13a9","modified":1596297190000},{"_id":"themes/next/source/js/next-boot.js","hash":"a1b0636423009d4a4e4cea97bcbf1842bfab582c","modified":1596297190000},{"_id":"themes/next/source/js/utils.js","hash":"2c6e6b4d9a592fbb4bf04689524db2cdfcd94ca7","modified":1596297190000},{"_id":"themes/next/source/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1596297190000},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"000bad572d76ee95d9c0a78f9ccdc8d97cc7d4b4","modified":1596297190000},{"_id":"themes/next/source/js/algolia-search.js","hash":"498d233eb5c7af6940baf94c1a1c36fdf1dd2636","modified":1596297190000},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"810d544019e4a8651b756dd23e5592ee851eda71","modified":1596297190000},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"c851717497ca64789f2176c9ecd1dedab237b752","modified":1596297190000},{"_id":"themes/next/source/js/local-search.js","hash":"35ccf100d8f9c0fd6bfbb7fa88c2a76c42a69110","modified":1596297190000},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"9b7a66791d7822c52117fe167612265356512477","modified":1596297190000},{"_id":"themes/next/source/js/bookmark.js","hash":"9734ebcb9b83489686f5c2da67dc9e6157e988ad","modified":1596297190000},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"c70f8e71e026e878a4e9d5ab3bbbf9b0b23c240c","modified":1596297190000},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"7dbe93b8297b746afb89700b4d29289556e85267","modified":1596297190000},{"_id":"themes/next/layout/_partials/header/menu-item.swig","hash":"9440d8a3a181698b80e1fa47f5104f4565d8cdf3","modified":1596297190000},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"d31f896680a6c2f2c3f5128b4d4dd46c87ce2130","modified":1596297190000},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"ae2261bea836581918a1c2b0d1028a78718434e0","modified":1596297190000},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"954ad71536b6eb08bd1f30ac6e2f5493b69d1c04","modified":1596297190000},{"_id":"themes/next/layout/_partials/post/post-followme.swig","hash":"ceba16b9bd3a0c5c8811af7e7e49d0f9dcb2f41e","modified":1596297190000},{"_id":"themes/next/layout/_partials/post/post-footer.swig","hash":"8f14f3f8a1b2998d5114cc56b680fb5c419a6b07","modified":1596297190000},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"f79c44692451db26efce704813f7a8872b7e63a0","modified":1596297190000},{"_id":"themes/next/layout/_partials/post/post-reward.swig","hash":"2b1a73556595c37951e39574df5a3f20b2edeaef","modified":1596297190000},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"48430bd03b8f19c9b8cdb2642005ed67d56c6e0b","modified":1596297190000},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"2be50f9bfb1c56b85b3b6910a7df27f51143632c","modified":1596297190000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"f48a6a8eba04eb962470ce76dd731e13074d4c45","modified":1596297190000},{"_id":"themes/next/layout/_partials/sidebar/site-overview.swig","hash":"c46849e0af8f8fb78baccd40d2af14df04a074af","modified":1596297190000},{"_id":"themes/next/layout/_scripts/pages/schedule.swig","hash":"077b5d66f6309f2e7dcf08645058ff2e03143e6c","modified":1596297190000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1596297190000},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1596297190000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1596297190000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1596297190000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"4790058691b7d36cf6d2d6b4e93795a7b8d608ad","modified":1596297190000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"2fa2b51d56bfac6a1ea76d651c93b9c20b01c09b","modified":1596297190000},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"5adea065641e8c55994dd2328ddae53215604928","modified":1596297190000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"1472cabb0181f60a6a0b7fec8899a4d03dfb2040","modified":1596297190000},{"_id":"themes/next/layout/_third-party/chat/tidio.swig","hash":"cba0e6e0fad08568a9e74ba9a5bee5341cfc04c1","modified":1596297190000},{"_id":"themes/next/layout/_third-party/chat/chatra.swig","hash":"f910618292c63871ca2e6c6e66c491f344fa7b1f","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"f39a5bf3ce9ee9adad282501235e0c588e4356ec","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"b14908644225d78c864cd0a9b60c52407de56183","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"82f5b6822aa5ec958aa987b101ef860494c6cf1f","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"d6ceb70648555338a80ae5724b778c8c58d7060d","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"f7a9eca599a682479e8ca863db59be7c9c7508c8","modified":1596297190000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"be0a8eccf1f6dc21154af297fc79555343031277","modified":1596297190000},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"6c5976621efd5db5f7c4c6b4f11bc79d6554885f","modified":1596297190000},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"4791c977a730f29c846efcf6c9c15131b9400ead","modified":1596297190000},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"ecf751321e799f0fb3bf94d049e535130e2547aa","modified":1596297190000},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"d35a999d67f4c302f76fdf13744ceef3c6506481","modified":1596297190000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"767b6c714c22588bcd26ba70b0fc19b6810cbacd","modified":1596297190000},{"_id":"themes/next/layout/_third-party/search/swiftype.swig","hash":"ba0dbc06b9d244073a1c681ff7a722dcbf920b51","modified":1596297190000},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.swig","hash":"4b1986e43d6abce13450d2b41a736dd6a5620a10","modified":1596297190000},{"_id":"themes/next/layout/_third-party/statistics/cnzz-analytics.swig","hash":"a17ace37876822327a2f9306a472974442c9005d","modified":1596297190000},{"_id":"themes/next/layout/_third-party/statistics/firestore.swig","hash":"b26ac2bfbe91dd88267f8b96aee6bb222b265b7a","modified":1596297190000},{"_id":"themes/next/layout/_third-party/statistics/index.swig","hash":"5f6a966c509680dbfa70433f9d658cee59c304d7","modified":1596297190000},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.swig","hash":"d56d5af427cdfecc33a0f62ee62c056b4e33d095","modified":1596297190000},{"_id":"themes/next/layout/_third-party/tags/mermaid.swig","hash":"f3c43664a071ff3c0b28bd7e59b5523446829576","modified":1596297190000},{"_id":"themes/next/layout/_third-party/tags/pdf.swig","hash":"d30b0e255a8092043bac46441243f943ed6fb09b","modified":1596297190000},{"_id":"themes/next/scripts/events/lib/config.js","hash":"d34c6040b13649714939f59be5175e137de65ede","modified":1596297190000},{"_id":"themes/next/scripts/events/lib/injects-point.js","hash":"6661c1c91c7cbdefc6a5e6a034b443b8811235a1","modified":1596297190000},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"f233d8d0103ae7f9b861344aa65c1a3c1de8a845","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"a54708fd9309b4357c423a3730eb67f395344a5e","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"2486f3e0150c753e5f3af1a3665d074704b8ee2c","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"7f2d93af012c1e14b8596fecbfc7febb43d9b7f5","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"7f8b92913d21070b489457fa5ed996d2a55f2c32","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"4c0c99c7e0f00849003dfce02a131104fb671137","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"e51dc3072c1ba0ea3008f09ecae8b46242ec6021","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"d5fefc31fba4ab0188305b1af1feb61da49fdeb0","modified":1596297190000},{"_id":"themes/next/scripts/filters/comment/valine.js","hash":"6cbd85f9433c06bae22225ccf75ac55e04f2d106","modified":1596297190000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"f4e694e5db81e57442c7e34505a416d818b3044a","modified":1596297190000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"612ec843372dae709acb17112c1145a53450cc59","modified":1596297190000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"62df49459d552bbf73841753da8011a1f5e875c8","modified":1596297190000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"f70be8e229da7e1715c11dd0e975a2e71e453ac8","modified":1596297190000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"818508748b7a62e02035e87fe58e75b603ed56dc","modified":1596297190000},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"0ac5ce155bc58c972fe21c4c447f85e6f8755c62","modified":1596297190000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1596297190000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"a47725574e1bee3bc3b63b0ff2039cc982b17eff","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"8e7b57a72e757cf95278239641726bb2d5b869d1","modified":1596297190000},{"_id":"themes/next/source/js/schemes/muse.js","hash":"1eb9b88103ddcf8827b1a7cbc56471a9c5592d53","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"ca5e70662dcfb261c25191cc5db5084dcf661c76","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"a1690e035b505d28bdef2b4424c13fc6312ab049","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"0b2c4b78eead410020d7c4ded59c75592a648df8","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"2e3bf7baf383c9073ec5e67f157d3cb3823c0957","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"b1f0fab7344a20ed6748b04065b141ad423cf4d9","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"a2e9e00962e43e98ec2614d6d248ef1773bb9b78","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"681d33e3bc85bdca407d93b134c089264837378c","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"8f58570a1bbc34c4989a47a1b7d42a8030f38b06","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"18ce72d90459c9aa66910ac64eae115f2dde3767","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"179e33b8ac7f4d8a8e76736a7e4f965fe9ab8b42","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"7785bd756e0c4acede3a47fec1ed7b55988385a5","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"bb7ace23345364eb14983e860a7172e1683a4c94","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"f6516d0f7d89dc7b6c6e143a5af54b926f585d82","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"7104b9cef90ca3b140d7a7afcf15540a250218fc","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"a717969829fa6ef88225095737df3f8ee86c286b","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"f0131db6275ceaecae7e1a6a3798b8f89f6c850d","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"6136da4bbb7e70cec99f5c7ae8c7e74f5e7c261a","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"93db5dafe9294542a6b5f647643cb9deaced8e06","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"4d1c17345d2d39ef7698f7acf82dfc0f59308c34","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"2b2e7b5cea7783c9c8bb92655e26a67c266886f0","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"e282df938bd029f391c466168d0e68389978f120","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"70a4324b70501132855b5e59029acfc5d3da1ebd","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"85da2f3006f4bef9a2199416ecfab4d288f848c4","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"44f47c88c06d89d06f220f102649057118715828","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"e740deadcfc4f29c5cb01e40f9df6277262ba4e3","modified":1596297190000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1596297190000},{"_id":"themes/next/source/lib/font-awesome/css/all.min.css","hash":"0038dc97c79451578b7bd48af60ba62282b4082b","modified":1596297190000},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-regular-400.woff2","hash":"260bb01acd44d88dcb7f501a238ab968f86bef9e","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"8a7fc03a568b95be8d3337195e38bc7ec5ba2b23","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"e2992846b39bf3857b5104675af02ba73e72eed5","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"9a878d0119785a2316f42aebcceaa05a120b9a7a","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"b49e9fbd3c182b8fc066b8c2caf248e3eb748619","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"e75693f33dbc92afc55489438267869ae2f3db54","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"902569a9dea90548bec21a823dd3efd94ff7c133","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"ded41fd9d20a5e8db66aaff7cc50f105f5ef2952","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"9f0b93d109c9aec79450c8a0cf4a4eab717d674d","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"72d495a88f7d6515af425c12cbc67308a57d88ea","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f49ca072b5a800f735e8f01fc3518f885951dd8e","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"65cb6edb69e94e70e3291e9132408361148d41d5","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"6a97bcfa635d637dc59005be3b931109e0d1ead5","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"f5c2788a78790aca1a2f37f7149d6058afb539e0","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-followme.styl","hash":"1e4190c10c9e0c9ce92653b0dbcec21754b0b69d","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"d114b2a531129e739a27ba6271cfe6857aa9a865","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"99e12c9ce3d14d4837e3d3f12fc867ba9c565317","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5b5649b9749e3fd8b63aef22ceeece0a6e1df605","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"a760ee83ba6216871a9f14c5e56dc9bd0d9e2103","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fafc96c86926b22afba8bb9418c05e6afbc05a57","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"2bd0eb1512415325653b26d62a4463e6de83c5ac","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"e771dcb0b4673e063c0f3e2d73e7336ac05bcd57","modified":1596297190000},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"d21d4ac1982c13d02f125a67c065412085a92ff2","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/footer/footer.styl","hash":"454a4aebfabb4469b92a8cbb49f46c49ac9bf165","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/header.styl","hash":"a793cfff86ad4af818faef04c18013077873f8f0","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/headerband.styl","hash":"0caf32492692ba8e854da43697a2ec8a41612194","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"5f432a6ed9ca80a413c68b00e93d4a411abf280a","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"e2d606f1ac343e9be4f15dbbaf3464bc4df8bf81","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"45a239edca44acecf971d99b04f30a1aafbf6906","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"b2fc519828fe89a1f8f03ff7b809ad68cd46f3d7","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"e7a9fdb6478b8674b1cdf94de4f8052843fb71d9","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/diff.styl","hash":"d3f73688bb7423e3ab0de1efdf6db46db5e34f80","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/highlight.styl","hash":"35c871a809afa8306c8cde13651010e282548bc6","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/theme.styl","hash":"3b3acc5caa0b95a2598bef4eeacb21bab21bea56","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2cb1876e9e0c9ac32160888af27b1178dbcb0616","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"f71a3e86c05ea668b008cf05a81f67d92b6d65e4","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"fa0222197b5eee47e18ac864cdc6eac75678b8fe","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"44487d9ab290dc97871fa8dd4487016deb56e123","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"1f0e7fbe80956f47087c2458ea880acf7a83078b","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"9b479c2f9a9bfed77885e5093b8245cc5d768ec7","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"a960a2dd587b15d3b3fe1b59525d6fa971c6a6ec","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"a05a4031e799bc864a4536f9ef61fe643cd421af","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"b3220db827e1adbca7880c2bb23e78fa7cbe95cb","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar.styl","hash":"a9cd93c36bae5af9223e7804963096274e8a4f03","modified":1596297190000},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"2a47f8a6bb589c2fb635e6c1e4a2563c7f63c407","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"1d2778ca5aeeeafaa690dc2766b01b352ab76a02","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"d7fce4b51b5f4b7c31d93a9edb6c6ce740aa0d6b","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"709d10f763e357e1472d6471f8be384ec9e2d983","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"e4d9a77ffe98e851c1202676940097ba28253313","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"f23670f1d8e749f3e83766d446790d8fd9620278","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/tags.styl","hash":"9e4c0653cfd3cc6908fa0d97581bcf80861fb1e7","modified":1596297190000},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"b49c64f8e9a6ca1c45c0ba98febf1974fdd03616","modified":1596297190000},{"_id":"themes/next/source/images/avatar.jpg","hash":"bd42bc2f990d78707c488b99d0d21c3dc587d30e","modified":1596328101000},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-solid-900.woff2","hash":"75a88815c47a249eadb5f0edc1675957f860cca7","modified":1596297190000},{"_id":"themes/next/source/lib/font-awesome/webfonts/fa-brands-400.woff2","hash":"509988477da79c146cb93fb728405f18e923c2de","modified":1596297190000},{"_id":"themes/next/source/images/logo.svg","hash":"5a4f99b6915fe7f59e4d1f197ce0d979c57872b2","modified":1596336066000},{"_id":"public/about/index.html","hash":"bcb9aefafab8f83d26b7c7df1f8fe64b9b7f17be","modified":1633614169094},{"_id":"public/archives/index.html","hash":"68e462533a6248af640dd31d5dcbbf8612c7bdba","modified":1633614169094},{"_id":"public/archives/2020/index.html","hash":"d9e7f3e75ca5f5af6b71de507388465cbe5d6e48","modified":1633614169094},{"_id":"public/archives/2020/08/index.html","hash":"689339a48a0ebc37646bf39a37f56ab543ac4d41","modified":1633614169094},{"_id":"public/index.html","hash":"5ff33947d293e0720dfc302dff9c10e03993686d","modified":1633614169094},{"_id":"public/2020/08/02/postgresql-optimizer-outline-3/index.html","hash":"fcc1d8c6b5a9edcc284e461e4130253a8fdbb594","modified":1633614169094},{"_id":"public/2020/08/02/postgresql-optimizer-outline-2/index.html","hash":"594c255dfbd623699b8f4b92e06948bb9db62eda","modified":1633614169094},{"_id":"public/2020/08/02/postgresql-optimizer-outline-1/index.html","hash":"d2480a215b08a49e4cce1969cf68b92d692e9f15","modified":1633614169094},{"_id":"public/CNAME","hash":"1abf4ed9424d03bbf169fb354620f024705bde24","modified":1596336357102},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1596336357102},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1596336357102},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1596336357102},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1596336357102},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1596336357102},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1596336357102},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1596336357102},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1596336357102},{"_id":"public/images/favicon-16x16-next.png","hash":"25dffea8b5603caf2ea77feb90bd9c1e86738713","modified":1596336357102},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1596336357102},{"_id":"public/images/favicon-32x32-next.png","hash":"ab599db2348f43f2cd71995e4d27e784847605aa","modified":1596336357102},{"_id":"public/lib/font-awesome/webfonts/fa-regular-400.woff2","hash":"260bb01acd44d88dcb7f501a238ab968f86bef9e","modified":1596336357102},{"_id":"public/2020/08/02/postgresql-optimizer-outline-2/1.jpg","hash":"7dd5636eac16621f1e2923c163c18983a64bf590","modified":1596336357102},{"_id":"public/2020/08/02/postgresql-optimizer-outline-2/2.jpg","hash":"8f1628d4fd45d15e91cf12ae9f5793cacbb0423c","modified":1596336357102},{"_id":"public/images/apple-touch-icon-next.png","hash":"c98146a0f81666956272fe692c1958fd1cf3d9a1","modified":1596336357102},{"_id":"public/images/avatar.jpg","hash":"bd42bc2f990d78707c488b99d0d21c3dc587d30e","modified":1596336357102},{"_id":"public/lib/font-awesome/webfonts/fa-brands-400.woff2","hash":"509988477da79c146cb93fb728405f18e923c2de","modified":1596336357102},{"_id":"public/lib/font-awesome/webfonts/fa-solid-900.woff2","hash":"75a88815c47a249eadb5f0edc1675957f860cca7","modified":1596336357102},{"_id":"public/images/logo.svg","hash":"5a4f99b6915fe7f59e4d1f197ce0d979c57872b2","modified":1596336357102},{"_id":"public/js/algolia-search.js","hash":"498d233eb5c7af6940baf94c1a1c36fdf1dd2636","modified":1596336357102},{"_id":"public/js/bookmark.js","hash":"9734ebcb9b83489686f5c2da67dc9e6157e988ad","modified":1596336357102},{"_id":"public/js/local-search.js","hash":"35ccf100d8f9c0fd6bfbb7fa88c2a76c42a69110","modified":1596336357102},{"_id":"public/js/motion.js","hash":"72df86f6dfa29cce22abeff9d814c9dddfcf13a9","modified":1596336357102},{"_id":"public/js/next-boot.js","hash":"a1b0636423009d4a4e4cea97bcbf1842bfab582c","modified":1596336357102},{"_id":"public/js/utils.js","hash":"2c6e6b4d9a592fbb4bf04689524db2cdfcd94ca7","modified":1596336357102},{"_id":"public/js/schemes/muse.js","hash":"1eb9b88103ddcf8827b1a7cbc56471a9c5592d53","modified":1596336357102},{"_id":"public/js/schemes/pisces.js","hash":"0ac5ce155bc58c972fe21c4c447f85e6f8755c62","modified":1596336357102},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1596336357102},{"_id":"public/css/main.css","hash":"38afd92942bc1de414d27567b614c311d1083e5c","modified":1596336357102},{"_id":"public/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1596336357102},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1596336357102},{"_id":"public/lib/font-awesome/css/all.min.css","hash":"0038dc97c79451578b7bd48af60ba62282b4082b","modified":1596336357102},{"_id":"source/_posts/postgresql-optimizer-outline-4.md","hash":"2db530cffe38825f62b67ca207b720f17ec5b799","modified":1596583097000},{"_id":"source/_posts/postgresql-optimizer-outline-4/1.png","hash":"8c8c6bf54553e00c4721d0312d99053203076e86","modified":1596582921000},{"_id":"source/_posts/postgresql-optimizer-outline-4/2.png","hash":"fb15c7b6a05bd9b50f72e37899a1e23aada14e9b","modified":1596582921000},{"_id":"public/2020/08/05/postgresql-optimizer-outline-4/index.html","hash":"37ec8b9f94b5f96b5a16cc22b97754a68d41f88a","modified":1633614169094},{"_id":"public/2020/08/05/postgresql-optimizer-outline-4/2.png","hash":"fb15c7b6a05bd9b50f72e37899a1e23aada14e9b","modified":1596583024481},{"_id":"public/2020/08/05/postgresql-optimizer-outline-4/1.png","hash":"8c8c6bf54553e00c4721d0312d99053203076e86","modified":1596583024481},{"_id":"source/_posts/postgresql-optimizer-outline-5.md","hash":"1db7bc5a33099f38a0ab397ce25287fd20a2aa3a","modified":1597419918000},{"_id":"public/2020/08/14/postgresql-optimizer-outline-5/index.html","hash":"6d7c6742a28bc91bcff78457d290225b068b52e3","modified":1633614169094},{"_id":"source/_posts/postgresql-optimizer-outline-6.md","hash":"e1ef8bcea928e0252cac28a5f199b17ab7eeba07","modified":1601685354000},{"_id":"public/2020/10/03/postgresql-optimizer-outline-6/index.html","hash":"1e4e1151b68ffec0c8bdfdc8075d378f66e83b4e","modified":1633614169094},{"_id":"public/archives/2020/10/index.html","hash":"29bb1e59a6c701cab0b49c88d2aea214a28fc3eb","modified":1633614169094},{"_id":"source/_posts/postgresql-optimizer-outline-8.md","hash":"7138a2d74d8b8b92372ee6a6f84ca302a9e056d2","modified":1601686863000},{"_id":"source/_posts/postgresql-optimizer-outline-9.md","hash":"5cbd63018518f572d6cd8d1100972f54686ba4cc","modified":1601687609000},{"_id":"source/_posts/postgresql-optimizer-outline-7/1.jpg","hash":"50c5074e7dbf176d1ebd5b45b5e5a941147126e8","modified":1527260674000},{"_id":"source/_posts/postgresql-optimizer-outline-7/3.png","hash":"6a34d81f9a58d35f6656d8b30ff603afc13eb151","modified":1527260687000},{"_id":"source/_posts/postgresql-optimizer-outline-9/1.png","hash":"7c1477a5ee41d9d541cceaf59f278b1460a857ee","modified":1527260717000},{"_id":"source/_posts/postgresql-optimizer-outline-9/2.png","hash":"1f58087cc2c9f30dba34d0bc6abe6ad34f5fb345","modified":1527260724000},{"_id":"source/_posts/postgresql-optimizer-outline-9/4.png","hash":"404e59978b659c9cf7d56d8dd456851480d0017d","modified":1527260736000},{"_id":"source/_posts/postgresql-optimizer-outline-7/.DS_Store","hash":"872a5b56a7f41a1fc54298a25149a150f2078d00","modified":1601686554000},{"_id":"source/_posts/postgresql-optimizer-outline-9/.DS_Store","hash":"764ae0cbe6b3609133570242eaa44dde709424d4","modified":1601687624000},{"_id":"source/_posts/postgresql-optimizer-outline-7.md","hash":"12b80578f6b1336a487c5ffa3f79d81926ba9f36","modified":1601687567000},{"_id":"source/_posts/postgresql-optimizer-outline-7/2.png","hash":"a73527127e774ddeae33912214b7f04052e7476a","modified":1527260681000},{"_id":"source/_posts/postgresql-optimizer-outline-7/4.png","hash":"e37eef8c2a5e6186fb13c32473984531afcd3301","modified":1527260695000},{"_id":"source/_posts/postgresql-optimizer-outline-7/5.png","hash":"fdc70d5ddabe15a5e324a26944fec62b3a8a3c38","modified":1527260701000},{"_id":"source/_posts/postgresql-optimizer-outline-7/6.png","hash":"16838273101e54a62b7c194c439976c04c031ced","modified":1527260707000},{"_id":"source/_posts/postgresql-optimizer-outline-9/3.png","hash":"84b7b9c69cc069c542bec3c6a48bf9efc6a356da","modified":1527260730000},{"_id":"public/tags/è·¯å¾-Path-é¡ºåºæ«æ-ç´¢å¼æ«æ-ä½å¾æ«æ-Join/index.html","hash":"5f8f0b9dfbcacbb6a8f7c0c4c086ca7a4eec9d43","modified":1633614169094},{"_id":"public/tags/ä»£ä»·-å¯å¨ä»£ä»·-IOä»£ä»·-CPUä»£ä»·/index.html","hash":"36c863be121159f20b074491b9ff8c988f5c5a64","modified":1633614169094},{"_id":"public/tags/å¨æè§å-èªåºåä¸-èªé¡¶åä¸/index.html","hash":"7aa3c98c461d049ec6aaab104a4e0f1c11ad3306","modified":1633614169094},{"_id":"public/2020/10/03/postgresql-optimizer-outline-9/index.html","hash":"e78c1d0ccdb558eb9ff9eeeb83e1ee5e2fb5d898","modified":1633614169094},{"_id":"public/2020/10/03/postgresql-optimizer-outline-8/index.html","hash":"97de29c4850415e383987ed58d0b0ea8c809c65e","modified":1633614169094},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/index.html","hash":"e21c65db2acd293fc30ea83280c063749c40f4f4","modified":1633614169094},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/1.jpg","hash":"50c5074e7dbf176d1ebd5b45b5e5a941147126e8","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-9/1.png","hash":"7c1477a5ee41d9d541cceaf59f278b1460a857ee","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-9/2.png","hash":"1f58087cc2c9f30dba34d0bc6abe6ad34f5fb345","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-9/4.png","hash":"404e59978b659c9cf7d56d8dd456851480d0017d","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-9/3.png","hash":"84b7b9c69cc069c542bec3c6a48bf9efc6a356da","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/3.png","hash":"6a34d81f9a58d35f6656d8b30ff603afc13eb151","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/4.png","hash":"e37eef8c2a5e6186fb13c32473984531afcd3301","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/5.png","hash":"fdc70d5ddabe15a5e324a26944fec62b3a8a3c38","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/6.png","hash":"16838273101e54a62b7c194c439976c04c031ced","modified":1601687415870},{"_id":"public/2020/10/03/postgresql-optimizer-outline-7/2.png","hash":"a73527127e774ddeae33912214b7f04052e7476a","modified":1601687415870},{"_id":"source/_posts/postgresql-optimizer-outline-10.md","hash":"49dfab0578d37dd292f589d6c6014f0dc6e067f0","modified":1601688572000},{"_id":"public/2020/10/03/postgresql-optimizer-outline-10/index.html","hash":"21d7c6aa32a4591acdeddbc49c3cd7c4316a9f84","modified":1633614169094},{"_id":"source/_posts/postgresql-lock-spinlock-implement.md","hash":"ea26ade52e5315b70bad2ca160a8aa8a5b66bfa6","modified":1612599947000},{"_id":"public/archives/page/2/index.html","hash":"ac0baa5b6370262688ae4cabb680ff280316ebb8","modified":1633614169094},{"_id":"public/archives/2021/index.html","hash":"4394bad57aa61601750a0822e0c53574ec5e0917","modified":1633614169094},{"_id":"public/archives/2021/02/index.html","hash":"489f9b0c971aa450dc21f6a827b46fa3f2c0294c","modified":1633614169094},{"_id":"public/page/2/index.html","hash":"e17ac7dbec05197ba7048df0c36bc3f96ea6ddde","modified":1633614169094},{"_id":"public/tags/lock-spinlock-transaction-postgresql/index.html","hash":"ca19ccf675b60f3e2bd0c26ef1603c5305a65be8","modified":1633614169094},{"_id":"public/2021/02/06/postgresql-lock-spinlock-implement/index.html","hash":"b6dff1303ed28b55f28ddd1f33a489a6e7d1634d","modified":1633614169094},{"_id":"source/_posts/postgresql-lock-lwlock-implement/lockstate.jpg","hash":"b862e97340e5c8ce6ca95a0b4f429ba7b3f8b13d","modified":1553328346000},{"_id":"source/_posts/postgresql-lock-lwlock-implement/sxlock.jpg","hash":"e2c654dc3534222f8c9cca7151ca233b9e92e511","modified":1553438984000},{"_id":"source/_posts/postgresql-lock-lwlock-implement/waitqueue.jpg","hash":"88b3b3119a54e1ab17a0cd8121c292a028b0a217","modified":1554002287000},{"_id":"source/_posts/postgresql-lock-lwlock-implement.md","hash":"60c69cd65a66501b3deb1d499ea7a390a0c0b6e5","modified":1626738251000},{"_id":"public/2021/07/20/postgresql-lock-lwlock-implement/index.html","hash":"0d4050d8ed1d59b5eebcb9c4953973eb1f619ab0","modified":1633614169094},{"_id":"public/archives/2021/07/index.html","hash":"a6770acde5472c5b763e19e556ff802feb85d67c","modified":1633614169094},{"_id":"public/tags/lock-lwlock-transaction-postgresql/index.html","hash":"177f40dfc2deb3fcea1ab3078682a14c47109f28","modified":1633614169094},{"_id":"public/2021/07/20/postgresql-lock-lwlock-implement/lockstate.jpg","hash":"b862e97340e5c8ce6ca95a0b4f429ba7b3f8b13d","modified":1626738144043},{"_id":"public/2021/07/20/postgresql-lock-lwlock-implement/sxlock.jpg","hash":"e2c654dc3534222f8c9cca7151ca233b9e92e511","modified":1626738144043},{"_id":"public/2021/07/20/postgresql-lock-lwlock-implement/waitqueue.jpg","hash":"88b3b3119a54e1ab17a0cd8121c292a028b0a217","modified":1626738144043},{"_id":"source/_posts/postgresql-transaction-internals-introduce.md","hash":"e7fd82aee4a2dace7ad79ca59f6e445a159b24f8","modified":1628179115000},{"_id":"source/_posts/postgresql-transaction-internals-introduce/introduce.jpg","hash":"c256a598269c08804ed69bf3328301985fb178ed","modified":1627911924000},{"_id":"public/archives/2021/08/index.html","hash":"c3f1152a4cca9b374df7a15e2aa1b47c650af44a","modified":1633614169094},{"_id":"public/2021/08/02/postgresql-transaction-internals-introduce/index.html","hash":"68b98f39d7fa970ece69004fc577f673ac0bcd40","modified":1633614169094},{"_id":"public/tags/transaction-äºå¡-æ°ä¹¦-ææ¯åå¹-PostgreSQL/index.html","hash":"f70e70d64ec5b8f1cfd5deb99e8dd0c9e0915327","modified":1633614169094},{"_id":"public/2021/08/02/postgresql-transaction-internals-introduce/introduce.jpg","hash":"c256a598269c08804ed69bf3328301985fb178ed","modified":1627913400155},{"_id":"source/_posts/database-developer-say-no-to-us/have_no_tech.jpeg","hash":"ad8ef37dedc3e0610e221e498c6be114a82638d5","modified":1628177857000},{"_id":"source/_posts/postgresql-transaction-internals-introduce/.DS_Store","hash":"20b8c643b786d3639845ae6ca7d871362eb0e518","modified":1628178116000},{"_id":"source/_posts/database-developer-say-no-to-us.md","hash":"bceeb32211c1e14c6dd7dda029a841c775d6279d","modified":1628179260000},{"_id":"source/_posts/database-developer-say-no-to-us/buy_link.jpeg","hash":"8bf46356b49f0aedbb773a73990a7be589747902","modified":1628177622000},{"_id":"public/2021/08/05/database-developer-say-no-to-us/index.html","hash":"ee34abfd3fabf129733680ab53b7b08bbe66b321","modified":1633614169094},{"_id":"public/tags/database-transaction/index.html","hash":"51d892c2157e677fb8b85ab8fe4dd6a13a0fe737","modified":1633614169094},{"_id":"public/2021/08/05/database-developer-say-no-to-us/have_no_tech.jpeg","hash":"ad8ef37dedc3e0610e221e498c6be114a82638d5","modified":1628178302551},{"_id":"public/2021/08/05/database-developer-say-no-to-us/buy_link.jpeg","hash":"8bf46356b49f0aedbb773a73990a7be589747902","modified":1628178302551},{"_id":"source/_posts/postgresql-lock-vedio.md","hash":"e80c9e673b51ba16a3de29b166251bf4eee477da","modified":1633614145000},{"_id":"public/2021/10/07/postgresql-lock-vedio/index.html","hash":"675fcaa5de773c90020731bbfd625e880260ac37","modified":1633614169094},{"_id":"public/archives/2021/10/index.html","hash":"afa29e072679ec7db6caf35fec255c5cd76b6cad","modified":1633614169094},{"_id":"public/tags/PostgreSQL-äºå¡-é-æ°æ®åº/index.html","hash":"6fddff022f9f9051f37283e8881ae12bd44aa8cb","modified":1633614169094}],"Category":[],"Data":[],"Page":[{"title":"å¼ æ æ°","date":"2020-08-02T02:00:11.000Z","_content":"\n\n* ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã\n* ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã\n","source":"about/index.md","raw":"---\ntitle: å¼ æ æ°\ndate: 2020-08-02 10:00:11\n---\n\n\n* ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã\n* ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã\n","updated":"2021-07-19T23:55:18.000Z","path":"about/index.html","_id":"ckdchg8j80000r2s6dnmidrbh","comments":1,"layout":"page","content":"<ul>\n<li>ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã</li>\n<li>ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<ul>\n<li>ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã</li>\n<li>ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã</li>\n</ul>\n"}],"Post":[{"title":"PostgreSQLä¼åå¨ç½è¯(1) - ä¸ºä»ä¹ä¼å","date":"2020-08-02T00:35:06.000Z","_content":"\n\nå°æèä¸äºåæ¸å¤§å­¦çè®¡ç®æºç ç©¶çï¼ä»å¹´å­¦æ ¡å¼äºæ°æ®åºåççè¯¾ç¨ï¼å°æå¯¹æ¥è¯¢ä¼åçé¨åä¸æ¯å¾çè§£ï¼è½ç¶å·²ç»ä½¿åºäºæ´ªèä¹åï¼ä»ç¶è§å¾å¶ä¸­çé¨ååçæäºæ¦æ¶©é¾æï¼äºæ¯å°ææç®é®ä¸ä¸èªå·±çå¥å¥å¤§æï¼å¤§ææ¯ä¸ä½èµæ·±çæ°æ®åºåæ ¸å¼åçèç åï¼å¯¹Greenplum/HAWQæ°æ®åºæå¤å¹´çåæ ¸å¼åç»éª<!-- more -->ï¼ååç¼éçä¸çåååå¹´è½®ä¸æ ·æ·±æ·±çè§è¯çå¤§æåå¤å¹´çä»ä¸ç»åï¼ç¥éå°æè¦æ¥é®é®é¢ï¼å¤§ææç¹ç´§å¼ ï¼è½ç¶èªå·±åæ°æ®åºåæ ¸å¥½å¤å¹´äºï¼ä½æ¯å¯¹ä¼åå¨ç ç©¶å´ä¸æ·±å¥ï¼å¦æè¢«å°æè¿æ ·çå°èé¸é®åå°±å°´å°¬äºï¼äºæ¯å¤§æåªå¥½ä¸´æ¶æ±ä½èï¼æ¿åºäºå¥½å¤å¹´ä¸ççãæ°æ®åºç³»ç»å®ç°ãåäºèµ·æ¥ã\n\nå°ææåºçç¬¬ä¸ä¸ªé®é¢æ¯ï¼âä¸ºä»ä¹æ°æ®åºè¦è¿è¡æ¥è¯¢ä¼åï¼â\n\nå¤§ææ¨äºæ¨é¼»æ¢ä¸çç¼éï¼ç¹ä¸äºä¸æ ¹ä¸­åæ·±å¸ä¸å£ï¼ç«çº¢ççå¤´å¥åçç§ï¼ç±æåæï¼å ççç°é£é£æ¸ºæ¸ºçæ£è½ä¸æ¥ï¼ååå¤§æååºçäºé¾äº¤ç¼ å¨ä¸èµ·ï¼å³è½»çåå¾å¨ï¼å¤§æå¼¹äºå¼¹çç°ï¼æ¢æ¡æ¯ççè¯´ï¼âä¸æ­¢æ¯æ°æ®åºè¦è¿è¡ä¼åï¼åºæ¬ä¸ææçç¼ç¨è¯­è¨å¨ç¼è¯çæ¶åé½ä¼ä¼åï¼æ¯å¦ä½ å¨ç¼è¯Cè¯­è¨çæ¶åï¼å¯ä»¥éè¿ç¼è¯éé¡¹-oæ¥æå®è¿è¡åªä¸ªçº§å«çä¼åï¼ä½æ¯æ¥è¯¢æ°æ®åºçæ¥è¯¢ä¼ååCè¯­è¨çä¼åè¿æäºåºå«ãâ\n\nâæåªäºåºå«å¢ï¼âå¤§æåé¡¿äºä¸ä¸ï¼åè§çå°æï¼ä»¿ä½ææå°æç»åºç­æ¡ï¼æèæ¯ç»å°æè¾æªåºè¶³å¤æèçç©ºé´ï¼ä¸äºç§ä¹åå¤§æåèªé®èªç­éï¼âCè¯­è¨æ¯è¿ç¨åè¯­è¨ï¼ä½ å·²ç»æå®å¥½äºéè¦æ§è¡çæ¯ä¸ä¸ªæ­¥éª¤ï¼ä½æ¯SQLæ¯æè¿°æ§è¯­è¨ï¼å®åªæå®äºWHATï¼èæ²¡ææå®HOWï¼è¿æ ·å®çä¼åç©ºé´å°±å¤§äºï¼ä½ è¯´æ¯ä¸æ¯ï¼â\n\nå°æç¹äºç¹å¤´è¯´ï¼âå¯¹ï¼ä¹å°±æ¯è¯´æ¡æ¡å¤§è·¯éç½é©¬ï¼å®æ¯è¿ç¨è¯­è¨çéæ©æ´å¤ï¼æ¯ä¸æ¯è¿æ ·ï¼âå¤§æç¬éï¼âå­ºå­å¯æä¹ãè½ç¶æä»¬ç¥éå®çä¼åç©ºé´å¤§ï¼ä½å·ä½å¦ä½ä¼åå¢ï¼â\n\nè¯´çå¤§æå°èº«å­åæ²åéé ä»¥é ï¼ç¿ä¸äºéè¿ç»§ç»­è¯´ï¼âéå¸¸æ¥è¯´åæä¸¤ä¸ªå±é¢ï¼ä¸ä¸ªæ¯åºäºè§åçä¼åï¼å¦ä¸ä¸ªæ¯åºäºä»£ä»·çä¼åï¼åºäºè§åçä¼åä¹å¯ä»¥å«é»è¾ä¼åæèè§åä¼åï¼åºäºä»£ä»·çä¼åä¹å¯ä»¥å«ç©çä¼åæèä»£ä»·ä¼åãâå¤§æè¾¹è¯´è¾¹ç¨ææ¯åçï¼æéççç«ä¹æ¬¢å¿«çè·³è·çã\n\nâé£ä¸ºä»ä¹è¦è¿è¡è¿æ ·çåºåå¢ï¼ä¼åå°±ä¼ååï¼ä½å¿è¿åä»ä¹è§ååä»£ä»·å¢ï¼âï¼å°æé®éã\n\nâåå±ä¸åå±ä¸æ¯éç¹ï¼æäºä¼åå¨å±æ¬¡åçæ¸æ¥ç¹ï¼æäºä¼åå¨å±æ¬¡åçå°±ä¸é£ä¹æ¸æ¥ï¼é½åªæ¯ä¼åææ®µèå·²ãâå¤§ææå°æç¹å¿èï¼åè¿ä¹é®ä¸å»ææè¦è¢«é®ä½ï¼äºæ¯è¯å¾å¼å¼è¯é¢ï¼âæä»¬ç»§ç»­è¯´è¯´SQLè¯­è¨å§ï¼æä»¬è¯´å®æ¯ä¸ç§ä»äºå³ç³»æ¼ç®åå³ç³»ä»£æ°ä¹é´çè¯­è¨ï¼å³ç³»æ¼ç®åå³ç³»ä»£æ°ä½ çè¿å§ï¼â\n\nå°ææ³äºæ³ï¼å¥½åèªå·±ä¸è¯¾çæ¶åèå¸è¯´è¿å³ç³»ä»£æ°ï¼ä½æ¯æ²¡æè¯´å³ç³»æ¼ç®ï¼äºæ¯è¯´ï¼âæ¥è§¦è¿ä¸ç¹ï¼ä½ä¹ä¸æ¯ç¹å«æç½ãâå¤§æå¾æçè¯´ï¼âå³ç³»æ¼ç®æ¯çº¯æè¿°æ§çè¯­è¨ï¼èå³ç³»ä»£æ°å¢ï¼ååå«äºä¸äºåºæ¬çå³ç³»æä½ï¼SQLä¸»è¦åé´çæ¯å³ç³»æ¼ç®ï¼ä¹åå«äºå³ç³»ä»£æ°çä¸é¨åç¹ç¹ãâ\n\nå¤§æçå°ææç¹æµï¼é¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´éï¼âä½ ä»¬ä¸è¯¾çæ¶åèå¸ææ²¡æè¯´è¿å³ç³»ä»£æ°çåºæ¬æä½ï¼âå°ææ³äºä¸ä¸è¯´ï¼âå¥½åè¯´äºï¼ææå½±ãéæ©ãè¿æ¥ãäº¤éãå·®éè¿å ä¸ªãâå¤§æç¹ç¹å¤´è¯´ï¼âå¯¹çï¼è¿å¯ä»¥æä¸ä¸ªå«éå½åçï¼ä¸å±6ä¸ªåºæ¬æä½ï¼å¦å¤ç»åå®éåºç¨å¨è¿äºåºæ¬æä½ä¹ä¸åæ©å±åºäºå¤è¿æ¥ãåè¿æ¥ãèéæä½ãåç»æä½ç­ç­ãâ\n\nå¤§æåæ·±å¸äºä¸å£çï¼ä¼éçåäºä¸ªçåï¼ç»§ç»­è¯´éï¼âSQLè¯­å¥è½ç¶æ¯æè¿°æ§çï¼ä½æ¯æä»¬å¯ä»¥æå®è½¬åæä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼èå³ç³»ä»£æ°ä¸­å¢ï¼åæä¸äºç­ä»·çè§åï¼è¿æ ·æä»¬å°±è½ç»åè¿äºç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çè½¬æ¢ãâ\n\nâè¿è¡ç­ä»·è½¬æ¢çç®çæ¯æ¾å°æ§è½æ´å¥½çä»£æ°è¡¨è¾¾å¼å§ï¼âå°æé®ã\n\nâå¯¹ï¼å°±æ¯è¿æ ·ãâå¤§æææ¥èµè®¸çç®åã\n\nâé£ä¹å¦ä½ç¡®å®ç­ä»·åæ¢ä¹åçè¡¨è¾¾å¼å°±è½åå¾æ¯åæ¢ä¹åæ§è½æ´å¥½å¢ï¼æèè¯´ä¸ºä»ä¹æä»¬è¦è¿è¡è¿æ ·çç­ä»·åæ¢ï¼èä¸æ¯ä½¿ç¨åæ¥çè¡¨è¾¾å¼å¢ï¼â\n\nå¤§ææ£äºä¸ä¸ï¼ä»¿ä½æ²¡ææ³å°å°æä¼æåºè¿æ ·çé®é¢ï¼ä½æ¯åºäºèªå·±å¤å¹´çå¿½æ ç»éªï¼ä»å®äºå®ç¥ï¼åç­éï¼âè¿æ¢æç»éªçæåï¼ä¹æéåçèèãä¾å¦å°éæ©æä½ä¸æ¨ï¼å°±è½ä¼åè¿æ»¤æ°æ®ï¼é£ä¹è¡¨è¾¾å¼çä¸å±è®¡ç®ç»ç¹å°±è½éä½è®¡ç®éï¼å æ­¤å¾å®¹æå¯ä»¥ç¥éæ¯è½éä½ä»£ä»·çãåä¾å¦æä»¬éå¸¸ä¼å¯¹ç¸å³çå­æ¥è¯¢è¿è¡æåï¼è¿æ¯å ä¸ºå¦æä¸æåè¿ç§å­æ¥è¯¢ï¼é£ä¹å®æ§è¡çæ¶åå°±ä¼äº§çä¸ä¸ªåµå¥å¾ªç¯ï¼è¿ç§åµå¥å¾ªç¯çæ§è¡ä»£ä»·æ¯O(N^2)ï¼è¿ç§å¤æåº¦å·²ç»æ¯æåçæåµäºï¼æåä¸æ¥è³å°ä¸ä¼æ¯å®å·®ï¼å æ­¤æåä¸æ¥æ¯æä»·å¼çãâå¤§æå¿éå¯¹èªå·±çä¸´å±ä¸ä¹±ææç¹äºä¸ªèµã\n\nå¤§æçå°ææ²¡ææé®ï¼ç»§ç»­è¯´éï¼âè¿äºåºäºå³ç³»ä»£æ°ç­ä»·è§ååç­ä»·åæ¢çä¼åï¼å°±æ¯åºäºè§åçä¼åï¼å½ç¶æ°æ®åºæ¬èº«ä¹ä¼ç»åå®éçç»éªï¼äº§çä¸äºä¼åè§åï¼æ¯å¦å¤è¿æ¥æ¶é¤ï¼å ä¸ºå¤è¿æ¥ä¼åèµ·æ¥ä¸å¤ªæ¹ä¾¿ï¼å¦æè½æå®æ¶é¤æï¼æä»¬å°±æäºæ´å¤§çä¼åç©ºé´ï¼è¿äºç»ç»é½æ¯åºäºè§åçä¼åãåæ¶è¿äºé½æ¯å»ºç«å¨é»è¾æä½ç¬¦ä¸çä¼åï¼è¿ä¹æ¯ä¸ºä»ä¹åºäºè§åçä¼åä¹å«åé»è¾ä¼åãâ\n\nå°ææ³äºæ³ï¼èªå·±å¥½åå¯¹é»è¾æä½ç¬¦ä¸å¤ªçè§£ï¼è¿å¿é®ï¼âé»è¾æä½ç¬¦æ¯å¥ï¼æ¢ç¶æç©çä¼åï¼é¾éè¿æç©çæä½ç¬¦åï¼â\n\nå¤§æçèªå·±ççå·²ç»ç§çåªå©ä¸è¿æ»¤å´äºï¼è¿å¿æçå¤´æå°çç°ç¼¸ï¼ä¼¸ä¸ªæè°ç»§ç»­è¯´ï¼âæ¯å¦è¯´å§ï¼ä½ å¨SQLè¯­å¥éåä¸äºä¸¤ä¸ªè¡¨è¦åä¸ä¸ªå·¦å¤è¿æ¥ï¼é£ä¹æ°æ®åºæä¹æ¥åè¿ä¸ªå·¦å¤è¿æ¥å¢ï¼â\n\nå°æä¸å¤´é¾æ°´çææå¤´ï¼å¯¹å¤§ææåºäºæå¾çç¼ç¥ã\n\nå¤§æèªé®èªç­çç»§ç»­è¯´éï¼âæ°æ®åºè¯´æä¹ä¸ç¥éåï¼ä½ è¯´çå·¦å¤è¿æ¥ææææï¼ä½æä¹ä¸ç¥éæä¹å®ç°åï¼ä½ éè¦åè¯æå®ç°æ¹æ³åï¼å æ­¤ä¼åå¨è¿æ¿æäºä¸ä¸ªä»»å¡ï¼å°±æ¯åè¯æ§è¡å¨ï¼æä¹æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥ãâ\n\nå¤§æä¸è¾¹è¯´ï¼ä¸è¾¹ä»è¶å ä¸æçæ¿èµ·æ¥ï¼åå¤åæ½ä¸æ ¹ï¼å´å°´å°¬çåç°ï¼ççéä¸æ ¹çé½æ²¡æäºï¼å¤§ææç©ºççå¼¹è¿åå¾æ¡¶ï¼ç»§ç»­è¯´ï¼âæ°æ®åºæåªäºæ¹æ³æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥å¢ï¼å®å¯ä»¥ç¨åµå¥å¾ªç¯è¿æ¥ãåå¸è¿æ¥ãå½å¹¶è¿æ¥ç­ç­ï¼æ³¨æäºï¼éè¦çäºæè¯´ä¸éï¼ä½ çåè¿æ¥ãå¤è¿æ¥æ¯è¿æ¥æä½ï¼åµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥ç­ä¹å«è¿æ¥ï¼ä½åè¿æ¥ãå¤è¿æ¥è¿äºå°±æ¯é»è¾æä½ç¬¦ï¼èåµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥è¿äºå°±æ¯ç©çæä½ç¬¦ãæä»¥ä½ è¯´å¯¹äºï¼ç©çä¼åå°±æ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åãâ\n\nå¤§æåé®å°æï¼âä½ è¦ä»åäº¬å»ä¸æµ·ï¼ä½ è¯´ä½ æä¹å»ï¼â\n\nå°æè¯´ï¼âåé«éåï¼åå¿«åæ¹ä¾¿ãâ\n\nå¤§æç»§ç»­é®ï¼âåé«éåå»å¹¿å·ï¼ç¶ååè½¦å°ä¸æµ·è¡ä¸è¡ï¼â\n\nå°æè¯´ï¼âæç¹æå¿äºï¼è¿ä¸æ¯åé¥±äºæçåï¼â\n\nå¤§æè¿½é®ï¼âä¸ºä»ä¹ï¼â\n\nå°æè¯´ï¼âå¾ææ¾ï¼ææç´è¾¾çé«éï¼å³èçæ¶é´ï¼åèçè´¹ç¨ï¼åå»å¹¿å·ååè½¦ï¼æèå­ç¦ç¹äºï¼ï¼â\n\nå¤§æç¬äºç¬è¯´ï¼âä¸ç¥ä¸è§ä¹é´ï¼ä½ çå¤§èå°±å»ºç«äºä¸ä¸ªä»£ä»·æ¨¡åï¼é£å°±æ¯æ§ä»·æ¯ï¼ä¼åå¨ä½ä¸ºæ°æ®åºçå¤§èï¼ä¹éè¦å»ºç«ä»£ä»·æ¨¡åï¼å¯¹ç©çæä½ç¬¦è®¡ç®ä»£ä»·ï¼ç¶åç­éåºæä¼çç©çæä½ç¬¦æ¥ï¼å æ­¤åºäºä»£ä»·çä¼åæ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åï¼æä»¥ä¹å«ç©çä¼åãâ\n\nå°æè§å¾ä¼¼ä¹æäºï¼âå¬å¸æ´¾æå»ä¸æµ·åºå·®å°±æ¯ä¸ä¸ªé»è¾æä½ç¬¦ï¼å®åæä»¬åä¸ä¸ªSQLè¯­å¥è¦æ±æ°æ®åºå¯¹ä¸¤ä¸ªè¡¨åå·¦å¤è¿æ¥ç±»ä¼¼ï¼èå»ä¸æµ·çå®éè·¯å¾æå¾å¤ç§ï¼è¿äºå°±åæ¯ç©çæä½ç¬¦ï¼æä»¬å¯¹è¿äºå®éçç©çè·¯å¾è®¡ç®ä»£ä»·ä¹åï¼å°±å¯ä»¥éåºæ¥æå¥½çè·¯å¾äºãâ\n\nå¤§ææåºææºï¼åå«æå¼äºç½åå°å¾APPåé«è¾¾å°å¾APPï¼è¾å¥äºåäº¬å°ä¸æµ·çä¿¡æ¯ï¼ç¶åæ¿ç»å°æçï¼å°æåç°ä¸¤å®¶APPç»åºçæä¼è·¯å¾æ¯ä¸ä¸æ ·çãå°æè¥æææçè¯´ï¼âçæ¥ä»£ä»·æ¨¡åå¾éè¦ï¼ä»£ä»·æ¨¡åæ¯ä¸æ¯åç¡®å³å®äºæä¼è·¯å¾éæ©çæ¯ä¸æ¯åç¡®ãâ\nå¤§æä¸æå¤§è¿ï¼ç¬çè¯´ï¼âå¤ªå¯¹äºï¼æä»¥æä½ä¸ºä¸ä¸ªæ°æ®åºåæ ¸çèµæ·±å¼åäººåï¼éè¦ä¸æ­çè°æ´ä¼åå¨çä»£ä»·æ¨¡åï¼ä»¥ææè·å¾ä¸ä¸ªç¸å¯¹ç¨³å®çä»£ä»·æ¨¡åï¼ä¸è¿ä»ç¶æ¯ä»»ééè¿åãâ\n","source":"_posts/postgresql-optimizer-outline-1.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(1) - ä¸ºä»ä¹ä¼å\ndate: 2020-08-02 08:35:06\n---\n\n\nå°æèä¸äºåæ¸å¤§å­¦çè®¡ç®æºç ç©¶çï¼ä»å¹´å­¦æ ¡å¼äºæ°æ®åºåççè¯¾ç¨ï¼å°æå¯¹æ¥è¯¢ä¼åçé¨åä¸æ¯å¾çè§£ï¼è½ç¶å·²ç»ä½¿åºäºæ´ªèä¹åï¼ä»ç¶è§å¾å¶ä¸­çé¨ååçæäºæ¦æ¶©é¾æï¼äºæ¯å°ææç®é®ä¸ä¸èªå·±çå¥å¥å¤§æï¼å¤§ææ¯ä¸ä½èµæ·±çæ°æ®åºåæ ¸å¼åçèç åï¼å¯¹Greenplum/HAWQæ°æ®åºæå¤å¹´çåæ ¸å¼åç»éª<!-- more -->ï¼ååç¼éçä¸çåååå¹´è½®ä¸æ ·æ·±æ·±çè§è¯çå¤§æåå¤å¹´çä»ä¸ç»åï¼ç¥éå°æè¦æ¥é®é®é¢ï¼å¤§ææç¹ç´§å¼ ï¼è½ç¶èªå·±åæ°æ®åºåæ ¸å¥½å¤å¹´äºï¼ä½æ¯å¯¹ä¼åå¨ç ç©¶å´ä¸æ·±å¥ï¼å¦æè¢«å°æè¿æ ·çå°èé¸é®åå°±å°´å°¬äºï¼äºæ¯å¤§æåªå¥½ä¸´æ¶æ±ä½èï¼æ¿åºäºå¥½å¤å¹´ä¸ççãæ°æ®åºç³»ç»å®ç°ãåäºèµ·æ¥ã\n\nå°ææåºçç¬¬ä¸ä¸ªé®é¢æ¯ï¼âä¸ºä»ä¹æ°æ®åºè¦è¿è¡æ¥è¯¢ä¼åï¼â\n\nå¤§ææ¨äºæ¨é¼»æ¢ä¸çç¼éï¼ç¹ä¸äºä¸æ ¹ä¸­åæ·±å¸ä¸å£ï¼ç«çº¢ççå¤´å¥åçç§ï¼ç±æåæï¼å ççç°é£é£æ¸ºæ¸ºçæ£è½ä¸æ¥ï¼ååå¤§æååºçäºé¾äº¤ç¼ å¨ä¸èµ·ï¼å³è½»çåå¾å¨ï¼å¤§æå¼¹äºå¼¹çç°ï¼æ¢æ¡æ¯ççè¯´ï¼âä¸æ­¢æ¯æ°æ®åºè¦è¿è¡ä¼åï¼åºæ¬ä¸ææçç¼ç¨è¯­è¨å¨ç¼è¯çæ¶åé½ä¼ä¼åï¼æ¯å¦ä½ å¨ç¼è¯Cè¯­è¨çæ¶åï¼å¯ä»¥éè¿ç¼è¯éé¡¹-oæ¥æå®è¿è¡åªä¸ªçº§å«çä¼åï¼ä½æ¯æ¥è¯¢æ°æ®åºçæ¥è¯¢ä¼ååCè¯­è¨çä¼åè¿æäºåºå«ãâ\n\nâæåªäºåºå«å¢ï¼âå¤§æåé¡¿äºä¸ä¸ï¼åè§çå°æï¼ä»¿ä½ææå°æç»åºç­æ¡ï¼æèæ¯ç»å°æè¾æªåºè¶³å¤æèçç©ºé´ï¼ä¸äºç§ä¹åå¤§æåèªé®èªç­éï¼âCè¯­è¨æ¯è¿ç¨åè¯­è¨ï¼ä½ å·²ç»æå®å¥½äºéè¦æ§è¡çæ¯ä¸ä¸ªæ­¥éª¤ï¼ä½æ¯SQLæ¯æè¿°æ§è¯­è¨ï¼å®åªæå®äºWHATï¼èæ²¡ææå®HOWï¼è¿æ ·å®çä¼åç©ºé´å°±å¤§äºï¼ä½ è¯´æ¯ä¸æ¯ï¼â\n\nå°æç¹äºç¹å¤´è¯´ï¼âå¯¹ï¼ä¹å°±æ¯è¯´æ¡æ¡å¤§è·¯éç½é©¬ï¼å®æ¯è¿ç¨è¯­è¨çéæ©æ´å¤ï¼æ¯ä¸æ¯è¿æ ·ï¼âå¤§æç¬éï¼âå­ºå­å¯æä¹ãè½ç¶æä»¬ç¥éå®çä¼åç©ºé´å¤§ï¼ä½å·ä½å¦ä½ä¼åå¢ï¼â\n\nè¯´çå¤§æå°èº«å­åæ²åéé ä»¥é ï¼ç¿ä¸äºéè¿ç»§ç»­è¯´ï¼âéå¸¸æ¥è¯´åæä¸¤ä¸ªå±é¢ï¼ä¸ä¸ªæ¯åºäºè§åçä¼åï¼å¦ä¸ä¸ªæ¯åºäºä»£ä»·çä¼åï¼åºäºè§åçä¼åä¹å¯ä»¥å«é»è¾ä¼åæèè§åä¼åï¼åºäºä»£ä»·çä¼åä¹å¯ä»¥å«ç©çä¼åæèä»£ä»·ä¼åãâå¤§æè¾¹è¯´è¾¹ç¨ææ¯åçï¼æéççç«ä¹æ¬¢å¿«çè·³è·çã\n\nâé£ä¸ºä»ä¹è¦è¿è¡è¿æ ·çåºåå¢ï¼ä¼åå°±ä¼ååï¼ä½å¿è¿åä»ä¹è§ååä»£ä»·å¢ï¼âï¼å°æé®éã\n\nâåå±ä¸åå±ä¸æ¯éç¹ï¼æäºä¼åå¨å±æ¬¡åçæ¸æ¥ç¹ï¼æäºä¼åå¨å±æ¬¡åçå°±ä¸é£ä¹æ¸æ¥ï¼é½åªæ¯ä¼åææ®µèå·²ãâå¤§ææå°æç¹å¿èï¼åè¿ä¹é®ä¸å»ææè¦è¢«é®ä½ï¼äºæ¯è¯å¾å¼å¼è¯é¢ï¼âæä»¬ç»§ç»­è¯´è¯´SQLè¯­è¨å§ï¼æä»¬è¯´å®æ¯ä¸ç§ä»äºå³ç³»æ¼ç®åå³ç³»ä»£æ°ä¹é´çè¯­è¨ï¼å³ç³»æ¼ç®åå³ç³»ä»£æ°ä½ çè¿å§ï¼â\n\nå°ææ³äºæ³ï¼å¥½åèªå·±ä¸è¯¾çæ¶åèå¸è¯´è¿å³ç³»ä»£æ°ï¼ä½æ¯æ²¡æè¯´å³ç³»æ¼ç®ï¼äºæ¯è¯´ï¼âæ¥è§¦è¿ä¸ç¹ï¼ä½ä¹ä¸æ¯ç¹å«æç½ãâå¤§æå¾æçè¯´ï¼âå³ç³»æ¼ç®æ¯çº¯æè¿°æ§çè¯­è¨ï¼èå³ç³»ä»£æ°å¢ï¼ååå«äºä¸äºåºæ¬çå³ç³»æä½ï¼SQLä¸»è¦åé´çæ¯å³ç³»æ¼ç®ï¼ä¹åå«äºå³ç³»ä»£æ°çä¸é¨åç¹ç¹ãâ\n\nå¤§æçå°ææç¹æµï¼é¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´éï¼âä½ ä»¬ä¸è¯¾çæ¶åèå¸ææ²¡æè¯´è¿å³ç³»ä»£æ°çåºæ¬æä½ï¼âå°ææ³äºä¸ä¸è¯´ï¼âå¥½åè¯´äºï¼ææå½±ãéæ©ãè¿æ¥ãäº¤éãå·®éè¿å ä¸ªãâå¤§æç¹ç¹å¤´è¯´ï¼âå¯¹çï¼è¿å¯ä»¥æä¸ä¸ªå«éå½åçï¼ä¸å±6ä¸ªåºæ¬æä½ï¼å¦å¤ç»åå®éåºç¨å¨è¿äºåºæ¬æä½ä¹ä¸åæ©å±åºäºå¤è¿æ¥ãåè¿æ¥ãèéæä½ãåç»æä½ç­ç­ãâ\n\nå¤§æåæ·±å¸äºä¸å£çï¼ä¼éçåäºä¸ªçåï¼ç»§ç»­è¯´éï¼âSQLè¯­å¥è½ç¶æ¯æè¿°æ§çï¼ä½æ¯æä»¬å¯ä»¥æå®è½¬åæä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼èå³ç³»ä»£æ°ä¸­å¢ï¼åæä¸äºç­ä»·çè§åï¼è¿æ ·æä»¬å°±è½ç»åè¿äºç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çè½¬æ¢ãâ\n\nâè¿è¡ç­ä»·è½¬æ¢çç®çæ¯æ¾å°æ§è½æ´å¥½çä»£æ°è¡¨è¾¾å¼å§ï¼âå°æé®ã\n\nâå¯¹ï¼å°±æ¯è¿æ ·ãâå¤§æææ¥èµè®¸çç®åã\n\nâé£ä¹å¦ä½ç¡®å®ç­ä»·åæ¢ä¹åçè¡¨è¾¾å¼å°±è½åå¾æ¯åæ¢ä¹åæ§è½æ´å¥½å¢ï¼æèè¯´ä¸ºä»ä¹æä»¬è¦è¿è¡è¿æ ·çç­ä»·åæ¢ï¼èä¸æ¯ä½¿ç¨åæ¥çè¡¨è¾¾å¼å¢ï¼â\n\nå¤§ææ£äºä¸ä¸ï¼ä»¿ä½æ²¡ææ³å°å°æä¼æåºè¿æ ·çé®é¢ï¼ä½æ¯åºäºèªå·±å¤å¹´çå¿½æ ç»éªï¼ä»å®äºå®ç¥ï¼åç­éï¼âè¿æ¢æç»éªçæåï¼ä¹æéåçèèãä¾å¦å°éæ©æä½ä¸æ¨ï¼å°±è½ä¼åè¿æ»¤æ°æ®ï¼é£ä¹è¡¨è¾¾å¼çä¸å±è®¡ç®ç»ç¹å°±è½éä½è®¡ç®éï¼å æ­¤å¾å®¹æå¯ä»¥ç¥éæ¯è½éä½ä»£ä»·çãåä¾å¦æä»¬éå¸¸ä¼å¯¹ç¸å³çå­æ¥è¯¢è¿è¡æåï¼è¿æ¯å ä¸ºå¦æä¸æåè¿ç§å­æ¥è¯¢ï¼é£ä¹å®æ§è¡çæ¶åå°±ä¼äº§çä¸ä¸ªåµå¥å¾ªç¯ï¼è¿ç§åµå¥å¾ªç¯çæ§è¡ä»£ä»·æ¯O(N^2)ï¼è¿ç§å¤æåº¦å·²ç»æ¯æåçæåµäºï¼æåä¸æ¥è³å°ä¸ä¼æ¯å®å·®ï¼å æ­¤æåä¸æ¥æ¯æä»·å¼çãâå¤§æå¿éå¯¹èªå·±çä¸´å±ä¸ä¹±ææç¹äºä¸ªèµã\n\nå¤§æçå°ææ²¡ææé®ï¼ç»§ç»­è¯´éï¼âè¿äºåºäºå³ç³»ä»£æ°ç­ä»·è§ååç­ä»·åæ¢çä¼åï¼å°±æ¯åºäºè§åçä¼åï¼å½ç¶æ°æ®åºæ¬èº«ä¹ä¼ç»åå®éçç»éªï¼äº§çä¸äºä¼åè§åï¼æ¯å¦å¤è¿æ¥æ¶é¤ï¼å ä¸ºå¤è¿æ¥ä¼åèµ·æ¥ä¸å¤ªæ¹ä¾¿ï¼å¦æè½æå®æ¶é¤æï¼æä»¬å°±æäºæ´å¤§çä¼åç©ºé´ï¼è¿äºç»ç»é½æ¯åºäºè§åçä¼åãåæ¶è¿äºé½æ¯å»ºç«å¨é»è¾æä½ç¬¦ä¸çä¼åï¼è¿ä¹æ¯ä¸ºä»ä¹åºäºè§åçä¼åä¹å«åé»è¾ä¼åãâ\n\nå°ææ³äºæ³ï¼èªå·±å¥½åå¯¹é»è¾æä½ç¬¦ä¸å¤ªçè§£ï¼è¿å¿é®ï¼âé»è¾æä½ç¬¦æ¯å¥ï¼æ¢ç¶æç©çä¼åï¼é¾éè¿æç©çæä½ç¬¦åï¼â\n\nå¤§æçèªå·±ççå·²ç»ç§çåªå©ä¸è¿æ»¤å´äºï¼è¿å¿æçå¤´æå°çç°ç¼¸ï¼ä¼¸ä¸ªæè°ç»§ç»­è¯´ï¼âæ¯å¦è¯´å§ï¼ä½ å¨SQLè¯­å¥éåä¸äºä¸¤ä¸ªè¡¨è¦åä¸ä¸ªå·¦å¤è¿æ¥ï¼é£ä¹æ°æ®åºæä¹æ¥åè¿ä¸ªå·¦å¤è¿æ¥å¢ï¼â\n\nå°æä¸å¤´é¾æ°´çææå¤´ï¼å¯¹å¤§ææåºäºæå¾çç¼ç¥ã\n\nå¤§æèªé®èªç­çç»§ç»­è¯´éï¼âæ°æ®åºè¯´æä¹ä¸ç¥éåï¼ä½ è¯´çå·¦å¤è¿æ¥ææææï¼ä½æä¹ä¸ç¥éæä¹å®ç°åï¼ä½ éè¦åè¯æå®ç°æ¹æ³åï¼å æ­¤ä¼åå¨è¿æ¿æäºä¸ä¸ªä»»å¡ï¼å°±æ¯åè¯æ§è¡å¨ï¼æä¹æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥ãâ\n\nå¤§æä¸è¾¹è¯´ï¼ä¸è¾¹ä»è¶å ä¸æçæ¿èµ·æ¥ï¼åå¤åæ½ä¸æ ¹ï¼å´å°´å°¬çåç°ï¼ççéä¸æ ¹çé½æ²¡æäºï¼å¤§ææç©ºççå¼¹è¿åå¾æ¡¶ï¼ç»§ç»­è¯´ï¼âæ°æ®åºæåªäºæ¹æ³æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥å¢ï¼å®å¯ä»¥ç¨åµå¥å¾ªç¯è¿æ¥ãåå¸è¿æ¥ãå½å¹¶è¿æ¥ç­ç­ï¼æ³¨æäºï¼éè¦çäºæè¯´ä¸éï¼ä½ çåè¿æ¥ãå¤è¿æ¥æ¯è¿æ¥æä½ï¼åµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥ç­ä¹å«è¿æ¥ï¼ä½åè¿æ¥ãå¤è¿æ¥è¿äºå°±æ¯é»è¾æä½ç¬¦ï¼èåµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥è¿äºå°±æ¯ç©çæä½ç¬¦ãæä»¥ä½ è¯´å¯¹äºï¼ç©çä¼åå°±æ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åãâ\n\nå¤§æåé®å°æï¼âä½ è¦ä»åäº¬å»ä¸æµ·ï¼ä½ è¯´ä½ æä¹å»ï¼â\n\nå°æè¯´ï¼âåé«éåï¼åå¿«åæ¹ä¾¿ãâ\n\nå¤§æç»§ç»­é®ï¼âåé«éåå»å¹¿å·ï¼ç¶ååè½¦å°ä¸æµ·è¡ä¸è¡ï¼â\n\nå°æè¯´ï¼âæç¹æå¿äºï¼è¿ä¸æ¯åé¥±äºæçåï¼â\n\nå¤§æè¿½é®ï¼âä¸ºä»ä¹ï¼â\n\nå°æè¯´ï¼âå¾ææ¾ï¼ææç´è¾¾çé«éï¼å³èçæ¶é´ï¼åèçè´¹ç¨ï¼åå»å¹¿å·ååè½¦ï¼æèå­ç¦ç¹äºï¼ï¼â\n\nå¤§æç¬äºç¬è¯´ï¼âä¸ç¥ä¸è§ä¹é´ï¼ä½ çå¤§èå°±å»ºç«äºä¸ä¸ªä»£ä»·æ¨¡åï¼é£å°±æ¯æ§ä»·æ¯ï¼ä¼åå¨ä½ä¸ºæ°æ®åºçå¤§èï¼ä¹éè¦å»ºç«ä»£ä»·æ¨¡åï¼å¯¹ç©çæä½ç¬¦è®¡ç®ä»£ä»·ï¼ç¶åç­éåºæä¼çç©çæä½ç¬¦æ¥ï¼å æ­¤åºäºä»£ä»·çä¼åæ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åï¼æä»¥ä¹å«ç©çä¼åãâ\n\nå°æè§å¾ä¼¼ä¹æäºï¼âå¬å¸æ´¾æå»ä¸æµ·åºå·®å°±æ¯ä¸ä¸ªé»è¾æä½ç¬¦ï¼å®åæä»¬åä¸ä¸ªSQLè¯­å¥è¦æ±æ°æ®åºå¯¹ä¸¤ä¸ªè¡¨åå·¦å¤è¿æ¥ç±»ä¼¼ï¼èå»ä¸æµ·çå®éè·¯å¾æå¾å¤ç§ï¼è¿äºå°±åæ¯ç©çæä½ç¬¦ï¼æä»¬å¯¹è¿äºå®éçç©çè·¯å¾è®¡ç®ä»£ä»·ä¹åï¼å°±å¯ä»¥éåºæ¥æå¥½çè·¯å¾äºãâ\n\nå¤§ææåºææºï¼åå«æå¼äºç½åå°å¾APPåé«è¾¾å°å¾APPï¼è¾å¥äºåäº¬å°ä¸æµ·çä¿¡æ¯ï¼ç¶åæ¿ç»å°æçï¼å°æåç°ä¸¤å®¶APPç»åºçæä¼è·¯å¾æ¯ä¸ä¸æ ·çãå°æè¥æææçè¯´ï¼âçæ¥ä»£ä»·æ¨¡åå¾éè¦ï¼ä»£ä»·æ¨¡åæ¯ä¸æ¯åç¡®å³å®äºæä¼è·¯å¾éæ©çæ¯ä¸æ¯åç¡®ãâ\nå¤§æä¸æå¤§è¿ï¼ç¬çè¯´ï¼âå¤ªå¯¹äºï¼æä»¥æä½ä¸ºä¸ä¸ªæ°æ®åºåæ ¸çèµæ·±å¼åäººåï¼éè¦ä¸æ­çè°æ´ä¼åå¨çä»£ä»·æ¨¡åï¼ä»¥ææè·å¾ä¸ä¸ªç¸å¯¹ç¨³å®çä»£ä»·æ¨¡åï¼ä¸è¿ä»ç¶æ¯ä»»ééè¿åãâ\n","slug":"postgresql-optimizer-outline-1","published":1,"updated":"2020-08-02T00:57:32.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckdchg8jc0001r2s695jh2xip","content":"<p>å°æèä¸äºåæ¸å¤§å­¦çè®¡ç®æºç ç©¶çï¼ä»å¹´å­¦æ ¡å¼äºæ°æ®åºåççè¯¾ç¨ï¼å°æå¯¹æ¥è¯¢ä¼åçé¨åä¸æ¯å¾çè§£ï¼è½ç¶å·²ç»ä½¿åºäºæ´ªèä¹åï¼ä»ç¶è§å¾å¶ä¸­çé¨ååçæäºæ¦æ¶©é¾æï¼äºæ¯å°ææç®é®ä¸ä¸èªå·±çå¥å¥å¤§æï¼å¤§ææ¯ä¸ä½èµæ·±çæ°æ®åºåæ ¸å¼åçèç åï¼å¯¹Greenplum/HAWQæ°æ®åºæå¤å¹´çåæ ¸å¼åç»éª<a id=\"more\"></a>ï¼ååç¼éçä¸çåååå¹´è½®ä¸æ ·æ·±æ·±çè§è¯çå¤§æåå¤å¹´çä»ä¸ç»åï¼ç¥éå°æè¦æ¥é®é®é¢ï¼å¤§ææç¹ç´§å¼ ï¼è½ç¶èªå·±åæ°æ®åºåæ ¸å¥½å¤å¹´äºï¼ä½æ¯å¯¹ä¼åå¨ç ç©¶å´ä¸æ·±å¥ï¼å¦æè¢«å°æè¿æ ·çå°èé¸é®åå°±å°´å°¬äºï¼äºæ¯å¤§æåªå¥½ä¸´æ¶æ±ä½èï¼æ¿åºäºå¥½å¤å¹´ä¸ççãæ°æ®åºç³»ç»å®ç°ãåäºèµ·æ¥ã</p>\n<p>å°ææåºçç¬¬ä¸ä¸ªé®é¢æ¯ï¼âä¸ºä»ä¹æ°æ®åºè¦è¿è¡æ¥è¯¢ä¼åï¼â</p>\n<p>å¤§ææ¨äºæ¨é¼»æ¢ä¸çç¼éï¼ç¹ä¸äºä¸æ ¹ä¸­åæ·±å¸ä¸å£ï¼ç«çº¢ççå¤´å¥åçç§ï¼ç±æåæï¼å ççç°é£é£æ¸ºæ¸ºçæ£è½ä¸æ¥ï¼ååå¤§æååºçäºé¾äº¤ç¼ å¨ä¸èµ·ï¼å³è½»çåå¾å¨ï¼å¤§æå¼¹äºå¼¹çç°ï¼æ¢æ¡æ¯ççè¯´ï¼âä¸æ­¢æ¯æ°æ®åºè¦è¿è¡ä¼åï¼åºæ¬ä¸ææçç¼ç¨è¯­è¨å¨ç¼è¯çæ¶åé½ä¼ä¼åï¼æ¯å¦ä½ å¨ç¼è¯Cè¯­è¨çæ¶åï¼å¯ä»¥éè¿ç¼è¯éé¡¹-oæ¥æå®è¿è¡åªä¸ªçº§å«çä¼åï¼ä½æ¯æ¥è¯¢æ°æ®åºçæ¥è¯¢ä¼ååCè¯­è¨çä¼åè¿æäºåºå«ãâ</p>\n<p>âæåªäºåºå«å¢ï¼âå¤§æåé¡¿äºä¸ä¸ï¼åè§çå°æï¼ä»¿ä½ææå°æç»åºç­æ¡ï¼æèæ¯ç»å°æè¾æªåºè¶³å¤æèçç©ºé´ï¼ä¸äºç§ä¹åå¤§æåèªé®èªç­éï¼âCè¯­è¨æ¯è¿ç¨åè¯­è¨ï¼ä½ å·²ç»æå®å¥½äºéè¦æ§è¡çæ¯ä¸ä¸ªæ­¥éª¤ï¼ä½æ¯SQLæ¯æè¿°æ§è¯­è¨ï¼å®åªæå®äºWHATï¼èæ²¡ææå®HOWï¼è¿æ ·å®çä¼åç©ºé´å°±å¤§äºï¼ä½ è¯´æ¯ä¸æ¯ï¼â</p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¯¹ï¼ä¹å°±æ¯è¯´æ¡æ¡å¤§è·¯éç½é©¬ï¼å®æ¯è¿ç¨è¯­è¨çéæ©æ´å¤ï¼æ¯ä¸æ¯è¿æ ·ï¼âå¤§æç¬éï¼âå­ºå­å¯æä¹ãè½ç¶æä»¬ç¥éå®çä¼åç©ºé´å¤§ï¼ä½å·ä½å¦ä½ä¼åå¢ï¼â</p>\n<p>è¯´çå¤§æå°èº«å­åæ²åéé ä»¥é ï¼ç¿ä¸äºéè¿ç»§ç»­è¯´ï¼âéå¸¸æ¥è¯´åæä¸¤ä¸ªå±é¢ï¼ä¸ä¸ªæ¯åºäºè§åçä¼åï¼å¦ä¸ä¸ªæ¯åºäºä»£ä»·çä¼åï¼åºäºè§åçä¼åä¹å¯ä»¥å«é»è¾ä¼åæèè§åä¼åï¼åºäºä»£ä»·çä¼åä¹å¯ä»¥å«ç©çä¼åæèä»£ä»·ä¼åãâå¤§æè¾¹è¯´è¾¹ç¨ææ¯åçï¼æéççç«ä¹æ¬¢å¿«çè·³è·çã</p>\n<p>âé£ä¸ºä»ä¹è¦è¿è¡è¿æ ·çåºåå¢ï¼ä¼åå°±ä¼ååï¼ä½å¿è¿åä»ä¹è§ååä»£ä»·å¢ï¼âï¼å°æé®éã</p>\n<p>âåå±ä¸åå±ä¸æ¯éç¹ï¼æäºä¼åå¨å±æ¬¡åçæ¸æ¥ç¹ï¼æäºä¼åå¨å±æ¬¡åçå°±ä¸é£ä¹æ¸æ¥ï¼é½åªæ¯ä¼åææ®µèå·²ãâå¤§ææå°æç¹å¿èï¼åè¿ä¹é®ä¸å»ææè¦è¢«é®ä½ï¼äºæ¯è¯å¾å¼å¼è¯é¢ï¼âæä»¬ç»§ç»­è¯´è¯´SQLè¯­è¨å§ï¼æä»¬è¯´å®æ¯ä¸ç§ä»äºå³ç³»æ¼ç®åå³ç³»ä»£æ°ä¹é´çè¯­è¨ï¼å³ç³»æ¼ç®åå³ç³»ä»£æ°ä½ çè¿å§ï¼â</p>\n<p>å°ææ³äºæ³ï¼å¥½åèªå·±ä¸è¯¾çæ¶åèå¸è¯´è¿å³ç³»ä»£æ°ï¼ä½æ¯æ²¡æè¯´å³ç³»æ¼ç®ï¼äºæ¯è¯´ï¼âæ¥è§¦è¿ä¸ç¹ï¼ä½ä¹ä¸æ¯ç¹å«æç½ãâå¤§æå¾æçè¯´ï¼âå³ç³»æ¼ç®æ¯çº¯æè¿°æ§çè¯­è¨ï¼èå³ç³»ä»£æ°å¢ï¼ååå«äºä¸äºåºæ¬çå³ç³»æä½ï¼SQLä¸»è¦åé´çæ¯å³ç³»æ¼ç®ï¼ä¹åå«äºå³ç³»ä»£æ°çä¸é¨åç¹ç¹ãâ</p>\n<p>å¤§æçå°ææç¹æµï¼é¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´éï¼âä½ ä»¬ä¸è¯¾çæ¶åèå¸ææ²¡æè¯´è¿å³ç³»ä»£æ°çåºæ¬æä½ï¼âå°ææ³äºä¸ä¸è¯´ï¼âå¥½åè¯´äºï¼ææå½±ãéæ©ãè¿æ¥ãäº¤éãå·®éè¿å ä¸ªãâå¤§æç¹ç¹å¤´è¯´ï¼âå¯¹çï¼è¿å¯ä»¥æä¸ä¸ªå«éå½åçï¼ä¸å±6ä¸ªåºæ¬æä½ï¼å¦å¤ç»åå®éåºç¨å¨è¿äºåºæ¬æä½ä¹ä¸åæ©å±åºäºå¤è¿æ¥ãåè¿æ¥ãèéæä½ãåç»æä½ç­ç­ãâ</p>\n<p>å¤§æåæ·±å¸äºä¸å£çï¼ä¼éçåäºä¸ªçåï¼ç»§ç»­è¯´éï¼âSQLè¯­å¥è½ç¶æ¯æè¿°æ§çï¼ä½æ¯æä»¬å¯ä»¥æå®è½¬åæä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼èå³ç³»ä»£æ°ä¸­å¢ï¼åæä¸äºç­ä»·çè§åï¼è¿æ ·æä»¬å°±è½ç»åè¿äºç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çè½¬æ¢ãâ</p>\n<p>âè¿è¡ç­ä»·è½¬æ¢çç®çæ¯æ¾å°æ§è½æ´å¥½çä»£æ°è¡¨è¾¾å¼å§ï¼âå°æé®ã</p>\n<p>âå¯¹ï¼å°±æ¯è¿æ ·ãâå¤§æææ¥èµè®¸çç®åã</p>\n<p>âé£ä¹å¦ä½ç¡®å®ç­ä»·åæ¢ä¹åçè¡¨è¾¾å¼å°±è½åå¾æ¯åæ¢ä¹åæ§è½æ´å¥½å¢ï¼æèè¯´ä¸ºä»ä¹æä»¬è¦è¿è¡è¿æ ·çç­ä»·åæ¢ï¼èä¸æ¯ä½¿ç¨åæ¥çè¡¨è¾¾å¼å¢ï¼â</p>\n<p>å¤§ææ£äºä¸ä¸ï¼ä»¿ä½æ²¡ææ³å°å°æä¼æåºè¿æ ·çé®é¢ï¼ä½æ¯åºäºèªå·±å¤å¹´çå¿½æ ç»éªï¼ä»å®äºå®ç¥ï¼åç­éï¼âè¿æ¢æç»éªçæåï¼ä¹æéåçèèãä¾å¦å°éæ©æä½ä¸æ¨ï¼å°±è½ä¼åè¿æ»¤æ°æ®ï¼é£ä¹è¡¨è¾¾å¼çä¸å±è®¡ç®ç»ç¹å°±è½éä½è®¡ç®éï¼å æ­¤å¾å®¹æå¯ä»¥ç¥éæ¯è½éä½ä»£ä»·çãåä¾å¦æä»¬éå¸¸ä¼å¯¹ç¸å³çå­æ¥è¯¢è¿è¡æåï¼è¿æ¯å ä¸ºå¦æä¸æåè¿ç§å­æ¥è¯¢ï¼é£ä¹å®æ§è¡çæ¶åå°±ä¼äº§çä¸ä¸ªåµå¥å¾ªç¯ï¼è¿ç§åµå¥å¾ªç¯çæ§è¡ä»£ä»·æ¯O(N^2)ï¼è¿ç§å¤æåº¦å·²ç»æ¯æåçæåµäºï¼æåä¸æ¥è³å°ä¸ä¼æ¯å®å·®ï¼å æ­¤æåä¸æ¥æ¯æä»·å¼çãâå¤§æå¿éå¯¹èªå·±çä¸´å±ä¸ä¹±ææç¹äºä¸ªèµã</p>\n<p>å¤§æçå°ææ²¡ææé®ï¼ç»§ç»­è¯´éï¼âè¿äºåºäºå³ç³»ä»£æ°ç­ä»·è§ååç­ä»·åæ¢çä¼åï¼å°±æ¯åºäºè§åçä¼åï¼å½ç¶æ°æ®åºæ¬èº«ä¹ä¼ç»åå®éçç»éªï¼äº§çä¸äºä¼åè§åï¼æ¯å¦å¤è¿æ¥æ¶é¤ï¼å ä¸ºå¤è¿æ¥ä¼åèµ·æ¥ä¸å¤ªæ¹ä¾¿ï¼å¦æè½æå®æ¶é¤æï¼æä»¬å°±æäºæ´å¤§çä¼åç©ºé´ï¼è¿äºç»ç»é½æ¯åºäºè§åçä¼åãåæ¶è¿äºé½æ¯å»ºç«å¨é»è¾æä½ç¬¦ä¸çä¼åï¼è¿ä¹æ¯ä¸ºä»ä¹åºäºè§åçä¼åä¹å«åé»è¾ä¼åãâ</p>\n<p>å°ææ³äºæ³ï¼èªå·±å¥½åå¯¹é»è¾æä½ç¬¦ä¸å¤ªçè§£ï¼è¿å¿é®ï¼âé»è¾æä½ç¬¦æ¯å¥ï¼æ¢ç¶æç©çä¼åï¼é¾éè¿æç©çæä½ç¬¦åï¼â</p>\n<p>å¤§æçèªå·±ççå·²ç»ç§çåªå©ä¸è¿æ»¤å´äºï¼è¿å¿æçå¤´æå°çç°ç¼¸ï¼ä¼¸ä¸ªæè°ç»§ç»­è¯´ï¼âæ¯å¦è¯´å§ï¼ä½ å¨SQLè¯­å¥éåä¸äºä¸¤ä¸ªè¡¨è¦åä¸ä¸ªå·¦å¤è¿æ¥ï¼é£ä¹æ°æ®åºæä¹æ¥åè¿ä¸ªå·¦å¤è¿æ¥å¢ï¼â</p>\n<p>å°æä¸å¤´é¾æ°´çææå¤´ï¼å¯¹å¤§ææåºäºæå¾çç¼ç¥ã</p>\n<p>å¤§æèªé®èªç­çç»§ç»­è¯´éï¼âæ°æ®åºè¯´æä¹ä¸ç¥éåï¼ä½ è¯´çå·¦å¤è¿æ¥ææææï¼ä½æä¹ä¸ç¥éæä¹å®ç°åï¼ä½ éè¦åè¯æå®ç°æ¹æ³åï¼å æ­¤ä¼åå¨è¿æ¿æäºä¸ä¸ªä»»å¡ï¼å°±æ¯åè¯æ§è¡å¨ï¼æä¹æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥ãâ</p>\n<p>å¤§æä¸è¾¹è¯´ï¼ä¸è¾¹ä»è¶å ä¸æçæ¿èµ·æ¥ï¼åå¤åæ½ä¸æ ¹ï¼å´å°´å°¬çåç°ï¼ççéä¸æ ¹çé½æ²¡æäºï¼å¤§ææç©ºççå¼¹è¿åå¾æ¡¶ï¼ç»§ç»­è¯´ï¼âæ°æ®åºæåªäºæ¹æ³æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥å¢ï¼å®å¯ä»¥ç¨åµå¥å¾ªç¯è¿æ¥ãåå¸è¿æ¥ãå½å¹¶è¿æ¥ç­ç­ï¼æ³¨æäºï¼éè¦çäºæè¯´ä¸éï¼ä½ çåè¿æ¥ãå¤è¿æ¥æ¯è¿æ¥æä½ï¼åµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥ç­ä¹å«è¿æ¥ï¼ä½åè¿æ¥ãå¤è¿æ¥è¿äºå°±æ¯é»è¾æä½ç¬¦ï¼èåµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥è¿äºå°±æ¯ç©çæä½ç¬¦ãæä»¥ä½ è¯´å¯¹äºï¼ç©çä¼åå°±æ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åãâ</p>\n<p>å¤§æåé®å°æï¼âä½ è¦ä»åäº¬å»ä¸æµ·ï¼ä½ è¯´ä½ æä¹å»ï¼â</p>\n<p>å°æè¯´ï¼âåé«éåï¼åå¿«åæ¹ä¾¿ãâ</p>\n<p>å¤§æç»§ç»­é®ï¼âåé«éåå»å¹¿å·ï¼ç¶ååè½¦å°ä¸æµ·è¡ä¸è¡ï¼â</p>\n<p>å°æè¯´ï¼âæç¹æå¿äºï¼è¿ä¸æ¯åé¥±äºæçåï¼â</p>\n<p>å¤§æè¿½é®ï¼âä¸ºä»ä¹ï¼â</p>\n<p>å°æè¯´ï¼âå¾ææ¾ï¼ææç´è¾¾çé«éï¼å³èçæ¶é´ï¼åèçè´¹ç¨ï¼åå»å¹¿å·ååè½¦ï¼æèå­ç¦ç¹äºï¼ï¼â</p>\n<p>å¤§æç¬äºç¬è¯´ï¼âä¸ç¥ä¸è§ä¹é´ï¼ä½ çå¤§èå°±å»ºç«äºä¸ä¸ªä»£ä»·æ¨¡åï¼é£å°±æ¯æ§ä»·æ¯ï¼ä¼åå¨ä½ä¸ºæ°æ®åºçå¤§èï¼ä¹éè¦å»ºç«ä»£ä»·æ¨¡åï¼å¯¹ç©çæä½ç¬¦è®¡ç®ä»£ä»·ï¼ç¶åç­éåºæä¼çç©çæä½ç¬¦æ¥ï¼å æ­¤åºäºä»£ä»·çä¼åæ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åï¼æä»¥ä¹å«ç©çä¼åãâ</p>\n<p>å°æè§å¾ä¼¼ä¹æäºï¼âå¬å¸æ´¾æå»ä¸æµ·åºå·®å°±æ¯ä¸ä¸ªé»è¾æä½ç¬¦ï¼å®åæä»¬åä¸ä¸ªSQLè¯­å¥è¦æ±æ°æ®åºå¯¹ä¸¤ä¸ªè¡¨åå·¦å¤è¿æ¥ç±»ä¼¼ï¼èå»ä¸æµ·çå®éè·¯å¾æå¾å¤ç§ï¼è¿äºå°±åæ¯ç©çæä½ç¬¦ï¼æä»¬å¯¹è¿äºå®éçç©çè·¯å¾è®¡ç®ä»£ä»·ä¹åï¼å°±å¯ä»¥éåºæ¥æå¥½çè·¯å¾äºãâ</p>\n<p>å¤§ææåºææºï¼åå«æå¼äºç½åå°å¾APPåé«è¾¾å°å¾APPï¼è¾å¥äºåäº¬å°ä¸æµ·çä¿¡æ¯ï¼ç¶åæ¿ç»å°æçï¼å°æåç°ä¸¤å®¶APPç»åºçæä¼è·¯å¾æ¯ä¸ä¸æ ·çãå°æè¥æææçè¯´ï¼âçæ¥ä»£ä»·æ¨¡åå¾éè¦ï¼ä»£ä»·æ¨¡åæ¯ä¸æ¯åç¡®å³å®äºæä¼è·¯å¾éæ©çæ¯ä¸æ¯åç¡®ãâ<br>å¤§æä¸æå¤§è¿ï¼ç¬çè¯´ï¼âå¤ªå¯¹äºï¼æä»¥æä½ä¸ºä¸ä¸ªæ°æ®åºåæ ¸çèµæ·±å¼åäººåï¼éè¦ä¸æ­çè°æ´ä¼åå¨çä»£ä»·æ¨¡åï¼ä»¥ææè·å¾ä¸ä¸ªç¸å¯¹ç¨³å®çä»£ä»·æ¨¡åï¼ä¸è¿ä»ç¶æ¯ä»»ééè¿åãâ</p>\n","site":{"data":{}},"excerpt":"<p>å°æèä¸äºåæ¸å¤§å­¦çè®¡ç®æºç ç©¶çï¼ä»å¹´å­¦æ ¡å¼äºæ°æ®åºåççè¯¾ç¨ï¼å°æå¯¹æ¥è¯¢ä¼åçé¨åä¸æ¯å¾çè§£ï¼è½ç¶å·²ç»ä½¿åºäºæ´ªèä¹åï¼ä»ç¶è§å¾å¶ä¸­çé¨ååçæäºæ¦æ¶©é¾æï¼äºæ¯å°ææç®é®ä¸ä¸èªå·±çå¥å¥å¤§æï¼å¤§ææ¯ä¸ä½èµæ·±çæ°æ®åºåæ ¸å¼åçèç åï¼å¯¹Greenplum/HAWQæ°æ®åºæå¤å¹´çåæ ¸å¼åç»éª</p>","more":"ï¼ååç¼éçä¸çåååå¹´è½®ä¸æ ·æ·±æ·±çè§è¯çå¤§æåå¤å¹´çä»ä¸ç»åï¼ç¥éå°æè¦æ¥é®é®é¢ï¼å¤§ææç¹ç´§å¼ ï¼è½ç¶èªå·±åæ°æ®åºåæ ¸å¥½å¤å¹´äºï¼ä½æ¯å¯¹ä¼åå¨ç ç©¶å´ä¸æ·±å¥ï¼å¦æè¢«å°æè¿æ ·çå°èé¸é®åå°±å°´å°¬äºï¼äºæ¯å¤§æåªå¥½ä¸´æ¶æ±ä½èï¼æ¿åºäºå¥½å¤å¹´ä¸ççãæ°æ®åºç³»ç»å®ç°ãåäºèµ·æ¥ã<p></p>\n<p>å°ææåºçç¬¬ä¸ä¸ªé®é¢æ¯ï¼âä¸ºä»ä¹æ°æ®åºè¦è¿è¡æ¥è¯¢ä¼åï¼â</p>\n<p>å¤§ææ¨äºæ¨é¼»æ¢ä¸çç¼éï¼ç¹ä¸äºä¸æ ¹ä¸­åæ·±å¸ä¸å£ï¼ç«çº¢ççå¤´å¥åçç§ï¼ç±æåæï¼å ççç°é£é£æ¸ºæ¸ºçæ£è½ä¸æ¥ï¼ååå¤§æååºçäºé¾äº¤ç¼ å¨ä¸èµ·ï¼å³è½»çåå¾å¨ï¼å¤§æå¼¹äºå¼¹çç°ï¼æ¢æ¡æ¯ççè¯´ï¼âä¸æ­¢æ¯æ°æ®åºè¦è¿è¡ä¼åï¼åºæ¬ä¸ææçç¼ç¨è¯­è¨å¨ç¼è¯çæ¶åé½ä¼ä¼åï¼æ¯å¦ä½ å¨ç¼è¯Cè¯­è¨çæ¶åï¼å¯ä»¥éè¿ç¼è¯éé¡¹-oæ¥æå®è¿è¡åªä¸ªçº§å«çä¼åï¼ä½æ¯æ¥è¯¢æ°æ®åºçæ¥è¯¢ä¼ååCè¯­è¨çä¼åè¿æäºåºå«ãâ</p>\n<p>âæåªäºåºå«å¢ï¼âå¤§æåé¡¿äºä¸ä¸ï¼åè§çå°æï¼ä»¿ä½ææå°æç»åºç­æ¡ï¼æèæ¯ç»å°æè¾æªåºè¶³å¤æèçç©ºé´ï¼ä¸äºç§ä¹åå¤§æåèªé®èªç­éï¼âCè¯­è¨æ¯è¿ç¨åè¯­è¨ï¼ä½ å·²ç»æå®å¥½äºéè¦æ§è¡çæ¯ä¸ä¸ªæ­¥éª¤ï¼ä½æ¯SQLæ¯æè¿°æ§è¯­è¨ï¼å®åªæå®äºWHATï¼èæ²¡ææå®HOWï¼è¿æ ·å®çä¼åç©ºé´å°±å¤§äºï¼ä½ è¯´æ¯ä¸æ¯ï¼â</p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¯¹ï¼ä¹å°±æ¯è¯´æ¡æ¡å¤§è·¯éç½é©¬ï¼å®æ¯è¿ç¨è¯­è¨çéæ©æ´å¤ï¼æ¯ä¸æ¯è¿æ ·ï¼âå¤§æç¬éï¼âå­ºå­å¯æä¹ãè½ç¶æä»¬ç¥éå®çä¼åç©ºé´å¤§ï¼ä½å·ä½å¦ä½ä¼åå¢ï¼â</p>\n<p>è¯´çå¤§æå°èº«å­åæ²åéé ä»¥é ï¼ç¿ä¸äºéè¿ç»§ç»­è¯´ï¼âéå¸¸æ¥è¯´åæä¸¤ä¸ªå±é¢ï¼ä¸ä¸ªæ¯åºäºè§åçä¼åï¼å¦ä¸ä¸ªæ¯åºäºä»£ä»·çä¼åï¼åºäºè§åçä¼åä¹å¯ä»¥å«é»è¾ä¼åæèè§åä¼åï¼åºäºä»£ä»·çä¼åä¹å¯ä»¥å«ç©çä¼åæèä»£ä»·ä¼åãâå¤§æè¾¹è¯´è¾¹ç¨ææ¯åçï¼æéççç«ä¹æ¬¢å¿«çè·³è·çã</p>\n<p>âé£ä¸ºä»ä¹è¦è¿è¡è¿æ ·çåºåå¢ï¼ä¼åå°±ä¼ååï¼ä½å¿è¿åä»ä¹è§ååä»£ä»·å¢ï¼âï¼å°æé®éã</p>\n<p>âåå±ä¸åå±ä¸æ¯éç¹ï¼æäºä¼åå¨å±æ¬¡åçæ¸æ¥ç¹ï¼æäºä¼åå¨å±æ¬¡åçå°±ä¸é£ä¹æ¸æ¥ï¼é½åªæ¯ä¼åææ®µèå·²ãâå¤§ææå°æç¹å¿èï¼åè¿ä¹é®ä¸å»ææè¦è¢«é®ä½ï¼äºæ¯è¯å¾å¼å¼è¯é¢ï¼âæä»¬ç»§ç»­è¯´è¯´SQLè¯­è¨å§ï¼æä»¬è¯´å®æ¯ä¸ç§ä»äºå³ç³»æ¼ç®åå³ç³»ä»£æ°ä¹é´çè¯­è¨ï¼å³ç³»æ¼ç®åå³ç³»ä»£æ°ä½ çè¿å§ï¼â</p>\n<p>å°ææ³äºæ³ï¼å¥½åèªå·±ä¸è¯¾çæ¶åèå¸è¯´è¿å³ç³»ä»£æ°ï¼ä½æ¯æ²¡æè¯´å³ç³»æ¼ç®ï¼äºæ¯è¯´ï¼âæ¥è§¦è¿ä¸ç¹ï¼ä½ä¹ä¸æ¯ç¹å«æç½ãâå¤§æå¾æçè¯´ï¼âå³ç³»æ¼ç®æ¯çº¯æè¿°æ§çè¯­è¨ï¼èå³ç³»ä»£æ°å¢ï¼ååå«äºä¸äºåºæ¬çå³ç³»æä½ï¼SQLä¸»è¦åé´çæ¯å³ç³»æ¼ç®ï¼ä¹åå«äºå³ç³»ä»£æ°çä¸é¨åç¹ç¹ãâ</p>\n<p>å¤§æçå°ææç¹æµï¼é¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´éï¼âä½ ä»¬ä¸è¯¾çæ¶åèå¸ææ²¡æè¯´è¿å³ç³»ä»£æ°çåºæ¬æä½ï¼âå°ææ³äºä¸ä¸è¯´ï¼âå¥½åè¯´äºï¼ææå½±ãéæ©ãè¿æ¥ãäº¤éãå·®éè¿å ä¸ªãâå¤§æç¹ç¹å¤´è¯´ï¼âå¯¹çï¼è¿å¯ä»¥æä¸ä¸ªå«éå½åçï¼ä¸å±6ä¸ªåºæ¬æä½ï¼å¦å¤ç»åå®éåºç¨å¨è¿äºåºæ¬æä½ä¹ä¸åæ©å±åºäºå¤è¿æ¥ãåè¿æ¥ãèéæä½ãåç»æä½ç­ç­ãâ</p>\n<p>å¤§æåæ·±å¸äºä¸å£çï¼ä¼éçåäºä¸ªçåï¼ç»§ç»­è¯´éï¼âSQLè¯­å¥è½ç¶æ¯æè¿°æ§çï¼ä½æ¯æä»¬å¯ä»¥æå®è½¬åæä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼èå³ç³»ä»£æ°ä¸­å¢ï¼åæä¸äºç­ä»·çè§åï¼è¿æ ·æä»¬å°±è½ç»åè¿äºç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çè½¬æ¢ãâ</p>\n<p>âè¿è¡ç­ä»·è½¬æ¢çç®çæ¯æ¾å°æ§è½æ´å¥½çä»£æ°è¡¨è¾¾å¼å§ï¼âå°æé®ã</p>\n<p>âå¯¹ï¼å°±æ¯è¿æ ·ãâå¤§æææ¥èµè®¸çç®åã</p>\n<p>âé£ä¹å¦ä½ç¡®å®ç­ä»·åæ¢ä¹åçè¡¨è¾¾å¼å°±è½åå¾æ¯åæ¢ä¹åæ§è½æ´å¥½å¢ï¼æèè¯´ä¸ºä»ä¹æä»¬è¦è¿è¡è¿æ ·çç­ä»·åæ¢ï¼èä¸æ¯ä½¿ç¨åæ¥çè¡¨è¾¾å¼å¢ï¼â</p>\n<p>å¤§ææ£äºä¸ä¸ï¼ä»¿ä½æ²¡ææ³å°å°æä¼æåºè¿æ ·çé®é¢ï¼ä½æ¯åºäºèªå·±å¤å¹´çå¿½æ ç»éªï¼ä»å®äºå®ç¥ï¼åç­éï¼âè¿æ¢æç»éªçæåï¼ä¹æéåçèèãä¾å¦å°éæ©æä½ä¸æ¨ï¼å°±è½ä¼åè¿æ»¤æ°æ®ï¼é£ä¹è¡¨è¾¾å¼çä¸å±è®¡ç®ç»ç¹å°±è½éä½è®¡ç®éï¼å æ­¤å¾å®¹æå¯ä»¥ç¥éæ¯è½éä½ä»£ä»·çãåä¾å¦æä»¬éå¸¸ä¼å¯¹ç¸å³çå­æ¥è¯¢è¿è¡æåï¼è¿æ¯å ä¸ºå¦æä¸æåè¿ç§å­æ¥è¯¢ï¼é£ä¹å®æ§è¡çæ¶åå°±ä¼äº§çä¸ä¸ªåµå¥å¾ªç¯ï¼è¿ç§åµå¥å¾ªç¯çæ§è¡ä»£ä»·æ¯O(N^2)ï¼è¿ç§å¤æåº¦å·²ç»æ¯æåçæåµäºï¼æåä¸æ¥è³å°ä¸ä¼æ¯å®å·®ï¼å æ­¤æåä¸æ¥æ¯æä»·å¼çãâå¤§æå¿éå¯¹èªå·±çä¸´å±ä¸ä¹±ææç¹äºä¸ªèµã</p>\n<p>å¤§æçå°ææ²¡ææé®ï¼ç»§ç»­è¯´éï¼âè¿äºåºäºå³ç³»ä»£æ°ç­ä»·è§ååç­ä»·åæ¢çä¼åï¼å°±æ¯åºäºè§åçä¼åï¼å½ç¶æ°æ®åºæ¬èº«ä¹ä¼ç»åå®éçç»éªï¼äº§çä¸äºä¼åè§åï¼æ¯å¦å¤è¿æ¥æ¶é¤ï¼å ä¸ºå¤è¿æ¥ä¼åèµ·æ¥ä¸å¤ªæ¹ä¾¿ï¼å¦æè½æå®æ¶é¤æï¼æä»¬å°±æäºæ´å¤§çä¼åç©ºé´ï¼è¿äºç»ç»é½æ¯åºäºè§åçä¼åãåæ¶è¿äºé½æ¯å»ºç«å¨é»è¾æä½ç¬¦ä¸çä¼åï¼è¿ä¹æ¯ä¸ºä»ä¹åºäºè§åçä¼åä¹å«åé»è¾ä¼åãâ</p>\n<p>å°ææ³äºæ³ï¼èªå·±å¥½åå¯¹é»è¾æä½ç¬¦ä¸å¤ªçè§£ï¼è¿å¿é®ï¼âé»è¾æä½ç¬¦æ¯å¥ï¼æ¢ç¶æç©çä¼åï¼é¾éè¿æç©çæä½ç¬¦åï¼â</p>\n<p>å¤§æçèªå·±ççå·²ç»ç§çåªå©ä¸è¿æ»¤å´äºï¼è¿å¿æçå¤´æå°çç°ç¼¸ï¼ä¼¸ä¸ªæè°ç»§ç»­è¯´ï¼âæ¯å¦è¯´å§ï¼ä½ å¨SQLè¯­å¥éåä¸äºä¸¤ä¸ªè¡¨è¦åä¸ä¸ªå·¦å¤è¿æ¥ï¼é£ä¹æ°æ®åºæä¹æ¥åè¿ä¸ªå·¦å¤è¿æ¥å¢ï¼â</p>\n<p>å°æä¸å¤´é¾æ°´çææå¤´ï¼å¯¹å¤§ææåºäºæå¾çç¼ç¥ã</p>\n<p>å¤§æèªé®èªç­çç»§ç»­è¯´éï¼âæ°æ®åºè¯´æä¹ä¸ç¥éåï¼ä½ è¯´çå·¦å¤è¿æ¥ææææï¼ä½æä¹ä¸ç¥éæä¹å®ç°åï¼ä½ éè¦åè¯æå®ç°æ¹æ³åï¼å æ­¤ä¼åå¨è¿æ¿æäºä¸ä¸ªä»»å¡ï¼å°±æ¯åè¯æ§è¡å¨ï¼æä¹æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥ãâ</p>\n<p>å¤§æä¸è¾¹è¯´ï¼ä¸è¾¹ä»è¶å ä¸æçæ¿èµ·æ¥ï¼åå¤åæ½ä¸æ ¹ï¼å´å°´å°¬çåç°ï¼ççéä¸æ ¹çé½æ²¡æäºï¼å¤§ææç©ºççå¼¹è¿åå¾æ¡¶ï¼ç»§ç»­è¯´ï¼âæ°æ®åºæåªäºæ¹æ³æ¥å®ç°ä¸ä¸ªå·¦å¤è¿æ¥å¢ï¼å®å¯ä»¥ç¨åµå¥å¾ªç¯è¿æ¥ãåå¸è¿æ¥ãå½å¹¶è¿æ¥ç­ç­ï¼æ³¨æäºï¼éè¦çäºæè¯´ä¸éï¼ä½ çåè¿æ¥ãå¤è¿æ¥æ¯è¿æ¥æä½ï¼åµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥ç­ä¹å«è¿æ¥ï¼ä½åè¿æ¥ãå¤è¿æ¥è¿äºå°±æ¯é»è¾æä½ç¬¦ï¼èåµå¥å¾ªç¯è¿æ¥ãå½å¹¶è¿æ¥è¿äºå°±æ¯ç©çæä½ç¬¦ãæä»¥ä½ è¯´å¯¹äºï¼ç©çä¼åå°±æ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åãâ</p>\n<p>å¤§æåé®å°æï¼âä½ è¦ä»åäº¬å»ä¸æµ·ï¼ä½ è¯´ä½ æä¹å»ï¼â</p>\n<p>å°æè¯´ï¼âåé«éåï¼åå¿«åæ¹ä¾¿ãâ</p>\n<p>å¤§æç»§ç»­é®ï¼âåé«éåå»å¹¿å·ï¼ç¶ååè½¦å°ä¸æµ·è¡ä¸è¡ï¼â</p>\n<p>å°æè¯´ï¼âæç¹æå¿äºï¼è¿ä¸æ¯åé¥±äºæçåï¼â</p>\n<p>å¤§æè¿½é®ï¼âä¸ºä»ä¹ï¼â</p>\n<p>å°æè¯´ï¼âå¾ææ¾ï¼ææç´è¾¾çé«éï¼å³èçæ¶é´ï¼åèçè´¹ç¨ï¼åå»å¹¿å·ååè½¦ï¼æèå­ç¦ç¹äºï¼ï¼â</p>\n<p>å¤§æç¬äºç¬è¯´ï¼âä¸ç¥ä¸è§ä¹é´ï¼ä½ çå¤§èå°±å»ºç«äºä¸ä¸ªä»£ä»·æ¨¡åï¼é£å°±æ¯æ§ä»·æ¯ï¼ä¼åå¨ä½ä¸ºæ°æ®åºçå¤§èï¼ä¹éè¦å»ºç«ä»£ä»·æ¨¡åï¼å¯¹ç©çæä½ç¬¦è®¡ç®ä»£ä»·ï¼ç¶åç­éåºæä¼çç©çæä½ç¬¦æ¥ï¼å æ­¤åºäºä»£ä»·çä¼åæ¯å»ºç«å¨ç©çæä½ç¬¦ä¸çä¼åï¼æä»¥ä¹å«ç©çä¼åãâ</p>\n<p>å°æè§å¾ä¼¼ä¹æäºï¼âå¬å¸æ´¾æå»ä¸æµ·åºå·®å°±æ¯ä¸ä¸ªé»è¾æä½ç¬¦ï¼å®åæä»¬åä¸ä¸ªSQLè¯­å¥è¦æ±æ°æ®åºå¯¹ä¸¤ä¸ªè¡¨åå·¦å¤è¿æ¥ç±»ä¼¼ï¼èå»ä¸æµ·çå®éè·¯å¾æå¾å¤ç§ï¼è¿äºå°±åæ¯ç©çæä½ç¬¦ï¼æä»¬å¯¹è¿äºå®éçç©çè·¯å¾è®¡ç®ä»£ä»·ä¹åï¼å°±å¯ä»¥éåºæ¥æå¥½çè·¯å¾äºãâ</p>\n<p>å¤§ææåºææºï¼åå«æå¼äºç½åå°å¾APPåé«è¾¾å°å¾APPï¼è¾å¥äºåäº¬å°ä¸æµ·çä¿¡æ¯ï¼ç¶åæ¿ç»å°æçï¼å°æåç°ä¸¤å®¶APPç»åºçæä¼è·¯å¾æ¯ä¸ä¸æ ·çãå°æè¥æææçè¯´ï¼âçæ¥ä»£ä»·æ¨¡åå¾éè¦ï¼ä»£ä»·æ¨¡åæ¯ä¸æ¯åç¡®å³å®äºæä¼è·¯å¾éæ©çæ¯ä¸æ¯åç¡®ãâ<br>å¤§æä¸æå¤§è¿ï¼ç¬çè¯´ï¼âå¤ªå¯¹äºï¼æä»¥æä½ä¸ºä¸ä¸ªæ°æ®åºåæ ¸çèµæ·±å¼åäººåï¼éè¦ä¸æ­çè°æ´ä¼åå¨çä»£ä»·æ¨¡åï¼ä»¥ææè·å¾ä¸ä¸ªç¸å¯¹ç¨³å®çä»£ä»·æ¨¡åï¼ä¸è¿ä»ç¶æ¯ä»»ééè¿åãâ</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(2) - SQLè¿åå²","date":"2020-08-02T00:56:06.000Z","_content":"\néè¿å¤§æç»å°æè§£éäºæ¥è¯¢ä¼åå¨çåºæ¬åçï¼å°æå¨å­¦æ ¡çæ°æ®åºåçè¯¾å ä¸é¡ºé£é¡ºæ°´ï¼æ¯å¤©åé¥­ç¡è§æè±è±ï¼æ¥å­è¿å¾éå¸¸æ åï¼ä¸è¿ç¼çå°±å°äºæ°æ®åºåççå®è·µè¯¾äºï¼èå¸ç»åºçé¢ç®æ¯åæä¸ä¸ªæ°æ®åºçæä¸æ¨¡åçå®ç°ï¼å°æåæä¸éï¼ç»äºéå®äºè¦åæPostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨çå®ç°ï¼å ä¸ºæ®è¯´PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨å±ï¼ç¸ï¼æ¬¡ï¼å½ï¼æ¸ï¼å¤ï¼æ¥ï¼æï¼ï¼å·ææç§ä¹¦çº§çç¤ºèä½ç¨ã<!-- more -->\n\t\nå¯æ¯å½å°æä¸è½½äºPostgreSQLæ°æ®åºçæºä»£ç ï¼é¡¿æ¶å°±æµåäºï¼è½ç¶å¹³æ¶çè®ºè¯´çå¤©è±ä¹±å ï¼ä½æ¯å°äºå®è·µçæ¶åå´åç°ï¼çè®ºåå®éå¯¹åºä¸ä¸ï¼å°ææ·±æ·±çé·å¥å°ä»£ç çç»èéé¢ä¸å¯èªæï¼å°ææ¥éäºå¥½å¤èµæï¼ç»ææ¯è¯»ç ´ä¹¦ä¸å·ï¼ä¸ç¬å¦æé¤ï¼ä¸ç¹è¿å±å°±æ²¡æãäºæ¯å°æåæ³å°äºèªå·±çå¥å¥ââå¤§æï¼ä»ä½ä¸ºGreenplum/HAWQæ°æ®åºçèµæ·±çæ°æ®åºåæ ¸èç åï¼ä¸æ¯åPostgreSQLæ°æ®åºæçä¸è§£ä¹ç¼åï¼æ³å¿ä»ä¸å®è½ç«å¾æ´é«ï¼ççæ´è¿ï¼äºæ¯å°æè¹¬çèªå·±çå®é©¬åå¤§æé©¶å»ã\n\t\nå¤§ææ¥å°äºå°æè¦æ¥âè§å¯âçæ¶æ¯ï¼æ©å°±åå¥½äºåå¤ï¼å¤§æä¹åªæ¯å¨å·¥ä½ä¸­å¶å°æ¥è§¦ä¸ä¸ä¼åå¨ï¼ä¹æ²¡æå¯¹æ¥è¯¢ä¼åå¨æå¤çæï¼æ­£å¥½åçè¿æ¬¡æºä¼èªå·±ä¹å¯¹ä¼åå¨è¿è¡äºä¸çªå­¦ä¹ ãççå°æå¤§æ±æ·æ¼çèµ°è¿äºé¨ï¼å¤§æä»å°ç®±éæ¿äºä¸æ ¹ä»èå¸åºä¹°çå·§çå¹ï¼æå³æ·±é¿çè¯´ï¼âå°æåå­¦ï¼PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨åè½æ¯è¾å¤ï¼ææä¸æ¬¡è¯´ä¸å®ï¼æä»¬æå®åæå æ¬¡æ¥è¯´æ¸æ¥å§ãâ\n\nå°æè½ç¶æè§å°æ£çå³éæç¹åå·®ï¼ä½è§å¾å¤§æè¯´å¾æéçï¼å ä¸ºèªå·±éè¿æ¥çPostgreSQLæ°æ®åºçæºç çç¡®éå¸¸å¤æï¼äºæ¯è¯´ï¼âçç¡®æ¯çï¼æå¨çæ¥è¯¢ä¼åå¨ä»£ç çæ¶åï¼è§å¾æ ä»ä¸æï¼è½ç¶æ¥è¯¢ä¼åçä¸äºçè®ºæå­¦è¿äºï¼ä½æ¯ä¸ç¥éä»£ç åçè®ºå¦ä½å¯¹åºï¼èä¸è¿æä¸äºä¼åè§åå¥½åæä»¬è®²æ°æ®åºåççæ¶åä¹æ²¡ææ¶åå°ï¼æ¯ç«çè®ºåå®è·µä¹é´è¿æä¸äºå·®è·ãâ\n\nå¤§ææå¼çµèï¼è°åºäºPostgreSQLçä»£ç ï¼ç¶åè¯´ï¼âæä»¬åæ¥çä¸ä¸PostgreSQLæ°æ®åºä¸ä¸ªæ¥è¯¢æ§è¡çåºæ¬æµç¨ãâï¼ç¶åå¤§æè°åºäºä¸å¼ å¾ã\n\n![](./postgresql-optimizer-outline-2/1.jpg) \n \nå°æè§å¾è¿å¼ å¾ä¼¼æ¾ç¸è¯ï¼åä¸ç¥éå¨åªè§è¿ï¼äºæ¯è¯´ï¼âæå¥½åè§è¿è¿å¼ å¾ãâå¤§æç¹ç¹å¤´è¯´ï¼âæ¯çï¼å¤§é¨åæ¥è¯¢ä¼åçå¹è®­é½æ¯ä»è¿å¼ å¾å¼å§çï¼ä¸è¿è¿å¼ å¾æ¯æèªå·±ç»çï¼ä½ çå°çé£äºå¾è¡¨è¾¾çææåºè¯¥æ¯ä¸æ ·çï¼ä½å®çå½¢å¼å¯è½ç¥æä¸åï¼è¿ç§å¾å·²ç»æäºä¼åå¨å¹è®­å¼ç¯çå¿å¤å¾äºï¼ä¸è¿æä»¬è¿æ¯æå¿è¦åå©è¿å¼ å¾æ¥çä¸ä¸PostgreSQLæ°æ®åºæºç çå¤§ä½ç»æï¼äºè§£æ¥è¯¢ä¼åå¨æå¤çä½ç½®ãâ\n\t\nå¤§æä¸è¾¹æç¹ççµèå±å¹ï¼ä¸è¾¹ç»§ç»­è¯´ï¼âæä»¬è¦æ§è¡ä¸æ¡SQLè¯­å¥ï¼é¦åä¼è¿è¡è¯æ³åæï¼ä¹å°±æ¯è¯´æSQLè¯­å¥åä¸ä¸ªåå²ï¼åæå¾å¤å°æ®µæ®µãããâå°æè¿å¿è¯´ï¼âæä»¬å¨å­¦ç¼è¯åççæ¶åèå¸è¯´äºï¼åæçå°æ®µæ®µå¯ä»¥æ¯å³é®å­ãæ è¯ç¬¦ãå¸¸éãè¿ç®ç¬¦åè¾¹çç¬¦ï¼æ¯ä¸æ¯åè¯ä¹åå°±ä¼ç»è¿äºå°æ®µæ®µèµäºä¸è¿äºè¯­ä¹ï¼â\n\nâå¯¹çï¼çæ¥ä½ å¯¹ç¼è¯åççç¬¬ä¸ç« å¾çæåãâå¤§æç¬çè¯´ã\n\t\nâå½ç¶ï¼æææé¿åHello Worldãâ\n\t\nâå¥½å§ï¼Letâs ç»§ç»­ï¼PostgreSQLçåè¯æ¯å¨scan.læä»¶ä¸­å®æçï¼å®å¯è½åçæ´ç»è´ä¸äºï¼æ¯å¦å¸¸éå®å°±åæäºSCONSTãFCONSTãICONSTç­ç­ï¼ä¸è¿åºæ¬çåçæ¯ä¸æ ·çãè¿è¡åè¯å¹¶ä¸ç»æ¯ä¸ªåè¯ä»¥è¯­ä¹ä¹åï¼å°±å¯ä»¥å»å¹égram.yéçè¯­æ³è§åäºï¼å¨gram.yæä»¶éå®ä¹äºææçSQLè¯­è¨çè¯­æ³è§åï¼æä»¬çæ¥è¯¢ç»è¿å¹éä¹åï¼æç»å½¢æäºä¸é¢è¯­æ³æ ãâ\n\t\nâè¯­æ³æ ï¼æè¿å¬è¿ä»ä¹æ¥è¯¢æ ãè®¡åæ ï¼è¿äºæ è¦æä¹åºåå¢ï¼â\n\t\nâä¸ä¸ªæ¥è¯¢è¯­å¥å¨ä¸åçé¶æ®µï¼çæçæ æ¯ä¸åçï¼è¿äºæ çé¡ºåºåºè¯¥æ¯åçæè¯­æ³æ ï¼ç¶åå¾å°æ¥è¯¢æ ï¼æç»å¾å°è®¡åæ ï¼è®¡åæ å°±æ¯æä»¬è¯´çæ§è¡è®¡åãâ\n\t\nâé£ä¹ä¸ºä»ä¹è¦åè¿äºè½¬æ¢å¢ï¼âå°æä¸è§£çé®ã\n\t\nâæä»¬éè¿è¯æ³åæãè¯­æ³åæè·å¾äºè¯­æ³æ ï¼ä½è¿æ¶çè¯­æ³æ è¿åSQLè¯­å¥æå¾ç´§å¯çå³ç³»ï¼æ¯å¦æä»¬å¨è¯­æ³æ ä¸­ä¿å­çè¿æ¯ä¸ä¸ªè¡¨çåå­ï¼ä¸ä¸ªåçåå­ï¼ä½å®éä¸å¨PostgreSQLæ°æ®åºæ°æ®åºä¸­ï¼æå¾å¤ç³»ç»è¡¨ï¼æ¯å¦PG_CLASSç¨æ¥å°è¡¨ä¿å­ææ°æ®åºçåé¨ç»æï¼å½æä»¬åå»ºä¸ä¸ªè¡¨çæ¶åï¼ä¼å¨PG_CLASSãPG_ATTRIBUTEç­ç­ç³»ç»è¡¨éå¢å æ°çåæ°æ®ï¼æä»¬è¦ç¨è¿äºåæ°æ®çä¿¡æ¯åä»£è¯­æ³æ ä¸­çè¡¨çåå­ãåçåå­ç­ç­ãâ\n\t\nå°ææ³äºæ³ï¼è¯´ï¼âè¿ä¸ªåä»£çè¿ç¨å°±æ¯è¯­ä¹åæï¼è¿æ ·å°±æè¯­æ³æ è½¬æ¢æäºæ¥è¯¢æ ï¼èæ¥è¯¢æ æ¯ä½¿ç¨åæ°æ®æ¥æè¿°çï¼æä»¥æä»¬å¨æ°æ®åºåæ ¸ä¸­ä½¿ç¨å®å°±æ´æ¹ä¾¿äºï¼â\n\t\nâæ¯çãâå¤§æè¯å®çè¯´ãâä¸è¿è¯­ä¹åæè¿åäºä¸ä¸ªå·¥ä½ï¼é£å°±æ¯æ£æ¥å·¥ä½ï¼å¨è¯­æ³æ æ¯éè¿åæSQLè¯­å¥è·å¾çï¼å®è¿ä¸ç¥éä¸ä¸ªè¡¨æ¯ä¸æ¯å­å¨ï¼ä¸ä¸ªåæ¯ä¸æ¯å­å¨ï¼è¿ä¸ªè½¬æ¢çè¿ç¨ï¼ä¹æ¯ä¸ä¸ªæ£æ¥çè¿ç¨ãâå¤§æåé¡¿äºä¸ä¸ï¼ä¼¼ä¹æ¯åäºä¸ä¸æèï¼ç¶åæ¿åºä¸å¼ çº¸ï¼å¨ä¸è¾¹ç»äºèµ·æ¥ã\n\n![](postgresql-optimizer-outline-2/2.jpg) \n\nâè¿æ¯SQLè¯­å¥SELECT st.sname, c.cname, sc.degree FROM STUDENT st , COURSE c INNER JOIN SCORE sc ON c.cno = sc.cno WHERE st.sno = sc.snoå¯¹åºçç®çæ¥è¯¢æ ï¼ççå¤æåï¼âå¤§æè¾¹ç»è¾¹é®ãå°æå¿ä¸­ç¿»è¾åºåä¸åªæ³¥é©¬ï¼ä»ä¼¼ä¹æè§å°èªå·±éæ©æ¥è¯¢ä¼åä½ä¸ºæ°æ®åºåçè¯¾çå®è·µä½ä¸æ¯ä¸ä¸ªéè¯¯çå³å®ï¼ç°å¨èªå·±å·²ç»åå°äºå²å¨çæ©ç½ï¼è¿ä¸ªå¾éçå¤§é¨ååå®¹ä»é½ä¸ç¥éæ¯ä»ä¹ä¸è¥¿ã\n\nççå°æè¿·ç¦»çç¼ç¥ï¼å¤§ææç¹åæï¼è¯´ï¼âæä»¬ç°å¨è¿ä¸ç¨æ·±å¥å°ä»£ç å±é¢ï¼ä½ å¯ä»¥å¿½ç¥è¿å¼ å¾ï¼ç°å¨å¯ä»¥ææ¥è¯¢æ è®¤ä¸ºæ¯ä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ãâ\n\nå°æå®äºå®ç¥ï¼é®éï¼âå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ä¸æ¬¡æå¨è¯¢ä½ æ¥è¯¢ä¼ååççæ¶åä½ æ¯ä¸æ¯è¯´åºäºè§åçä¼åå°±æ¯ä½¿ç¨å³ç³»ä»£æ°çç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çåæ¢ï¼æä»¥æ¥è¯¢ä¼åå¨çå·¥ä½å°±æ¯ç¨è¿ä¸ªæ¥è¯¢æ åç­ä»·åæ¢ï¼â\n\nâæ­åä½ ï¼ç­å¯¹äºãâå¤§æææèµè®¸å°æççè§£è½åè¿æè®°å¿åï¼ç»§ç»­è¯´ï¼âæ¥è¯¢æ å°±æ¯æ¥è¯¢ä¼åå¨çè¾å¥ï¼ç»è¿é»è¾ä¼ååç©çä¼åï¼æç»äº§çä¸é¢æä¼çè®¡åæ ï¼èæä»¬è¦åçå°±ä¼ççæ¥è¯¢ä¼åå¨æ¯å¦ä½äº§çè¿æ£µæä¼çè®¡åæ çãâ\n\nè¿æ¶é¨éåäºï¼å°ææå¼é¨ä¸çï¼åæ¥æ¯åäºåå¤åå°äºï¼å°ææçå¤åè¯´ï¼âçæ¥æä»¬åè¦é¥±é¤æé¥­ï¼ç¶åæè½çæ¥è¯¢æ çåæ¢è¿ç¨äºãâè¯´çæå¼éé¤åè£ï¼ç¾ç¾çåèµ·äºå¤§è°å­ï¼èå¤§æåå·²ç»ä»éæéæ¿åºäºçèççº¢éããã\n","source":"_posts/postgresql-optimizer-outline-2.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(2) - SQLè¿åå²\ndate: 2020-08-02 08:56:06\n---\n\néè¿å¤§æç»å°æè§£éäºæ¥è¯¢ä¼åå¨çåºæ¬åçï¼å°æå¨å­¦æ ¡çæ°æ®åºåçè¯¾å ä¸é¡ºé£é¡ºæ°´ï¼æ¯å¤©åé¥­ç¡è§æè±è±ï¼æ¥å­è¿å¾éå¸¸æ åï¼ä¸è¿ç¼çå°±å°äºæ°æ®åºåççå®è·µè¯¾äºï¼èå¸ç»åºçé¢ç®æ¯åæä¸ä¸ªæ°æ®åºçæä¸æ¨¡åçå®ç°ï¼å°æåæä¸éï¼ç»äºéå®äºè¦åæPostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨çå®ç°ï¼å ä¸ºæ®è¯´PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨å±ï¼ç¸ï¼æ¬¡ï¼å½ï¼æ¸ï¼å¤ï¼æ¥ï¼æï¼ï¼å·ææç§ä¹¦çº§çç¤ºèä½ç¨ã<!-- more -->\n\t\nå¯æ¯å½å°æä¸è½½äºPostgreSQLæ°æ®åºçæºä»£ç ï¼é¡¿æ¶å°±æµåäºï¼è½ç¶å¹³æ¶çè®ºè¯´çå¤©è±ä¹±å ï¼ä½æ¯å°äºå®è·µçæ¶åå´åç°ï¼çè®ºåå®éå¯¹åºä¸ä¸ï¼å°ææ·±æ·±çé·å¥å°ä»£ç çç»èéé¢ä¸å¯èªæï¼å°ææ¥éäºå¥½å¤èµæï¼ç»ææ¯è¯»ç ´ä¹¦ä¸å·ï¼ä¸ç¬å¦æé¤ï¼ä¸ç¹è¿å±å°±æ²¡æãäºæ¯å°æåæ³å°äºèªå·±çå¥å¥ââå¤§æï¼ä»ä½ä¸ºGreenplum/HAWQæ°æ®åºçèµæ·±çæ°æ®åºåæ ¸èç åï¼ä¸æ¯åPostgreSQLæ°æ®åºæçä¸è§£ä¹ç¼åï¼æ³å¿ä»ä¸å®è½ç«å¾æ´é«ï¼ççæ´è¿ï¼äºæ¯å°æè¹¬çèªå·±çå®é©¬åå¤§æé©¶å»ã\n\t\nå¤§ææ¥å°äºå°æè¦æ¥âè§å¯âçæ¶æ¯ï¼æ©å°±åå¥½äºåå¤ï¼å¤§æä¹åªæ¯å¨å·¥ä½ä¸­å¶å°æ¥è§¦ä¸ä¸ä¼åå¨ï¼ä¹æ²¡æå¯¹æ¥è¯¢ä¼åå¨æå¤çæï¼æ­£å¥½åçè¿æ¬¡æºä¼èªå·±ä¹å¯¹ä¼åå¨è¿è¡äºä¸çªå­¦ä¹ ãççå°æå¤§æ±æ·æ¼çèµ°è¿äºé¨ï¼å¤§æä»å°ç®±éæ¿äºä¸æ ¹ä»èå¸åºä¹°çå·§çå¹ï¼æå³æ·±é¿çè¯´ï¼âå°æåå­¦ï¼PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨åè½æ¯è¾å¤ï¼ææä¸æ¬¡è¯´ä¸å®ï¼æä»¬æå®åæå æ¬¡æ¥è¯´æ¸æ¥å§ãâ\n\nå°æè½ç¶æè§å°æ£çå³éæç¹åå·®ï¼ä½è§å¾å¤§æè¯´å¾æéçï¼å ä¸ºèªå·±éè¿æ¥çPostgreSQLæ°æ®åºçæºç çç¡®éå¸¸å¤æï¼äºæ¯è¯´ï¼âçç¡®æ¯çï¼æå¨çæ¥è¯¢ä¼åå¨ä»£ç çæ¶åï¼è§å¾æ ä»ä¸æï¼è½ç¶æ¥è¯¢ä¼åçä¸äºçè®ºæå­¦è¿äºï¼ä½æ¯ä¸ç¥éä»£ç åçè®ºå¦ä½å¯¹åºï¼èä¸è¿æä¸äºä¼åè§åå¥½åæä»¬è®²æ°æ®åºåççæ¶åä¹æ²¡ææ¶åå°ï¼æ¯ç«çè®ºåå®è·µä¹é´è¿æä¸äºå·®è·ãâ\n\nå¤§ææå¼çµèï¼è°åºäºPostgreSQLçä»£ç ï¼ç¶åè¯´ï¼âæä»¬åæ¥çä¸ä¸PostgreSQLæ°æ®åºä¸ä¸ªæ¥è¯¢æ§è¡çåºæ¬æµç¨ãâï¼ç¶åå¤§æè°åºäºä¸å¼ å¾ã\n\n![](./postgresql-optimizer-outline-2/1.jpg) \n \nå°æè§å¾è¿å¼ å¾ä¼¼æ¾ç¸è¯ï¼åä¸ç¥éå¨åªè§è¿ï¼äºæ¯è¯´ï¼âæå¥½åè§è¿è¿å¼ å¾ãâå¤§æç¹ç¹å¤´è¯´ï¼âæ¯çï¼å¤§é¨åæ¥è¯¢ä¼åçå¹è®­é½æ¯ä»è¿å¼ å¾å¼å§çï¼ä¸è¿è¿å¼ å¾æ¯æèªå·±ç»çï¼ä½ çå°çé£äºå¾è¡¨è¾¾çææåºè¯¥æ¯ä¸æ ·çï¼ä½å®çå½¢å¼å¯è½ç¥æä¸åï¼è¿ç§å¾å·²ç»æäºä¼åå¨å¹è®­å¼ç¯çå¿å¤å¾äºï¼ä¸è¿æä»¬è¿æ¯æå¿è¦åå©è¿å¼ å¾æ¥çä¸ä¸PostgreSQLæ°æ®åºæºç çå¤§ä½ç»æï¼äºè§£æ¥è¯¢ä¼åå¨æå¤çä½ç½®ãâ\n\t\nå¤§æä¸è¾¹æç¹ççµèå±å¹ï¼ä¸è¾¹ç»§ç»­è¯´ï¼âæä»¬è¦æ§è¡ä¸æ¡SQLè¯­å¥ï¼é¦åä¼è¿è¡è¯æ³åæï¼ä¹å°±æ¯è¯´æSQLè¯­å¥åä¸ä¸ªåå²ï¼åæå¾å¤å°æ®µæ®µãããâå°æè¿å¿è¯´ï¼âæä»¬å¨å­¦ç¼è¯åççæ¶åèå¸è¯´äºï¼åæçå°æ®µæ®µå¯ä»¥æ¯å³é®å­ãæ è¯ç¬¦ãå¸¸éãè¿ç®ç¬¦åè¾¹çç¬¦ï¼æ¯ä¸æ¯åè¯ä¹åå°±ä¼ç»è¿äºå°æ®µæ®µèµäºä¸è¿äºè¯­ä¹ï¼â\n\nâå¯¹çï¼çæ¥ä½ å¯¹ç¼è¯åççç¬¬ä¸ç« å¾çæåãâå¤§æç¬çè¯´ã\n\t\nâå½ç¶ï¼æææé¿åHello Worldãâ\n\t\nâå¥½å§ï¼Letâs ç»§ç»­ï¼PostgreSQLçåè¯æ¯å¨scan.læä»¶ä¸­å®æçï¼å®å¯è½åçæ´ç»è´ä¸äºï¼æ¯å¦å¸¸éå®å°±åæäºSCONSTãFCONSTãICONSTç­ç­ï¼ä¸è¿åºæ¬çåçæ¯ä¸æ ·çãè¿è¡åè¯å¹¶ä¸ç»æ¯ä¸ªåè¯ä»¥è¯­ä¹ä¹åï¼å°±å¯ä»¥å»å¹égram.yéçè¯­æ³è§åäºï¼å¨gram.yæä»¶éå®ä¹äºææçSQLè¯­è¨çè¯­æ³è§åï¼æä»¬çæ¥è¯¢ç»è¿å¹éä¹åï¼æç»å½¢æäºä¸é¢è¯­æ³æ ãâ\n\t\nâè¯­æ³æ ï¼æè¿å¬è¿ä»ä¹æ¥è¯¢æ ãè®¡åæ ï¼è¿äºæ è¦æä¹åºåå¢ï¼â\n\t\nâä¸ä¸ªæ¥è¯¢è¯­å¥å¨ä¸åçé¶æ®µï¼çæçæ æ¯ä¸åçï¼è¿äºæ çé¡ºåºåºè¯¥æ¯åçæè¯­æ³æ ï¼ç¶åå¾å°æ¥è¯¢æ ï¼æç»å¾å°è®¡åæ ï¼è®¡åæ å°±æ¯æä»¬è¯´çæ§è¡è®¡åãâ\n\t\nâé£ä¹ä¸ºä»ä¹è¦åè¿äºè½¬æ¢å¢ï¼âå°æä¸è§£çé®ã\n\t\nâæä»¬éè¿è¯æ³åæãè¯­æ³åæè·å¾äºè¯­æ³æ ï¼ä½è¿æ¶çè¯­æ³æ è¿åSQLè¯­å¥æå¾ç´§å¯çå³ç³»ï¼æ¯å¦æä»¬å¨è¯­æ³æ ä¸­ä¿å­çè¿æ¯ä¸ä¸ªè¡¨çåå­ï¼ä¸ä¸ªåçåå­ï¼ä½å®éä¸å¨PostgreSQLæ°æ®åºæ°æ®åºä¸­ï¼æå¾å¤ç³»ç»è¡¨ï¼æ¯å¦PG_CLASSç¨æ¥å°è¡¨ä¿å­ææ°æ®åºçåé¨ç»æï¼å½æä»¬åå»ºä¸ä¸ªè¡¨çæ¶åï¼ä¼å¨PG_CLASSãPG_ATTRIBUTEç­ç­ç³»ç»è¡¨éå¢å æ°çåæ°æ®ï¼æä»¬è¦ç¨è¿äºåæ°æ®çä¿¡æ¯åä»£è¯­æ³æ ä¸­çè¡¨çåå­ãåçåå­ç­ç­ãâ\n\t\nå°ææ³äºæ³ï¼è¯´ï¼âè¿ä¸ªåä»£çè¿ç¨å°±æ¯è¯­ä¹åæï¼è¿æ ·å°±æè¯­æ³æ è½¬æ¢æäºæ¥è¯¢æ ï¼èæ¥è¯¢æ æ¯ä½¿ç¨åæ°æ®æ¥æè¿°çï¼æä»¥æä»¬å¨æ°æ®åºåæ ¸ä¸­ä½¿ç¨å®å°±æ´æ¹ä¾¿äºï¼â\n\t\nâæ¯çãâå¤§æè¯å®çè¯´ãâä¸è¿è¯­ä¹åæè¿åäºä¸ä¸ªå·¥ä½ï¼é£å°±æ¯æ£æ¥å·¥ä½ï¼å¨è¯­æ³æ æ¯éè¿åæSQLè¯­å¥è·å¾çï¼å®è¿ä¸ç¥éä¸ä¸ªè¡¨æ¯ä¸æ¯å­å¨ï¼ä¸ä¸ªåæ¯ä¸æ¯å­å¨ï¼è¿ä¸ªè½¬æ¢çè¿ç¨ï¼ä¹æ¯ä¸ä¸ªæ£æ¥çè¿ç¨ãâå¤§æåé¡¿äºä¸ä¸ï¼ä¼¼ä¹æ¯åäºä¸ä¸æèï¼ç¶åæ¿åºä¸å¼ çº¸ï¼å¨ä¸è¾¹ç»äºèµ·æ¥ã\n\n![](postgresql-optimizer-outline-2/2.jpg) \n\nâè¿æ¯SQLè¯­å¥SELECT st.sname, c.cname, sc.degree FROM STUDENT st , COURSE c INNER JOIN SCORE sc ON c.cno = sc.cno WHERE st.sno = sc.snoå¯¹åºçç®çæ¥è¯¢æ ï¼ççå¤æåï¼âå¤§æè¾¹ç»è¾¹é®ãå°æå¿ä¸­ç¿»è¾åºåä¸åªæ³¥é©¬ï¼ä»ä¼¼ä¹æè§å°èªå·±éæ©æ¥è¯¢ä¼åä½ä¸ºæ°æ®åºåçè¯¾çå®è·µä½ä¸æ¯ä¸ä¸ªéè¯¯çå³å®ï¼ç°å¨èªå·±å·²ç»åå°äºå²å¨çæ©ç½ï¼è¿ä¸ªå¾éçå¤§é¨ååå®¹ä»é½ä¸ç¥éæ¯ä»ä¹ä¸è¥¿ã\n\nççå°æè¿·ç¦»çç¼ç¥ï¼å¤§ææç¹åæï¼è¯´ï¼âæä»¬ç°å¨è¿ä¸ç¨æ·±å¥å°ä»£ç å±é¢ï¼ä½ å¯ä»¥å¿½ç¥è¿å¼ å¾ï¼ç°å¨å¯ä»¥ææ¥è¯¢æ è®¤ä¸ºæ¯ä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ãâ\n\nå°æå®äºå®ç¥ï¼é®éï¼âå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ä¸æ¬¡æå¨è¯¢ä½ æ¥è¯¢ä¼ååççæ¶åä½ æ¯ä¸æ¯è¯´åºäºè§åçä¼åå°±æ¯ä½¿ç¨å³ç³»ä»£æ°çç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çåæ¢ï¼æä»¥æ¥è¯¢ä¼åå¨çå·¥ä½å°±æ¯ç¨è¿ä¸ªæ¥è¯¢æ åç­ä»·åæ¢ï¼â\n\nâæ­åä½ ï¼ç­å¯¹äºãâå¤§æææèµè®¸å°æççè§£è½åè¿æè®°å¿åï¼ç»§ç»­è¯´ï¼âæ¥è¯¢æ å°±æ¯æ¥è¯¢ä¼åå¨çè¾å¥ï¼ç»è¿é»è¾ä¼ååç©çä¼åï¼æç»äº§çä¸é¢æä¼çè®¡åæ ï¼èæä»¬è¦åçå°±ä¼ççæ¥è¯¢ä¼åå¨æ¯å¦ä½äº§çè¿æ£µæä¼çè®¡åæ çãâ\n\nè¿æ¶é¨éåäºï¼å°ææå¼é¨ä¸çï¼åæ¥æ¯åäºåå¤åå°äºï¼å°ææçå¤åè¯´ï¼âçæ¥æä»¬åè¦é¥±é¤æé¥­ï¼ç¶åæè½çæ¥è¯¢æ çåæ¢è¿ç¨äºãâè¯´çæå¼éé¤åè£ï¼ç¾ç¾çåèµ·äºå¤§è°å­ï¼èå¤§æåå·²ç»ä»éæéæ¿åºäºçèççº¢éããã\n","slug":"postgresql-optimizer-outline-2","published":1,"updated":"2020-08-02T01:43:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckdchg8je0002r2s686meddyz","content":"<p>éè¿å¤§æç»å°æè§£éäºæ¥è¯¢ä¼åå¨çåºæ¬åçï¼å°æå¨å­¦æ ¡çæ°æ®åºåçè¯¾å ä¸é¡ºé£é¡ºæ°´ï¼æ¯å¤©åé¥­ç¡è§æè±è±ï¼æ¥å­è¿å¾éå¸¸æ åï¼ä¸è¿ç¼çå°±å°äºæ°æ®åºåççå®è·µè¯¾äºï¼èå¸ç»åºçé¢ç®æ¯åæä¸ä¸ªæ°æ®åºçæä¸æ¨¡åçå®ç°ï¼å°æåæä¸éï¼ç»äºéå®äºè¦åæPostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨çå®ç°ï¼å ä¸ºæ®è¯´PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨å±ï¼ç¸ï¼æ¬¡ï¼å½ï¼æ¸ï¼å¤ï¼æ¥ï¼æï¼ï¼å·ææç§ä¹¦çº§çç¤ºèä½ç¨ã<a id=\"more\"></a></p>\n<p>å¯æ¯å½å°æä¸è½½äºPostgreSQLæ°æ®åºçæºä»£ç ï¼é¡¿æ¶å°±æµåäºï¼è½ç¶å¹³æ¶çè®ºè¯´çå¤©è±ä¹±å ï¼ä½æ¯å°äºå®è·µçæ¶åå´åç°ï¼çè®ºåå®éå¯¹åºä¸ä¸ï¼å°ææ·±æ·±çé·å¥å°ä»£ç çç»èéé¢ä¸å¯èªæï¼å°ææ¥éäºå¥½å¤èµæï¼ç»ææ¯è¯»ç ´ä¹¦ä¸å·ï¼ä¸ç¬å¦æé¤ï¼ä¸ç¹è¿å±å°±æ²¡æãäºæ¯å°æåæ³å°äºèªå·±çå¥å¥ââå¤§æï¼ä»ä½ä¸ºGreenplum/HAWQæ°æ®åºçèµæ·±çæ°æ®åºåæ ¸èç åï¼ä¸æ¯åPostgreSQLæ°æ®åºæçä¸è§£ä¹ç¼åï¼æ³å¿ä»ä¸å®è½ç«å¾æ´é«ï¼ççæ´è¿ï¼äºæ¯å°æè¹¬çèªå·±çå®é©¬åå¤§æé©¶å»ã</p>\n<p>å¤§ææ¥å°äºå°æè¦æ¥âè§å¯âçæ¶æ¯ï¼æ©å°±åå¥½äºåå¤ï¼å¤§æä¹åªæ¯å¨å·¥ä½ä¸­å¶å°æ¥è§¦ä¸ä¸ä¼åå¨ï¼ä¹æ²¡æå¯¹æ¥è¯¢ä¼åå¨æå¤çæï¼æ­£å¥½åçè¿æ¬¡æºä¼èªå·±ä¹å¯¹ä¼åå¨è¿è¡äºä¸çªå­¦ä¹ ãççå°æå¤§æ±æ·æ¼çèµ°è¿äºé¨ï¼å¤§æä»å°ç®±éæ¿äºä¸æ ¹ä»èå¸åºä¹°çå·§çå¹ï¼æå³æ·±é¿çè¯´ï¼âå°æåå­¦ï¼PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨åè½æ¯è¾å¤ï¼ææä¸æ¬¡è¯´ä¸å®ï¼æä»¬æå®åæå æ¬¡æ¥è¯´æ¸æ¥å§ãâ</p>\n<p>å°æè½ç¶æè§å°æ£çå³éæç¹åå·®ï¼ä½è§å¾å¤§æè¯´å¾æéçï¼å ä¸ºèªå·±éè¿æ¥çPostgreSQLæ°æ®åºçæºç çç¡®éå¸¸å¤æï¼äºæ¯è¯´ï¼âçç¡®æ¯çï¼æå¨çæ¥è¯¢ä¼åå¨ä»£ç çæ¶åï¼è§å¾æ ä»ä¸æï¼è½ç¶æ¥è¯¢ä¼åçä¸äºçè®ºæå­¦è¿äºï¼ä½æ¯ä¸ç¥éä»£ç åçè®ºå¦ä½å¯¹åºï¼èä¸è¿æä¸äºä¼åè§åå¥½åæä»¬è®²æ°æ®åºåççæ¶åä¹æ²¡ææ¶åå°ï¼æ¯ç«çè®ºåå®è·µä¹é´è¿æä¸äºå·®è·ãâ</p>\n<p>å¤§ææå¼çµèï¼è°åºäºPostgreSQLçä»£ç ï¼ç¶åè¯´ï¼âæä»¬åæ¥çä¸ä¸PostgreSQLæ°æ®åºä¸ä¸ªæ¥è¯¢æ§è¡çåºæ¬æµç¨ãâï¼ç¶åå¤§æè°åºäºä¸å¼ å¾ã</p>\n<p><img src=\"/2020/08/02/postgresql-optimizer-outline-2/1.jpg\"> </p>\n<p>å°æè§å¾è¿å¼ å¾ä¼¼æ¾ç¸è¯ï¼åä¸ç¥éå¨åªè§è¿ï¼äºæ¯è¯´ï¼âæå¥½åè§è¿è¿å¼ å¾ãâå¤§æç¹ç¹å¤´è¯´ï¼âæ¯çï¼å¤§é¨åæ¥è¯¢ä¼åçå¹è®­é½æ¯ä»è¿å¼ å¾å¼å§çï¼ä¸è¿è¿å¼ å¾æ¯æèªå·±ç»çï¼ä½ çå°çé£äºå¾è¡¨è¾¾çææåºè¯¥æ¯ä¸æ ·çï¼ä½å®çå½¢å¼å¯è½ç¥æä¸åï¼è¿ç§å¾å·²ç»æäºä¼åå¨å¹è®­å¼ç¯çå¿å¤å¾äºï¼ä¸è¿æä»¬è¿æ¯æå¿è¦åå©è¿å¼ å¾æ¥çä¸ä¸PostgreSQLæ°æ®åºæºç çå¤§ä½ç»æï¼äºè§£æ¥è¯¢ä¼åå¨æå¤çä½ç½®ãâ</p>\n<p>å¤§æä¸è¾¹æç¹ççµèå±å¹ï¼ä¸è¾¹ç»§ç»­è¯´ï¼âæä»¬è¦æ§è¡ä¸æ¡SQLè¯­å¥ï¼é¦åä¼è¿è¡è¯æ³åæï¼ä¹å°±æ¯è¯´æSQLè¯­å¥åä¸ä¸ªåå²ï¼åæå¾å¤å°æ®µæ®µãããâå°æè¿å¿è¯´ï¼âæä»¬å¨å­¦ç¼è¯åççæ¶åèå¸è¯´äºï¼åæçå°æ®µæ®µå¯ä»¥æ¯å³é®å­ãæ è¯ç¬¦ãå¸¸éãè¿ç®ç¬¦åè¾¹çç¬¦ï¼æ¯ä¸æ¯åè¯ä¹åå°±ä¼ç»è¿äºå°æ®µæ®µèµäºä¸è¿äºè¯­ä¹ï¼â</p>\n<p>âå¯¹çï¼çæ¥ä½ å¯¹ç¼è¯åççç¬¬ä¸ç« å¾çæåãâå¤§æç¬çè¯´ã</p>\n<p>âå½ç¶ï¼æææé¿åHello Worldãâ</p>\n<p>âå¥½å§ï¼Letâs ç»§ç»­ï¼PostgreSQLçåè¯æ¯å¨scan.læä»¶ä¸­å®æçï¼å®å¯è½åçæ´ç»è´ä¸äºï¼æ¯å¦å¸¸éå®å°±åæäºSCONSTãFCONSTãICONSTç­ç­ï¼ä¸è¿åºæ¬çåçæ¯ä¸æ ·çãè¿è¡åè¯å¹¶ä¸ç»æ¯ä¸ªåè¯ä»¥è¯­ä¹ä¹åï¼å°±å¯ä»¥å»å¹égram.yéçè¯­æ³è§åäºï¼å¨gram.yæä»¶éå®ä¹äºææçSQLè¯­è¨çè¯­æ³è§åï¼æä»¬çæ¥è¯¢ç»è¿å¹éä¹åï¼æç»å½¢æäºä¸é¢è¯­æ³æ ãâ</p>\n<p>âè¯­æ³æ ï¼æè¿å¬è¿ä»ä¹æ¥è¯¢æ ãè®¡åæ ï¼è¿äºæ è¦æä¹åºåå¢ï¼â</p>\n<p>âä¸ä¸ªæ¥è¯¢è¯­å¥å¨ä¸åçé¶æ®µï¼çæçæ æ¯ä¸åçï¼è¿äºæ çé¡ºåºåºè¯¥æ¯åçæè¯­æ³æ ï¼ç¶åå¾å°æ¥è¯¢æ ï¼æç»å¾å°è®¡åæ ï¼è®¡åæ å°±æ¯æä»¬è¯´çæ§è¡è®¡åãâ</p>\n<p>âé£ä¹ä¸ºä»ä¹è¦åè¿äºè½¬æ¢å¢ï¼âå°æä¸è§£çé®ã</p>\n<p>âæä»¬éè¿è¯æ³åæãè¯­æ³åæè·å¾äºè¯­æ³æ ï¼ä½è¿æ¶çè¯­æ³æ è¿åSQLè¯­å¥æå¾ç´§å¯çå³ç³»ï¼æ¯å¦æä»¬å¨è¯­æ³æ ä¸­ä¿å­çè¿æ¯ä¸ä¸ªè¡¨çåå­ï¼ä¸ä¸ªåçåå­ï¼ä½å®éä¸å¨PostgreSQLæ°æ®åºæ°æ®åºä¸­ï¼æå¾å¤ç³»ç»è¡¨ï¼æ¯å¦PG_CLASSç¨æ¥å°è¡¨ä¿å­ææ°æ®åºçåé¨ç»æï¼å½æä»¬åå»ºä¸ä¸ªè¡¨çæ¶åï¼ä¼å¨PG_CLASSãPG_ATTRIBUTEç­ç­ç³»ç»è¡¨éå¢å æ°çåæ°æ®ï¼æä»¬è¦ç¨è¿äºåæ°æ®çä¿¡æ¯åä»£è¯­æ³æ ä¸­çè¡¨çåå­ãåçåå­ç­ç­ãâ</p>\n<p>å°ææ³äºæ³ï¼è¯´ï¼âè¿ä¸ªåä»£çè¿ç¨å°±æ¯è¯­ä¹åæï¼è¿æ ·å°±æè¯­æ³æ è½¬æ¢æäºæ¥è¯¢æ ï¼èæ¥è¯¢æ æ¯ä½¿ç¨åæ°æ®æ¥æè¿°çï¼æä»¥æä»¬å¨æ°æ®åºåæ ¸ä¸­ä½¿ç¨å®å°±æ´æ¹ä¾¿äºï¼â</p>\n<p>âæ¯çãâå¤§æè¯å®çè¯´ãâä¸è¿è¯­ä¹åæè¿åäºä¸ä¸ªå·¥ä½ï¼é£å°±æ¯æ£æ¥å·¥ä½ï¼å¨è¯­æ³æ æ¯éè¿åæSQLè¯­å¥è·å¾çï¼å®è¿ä¸ç¥éä¸ä¸ªè¡¨æ¯ä¸æ¯å­å¨ï¼ä¸ä¸ªåæ¯ä¸æ¯å­å¨ï¼è¿ä¸ªè½¬æ¢çè¿ç¨ï¼ä¹æ¯ä¸ä¸ªæ£æ¥çè¿ç¨ãâå¤§æåé¡¿äºä¸ä¸ï¼ä¼¼ä¹æ¯åäºä¸ä¸æèï¼ç¶åæ¿åºä¸å¼ çº¸ï¼å¨ä¸è¾¹ç»äºèµ·æ¥ã</p>\n<p><img src=\"/2020/08/02/postgresql-optimizer-outline-2/2.jpg\"> </p>\n<p>âè¿æ¯SQLè¯­å¥SELECT st.sname, c.cname, sc.degree FROM STUDENT st , COURSE c INNER JOIN SCORE sc ON c.cno = sc.cno WHERE st.sno = sc.snoå¯¹åºçç®çæ¥è¯¢æ ï¼ççå¤æåï¼âå¤§æè¾¹ç»è¾¹é®ãå°æå¿ä¸­ç¿»è¾åºåä¸åªæ³¥é©¬ï¼ä»ä¼¼ä¹æè§å°èªå·±éæ©æ¥è¯¢ä¼åä½ä¸ºæ°æ®åºåçè¯¾çå®è·µä½ä¸æ¯ä¸ä¸ªéè¯¯çå³å®ï¼ç°å¨èªå·±å·²ç»åå°äºå²å¨çæ©ç½ï¼è¿ä¸ªå¾éçå¤§é¨ååå®¹ä»é½ä¸ç¥éæ¯ä»ä¹ä¸è¥¿ã</p>\n<p>ççå°æè¿·ç¦»çç¼ç¥ï¼å¤§ææç¹åæï¼è¯´ï¼âæä»¬ç°å¨è¿ä¸ç¨æ·±å¥å°ä»£ç å±é¢ï¼ä½ å¯ä»¥å¿½ç¥è¿å¼ å¾ï¼ç°å¨å¯ä»¥ææ¥è¯¢æ è®¤ä¸ºæ¯ä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ãâ</p>\n<p>å°æå®äºå®ç¥ï¼é®éï¼âå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ä¸æ¬¡æå¨è¯¢ä½ æ¥è¯¢ä¼ååççæ¶åä½ æ¯ä¸æ¯è¯´åºäºè§åçä¼åå°±æ¯ä½¿ç¨å³ç³»ä»£æ°çç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çåæ¢ï¼æä»¥æ¥è¯¢ä¼åå¨çå·¥ä½å°±æ¯ç¨è¿ä¸ªæ¥è¯¢æ åç­ä»·åæ¢ï¼â</p>\n<p>âæ­åä½ ï¼ç­å¯¹äºãâå¤§æææèµè®¸å°æççè§£è½åè¿æè®°å¿åï¼ç»§ç»­è¯´ï¼âæ¥è¯¢æ å°±æ¯æ¥è¯¢ä¼åå¨çè¾å¥ï¼ç»è¿é»è¾ä¼ååç©çä¼åï¼æç»äº§çä¸é¢æä¼çè®¡åæ ï¼èæä»¬è¦åçå°±ä¼ççæ¥è¯¢ä¼åå¨æ¯å¦ä½äº§çè¿æ£µæä¼çè®¡åæ çãâ</p>\n<p>è¿æ¶é¨éåäºï¼å°ææå¼é¨ä¸çï¼åæ¥æ¯åäºåå¤åå°äºï¼å°ææçå¤åè¯´ï¼âçæ¥æä»¬åè¦é¥±é¤æé¥­ï¼ç¶åæè½çæ¥è¯¢æ çåæ¢è¿ç¨äºãâè¯´çæå¼éé¤åè£ï¼ç¾ç¾çåèµ·äºå¤§è°å­ï¼èå¤§æåå·²ç»ä»éæéæ¿åºäºçèççº¢éããã</p>\n","site":{"data":{}},"excerpt":"<p>éè¿å¤§æç»å°æè§£éäºæ¥è¯¢ä¼åå¨çåºæ¬åçï¼å°æå¨å­¦æ ¡çæ°æ®åºåçè¯¾å ä¸é¡ºé£é¡ºæ°´ï¼æ¯å¤©åé¥­ç¡è§æè±è±ï¼æ¥å­è¿å¾éå¸¸æ åï¼ä¸è¿ç¼çå°±å°äºæ°æ®åºåççå®è·µè¯¾äºï¼èå¸ç»åºçé¢ç®æ¯åæä¸ä¸ªæ°æ®åºçæä¸æ¨¡åçå®ç°ï¼å°æåæä¸éï¼ç»äºéå®äºè¦åæPostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨çå®ç°ï¼å ä¸ºæ®è¯´PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨å±ï¼ç¸ï¼æ¬¡ï¼å½ï¼æ¸ï¼å¤ï¼æ¥ï¼æï¼ï¼å·ææç§ä¹¦çº§çç¤ºèä½ç¨ã</p>","more":"<p></p>\n<p>å¯æ¯å½å°æä¸è½½äºPostgreSQLæ°æ®åºçæºä»£ç ï¼é¡¿æ¶å°±æµåäºï¼è½ç¶å¹³æ¶çè®ºè¯´çå¤©è±ä¹±å ï¼ä½æ¯å°äºå®è·µçæ¶åå´åç°ï¼çè®ºåå®éå¯¹åºä¸ä¸ï¼å°ææ·±æ·±çé·å¥å°ä»£ç çç»èéé¢ä¸å¯èªæï¼å°ææ¥éäºå¥½å¤èµæï¼ç»ææ¯è¯»ç ´ä¹¦ä¸å·ï¼ä¸ç¬å¦æé¤ï¼ä¸ç¹è¿å±å°±æ²¡æãäºæ¯å°æåæ³å°äºèªå·±çå¥å¥ââå¤§æï¼ä»ä½ä¸ºGreenplum/HAWQæ°æ®åºçèµæ·±çæ°æ®åºåæ ¸èç åï¼ä¸æ¯åPostgreSQLæ°æ®åºæçä¸è§£ä¹ç¼åï¼æ³å¿ä»ä¸å®è½ç«å¾æ´é«ï¼ççæ´è¿ï¼äºæ¯å°æè¹¬çèªå·±çå®é©¬åå¤§æé©¶å»ã</p>\n<p>å¤§ææ¥å°äºå°æè¦æ¥âè§å¯âçæ¶æ¯ï¼æ©å°±åå¥½äºåå¤ï¼å¤§æä¹åªæ¯å¨å·¥ä½ä¸­å¶å°æ¥è§¦ä¸ä¸ä¼åå¨ï¼ä¹æ²¡æå¯¹æ¥è¯¢ä¼åå¨æå¤çæï¼æ­£å¥½åçè¿æ¬¡æºä¼èªå·±ä¹å¯¹ä¼åå¨è¿è¡äºä¸çªå­¦ä¹ ãççå°æå¤§æ±æ·æ¼çèµ°è¿äºé¨ï¼å¤§æä»å°ç®±éæ¿äºä¸æ ¹ä»èå¸åºä¹°çå·§çå¹ï¼æå³æ·±é¿çè¯´ï¼âå°æåå­¦ï¼PostgreSQLæ°æ®åºçæ¥è¯¢ä¼åå¨åè½æ¯è¾å¤ï¼ææä¸æ¬¡è¯´ä¸å®ï¼æä»¬æå®åæå æ¬¡æ¥è¯´æ¸æ¥å§ãâ</p>\n<p>å°æè½ç¶æè§å°æ£çå³éæç¹åå·®ï¼ä½è§å¾å¤§æè¯´å¾æéçï¼å ä¸ºèªå·±éè¿æ¥çPostgreSQLæ°æ®åºçæºç çç¡®éå¸¸å¤æï¼äºæ¯è¯´ï¼âçç¡®æ¯çï¼æå¨çæ¥è¯¢ä¼åå¨ä»£ç çæ¶åï¼è§å¾æ ä»ä¸æï¼è½ç¶æ¥è¯¢ä¼åçä¸äºçè®ºæå­¦è¿äºï¼ä½æ¯ä¸ç¥éä»£ç åçè®ºå¦ä½å¯¹åºï¼èä¸è¿æä¸äºä¼åè§åå¥½åæä»¬è®²æ°æ®åºåççæ¶åä¹æ²¡ææ¶åå°ï¼æ¯ç«çè®ºåå®è·µä¹é´è¿æä¸äºå·®è·ãâ</p>\n<p>å¤§ææå¼çµèï¼è°åºäºPostgreSQLçä»£ç ï¼ç¶åè¯´ï¼âæä»¬åæ¥çä¸ä¸PostgreSQLæ°æ®åºä¸ä¸ªæ¥è¯¢æ§è¡çåºæ¬æµç¨ãâï¼ç¶åå¤§æè°åºäºä¸å¼ å¾ã</p>\n<p><img src=\"/2020/08/02/postgresql-optimizer-outline-2/1.jpg\"> </p>\n<p>å°æè§å¾è¿å¼ å¾ä¼¼æ¾ç¸è¯ï¼åä¸ç¥éå¨åªè§è¿ï¼äºæ¯è¯´ï¼âæå¥½åè§è¿è¿å¼ å¾ãâå¤§æç¹ç¹å¤´è¯´ï¼âæ¯çï¼å¤§é¨åæ¥è¯¢ä¼åçå¹è®­é½æ¯ä»è¿å¼ å¾å¼å§çï¼ä¸è¿è¿å¼ å¾æ¯æèªå·±ç»çï¼ä½ çå°çé£äºå¾è¡¨è¾¾çææåºè¯¥æ¯ä¸æ ·çï¼ä½å®çå½¢å¼å¯è½ç¥æä¸åï¼è¿ç§å¾å·²ç»æäºä¼åå¨å¹è®­å¼ç¯çå¿å¤å¾äºï¼ä¸è¿æä»¬è¿æ¯æå¿è¦åå©è¿å¼ å¾æ¥çä¸ä¸PostgreSQLæ°æ®åºæºç çå¤§ä½ç»æï¼äºè§£æ¥è¯¢ä¼åå¨æå¤çä½ç½®ãâ</p>\n<p>å¤§æä¸è¾¹æç¹ççµèå±å¹ï¼ä¸è¾¹ç»§ç»­è¯´ï¼âæä»¬è¦æ§è¡ä¸æ¡SQLè¯­å¥ï¼é¦åä¼è¿è¡è¯æ³åæï¼ä¹å°±æ¯è¯´æSQLè¯­å¥åä¸ä¸ªåå²ï¼åæå¾å¤å°æ®µæ®µãããâå°æè¿å¿è¯´ï¼âæä»¬å¨å­¦ç¼è¯åççæ¶åèå¸è¯´äºï¼åæçå°æ®µæ®µå¯ä»¥æ¯å³é®å­ãæ è¯ç¬¦ãå¸¸éãè¿ç®ç¬¦åè¾¹çç¬¦ï¼æ¯ä¸æ¯åè¯ä¹åå°±ä¼ç»è¿äºå°æ®µæ®µèµäºä¸è¿äºè¯­ä¹ï¼â</p>\n<p>âå¯¹çï¼çæ¥ä½ å¯¹ç¼è¯åççç¬¬ä¸ç« å¾çæåãâå¤§æç¬çè¯´ã</p>\n<p>âå½ç¶ï¼æææé¿åHello Worldãâ</p>\n<p>âå¥½å§ï¼Letâs ç»§ç»­ï¼PostgreSQLçåè¯æ¯å¨scan.læä»¶ä¸­å®æçï¼å®å¯è½åçæ´ç»è´ä¸äºï¼æ¯å¦å¸¸éå®å°±åæäºSCONSTãFCONSTãICONSTç­ç­ï¼ä¸è¿åºæ¬çåçæ¯ä¸æ ·çãè¿è¡åè¯å¹¶ä¸ç»æ¯ä¸ªåè¯ä»¥è¯­ä¹ä¹åï¼å°±å¯ä»¥å»å¹égram.yéçè¯­æ³è§åäºï¼å¨gram.yæä»¶éå®ä¹äºææçSQLè¯­è¨çè¯­æ³è§åï¼æä»¬çæ¥è¯¢ç»è¿å¹éä¹åï¼æç»å½¢æäºä¸é¢è¯­æ³æ ãâ</p>\n<p>âè¯­æ³æ ï¼æè¿å¬è¿ä»ä¹æ¥è¯¢æ ãè®¡åæ ï¼è¿äºæ è¦æä¹åºåå¢ï¼â</p>\n<p>âä¸ä¸ªæ¥è¯¢è¯­å¥å¨ä¸åçé¶æ®µï¼çæçæ æ¯ä¸åçï¼è¿äºæ çé¡ºåºåºè¯¥æ¯åçæè¯­æ³æ ï¼ç¶åå¾å°æ¥è¯¢æ ï¼æç»å¾å°è®¡åæ ï¼è®¡åæ å°±æ¯æä»¬è¯´çæ§è¡è®¡åãâ</p>\n<p>âé£ä¹ä¸ºä»ä¹è¦åè¿äºè½¬æ¢å¢ï¼âå°æä¸è§£çé®ã</p>\n<p>âæä»¬éè¿è¯æ³åæãè¯­æ³åæè·å¾äºè¯­æ³æ ï¼ä½è¿æ¶çè¯­æ³æ è¿åSQLè¯­å¥æå¾ç´§å¯çå³ç³»ï¼æ¯å¦æä»¬å¨è¯­æ³æ ä¸­ä¿å­çè¿æ¯ä¸ä¸ªè¡¨çåå­ï¼ä¸ä¸ªåçåå­ï¼ä½å®éä¸å¨PostgreSQLæ°æ®åºæ°æ®åºä¸­ï¼æå¾å¤ç³»ç»è¡¨ï¼æ¯å¦PG_CLASSç¨æ¥å°è¡¨ä¿å­ææ°æ®åºçåé¨ç»æï¼å½æä»¬åå»ºä¸ä¸ªè¡¨çæ¶åï¼ä¼å¨PG_CLASSãPG_ATTRIBUTEç­ç­ç³»ç»è¡¨éå¢å æ°çåæ°æ®ï¼æä»¬è¦ç¨è¿äºåæ°æ®çä¿¡æ¯åä»£è¯­æ³æ ä¸­çè¡¨çåå­ãåçåå­ç­ç­ãâ</p>\n<p>å°ææ³äºæ³ï¼è¯´ï¼âè¿ä¸ªåä»£çè¿ç¨å°±æ¯è¯­ä¹åæï¼è¿æ ·å°±æè¯­æ³æ è½¬æ¢æäºæ¥è¯¢æ ï¼èæ¥è¯¢æ æ¯ä½¿ç¨åæ°æ®æ¥æè¿°çï¼æä»¥æä»¬å¨æ°æ®åºåæ ¸ä¸­ä½¿ç¨å®å°±æ´æ¹ä¾¿äºï¼â</p>\n<p>âæ¯çãâå¤§æè¯å®çè¯´ãâä¸è¿è¯­ä¹åæè¿åäºä¸ä¸ªå·¥ä½ï¼é£å°±æ¯æ£æ¥å·¥ä½ï¼å¨è¯­æ³æ æ¯éè¿åæSQLè¯­å¥è·å¾çï¼å®è¿ä¸ç¥éä¸ä¸ªè¡¨æ¯ä¸æ¯å­å¨ï¼ä¸ä¸ªåæ¯ä¸æ¯å­å¨ï¼è¿ä¸ªè½¬æ¢çè¿ç¨ï¼ä¹æ¯ä¸ä¸ªæ£æ¥çè¿ç¨ãâå¤§æåé¡¿äºä¸ä¸ï¼ä¼¼ä¹æ¯åäºä¸ä¸æèï¼ç¶åæ¿åºä¸å¼ çº¸ï¼å¨ä¸è¾¹ç»äºèµ·æ¥ã</p>\n<p><img src=\"/2020/08/02/postgresql-optimizer-outline-2/2.jpg\"> </p>\n<p>âè¿æ¯SQLè¯­å¥SELECT st.sname, c.cname, sc.degree FROM STUDENT st , COURSE c INNER JOIN SCORE sc ON c.cno = sc.cno WHERE st.sno = sc.snoå¯¹åºçç®çæ¥è¯¢æ ï¼ççå¤æåï¼âå¤§æè¾¹ç»è¾¹é®ãå°æå¿ä¸­ç¿»è¾åºåä¸åªæ³¥é©¬ï¼ä»ä¼¼ä¹æè§å°èªå·±éæ©æ¥è¯¢ä¼åä½ä¸ºæ°æ®åºåçè¯¾çå®è·µä½ä¸æ¯ä¸ä¸ªéè¯¯çå³å®ï¼ç°å¨èªå·±å·²ç»åå°äºå²å¨çæ©ç½ï¼è¿ä¸ªå¾éçå¤§é¨ååå®¹ä»é½ä¸ç¥éæ¯ä»ä¹ä¸è¥¿ã</p>\n<p>ççå°æè¿·ç¦»çç¼ç¥ï¼å¤§ææç¹åæï¼è¯´ï¼âæä»¬ç°å¨è¿ä¸ç¨æ·±å¥å°ä»£ç å±é¢ï¼ä½ å¯ä»¥å¿½ç¥è¿å¼ å¾ï¼ç°å¨å¯ä»¥ææ¥è¯¢æ è®¤ä¸ºæ¯ä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ãâ</p>\n<p>å°æå®äºå®ç¥ï¼é®éï¼âå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ä¸æ¬¡æå¨è¯¢ä½ æ¥è¯¢ä¼ååççæ¶åä½ æ¯ä¸æ¯è¯´åºäºè§åçä¼åå°±æ¯ä½¿ç¨å³ç³»ä»£æ°çç­ä»·è§åå¯¹å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡ç­ä»·çåæ¢ï¼æä»¥æ¥è¯¢ä¼åå¨çå·¥ä½å°±æ¯ç¨è¿ä¸ªæ¥è¯¢æ åç­ä»·åæ¢ï¼â</p>\n<p>âæ­åä½ ï¼ç­å¯¹äºãâå¤§æææèµè®¸å°æççè§£è½åè¿æè®°å¿åï¼ç»§ç»­è¯´ï¼âæ¥è¯¢æ å°±æ¯æ¥è¯¢ä¼åå¨çè¾å¥ï¼ç»è¿é»è¾ä¼ååç©çä¼åï¼æç»äº§çä¸é¢æä¼çè®¡åæ ï¼èæä»¬è¦åçå°±ä¼ççæ¥è¯¢ä¼åå¨æ¯å¦ä½äº§çè¿æ£µæä¼çè®¡åæ çãâ</p>\n<p>è¿æ¶é¨éåäºï¼å°ææå¼é¨ä¸çï¼åæ¥æ¯åäºåå¤åå°äºï¼å°ææçå¤åè¯´ï¼âçæ¥æä»¬åè¦é¥±é¤æé¥­ï¼ç¶åæè½çæ¥è¯¢æ çåæ¢è¿ç¨äºãâè¯´çæå¼éé¤åè£ï¼ç¾ç¾çåèµ·äºå¤§è°å­ï¼èå¤§æåå·²ç»ä»éæéæ¿åºäºçèççº¢éããã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(3) - æåï¼æåï¼","date":"2020-08-02T01:25:08.000Z","_content":"\nå°æåç°å°å¤§æå®¶éé®é®é¢ä¸ä½è½æ¶è·ç¥è¯ï¼è¿è½æ¶è·å¤§è°å­åçº¢éï¼äºæ¯æ´å åå®äºå¸¸æ¥é®é®é¢çå³å¿ã\n\nå°æåå¤§æåå®äºåé¥­ï¼æå¼çµè§çä¸ä¼çµè§å§ï¼å¤§æåæ¬æçæ¬æçæ½èµ·äºä¸­åçï¼å°æé»çäºæçæç¹å¿ç¦ï¼å°±é®å¤§æï¼âå¥ï¼ä½ æ´å¤©æ½æ½æ½ï¼æé£ä¹å¥½æ½åï¼âå¤§æèªè±ªçè¯´ï¼âåå°ï¼å±ç·ç·æ½çï¼å±ç¸ç¸ä¹æ½çï¼å°æè¿ä¸è½æ­äºé¦ç«ï¼ä½ ä¸æ½çæ¯ä¸å­ç¥éä¸ï¼â<!-- more -->\n\nå°æè¯´ï¼âå±ç·ç·æ½çæ¯å¨åæç§ççå¶ï¼èªç»èªè¶³ï¼è¿çé±ï¼ä½ ä¹å¹²èååæç§çå¶ï¼ä½ è¿ä¸­åçååæçèªå·±å·ççå¶ï¼è½æä»ä¹åºå«ï¼â\n\nå¤§æççµè§å§æ­£çå¾èµ·å²ï¼å¿ä¸å¨ççè¯´ï¼âèªå·±ç§ççå¶ç´æ¥ç¨æ¥çº¸å·äºæ½ï¼æ²¡æè¿æ»¤å´ï¼ä¼å¸å¥æå®³é¢ç²ç©ï¼èä¸çå¶çå³éä¹ä¸å¦ç°å¨æ¹è¿çé¦çãâè¯´å°è¿éå¤§æå¥½åæ³å°äºäºä»ä¹ï¼ç»§ç»­è¯´ï¼âè¿å°±åæ¯æ¥è¯¢ä¼åå¨çé»è¾ä¼åï¼æ¥è¯¢æ è¾å¥ä¹åï¼éè¦è¿è¡æç»­çæ¹è¿ï¼æ è®ºæ¯èªå·±ç¨æ¥çº¸å·ççï¼è¿æ¯å¨è¶å¸ä¹°çæåçï¼å®é½æ¯é¦çï¼ä½æ¯éè¿æ¹è¿ä¹åï¼é¦ççæ¯å®³ä½ç¨æ´ä½ãé¦åæ´ä¸°å¯äºï¼é»è¾ä¼åä¹æ¯è¿ä¸ªéçï¼éè¿æ¹è¿æ¥è¯¢æ ï¼è½å¤å¾å°ä¸ä¸ªæ´âå¥½âçæ¥è¯¢æ ãâ\n\nâå¦ï¼é£é»è¾ä¼åæ¯å¦ä½å¨å·²æçæ¥è¯¢æ ä¸å¢å é¦åçå¢ï¼â\n\nå¤§ææè§çµè§å§æ²¡åæ³çä¸å»äºï¼äºæ¯æ¿èµ·é¥æ§å¨å³äºçµè§ï¼ç»§ç»­è¯´ï¼âææ»ç»ï¼PostgreSQLå¨é»è¾ä¼åé¶æ®µæè¿ä¹å ä¸ªéè¦çä¼åï¼å­æ¥è¯¢&å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ãè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çãâå¤§æåæ½äºä¸å£çï¼æ¥çè¯´å°ï¼âä»ä»£ç é»è¾ä¸æ¥çï¼æä»¬è¿å¯ä»¥æå­æ¥è¯¢&å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤å«åé»è¾éåä¼åï¼å ä¸ºä»ä»¬ä¸»è¦æ¯å¯¹æ¥è¯¢æ è¿è¡æ¹é ï¼èåé¢çè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çåå¯ä»¥ç§°ä¹ä¸ºé»è¾åè§£ä¼åï¼ä»ä»¬å·²ç»ææ¥è¯¢æ è¹èºçä¸ææ ·å­äºï¼å·²ç»å°äºçé¦çä¸æ¯é¦ççå°æ­¥äºãâ\n\nâå¯æ¯æä»¬çæ°æ®åºåçè¯¾ä¸å¹¶æ²¡æè¯´æé»è¾éåä¼ååé»è¾åè§£ä¼ååï¼â\n\nâå¯ï¼æ¯çï¼è¿æ¯æèªå·±æ ¹æ®PostgreSQLçæºä»£ç çç¹å¾èªå·±æ»ç»çï¼ä¸è¿å®è½æ¯è¾å½¢è±¡çå°ç°æçé»è¾ä¼ååºåå¼æ¥ï¼è¿æ ·å°±è½æ´å¥½çå¯¹é»è¾ä¼åè¿è¡æç¼ãæ»ç»ãåæãâå¤§ææ³äºä¸ä¸è§å¾å¦ææææçé»è¾ä¼åçè§åé½è¯´å®æç¹å¤ï¼å³å®éæ©å¶ä¸­çä¸ä¸¤ä¸ªè¯´ä¸ä¸ï¼äºæ¯å¯¹å°æè¯´éï¼âæä»¬å°±ä»ä¸­æéä¸ä¸¤ä¸ªè¯¦ç»çè¯´æä¸ä¸å§ï¼æä»¬åä»å­æ¥è¯¢&å­è¿æ¥çæåå¼å§è¯´èµ·ãâ\n\nâé£ãããå­æ¥è¯¢åå­è¿æ¥æä»ä¹åºå«å¢ï¼æä»¬å¨æ°æ®åºåçè¯¾éåªè®²äºå­æ¥è¯¢ï¼æ²¡æå­è¿æ¥çæ¦å¿µï¼è¿è¯¥æä¹è§£éå¢ï¼âå°æä¸è§£çé®ã\n\nå¤§æå»ä¹¦æéæ¿åºäºãæ°æ®åºç³»ç»å®ç°ãè¿æ¬ä¹¦ï¼ç¶åç¿»å¼äºå¯¹åºçç« èï¼è¯´éï¼âéå¸¸æ°æ®åºåçä¹¦ç±ä¸­è¯´çå­æ¥è¯¢ï¼æçæ¯PostgreSQLæ°æ®åºä¸­çå­è¿æ¥ãä½ çï¼ãæ°æ®åºç³»ç»å®ç°ãä¸­è¯´çæ¯ä»æ¡ä»¶ä¸­å»é¤å­æ¥è¯¢ï¼ä½æ¯PostgreSQLæè¿ç§æåµå½ç±»ä¸ºå­è¿æ¥ãâ\n\nâé£å¨PostgreSQLæ¯å¦ä½åºåå­æ¥è¯¢åå­è¿æ¥çå¢ï¼âå¤§æèªé®èªç­éï¼âå¨å®éåºç¨ä¸­å¯ä»¥éè¿å­å¥æå¤çä½ç½®æ¥åºåå­è¿æ¥åå­æ¥è¯¢ï¼åºç°å¨FROMå³é®å­åçå­å¥æ¯å­æ¥è¯¢è¯­å¥ï¼åºç°å¨WHERE/ONç­çº¦ææ¡ä»¶ä¸­ææå½±ä¸­çå­å¥æ¯å­è¿æ¥è¯­å¥ãâè¯´çå¤§æå¿«éçå¨çµèä¸æå¼äºè®°äºæ¬ï¼æ²å¥äºå ä¸ªSQLè¯­å¥ï¼\n\n```\n1. SELECT * FROM STUDENT, (SELECT * FROM SCORE) as sc;\n2. SELECT (SELECT AVG(degree) FROM SCORE), sname FROM STUDENT;\n3. SELECT * FROM STUDENT WHERE EXISTS (SELECT A FROM SCORE WHERE SCORE.sno = STUDENT.sno);\n```\n\nâè¿äºSQLè¯­å¥ä¸­åªä¸ªæ¯å­æ¥è¯¢ï¼åªä¸ªæ¯å­è¿æ¥ï¼â\n\nå°æçäºä¸ä¸ï¼ç¶åè¯´ï¼â1æ¯å­æ¥è¯¢ï¼2å3æ¯å­è¿æ¥ï¼è¯­å¥1éé¢çå­å¥åºç°å¨FROMåé¢ï¼å®æ¯ä»¥âè¡¨âçå½¢å¼å­å¨çï¼æ¯å­æ¥è¯¢ï¼2å3çå­å¥åºç°å¨æå½±åçº¦ææ¡ä»¶ä¸­ï¼æ¯ä»¥è¡¨è¾¾å¼çå½¢å¼å­å¨çï¼æ¯å­è¿æ¥ãâå°æä¸ä½ç­å¯¹äºé®é¢ï¼èä¸è¿å¯¹é®é¢çç­æ¡åäºæ©å±ï¼å¤§ææå°å¾ä¸é¢èµèï¼äºæ¯è°ä¾éï¼âè°é´çåå­¦ï¼ä½ åä¸ï¼ä½ å¤ªçªåºäºãâ\n\nç¶åå¤§ææ­£ä¸æ­£é¢è²ï¼ç»§ç»­è¯´éâä»å¤§çæ¹åä¸åç±»ï¼å­æ¥è¯¢è¿å¯ä»¥åä¸ºç¸å³å­è¿æ¥åéç¸å³å­è¿æ¥ï¼ç¸å³å­è¿æ¥æ¯æå¨å­æ¥è¯¢è¯­å¥ä¸­å¼ç¨äºå¤å±è¡¨çåå±æ§ï¼è¿å°±å¯¼è´å¤å±è¡¨æ¯è·å¾ä¸ä¸ªåç»ï¼å­æ¥è¯¢å°±éè¦éæ°æ§è¡ä¸æ¬¡ï¼èéç¸å³å­æ¥è¯¢æ¯æå¨å­æ¥è¯¢è¯­å¥æ¯ç¬ç«çï¼åå¤å±çè¡¨æ²¡æç´æ¥çå³èï¼å­æ¥è¯¢å¯ä»¥åç¬æ§è¡ä¸æ¬¡ï¼å¤å±è¡¨å¯ä»¥éå¤å©ç¨å­æ¥è¯¢çæ§è¡ç»æãâ\n\nâé£ä¹ä¸å®æ¯ç¸å³å­è¿æ¥æä¼æåäºï¼å ä¸ºæè®°å¾ä½ å¨è¯´é»è¾ä¼ååççæ¶åè¯´è¿ï¼ç¸å³å­è¿æ¥ä¼äº§çâåµå¥å¾ªç¯âï¼è¿ç§æåµçå¤æåº¦æ¯O(N^2)ï¼æåä¸æ¥çå¤æåº¦è¯å®ä¸ä¼æ¯O(N^2)å·®ï¼æä»¥æåæ¯æä»·å¼çãâå°æé®å°ã\n\nå¬å°è¿äºï¼å¤§æé¡¿æ¶ç¢å ¡äºï¼éçè½ç¶æ¯è¿ä¸ªéçï¼ä½æ¯PostgreSQLååä¸èµ°å¯»å¸¸è·¯ï¼åèªå·±ä¹åè¯´è¿çæäºè®¸å·®å¼ï¼å¤§æç¾æ¶©çè¯´ï¼âè½ç¶è¯æ¯è¿æ ·è¯´ï¼ä½PostgreSQLæç¹ä¸åï¼PostgreSQLæåäºä¸¤ç§ç±»åçå­è¿æ¥ï¼ä¸ç§æ¯ANYç±»åçå­è¿æ¥ï¼ä¸ç§æ¯EXISTSç±»åçå­è¿æ¥ï¼å¯¹äºANYç±»åçå­è¿æ¥ï¼åªæåéç¸å³å­è¿æ¥ï¼èå¯¹äºEXISTSç±»åçå­è¿æ¥ï¼ååªæåç¸å³å­è¿æ¥ãâ\n\nå°æé¡¿æ¶æ³èµ·äºèªå·±æ¾ååå­¦è¯´è¿ç¸å³å­è¿æ¥çè®ºï¼å½æ¶æå®¿èåå­¦å¿½æ çäºè¿·ä¸éçï¼ä»å¤©å¤§æåè¯´è¿å¯è½æ¯éçï¼å¿éä¸å¤ªç½å©ï¼äºæ¯æéï¼âä½ ä¹åææçé½æéè¯¯ï¼é£æååå­¦å¹è¿ççå²ä¸æ¯è¦æä¸ºç¬æï¼ææè§æåå°äºä¸ä¸ç¹ä¸æµ·ãâ\n\nâå°æåå­¦ä¸è¦æ¥âï¼å¤§æå®æéï¼âè½ç¶PostgreSQLå¯¹äºANYç±»ååªæåéç¸å³çå­è¿æ¥ï¼ä½å®ä»ç¶æ¯åªæåäº§çåµå¥å¾ªç¯çé£ç§å­è¿æ¥ï¼ä½ ççè¿ä¸ªä¾å­ãâè¯´çå¤§æå¨çµèä¸åæ²äºä¸ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT * FROM STUDENT WHERE sno > ANY (SELECT sno from STUDENT);\n```\n\nâè¿æ¯ä¸ä¸ªANYç±»åçéç¸å³å­è¿æ¥ï¼ä½æ¯è¯·æ³¨æï¼å¨>åé¢çsnoå®éä¸äº§çäºä¸ä¸ªå¤©ç¶çç¸å³æ§ï¼è¿ä¸ªå¤©ç¶çç¸å³æ§å°±ä¼äº§çåµå¥å¾ªç¯ï¼å æ­¤æ¯éè¦æåçãæä»¬åæ¥çå¦ä¸ä¸ªè¯­å¥ãâå¤§ææè¯­å¥ä¸­>åé¢çsnoæ¢æäºä¸ä¸ªå¸¸éï¼\n\n```\nSELECT * FROM STUDENT WHERE 10 > ANY (SELECT sno from STUDENT);\n```\n\nâè¿ä¸ªSQLè¯­å¥ä¸­çå­è¿æ¥å°±ä¸ä¼æåäºï¼å ä¸ºæä»¬æsnoæ¢æäºå¸¸éï¼ç¶å­ä¹é´çç¸å³æ§è¢«æç ´äºï¼æç½äºåï¼â\n\nå°æç¹ç¹å¤´ï¼å¿éæ³ï¼å­è¿æ¥æ¯å¦æååå³äºç¸å³æ§ï¼èè¿ä¸ªç¸å³æ§ä¸åªæ¯ä½ç°å¨å­å¥éï¼ä¹ä½ç°å¨è¡¨è¾¾å¼éï¼ä¹å°±æ¯è¯´åªè¦è½äº§çåµå¥å¾ªç¯ï¼é£å°±ææåçå¿è¦åï¼ä½æ¯ãããå°æçµæºä¸å¨ï¼é®éï¼âé£ANYç±»åçç¸å³å­è¿æ¥ä¹ä¼äº§çåµå¥å¾ªç¯åï¼ä¸ºä»ä¹ä¸æåå¢ï¼â\n\nå¤§æè¯´ï¼âè¿å¯è½æç¹åå²åå äºï¼PostgreSQLæåANYç±»åçå­è¿æ¥çæ¹å¼åEXISTSç±»åçå­è¿æ¥çæ¹å¼ä¸åï¼ä»æåEXISTSç±»åçå­è¿æ¥çæ¶åï¼æ¯ç´æ¥æå­å¥ä¸­çè¡¨æä¸æ¥åå½¢æä¸ä¸ªSemiJoinï¼å¯æ¯æåANYç±»åçå­è¿æ¥çæ¶åï¼æ¯ææ´ä¸ªå­å¥æä¸æ¥ï¼åç¶è¯­å¥ä¸­çè¡¨åSemiJoinï¼è¿æ¶åè¿ä¸ªå­å¥å°±åæäºä¸ä¸ªå­æ¥è¯¢ï¼ä½ çè¿ä¸ªä¾å­ãâè¯´çå¤§æåªåªåªçå¨çµèä¸æ²äº3ä¸ªè¯­å¥ï¼\n\n```\n1. SELECT * FROM TEST_A WHERE a > ANY (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b)ï¼\n2. SELECT * FROM TEST_A, (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b) b WHERE TEST_A.a > b.a;\n3. SELECT * FROM TEST_A, LATERAL (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b) b WHERE TEST_A.a > b.a;\n```\n\nâå¦ææç§ç®åANYç±»åå­è¿æ¥åæåæå­æ¥è¯¢çæ¹å¼ï¼ç¬¬1ä¸ªè¯­å¥æåä¹åä¼åæç­ä»·äºç¬¬2ä¸ªè¯­å¥ï¼èç¬¬2ä¸ªè¯­å¥æ¬èº«æ¯æ æ³æ§è¡çï¼å¨æ¯è¾æ°ççæ¬çPostgreSQLä¸æ¯æäºLATERALä¹åï¼åªè¦å¨ç¬¬2ä¸ªè¯­å¥ä¸å ä¸LATERALï¼ä¹å°±æ¯åæç¬¬3ä¸ªè¯­å¥å°±è½æ§è¡äºãâå¤§æå¨å±å¹ä¸æ¯åçè¯´ã\n\nå°æé®éï¼âé£å²ä¸æ¯è¯´ï¼æäºLATERALä¹åï¼ANYç±»åçç¸å³å­è¿æ¥ä¹è½æåäºï¼â\n\nå¤§æè¯´ï¼âåªè½è¯´æä¸é¨åANYç±»åçç¸å³å­è¿æ¥è½å¤æåäºï¼æ¯å¦æä»¬ä¸é¢çä¾1æ¬è´¨ä¸å°±æ¯è½æåçï¼èä¸ä¸äºåä¸æ°æ®åºç¡®å®ä¹å¯¹è¿ç§è¯­å¥åäºæåï¼ä½æ¯PostgreSQLæ°æ®åºç®åè¿æ²¡æå¤çè¿ç§æåµãâ\n\t\nå°ææäºä¸ªåæ¬ è¯´ï¼âå®å¨æ¯å¤ªç´¯äºï¼è®©æä»¬ä¼æ¯ä¸ä¸å§ï¼æ¥è¯¢ä¼åå¨å¤ªå¤æäºãâ\n\nå¤§æç¬çè¯´ï¼âåæä¸æå°±è½æåï¼ä¸ä¸æ¢¦æ³å®ç°äºå¢?å­è¿æ¥æåä¹åï¼è¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ï¼ä¸è¿ï¼å¨è¿ä¹åè¿æ¯è®©æä»¬ååä¸ªé¸¡åè¯´å§ãâ\n","source":"_posts/postgresql-optimizer-outline-3.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(3) - æåï¼æåï¼\ndate: 2020-08-02 09:25:08\n---\n\nå°æåç°å°å¤§æå®¶éé®é®é¢ä¸ä½è½æ¶è·ç¥è¯ï¼è¿è½æ¶è·å¤§è°å­åçº¢éï¼äºæ¯æ´å åå®äºå¸¸æ¥é®é®é¢çå³å¿ã\n\nå°æåå¤§æåå®äºåé¥­ï¼æå¼çµè§çä¸ä¼çµè§å§ï¼å¤§æåæ¬æçæ¬æçæ½èµ·äºä¸­åçï¼å°æé»çäºæçæç¹å¿ç¦ï¼å°±é®å¤§æï¼âå¥ï¼ä½ æ´å¤©æ½æ½æ½ï¼æé£ä¹å¥½æ½åï¼âå¤§æèªè±ªçè¯´ï¼âåå°ï¼å±ç·ç·æ½çï¼å±ç¸ç¸ä¹æ½çï¼å°æè¿ä¸è½æ­äºé¦ç«ï¼ä½ ä¸æ½çæ¯ä¸å­ç¥éä¸ï¼â<!-- more -->\n\nå°æè¯´ï¼âå±ç·ç·æ½çæ¯å¨åæç§ççå¶ï¼èªç»èªè¶³ï¼è¿çé±ï¼ä½ ä¹å¹²èååæç§çå¶ï¼ä½ è¿ä¸­åçååæçèªå·±å·ççå¶ï¼è½æä»ä¹åºå«ï¼â\n\nå¤§æççµè§å§æ­£çå¾èµ·å²ï¼å¿ä¸å¨ççè¯´ï¼âèªå·±ç§ççå¶ç´æ¥ç¨æ¥çº¸å·äºæ½ï¼æ²¡æè¿æ»¤å´ï¼ä¼å¸å¥æå®³é¢ç²ç©ï¼èä¸çå¶çå³éä¹ä¸å¦ç°å¨æ¹è¿çé¦çãâè¯´å°è¿éå¤§æå¥½åæ³å°äºäºä»ä¹ï¼ç»§ç»­è¯´ï¼âè¿å°±åæ¯æ¥è¯¢ä¼åå¨çé»è¾ä¼åï¼æ¥è¯¢æ è¾å¥ä¹åï¼éè¦è¿è¡æç»­çæ¹è¿ï¼æ è®ºæ¯èªå·±ç¨æ¥çº¸å·ççï¼è¿æ¯å¨è¶å¸ä¹°çæåçï¼å®é½æ¯é¦çï¼ä½æ¯éè¿æ¹è¿ä¹åï¼é¦ççæ¯å®³ä½ç¨æ´ä½ãé¦åæ´ä¸°å¯äºï¼é»è¾ä¼åä¹æ¯è¿ä¸ªéçï¼éè¿æ¹è¿æ¥è¯¢æ ï¼è½å¤å¾å°ä¸ä¸ªæ´âå¥½âçæ¥è¯¢æ ãâ\n\nâå¦ï¼é£é»è¾ä¼åæ¯å¦ä½å¨å·²æçæ¥è¯¢æ ä¸å¢å é¦åçå¢ï¼â\n\nå¤§ææè§çµè§å§æ²¡åæ³çä¸å»äºï¼äºæ¯æ¿èµ·é¥æ§å¨å³äºçµè§ï¼ç»§ç»­è¯´ï¼âææ»ç»ï¼PostgreSQLå¨é»è¾ä¼åé¶æ®µæè¿ä¹å ä¸ªéè¦çä¼åï¼å­æ¥è¯¢&å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ãè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çãâå¤§æåæ½äºä¸å£çï¼æ¥çè¯´å°ï¼âä»ä»£ç é»è¾ä¸æ¥çï¼æä»¬è¿å¯ä»¥æå­æ¥è¯¢&å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤å«åé»è¾éåä¼åï¼å ä¸ºä»ä»¬ä¸»è¦æ¯å¯¹æ¥è¯¢æ è¿è¡æ¹é ï¼èåé¢çè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çåå¯ä»¥ç§°ä¹ä¸ºé»è¾åè§£ä¼åï¼ä»ä»¬å·²ç»ææ¥è¯¢æ è¹èºçä¸ææ ·å­äºï¼å·²ç»å°äºçé¦çä¸æ¯é¦ççå°æ­¥äºãâ\n\nâå¯æ¯æä»¬çæ°æ®åºåçè¯¾ä¸å¹¶æ²¡æè¯´æé»è¾éåä¼ååé»è¾åè§£ä¼ååï¼â\n\nâå¯ï¼æ¯çï¼è¿æ¯æèªå·±æ ¹æ®PostgreSQLçæºä»£ç çç¹å¾èªå·±æ»ç»çï¼ä¸è¿å®è½æ¯è¾å½¢è±¡çå°ç°æçé»è¾ä¼ååºåå¼æ¥ï¼è¿æ ·å°±è½æ´å¥½çå¯¹é»è¾ä¼åè¿è¡æç¼ãæ»ç»ãåæãâå¤§ææ³äºä¸ä¸è§å¾å¦ææææçé»è¾ä¼åçè§åé½è¯´å®æç¹å¤ï¼å³å®éæ©å¶ä¸­çä¸ä¸¤ä¸ªè¯´ä¸ä¸ï¼äºæ¯å¯¹å°æè¯´éï¼âæä»¬å°±ä»ä¸­æéä¸ä¸¤ä¸ªè¯¦ç»çè¯´æä¸ä¸å§ï¼æä»¬åä»å­æ¥è¯¢&å­è¿æ¥çæåå¼å§è¯´èµ·ãâ\n\nâé£ãããå­æ¥è¯¢åå­è¿æ¥æä»ä¹åºå«å¢ï¼æä»¬å¨æ°æ®åºåçè¯¾éåªè®²äºå­æ¥è¯¢ï¼æ²¡æå­è¿æ¥çæ¦å¿µï¼è¿è¯¥æä¹è§£éå¢ï¼âå°æä¸è§£çé®ã\n\nå¤§æå»ä¹¦æéæ¿åºäºãæ°æ®åºç³»ç»å®ç°ãè¿æ¬ä¹¦ï¼ç¶åç¿»å¼äºå¯¹åºçç« èï¼è¯´éï¼âéå¸¸æ°æ®åºåçä¹¦ç±ä¸­è¯´çå­æ¥è¯¢ï¼æçæ¯PostgreSQLæ°æ®åºä¸­çå­è¿æ¥ãä½ çï¼ãæ°æ®åºç³»ç»å®ç°ãä¸­è¯´çæ¯ä»æ¡ä»¶ä¸­å»é¤å­æ¥è¯¢ï¼ä½æ¯PostgreSQLæè¿ç§æåµå½ç±»ä¸ºå­è¿æ¥ãâ\n\nâé£å¨PostgreSQLæ¯å¦ä½åºåå­æ¥è¯¢åå­è¿æ¥çå¢ï¼âå¤§æèªé®èªç­éï¼âå¨å®éåºç¨ä¸­å¯ä»¥éè¿å­å¥æå¤çä½ç½®æ¥åºåå­è¿æ¥åå­æ¥è¯¢ï¼åºç°å¨FROMå³é®å­åçå­å¥æ¯å­æ¥è¯¢è¯­å¥ï¼åºç°å¨WHERE/ONç­çº¦ææ¡ä»¶ä¸­ææå½±ä¸­çå­å¥æ¯å­è¿æ¥è¯­å¥ãâè¯´çå¤§æå¿«éçå¨çµèä¸æå¼äºè®°äºæ¬ï¼æ²å¥äºå ä¸ªSQLè¯­å¥ï¼\n\n```\n1. SELECT * FROM STUDENT, (SELECT * FROM SCORE) as sc;\n2. SELECT (SELECT AVG(degree) FROM SCORE), sname FROM STUDENT;\n3. SELECT * FROM STUDENT WHERE EXISTS (SELECT A FROM SCORE WHERE SCORE.sno = STUDENT.sno);\n```\n\nâè¿äºSQLè¯­å¥ä¸­åªä¸ªæ¯å­æ¥è¯¢ï¼åªä¸ªæ¯å­è¿æ¥ï¼â\n\nå°æçäºä¸ä¸ï¼ç¶åè¯´ï¼â1æ¯å­æ¥è¯¢ï¼2å3æ¯å­è¿æ¥ï¼è¯­å¥1éé¢çå­å¥åºç°å¨FROMåé¢ï¼å®æ¯ä»¥âè¡¨âçå½¢å¼å­å¨çï¼æ¯å­æ¥è¯¢ï¼2å3çå­å¥åºç°å¨æå½±åçº¦ææ¡ä»¶ä¸­ï¼æ¯ä»¥è¡¨è¾¾å¼çå½¢å¼å­å¨çï¼æ¯å­è¿æ¥ãâå°æä¸ä½ç­å¯¹äºé®é¢ï¼èä¸è¿å¯¹é®é¢çç­æ¡åäºæ©å±ï¼å¤§ææå°å¾ä¸é¢èµèï¼äºæ¯è°ä¾éï¼âè°é´çåå­¦ï¼ä½ åä¸ï¼ä½ å¤ªçªåºäºãâ\n\nç¶åå¤§ææ­£ä¸æ­£é¢è²ï¼ç»§ç»­è¯´éâä»å¤§çæ¹åä¸åç±»ï¼å­æ¥è¯¢è¿å¯ä»¥åä¸ºç¸å³å­è¿æ¥åéç¸å³å­è¿æ¥ï¼ç¸å³å­è¿æ¥æ¯æå¨å­æ¥è¯¢è¯­å¥ä¸­å¼ç¨äºå¤å±è¡¨çåå±æ§ï¼è¿å°±å¯¼è´å¤å±è¡¨æ¯è·å¾ä¸ä¸ªåç»ï¼å­æ¥è¯¢å°±éè¦éæ°æ§è¡ä¸æ¬¡ï¼èéç¸å³å­æ¥è¯¢æ¯æå¨å­æ¥è¯¢è¯­å¥æ¯ç¬ç«çï¼åå¤å±çè¡¨æ²¡æç´æ¥çå³èï¼å­æ¥è¯¢å¯ä»¥åç¬æ§è¡ä¸æ¬¡ï¼å¤å±è¡¨å¯ä»¥éå¤å©ç¨å­æ¥è¯¢çæ§è¡ç»æãâ\n\nâé£ä¹ä¸å®æ¯ç¸å³å­è¿æ¥æä¼æåäºï¼å ä¸ºæè®°å¾ä½ å¨è¯´é»è¾ä¼ååççæ¶åè¯´è¿ï¼ç¸å³å­è¿æ¥ä¼äº§çâåµå¥å¾ªç¯âï¼è¿ç§æåµçå¤æåº¦æ¯O(N^2)ï¼æåä¸æ¥çå¤æåº¦è¯å®ä¸ä¼æ¯O(N^2)å·®ï¼æä»¥æåæ¯æä»·å¼çãâå°æé®å°ã\n\nå¬å°è¿äºï¼å¤§æé¡¿æ¶ç¢å ¡äºï¼éçè½ç¶æ¯è¿ä¸ªéçï¼ä½æ¯PostgreSQLååä¸èµ°å¯»å¸¸è·¯ï¼åèªå·±ä¹åè¯´è¿çæäºè®¸å·®å¼ï¼å¤§æç¾æ¶©çè¯´ï¼âè½ç¶è¯æ¯è¿æ ·è¯´ï¼ä½PostgreSQLæç¹ä¸åï¼PostgreSQLæåäºä¸¤ç§ç±»åçå­è¿æ¥ï¼ä¸ç§æ¯ANYç±»åçå­è¿æ¥ï¼ä¸ç§æ¯EXISTSç±»åçå­è¿æ¥ï¼å¯¹äºANYç±»åçå­è¿æ¥ï¼åªæåéç¸å³å­è¿æ¥ï¼èå¯¹äºEXISTSç±»åçå­è¿æ¥ï¼ååªæåç¸å³å­è¿æ¥ãâ\n\nå°æé¡¿æ¶æ³èµ·äºèªå·±æ¾ååå­¦è¯´è¿ç¸å³å­è¿æ¥çè®ºï¼å½æ¶æå®¿èåå­¦å¿½æ çäºè¿·ä¸éçï¼ä»å¤©å¤§æåè¯´è¿å¯è½æ¯éçï¼å¿éä¸å¤ªç½å©ï¼äºæ¯æéï¼âä½ ä¹åææçé½æéè¯¯ï¼é£æååå­¦å¹è¿ççå²ä¸æ¯è¦æä¸ºç¬æï¼ææè§æåå°äºä¸ä¸ç¹ä¸æµ·ãâ\n\nâå°æåå­¦ä¸è¦æ¥âï¼å¤§æå®æéï¼âè½ç¶PostgreSQLå¯¹äºANYç±»ååªæåéç¸å³çå­è¿æ¥ï¼ä½å®ä»ç¶æ¯åªæåäº§çåµå¥å¾ªç¯çé£ç§å­è¿æ¥ï¼ä½ ççè¿ä¸ªä¾å­ãâè¯´çå¤§æå¨çµèä¸åæ²äºä¸ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT * FROM STUDENT WHERE sno > ANY (SELECT sno from STUDENT);\n```\n\nâè¿æ¯ä¸ä¸ªANYç±»åçéç¸å³å­è¿æ¥ï¼ä½æ¯è¯·æ³¨æï¼å¨>åé¢çsnoå®éä¸äº§çäºä¸ä¸ªå¤©ç¶çç¸å³æ§ï¼è¿ä¸ªå¤©ç¶çç¸å³æ§å°±ä¼äº§çåµå¥å¾ªç¯ï¼å æ­¤æ¯éè¦æåçãæä»¬åæ¥çå¦ä¸ä¸ªè¯­å¥ãâå¤§ææè¯­å¥ä¸­>åé¢çsnoæ¢æäºä¸ä¸ªå¸¸éï¼\n\n```\nSELECT * FROM STUDENT WHERE 10 > ANY (SELECT sno from STUDENT);\n```\n\nâè¿ä¸ªSQLè¯­å¥ä¸­çå­è¿æ¥å°±ä¸ä¼æåäºï¼å ä¸ºæä»¬æsnoæ¢æäºå¸¸éï¼ç¶å­ä¹é´çç¸å³æ§è¢«æç ´äºï¼æç½äºåï¼â\n\nå°æç¹ç¹å¤´ï¼å¿éæ³ï¼å­è¿æ¥æ¯å¦æååå³äºç¸å³æ§ï¼èè¿ä¸ªç¸å³æ§ä¸åªæ¯ä½ç°å¨å­å¥éï¼ä¹ä½ç°å¨è¡¨è¾¾å¼éï¼ä¹å°±æ¯è¯´åªè¦è½äº§çåµå¥å¾ªç¯ï¼é£å°±ææåçå¿è¦åï¼ä½æ¯ãããå°æçµæºä¸å¨ï¼é®éï¼âé£ANYç±»åçç¸å³å­è¿æ¥ä¹ä¼äº§çåµå¥å¾ªç¯åï¼ä¸ºä»ä¹ä¸æåå¢ï¼â\n\nå¤§æè¯´ï¼âè¿å¯è½æç¹åå²åå äºï¼PostgreSQLæåANYç±»åçå­è¿æ¥çæ¹å¼åEXISTSç±»åçå­è¿æ¥çæ¹å¼ä¸åï¼ä»æåEXISTSç±»åçå­è¿æ¥çæ¶åï¼æ¯ç´æ¥æå­å¥ä¸­çè¡¨æä¸æ¥åå½¢æä¸ä¸ªSemiJoinï¼å¯æ¯æåANYç±»åçå­è¿æ¥çæ¶åï¼æ¯ææ´ä¸ªå­å¥æä¸æ¥ï¼åç¶è¯­å¥ä¸­çè¡¨åSemiJoinï¼è¿æ¶åè¿ä¸ªå­å¥å°±åæäºä¸ä¸ªå­æ¥è¯¢ï¼ä½ çè¿ä¸ªä¾å­ãâè¯´çå¤§æåªåªåªçå¨çµèä¸æ²äº3ä¸ªè¯­å¥ï¼\n\n```\n1. SELECT * FROM TEST_A WHERE a > ANY (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b)ï¼\n2. SELECT * FROM TEST_A, (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b) b WHERE TEST_A.a > b.a;\n3. SELECT * FROM TEST_A, LATERAL (SELECT a FROM TEST_B WHERE TEST_A.b = TEST_B.b) b WHERE TEST_A.a > b.a;\n```\n\nâå¦ææç§ç®åANYç±»åå­è¿æ¥åæåæå­æ¥è¯¢çæ¹å¼ï¼ç¬¬1ä¸ªè¯­å¥æåä¹åä¼åæç­ä»·äºç¬¬2ä¸ªè¯­å¥ï¼èç¬¬2ä¸ªè¯­å¥æ¬èº«æ¯æ æ³æ§è¡çï¼å¨æ¯è¾æ°ççæ¬çPostgreSQLä¸æ¯æäºLATERALä¹åï¼åªè¦å¨ç¬¬2ä¸ªè¯­å¥ä¸å ä¸LATERALï¼ä¹å°±æ¯åæç¬¬3ä¸ªè¯­å¥å°±è½æ§è¡äºãâå¤§æå¨å±å¹ä¸æ¯åçè¯´ã\n\nå°æé®éï¼âé£å²ä¸æ¯è¯´ï¼æäºLATERALä¹åï¼ANYç±»åçç¸å³å­è¿æ¥ä¹è½æåäºï¼â\n\nå¤§æè¯´ï¼âåªè½è¯´æä¸é¨åANYç±»åçç¸å³å­è¿æ¥è½å¤æåäºï¼æ¯å¦æä»¬ä¸é¢çä¾1æ¬è´¨ä¸å°±æ¯è½æåçï¼èä¸ä¸äºåä¸æ°æ®åºç¡®å®ä¹å¯¹è¿ç§è¯­å¥åäºæåï¼ä½æ¯PostgreSQLæ°æ®åºç®åè¿æ²¡æå¤çè¿ç§æåµãâ\n\t\nå°ææäºä¸ªåæ¬ è¯´ï¼âå®å¨æ¯å¤ªç´¯äºï¼è®©æä»¬ä¼æ¯ä¸ä¸å§ï¼æ¥è¯¢ä¼åå¨å¤ªå¤æäºãâ\n\nå¤§æç¬çè¯´ï¼âåæä¸æå°±è½æåï¼ä¸ä¸æ¢¦æ³å®ç°äºå¢?å­è¿æ¥æåä¹åï¼è¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ï¼ä¸è¿ï¼å¨è¿ä¹åè¿æ¯è®©æä»¬ååä¸ªé¸¡åè¯´å§ãâ\n","slug":"postgresql-optimizer-outline-3","published":1,"updated":"2020-08-02T01:54:51.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckdchg8jg0003r2s6aul442ma","content":"<p>å°æåç°å°å¤§æå®¶éé®é®é¢ä¸ä½è½æ¶è·ç¥è¯ï¼è¿è½æ¶è·å¤§è°å­åçº¢éï¼äºæ¯æ´å åå®äºå¸¸æ¥é®é®é¢çå³å¿ã</p>\n<p>å°æåå¤§æåå®äºåé¥­ï¼æå¼çµè§çä¸ä¼çµè§å§ï¼å¤§æåæ¬æçæ¬æçæ½èµ·äºä¸­åçï¼å°æé»çäºæçæç¹å¿ç¦ï¼å°±é®å¤§æï¼âå¥ï¼ä½ æ´å¤©æ½æ½æ½ï¼æé£ä¹å¥½æ½åï¼âå¤§æèªè±ªçè¯´ï¼âåå°ï¼å±ç·ç·æ½çï¼å±ç¸ç¸ä¹æ½çï¼å°æè¿ä¸è½æ­äºé¦ç«ï¼ä½ ä¸æ½çæ¯ä¸å­ç¥éä¸ï¼â<a id=\"more\"></a></p>\n<p>å°æè¯´ï¼âå±ç·ç·æ½çæ¯å¨åæç§ççå¶ï¼èªç»èªè¶³ï¼è¿çé±ï¼ä½ ä¹å¹²èååæç§çå¶ï¼ä½ è¿ä¸­åçååæçèªå·±å·ççå¶ï¼è½æä»ä¹åºå«ï¼â</p>\n<p>å¤§æççµè§å§æ­£çå¾èµ·å²ï¼å¿ä¸å¨ççè¯´ï¼âèªå·±ç§ççå¶ç´æ¥ç¨æ¥çº¸å·äºæ½ï¼æ²¡æè¿æ»¤å´ï¼ä¼å¸å¥æå®³é¢ç²ç©ï¼èä¸çå¶çå³éä¹ä¸å¦ç°å¨æ¹è¿çé¦çãâè¯´å°è¿éå¤§æå¥½åæ³å°äºäºä»ä¹ï¼ç»§ç»­è¯´ï¼âè¿å°±åæ¯æ¥è¯¢ä¼åå¨çé»è¾ä¼åï¼æ¥è¯¢æ è¾å¥ä¹åï¼éè¦è¿è¡æç»­çæ¹è¿ï¼æ è®ºæ¯èªå·±ç¨æ¥çº¸å·ççï¼è¿æ¯å¨è¶å¸ä¹°çæåçï¼å®é½æ¯é¦çï¼ä½æ¯éè¿æ¹è¿ä¹åï¼é¦ççæ¯å®³ä½ç¨æ´ä½ãé¦åæ´ä¸°å¯äºï¼é»è¾ä¼åä¹æ¯è¿ä¸ªéçï¼éè¿æ¹è¿æ¥è¯¢æ ï¼è½å¤å¾å°ä¸ä¸ªæ´âå¥½âçæ¥è¯¢æ ãâ</p>\n<p>âå¦ï¼é£é»è¾ä¼åæ¯å¦ä½å¨å·²æçæ¥è¯¢æ ä¸å¢å é¦åçå¢ï¼â</p>\n<p>å¤§ææè§çµè§å§æ²¡åæ³çä¸å»äºï¼äºæ¯æ¿èµ·é¥æ§å¨å³äºçµè§ï¼ç»§ç»­è¯´ï¼âææ»ç»ï¼PostgreSQLå¨é»è¾ä¼åé¶æ®µæè¿ä¹å ä¸ªéè¦çä¼åï¼å­æ¥è¯¢&amp;å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ãè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çãâå¤§æåæ½äºä¸å£çï¼æ¥çè¯´å°ï¼âä»ä»£ç é»è¾ä¸æ¥çï¼æä»¬è¿å¯ä»¥æå­æ¥è¯¢&amp;å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤å«åé»è¾éåä¼åï¼å ä¸ºä»ä»¬ä¸»è¦æ¯å¯¹æ¥è¯¢æ è¿è¡æ¹é ï¼èåé¢çè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çåå¯ä»¥ç§°ä¹ä¸ºé»è¾åè§£ä¼åï¼ä»ä»¬å·²ç»ææ¥è¯¢æ è¹èºçä¸ææ ·å­äºï¼å·²ç»å°äºçé¦çä¸æ¯é¦ççå°æ­¥äºãâ</p>\n<p>âå¯æ¯æä»¬çæ°æ®åºåçè¯¾ä¸å¹¶æ²¡æè¯´æé»è¾éåä¼ååé»è¾åè§£ä¼ååï¼â</p>\n<p>âå¯ï¼æ¯çï¼è¿æ¯æèªå·±æ ¹æ®PostgreSQLçæºä»£ç çç¹å¾èªå·±æ»ç»çï¼ä¸è¿å®è½æ¯è¾å½¢è±¡çå°ç°æçé»è¾ä¼ååºåå¼æ¥ï¼è¿æ ·å°±è½æ´å¥½çå¯¹é»è¾ä¼åè¿è¡æç¼ãæ»ç»ãåæãâå¤§ææ³äºä¸ä¸è§å¾å¦ææææçé»è¾ä¼åçè§åé½è¯´å®æç¹å¤ï¼å³å®éæ©å¶ä¸­çä¸ä¸¤ä¸ªè¯´ä¸ä¸ï¼äºæ¯å¯¹å°æè¯´éï¼âæä»¬å°±ä»ä¸­æéä¸ä¸¤ä¸ªè¯¦ç»çè¯´æä¸ä¸å§ï¼æä»¬åä»å­æ¥è¯¢&amp;å­è¿æ¥çæåå¼å§è¯´èµ·ãâ</p>\n<p>âé£ãããå­æ¥è¯¢åå­è¿æ¥æä»ä¹åºå«å¢ï¼æä»¬å¨æ°æ®åºåçè¯¾éåªè®²äºå­æ¥è¯¢ï¼æ²¡æå­è¿æ¥çæ¦å¿µï¼è¿è¯¥æä¹è§£éå¢ï¼âå°æä¸è§£çé®ã</p>\n<p>å¤§æå»ä¹¦æéæ¿åºäºãæ°æ®åºç³»ç»å®ç°ãè¿æ¬ä¹¦ï¼ç¶åç¿»å¼äºå¯¹åºçç« èï¼è¯´éï¼âéå¸¸æ°æ®åºåçä¹¦ç±ä¸­è¯´çå­æ¥è¯¢ï¼æçæ¯PostgreSQLæ°æ®åºä¸­çå­è¿æ¥ãä½ çï¼ãæ°æ®åºç³»ç»å®ç°ãä¸­è¯´çæ¯ä»æ¡ä»¶ä¸­å»é¤å­æ¥è¯¢ï¼ä½æ¯PostgreSQLæè¿ç§æåµå½ç±»ä¸ºå­è¿æ¥ãâ</p>\n<p>âé£å¨PostgreSQLæ¯å¦ä½åºåå­æ¥è¯¢åå­è¿æ¥çå¢ï¼âå¤§æèªé®èªç­éï¼âå¨å®éåºç¨ä¸­å¯ä»¥éè¿å­å¥æå¤çä½ç½®æ¥åºåå­è¿æ¥åå­æ¥è¯¢ï¼åºç°å¨FROMå³é®å­åçå­å¥æ¯å­æ¥è¯¢è¯­å¥ï¼åºç°å¨WHERE/ONç­çº¦ææ¡ä»¶ä¸­ææå½±ä¸­çå­å¥æ¯å­è¿æ¥è¯­å¥ãâè¯´çå¤§æå¿«éçå¨çµèä¸æå¼äºè®°äºæ¬ï¼æ²å¥äºå ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. SELECT * FROM STUDENT, (SELECT * FROM SCORE) as sc;</span><br><span class=\"line\">2. SELECT (SELECT AVG(degree) FROM SCORE), sname FROM STUDENT;</span><br><span class=\"line\">3. SELECT * FROM STUDENT WHERE EXISTS (SELECT A FROM SCORE WHERE SCORE.sno &#x3D; STUDENT.sno);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿äºSQLè¯­å¥ä¸­åªä¸ªæ¯å­æ¥è¯¢ï¼åªä¸ªæ¯å­è¿æ¥ï¼â</p>\n<p>å°æçäºä¸ä¸ï¼ç¶åè¯´ï¼â1æ¯å­æ¥è¯¢ï¼2å3æ¯å­è¿æ¥ï¼è¯­å¥1éé¢çå­å¥åºç°å¨FROMåé¢ï¼å®æ¯ä»¥âè¡¨âçå½¢å¼å­å¨çï¼æ¯å­æ¥è¯¢ï¼2å3çå­å¥åºç°å¨æå½±åçº¦ææ¡ä»¶ä¸­ï¼æ¯ä»¥è¡¨è¾¾å¼çå½¢å¼å­å¨çï¼æ¯å­è¿æ¥ãâå°æä¸ä½ç­å¯¹äºé®é¢ï¼èä¸è¿å¯¹é®é¢çç­æ¡åäºæ©å±ï¼å¤§ææå°å¾ä¸é¢èµèï¼äºæ¯è°ä¾éï¼âè°é´çåå­¦ï¼ä½ åä¸ï¼ä½ å¤ªçªåºäºãâ</p>\n<p>ç¶åå¤§ææ­£ä¸æ­£é¢è²ï¼ç»§ç»­è¯´éâä»å¤§çæ¹åä¸åç±»ï¼å­æ¥è¯¢è¿å¯ä»¥åä¸ºç¸å³å­è¿æ¥åéç¸å³å­è¿æ¥ï¼ç¸å³å­è¿æ¥æ¯æå¨å­æ¥è¯¢è¯­å¥ä¸­å¼ç¨äºå¤å±è¡¨çåå±æ§ï¼è¿å°±å¯¼è´å¤å±è¡¨æ¯è·å¾ä¸ä¸ªåç»ï¼å­æ¥è¯¢å°±éè¦éæ°æ§è¡ä¸æ¬¡ï¼èéç¸å³å­æ¥è¯¢æ¯æå¨å­æ¥è¯¢è¯­å¥æ¯ç¬ç«çï¼åå¤å±çè¡¨æ²¡æç´æ¥çå³èï¼å­æ¥è¯¢å¯ä»¥åç¬æ§è¡ä¸æ¬¡ï¼å¤å±è¡¨å¯ä»¥éå¤å©ç¨å­æ¥è¯¢çæ§è¡ç»æãâ</p>\n<p>âé£ä¹ä¸å®æ¯ç¸å³å­è¿æ¥æä¼æåäºï¼å ä¸ºæè®°å¾ä½ å¨è¯´é»è¾ä¼ååççæ¶åè¯´è¿ï¼ç¸å³å­è¿æ¥ä¼äº§çâåµå¥å¾ªç¯âï¼è¿ç§æåµçå¤æåº¦æ¯O(N^2)ï¼æåä¸æ¥çå¤æåº¦è¯å®ä¸ä¼æ¯O(N^2)å·®ï¼æä»¥æåæ¯æä»·å¼çãâå°æé®å°ã</p>\n<p>å¬å°è¿äºï¼å¤§æé¡¿æ¶ç¢å ¡äºï¼éçè½ç¶æ¯è¿ä¸ªéçï¼ä½æ¯PostgreSQLååä¸èµ°å¯»å¸¸è·¯ï¼åèªå·±ä¹åè¯´è¿çæäºè®¸å·®å¼ï¼å¤§æç¾æ¶©çè¯´ï¼âè½ç¶è¯æ¯è¿æ ·è¯´ï¼ä½PostgreSQLæç¹ä¸åï¼PostgreSQLæåäºä¸¤ç§ç±»åçå­è¿æ¥ï¼ä¸ç§æ¯ANYç±»åçå­è¿æ¥ï¼ä¸ç§æ¯EXISTSç±»åçå­è¿æ¥ï¼å¯¹äºANYç±»åçå­è¿æ¥ï¼åªæåéç¸å³å­è¿æ¥ï¼èå¯¹äºEXISTSç±»åçå­è¿æ¥ï¼ååªæåç¸å³å­è¿æ¥ãâ</p>\n<p>å°æé¡¿æ¶æ³èµ·äºèªå·±æ¾ååå­¦è¯´è¿ç¸å³å­è¿æ¥çè®ºï¼å½æ¶æå®¿èåå­¦å¿½æ çäºè¿·ä¸éçï¼ä»å¤©å¤§æåè¯´è¿å¯è½æ¯éçï¼å¿éä¸å¤ªç½å©ï¼äºæ¯æéï¼âä½ ä¹åææçé½æéè¯¯ï¼é£æååå­¦å¹è¿ççå²ä¸æ¯è¦æä¸ºç¬æï¼ææè§æåå°äºä¸ä¸ç¹ä¸æµ·ãâ</p>\n<p>âå°æåå­¦ä¸è¦æ¥âï¼å¤§æå®æéï¼âè½ç¶PostgreSQLå¯¹äºANYç±»ååªæåéç¸å³çå­è¿æ¥ï¼ä½å®ä»ç¶æ¯åªæåäº§çåµå¥å¾ªç¯çé£ç§å­è¿æ¥ï¼ä½ ççè¿ä¸ªä¾å­ãâè¯´çå¤§æå¨çµèä¸åæ²äºä¸ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT WHERE sno &gt; ANY (SELECT sno from STUDENT);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿æ¯ä¸ä¸ªANYç±»åçéç¸å³å­è¿æ¥ï¼ä½æ¯è¯·æ³¨æï¼å¨&gt;åé¢çsnoå®éä¸äº§çäºä¸ä¸ªå¤©ç¶çç¸å³æ§ï¼è¿ä¸ªå¤©ç¶çç¸å³æ§å°±ä¼äº§çåµå¥å¾ªç¯ï¼å æ­¤æ¯éè¦æåçãæä»¬åæ¥çå¦ä¸ä¸ªè¯­å¥ãâå¤§ææè¯­å¥ä¸­&gt;åé¢çsnoæ¢æäºä¸ä¸ªå¸¸éï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT WHERE 10 &gt; ANY (SELECT sno from STUDENT);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿ä¸ªSQLè¯­å¥ä¸­çå­è¿æ¥å°±ä¸ä¼æåäºï¼å ä¸ºæä»¬æsnoæ¢æäºå¸¸éï¼ç¶å­ä¹é´çç¸å³æ§è¢«æç ´äºï¼æç½äºåï¼â</p>\n<p>å°æç¹ç¹å¤´ï¼å¿éæ³ï¼å­è¿æ¥æ¯å¦æååå³äºç¸å³æ§ï¼èè¿ä¸ªç¸å³æ§ä¸åªæ¯ä½ç°å¨å­å¥éï¼ä¹ä½ç°å¨è¡¨è¾¾å¼éï¼ä¹å°±æ¯è¯´åªè¦è½äº§çåµå¥å¾ªç¯ï¼é£å°±ææåçå¿è¦åï¼ä½æ¯ãããå°æçµæºä¸å¨ï¼é®éï¼âé£ANYç±»åçç¸å³å­è¿æ¥ä¹ä¼äº§çåµå¥å¾ªç¯åï¼ä¸ºä»ä¹ä¸æåå¢ï¼â</p>\n<p>å¤§æè¯´ï¼âè¿å¯è½æç¹åå²åå äºï¼PostgreSQLæåANYç±»åçå­è¿æ¥çæ¹å¼åEXISTSç±»åçå­è¿æ¥çæ¹å¼ä¸åï¼ä»æåEXISTSç±»åçå­è¿æ¥çæ¶åï¼æ¯ç´æ¥æå­å¥ä¸­çè¡¨æä¸æ¥åå½¢æä¸ä¸ªSemiJoinï¼å¯æ¯æåANYç±»åçå­è¿æ¥çæ¶åï¼æ¯ææ´ä¸ªå­å¥æä¸æ¥ï¼åç¶è¯­å¥ä¸­çè¡¨åSemiJoinï¼è¿æ¶åè¿ä¸ªå­å¥å°±åæäºä¸ä¸ªå­æ¥è¯¢ï¼ä½ çè¿ä¸ªä¾å­ãâè¯´çå¤§æåªåªåªçå¨çµèä¸æ²äº3ä¸ªè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. SELECT * FROM TEST_A WHERE a &gt; ANY (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b)ï¼</span><br><span class=\"line\">2. SELECT * FROM TEST_A, (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b) b WHERE TEST_A.a &gt; b.a;</span><br><span class=\"line\">3. SELECT * FROM TEST_A, LATERAL (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b) b WHERE TEST_A.a &gt; b.a;</span><br></pre></td></tr></table></figure>\n\n<p>âå¦ææç§ç®åANYç±»åå­è¿æ¥åæåæå­æ¥è¯¢çæ¹å¼ï¼ç¬¬1ä¸ªè¯­å¥æåä¹åä¼åæç­ä»·äºç¬¬2ä¸ªè¯­å¥ï¼èç¬¬2ä¸ªè¯­å¥æ¬èº«æ¯æ æ³æ§è¡çï¼å¨æ¯è¾æ°ççæ¬çPostgreSQLä¸æ¯æäºLATERALä¹åï¼åªè¦å¨ç¬¬2ä¸ªè¯­å¥ä¸å ä¸LATERALï¼ä¹å°±æ¯åæç¬¬3ä¸ªè¯­å¥å°±è½æ§è¡äºãâå¤§æå¨å±å¹ä¸æ¯åçè¯´ã</p>\n<p>å°æé®éï¼âé£å²ä¸æ¯è¯´ï¼æäºLATERALä¹åï¼ANYç±»åçç¸å³å­è¿æ¥ä¹è½æåäºï¼â</p>\n<p>å¤§æè¯´ï¼âåªè½è¯´æä¸é¨åANYç±»åçç¸å³å­è¿æ¥è½å¤æåäºï¼æ¯å¦æä»¬ä¸é¢çä¾1æ¬è´¨ä¸å°±æ¯è½æåçï¼èä¸ä¸äºåä¸æ°æ®åºç¡®å®ä¹å¯¹è¿ç§è¯­å¥åäºæåï¼ä½æ¯PostgreSQLæ°æ®åºç®åè¿æ²¡æå¤çè¿ç§æåµãâ</p>\n<p>å°ææäºä¸ªåæ¬ è¯´ï¼âå®å¨æ¯å¤ªç´¯äºï¼è®©æä»¬ä¼æ¯ä¸ä¸å§ï¼æ¥è¯¢ä¼åå¨å¤ªå¤æäºãâ</p>\n<p>å¤§æç¬çè¯´ï¼âåæä¸æå°±è½æåï¼ä¸ä¸æ¢¦æ³å®ç°äºå¢?å­è¿æ¥æåä¹åï¼è¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ï¼ä¸è¿ï¼å¨è¿ä¹åè¿æ¯è®©æä»¬ååä¸ªé¸¡åè¯´å§ãâ</p>\n","site":{"data":{}},"excerpt":"<p>å°æåç°å°å¤§æå®¶éé®é®é¢ä¸ä½è½æ¶è·ç¥è¯ï¼è¿è½æ¶è·å¤§è°å­åçº¢éï¼äºæ¯æ´å åå®äºå¸¸æ¥é®é®é¢çå³å¿ã</p>\n<p>å°æåå¤§æåå®äºåé¥­ï¼æå¼çµè§çä¸ä¼çµè§å§ï¼å¤§æåæ¬æçæ¬æçæ½èµ·äºä¸­åçï¼å°æé»çäºæçæç¹å¿ç¦ï¼å°±é®å¤§æï¼âå¥ï¼ä½ æ´å¤©æ½æ½æ½ï¼æé£ä¹å¥½æ½åï¼âå¤§æèªè±ªçè¯´ï¼âåå°ï¼å±ç·ç·æ½çï¼å±ç¸ç¸ä¹æ½çï¼å°æè¿ä¸è½æ­äºé¦ç«ï¼ä½ ä¸æ½çæ¯ä¸å­ç¥éä¸ï¼â</p>","more":"<p></p>\n<p>å°æè¯´ï¼âå±ç·ç·æ½çæ¯å¨åæç§ççå¶ï¼èªç»èªè¶³ï¼è¿çé±ï¼ä½ ä¹å¹²èååæç§çå¶ï¼ä½ è¿ä¸­åçååæçèªå·±å·ççå¶ï¼è½æä»ä¹åºå«ï¼â</p>\n<p>å¤§æççµè§å§æ­£çå¾èµ·å²ï¼å¿ä¸å¨ççè¯´ï¼âèªå·±ç§ççå¶ç´æ¥ç¨æ¥çº¸å·äºæ½ï¼æ²¡æè¿æ»¤å´ï¼ä¼å¸å¥æå®³é¢ç²ç©ï¼èä¸çå¶çå³éä¹ä¸å¦ç°å¨æ¹è¿çé¦çãâè¯´å°è¿éå¤§æå¥½åæ³å°äºäºä»ä¹ï¼ç»§ç»­è¯´ï¼âè¿å°±åæ¯æ¥è¯¢ä¼åå¨çé»è¾ä¼åï¼æ¥è¯¢æ è¾å¥ä¹åï¼éè¦è¿è¡æç»­çæ¹è¿ï¼æ è®ºæ¯èªå·±ç¨æ¥çº¸å·ççï¼è¿æ¯å¨è¶å¸ä¹°çæåçï¼å®é½æ¯é¦çï¼ä½æ¯éè¿æ¹è¿ä¹åï¼é¦ççæ¯å®³ä½ç¨æ´ä½ãé¦åæ´ä¸°å¯äºï¼é»è¾ä¼åä¹æ¯è¿ä¸ªéçï¼éè¿æ¹è¿æ¥è¯¢æ ï¼è½å¤å¾å°ä¸ä¸ªæ´âå¥½âçæ¥è¯¢æ ãâ</p>\n<p>âå¦ï¼é£é»è¾ä¼åæ¯å¦ä½å¨å·²æçæ¥è¯¢æ ä¸å¢å é¦åçå¢ï¼â</p>\n<p>å¤§ææè§çµè§å§æ²¡åæ³çä¸å»äºï¼äºæ¯æ¿èµ·é¥æ§å¨å³äºçµè§ï¼ç»§ç»­è¯´ï¼âææ»ç»ï¼PostgreSQLå¨é»è¾ä¼åé¶æ®µæè¿ä¹å ä¸ªéè¦çä¼åï¼å­æ¥è¯¢&amp;å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ãè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çãâå¤§æåæ½äºä¸å£çï¼æ¥çè¯´å°ï¼âä»ä»£ç é»è¾ä¸æ¥çï¼æä»¬è¿å¯ä»¥æå­æ¥è¯¢&amp;å­è¿æ¥æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤å«åé»è¾éåä¼åï¼å ä¸ºä»ä»¬ä¸»è¦æ¯å¯¹æ¥è¯¢æ è¿è¡æ¹é ï¼èåé¢çè°è¯ä¸æ¨ãè¿æ¥é¡ºåºäº¤æ¢ãç­ä»·ç±»æ¨çåå¯ä»¥ç§°ä¹ä¸ºé»è¾åè§£ä¼åï¼ä»ä»¬å·²ç»ææ¥è¯¢æ è¹èºçä¸ææ ·å­äºï¼å·²ç»å°äºçé¦çä¸æ¯é¦ççå°æ­¥äºãâ</p>\n<p>âå¯æ¯æä»¬çæ°æ®åºåçè¯¾ä¸å¹¶æ²¡æè¯´æé»è¾éåä¼ååé»è¾åè§£ä¼ååï¼â</p>\n<p>âå¯ï¼æ¯çï¼è¿æ¯æèªå·±æ ¹æ®PostgreSQLçæºä»£ç çç¹å¾èªå·±æ»ç»çï¼ä¸è¿å®è½æ¯è¾å½¢è±¡çå°ç°æçé»è¾ä¼ååºåå¼æ¥ï¼è¿æ ·å°±è½æ´å¥½çå¯¹é»è¾ä¼åè¿è¡æç¼ãæ»ç»ãåæãâå¤§ææ³äºä¸ä¸è§å¾å¦ææææçé»è¾ä¼åçè§åé½è¯´å®æç¹å¤ï¼å³å®éæ©å¶ä¸­çä¸ä¸¤ä¸ªè¯´ä¸ä¸ï¼äºæ¯å¯¹å°æè¯´éï¼âæä»¬å°±ä»ä¸­æéä¸ä¸¤ä¸ªè¯¦ç»çè¯´æä¸ä¸å§ï¼æä»¬åä»å­æ¥è¯¢&amp;å­è¿æ¥çæåå¼å§è¯´èµ·ãâ</p>\n<p>âé£ãããå­æ¥è¯¢åå­è¿æ¥æä»ä¹åºå«å¢ï¼æä»¬å¨æ°æ®åºåçè¯¾éåªè®²äºå­æ¥è¯¢ï¼æ²¡æå­è¿æ¥çæ¦å¿µï¼è¿è¯¥æä¹è§£éå¢ï¼âå°æä¸è§£çé®ã</p>\n<p>å¤§æå»ä¹¦æéæ¿åºäºãæ°æ®åºç³»ç»å®ç°ãè¿æ¬ä¹¦ï¼ç¶åç¿»å¼äºå¯¹åºçç« èï¼è¯´éï¼âéå¸¸æ°æ®åºåçä¹¦ç±ä¸­è¯´çå­æ¥è¯¢ï¼æçæ¯PostgreSQLæ°æ®åºä¸­çå­è¿æ¥ãä½ çï¼ãæ°æ®åºç³»ç»å®ç°ãä¸­è¯´çæ¯ä»æ¡ä»¶ä¸­å»é¤å­æ¥è¯¢ï¼ä½æ¯PostgreSQLæè¿ç§æåµå½ç±»ä¸ºå­è¿æ¥ãâ</p>\n<p>âé£å¨PostgreSQLæ¯å¦ä½åºåå­æ¥è¯¢åå­è¿æ¥çå¢ï¼âå¤§æèªé®èªç­éï¼âå¨å®éåºç¨ä¸­å¯ä»¥éè¿å­å¥æå¤çä½ç½®æ¥åºåå­è¿æ¥åå­æ¥è¯¢ï¼åºç°å¨FROMå³é®å­åçå­å¥æ¯å­æ¥è¯¢è¯­å¥ï¼åºç°å¨WHERE/ONç­çº¦ææ¡ä»¶ä¸­ææå½±ä¸­çå­å¥æ¯å­è¿æ¥è¯­å¥ãâè¯´çå¤§æå¿«éçå¨çµèä¸æå¼äºè®°äºæ¬ï¼æ²å¥äºå ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. SELECT * FROM STUDENT, (SELECT * FROM SCORE) as sc;</span><br><span class=\"line\">2. SELECT (SELECT AVG(degree) FROM SCORE), sname FROM STUDENT;</span><br><span class=\"line\">3. SELECT * FROM STUDENT WHERE EXISTS (SELECT A FROM SCORE WHERE SCORE.sno &#x3D; STUDENT.sno);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿äºSQLè¯­å¥ä¸­åªä¸ªæ¯å­æ¥è¯¢ï¼åªä¸ªæ¯å­è¿æ¥ï¼â</p>\n<p>å°æçäºä¸ä¸ï¼ç¶åè¯´ï¼â1æ¯å­æ¥è¯¢ï¼2å3æ¯å­è¿æ¥ï¼è¯­å¥1éé¢çå­å¥åºç°å¨FROMåé¢ï¼å®æ¯ä»¥âè¡¨âçå½¢å¼å­å¨çï¼æ¯å­æ¥è¯¢ï¼2å3çå­å¥åºç°å¨æå½±åçº¦ææ¡ä»¶ä¸­ï¼æ¯ä»¥è¡¨è¾¾å¼çå½¢å¼å­å¨çï¼æ¯å­è¿æ¥ãâå°æä¸ä½ç­å¯¹äºé®é¢ï¼èä¸è¿å¯¹é®é¢çç­æ¡åäºæ©å±ï¼å¤§ææå°å¾ä¸é¢èµèï¼äºæ¯è°ä¾éï¼âè°é´çåå­¦ï¼ä½ åä¸ï¼ä½ å¤ªçªåºäºãâ</p>\n<p>ç¶åå¤§ææ­£ä¸æ­£é¢è²ï¼ç»§ç»­è¯´éâä»å¤§çæ¹åä¸åç±»ï¼å­æ¥è¯¢è¿å¯ä»¥åä¸ºç¸å³å­è¿æ¥åéç¸å³å­è¿æ¥ï¼ç¸å³å­è¿æ¥æ¯æå¨å­æ¥è¯¢è¯­å¥ä¸­å¼ç¨äºå¤å±è¡¨çåå±æ§ï¼è¿å°±å¯¼è´å¤å±è¡¨æ¯è·å¾ä¸ä¸ªåç»ï¼å­æ¥è¯¢å°±éè¦éæ°æ§è¡ä¸æ¬¡ï¼èéç¸å³å­æ¥è¯¢æ¯æå¨å­æ¥è¯¢è¯­å¥æ¯ç¬ç«çï¼åå¤å±çè¡¨æ²¡æç´æ¥çå³èï¼å­æ¥è¯¢å¯ä»¥åç¬æ§è¡ä¸æ¬¡ï¼å¤å±è¡¨å¯ä»¥éå¤å©ç¨å­æ¥è¯¢çæ§è¡ç»æãâ</p>\n<p>âé£ä¹ä¸å®æ¯ç¸å³å­è¿æ¥æä¼æåäºï¼å ä¸ºæè®°å¾ä½ å¨è¯´é»è¾ä¼ååççæ¶åè¯´è¿ï¼ç¸å³å­è¿æ¥ä¼äº§çâåµå¥å¾ªç¯âï¼è¿ç§æåµçå¤æåº¦æ¯O(N^2)ï¼æåä¸æ¥çå¤æåº¦è¯å®ä¸ä¼æ¯O(N^2)å·®ï¼æä»¥æåæ¯æä»·å¼çãâå°æé®å°ã</p>\n<p>å¬å°è¿äºï¼å¤§æé¡¿æ¶ç¢å ¡äºï¼éçè½ç¶æ¯è¿ä¸ªéçï¼ä½æ¯PostgreSQLååä¸èµ°å¯»å¸¸è·¯ï¼åèªå·±ä¹åè¯´è¿çæäºè®¸å·®å¼ï¼å¤§æç¾æ¶©çè¯´ï¼âè½ç¶è¯æ¯è¿æ ·è¯´ï¼ä½PostgreSQLæç¹ä¸åï¼PostgreSQLæåäºä¸¤ç§ç±»åçå­è¿æ¥ï¼ä¸ç§æ¯ANYç±»åçå­è¿æ¥ï¼ä¸ç§æ¯EXISTSç±»åçå­è¿æ¥ï¼å¯¹äºANYç±»åçå­è¿æ¥ï¼åªæåéç¸å³å­è¿æ¥ï¼èå¯¹äºEXISTSç±»åçå­è¿æ¥ï¼ååªæåç¸å³å­è¿æ¥ãâ</p>\n<p>å°æé¡¿æ¶æ³èµ·äºèªå·±æ¾ååå­¦è¯´è¿ç¸å³å­è¿æ¥çè®ºï¼å½æ¶æå®¿èåå­¦å¿½æ çäºè¿·ä¸éçï¼ä»å¤©å¤§æåè¯´è¿å¯è½æ¯éçï¼å¿éä¸å¤ªç½å©ï¼äºæ¯æéï¼âä½ ä¹åææçé½æéè¯¯ï¼é£æååå­¦å¹è¿ççå²ä¸æ¯è¦æä¸ºç¬æï¼ææè§æåå°äºä¸ä¸ç¹ä¸æµ·ãâ</p>\n<p>âå°æåå­¦ä¸è¦æ¥âï¼å¤§æå®æéï¼âè½ç¶PostgreSQLå¯¹äºANYç±»ååªæåéç¸å³çå­è¿æ¥ï¼ä½å®ä»ç¶æ¯åªæåäº§çåµå¥å¾ªç¯çé£ç§å­è¿æ¥ï¼ä½ ççè¿ä¸ªä¾å­ãâè¯´çå¤§æå¨çµèä¸åæ²äºä¸ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT WHERE sno &gt; ANY (SELECT sno from STUDENT);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿æ¯ä¸ä¸ªANYç±»åçéç¸å³å­è¿æ¥ï¼ä½æ¯è¯·æ³¨æï¼å¨&gt;åé¢çsnoå®éä¸äº§çäºä¸ä¸ªå¤©ç¶çç¸å³æ§ï¼è¿ä¸ªå¤©ç¶çç¸å³æ§å°±ä¼äº§çåµå¥å¾ªç¯ï¼å æ­¤æ¯éè¦æåçãæä»¬åæ¥çå¦ä¸ä¸ªè¯­å¥ãâå¤§ææè¯­å¥ä¸­&gt;åé¢çsnoæ¢æäºä¸ä¸ªå¸¸éï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT WHERE 10 &gt; ANY (SELECT sno from STUDENT);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿ä¸ªSQLè¯­å¥ä¸­çå­è¿æ¥å°±ä¸ä¼æåäºï¼å ä¸ºæä»¬æsnoæ¢æäºå¸¸éï¼ç¶å­ä¹é´çç¸å³æ§è¢«æç ´äºï¼æç½äºåï¼â</p>\n<p>å°æç¹ç¹å¤´ï¼å¿éæ³ï¼å­è¿æ¥æ¯å¦æååå³äºç¸å³æ§ï¼èè¿ä¸ªç¸å³æ§ä¸åªæ¯ä½ç°å¨å­å¥éï¼ä¹ä½ç°å¨è¡¨è¾¾å¼éï¼ä¹å°±æ¯è¯´åªè¦è½äº§çåµå¥å¾ªç¯ï¼é£å°±ææåçå¿è¦åï¼ä½æ¯ãããå°æçµæºä¸å¨ï¼é®éï¼âé£ANYç±»åçç¸å³å­è¿æ¥ä¹ä¼äº§çåµå¥å¾ªç¯åï¼ä¸ºä»ä¹ä¸æåå¢ï¼â</p>\n<p>å¤§æè¯´ï¼âè¿å¯è½æç¹åå²åå äºï¼PostgreSQLæåANYç±»åçå­è¿æ¥çæ¹å¼åEXISTSç±»åçå­è¿æ¥çæ¹å¼ä¸åï¼ä»æåEXISTSç±»åçå­è¿æ¥çæ¶åï¼æ¯ç´æ¥æå­å¥ä¸­çè¡¨æä¸æ¥åå½¢æä¸ä¸ªSemiJoinï¼å¯æ¯æåANYç±»åçå­è¿æ¥çæ¶åï¼æ¯ææ´ä¸ªå­å¥æä¸æ¥ï¼åç¶è¯­å¥ä¸­çè¡¨åSemiJoinï¼è¿æ¶åè¿ä¸ªå­å¥å°±åæäºä¸ä¸ªå­æ¥è¯¢ï¼ä½ çè¿ä¸ªä¾å­ãâè¯´çå¤§æåªåªåªçå¨çµèä¸æ²äº3ä¸ªè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. SELECT * FROM TEST_A WHERE a &gt; ANY (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b)ï¼</span><br><span class=\"line\">2. SELECT * FROM TEST_A, (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b) b WHERE TEST_A.a &gt; b.a;</span><br><span class=\"line\">3. SELECT * FROM TEST_A, LATERAL (SELECT a FROM TEST_B WHERE TEST_A.b &#x3D; TEST_B.b) b WHERE TEST_A.a &gt; b.a;</span><br></pre></td></tr></table></figure>\n\n<p>âå¦ææç§ç®åANYç±»åå­è¿æ¥åæåæå­æ¥è¯¢çæ¹å¼ï¼ç¬¬1ä¸ªè¯­å¥æåä¹åä¼åæç­ä»·äºç¬¬2ä¸ªè¯­å¥ï¼èç¬¬2ä¸ªè¯­å¥æ¬èº«æ¯æ æ³æ§è¡çï¼å¨æ¯è¾æ°ççæ¬çPostgreSQLä¸æ¯æäºLATERALä¹åï¼åªè¦å¨ç¬¬2ä¸ªè¯­å¥ä¸å ä¸LATERALï¼ä¹å°±æ¯åæç¬¬3ä¸ªè¯­å¥å°±è½æ§è¡äºãâå¤§æå¨å±å¹ä¸æ¯åçè¯´ã</p>\n<p>å°æé®éï¼âé£å²ä¸æ¯è¯´ï¼æäºLATERALä¹åï¼ANYç±»åçç¸å³å­è¿æ¥ä¹è½æåäºï¼â</p>\n<p>å¤§æè¯´ï¼âåªè½è¯´æä¸é¨åANYç±»åçç¸å³å­è¿æ¥è½å¤æåäºï¼æ¯å¦æä»¬ä¸é¢çä¾1æ¬è´¨ä¸å°±æ¯è½æåçï¼èä¸ä¸äºåä¸æ°æ®åºç¡®å®ä¹å¯¹è¿ç§è¯­å¥åäºæåï¼ä½æ¯PostgreSQLæ°æ®åºç®åè¿æ²¡æå¤çè¿ç§æåµãâ</p>\n<p>å°ææäºä¸ªåæ¬ è¯´ï¼âå®å¨æ¯å¤ªç´¯äºï¼è®©æä»¬ä¼æ¯ä¸ä¸å§ï¼æ¥è¯¢ä¼åå¨å¤ªå¤æäºãâ</p>\n<p>å¤§æç¬çè¯´ï¼âåæä¸æå°±è½æåï¼ä¸ä¸æ¢¦æ³å®ç°äºå¢?å­è¿æ¥æåä¹åï¼è¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤ï¼ä¸è¿ï¼å¨è¿ä¹åè¿æ¯è®©æä»¬ååä¸ªé¸¡åè¯´å§ãâ</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(4) - ä¸æ¨ï¼ä¸æ¨ï¼","date":"2020-08-04T23:06:30.000Z","_content":"\nå°æå¨å¤§æå®¶çä¹¦æ¿éæå¥½äºçº¸ç ï¼å¨ä¸ä»½è¿æçæ¥çº¸ä¸æ¥æ¯«æ³¼å¢¨ï¼âç²¾æ¨ç»æ²ææéï¼éå³æ¼«éä¸¤è«è«ï¼å¤åæç¯è¯»è¯éï¼è«è°èä¸²ä¸ç¤é¦ãâå¤§æçäºä¹åç¬éï¼âå¥½è¯å¥½è¯ï¼æ¥ï¼è®©æä»¬ç»§ç»­å¤åæç¯è¯»ä¼åï¼è«ä¸æ¯æ·¡è¯è¡·è ãâ\n\nå°æè¯´ï¼âåæ­ä¼å§ï¼æè§å¾è¦æ·±åº¦äºè§£æ¥è¯¢ä¼åæ²¡å¸æäºãâå¤§æçåºäºå°æå¯¹æ¥è¯¢ä¼åäº§çäºä¸ç¹çé¾æç»ªï¼å ä¸ºå°ææ¬æ¥ä»¥ä¸ºéè¿å¤§æçè®²è§£è½å¤å¿«éççè§£æ¥è¯¢ä¼åçæ¬è´¨ï¼ä½æ¯ä»éè¿å æ¬¡å¬åå¤§æçè®²è§£ä¹ååç°ï¼æ¥è¯¢ä¼åå¨è¿ä¸æ¯å æ¬¡è®²è§£å°±è½è§£å³çï¼å¤§æç®åç»ä»è®²è§£çè¿åªæ¯å¨åºç¨å±é¢çè®²è§£ï¼è¿æ²¡ææ·±å¥å°åææºç é¶æ®µï¼ä»ä»å¦æ­¤ï¼å¯¹å°ææ¥è¯´çè§£ä¸å°±å·²ç»æäºå°é¾äºï¼çæ¥è¦æ³æ·±åº¦çäºè§£æ¥è¯¢ä¼åå¨ï¼è¿éè¦ä¸æ´å¤§çåå¤«æè¡ã<!-- more -->\n\t\nå¤§æè¯´ï¼âå¥å«æåï¼æåå°±æ¯å¨ä½ åæä¸ä¸å»çæ¶åååæä¸ä¸ï¼æ¥å§ï¼Letâsç»§ç»­ãâè¯´çæçå°ææ¥å°å®¢åï¼ç»§ç»­æå¼äºçµèï¼âæä»¬ç»§ç»­è¯´ç¹å¥å¢ï¼ä¸æ¬¡è¯´å°äºå­è¿æ¥ï¼è¿æ¬¡æä»¬ç®åè¯´è¯´éæ©ä¸æ¨åç­ä»·ç±»å§ãâ\n\nå°ææ³äºæ³è¯´ï¼âéæ©ä¸æ¨åç­ä»·ç±»æ¯é»è¾åè§£ä¼åä¸­çåå®¹äºï¼å¯æ¯é»è¾éåä¼åéè¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤è¿äºå¤§åå¤´ä½ è¿æ²¡æç»æè®²è§£è¿åãâ\n\nå¤§æè¯´ï¼âè¿äºåçç»ä½ èªå·±å»çè§£ï¼å¦æçè§£ä¸äºåæ¥æ¾æå§ãé»è¾ä¼åçè§åå®éä¸è¿æ¯æ¯è¾å¤çï¼ä½æ¯æ¯å¯ä»¥éä¸ªå»ç ´çï¼ä¹å°±æ¯ä»ä»¬ä¹é´éå¸¸èè¨å¹¶æ²¡æå¤å¤§çå³èï¼æä»¬ä¸æç®å¨è¿ä¸é¢çº ç¼ å¤ªå¤æ¶é´ï¼æç¸ä¿¡ä»¥ä½ èªå·±çè½åæä»ä»¬æå®æ¯æ²¡æé®é¢çãâ\n\nâå¦ï¼æè§å¾æ¯ä½ ææå¨ä½ å®¶åå¤ªé¿æ¶é´ï¼æä½ åç©·å§ï¼âå°æå·ç¬çé®ã\n\nâæ¯çï¼åå¤§å°å­åæ­»èå­ï¼ä½ è¿é¥­æ¡¶å¤ªè½åäºï¼åé¥­çéåº¦æ¯éæ©ä¸æ¨çéåº¦è¿è¦å¿«ï¼åé¥­é½è¢«ä½ åäºï¼æä»å¤©ä¸­åé½æ²¡åé¥±åãâ\n\nâæè®°å¾ä½ è¯´è¿ï¼éæ©ä¸æ¨æ¯ä¸ºäºå°½æ©çè¿æ»¤æ°æ®ï¼è¿æ ·å°±è½å¨ä¸å±ç»ç¹éä½è®¡ç®éï¼æ¯å§ï¼â\n\nâæ¯çãâå¤§æç¹äºç¹å¤´ï¼âè¿æ¯éè¿ä¸ä¸ªå³ç³»ä»£æ°çç¤ºä¾æ¥è¯´æä¸ä¸å®å§ï¼é¡ºä¾¿æä»¬æç­ä»·ç±»æ¨çä¹å¯ä»¥è¯´ä¸è¯´ï¼æ¯å¦è¯´æä»¬æ³è¦è·å¾ç¼å·ä¸º5çèå¸æ¿æçææçè¯¾ç¨åå­ï¼æä»¬å¯ä»¥ç»åºå®çå³ç³»ä»£æ°è¡¨è¾¾å¼ãâè¯´çå¤§æå¨çµèä¸æ²äºä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=5â§TEACHER.tno=COURSE.tno (TEACHERÃCOURSE))\n```\n\nâå°æï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼æä¹ä¸æ¨éæ©æä½ï¼â\n\nå°æççå³ç³»ä»£æ°è¡¨è¾¾å¼æèäºä¸ä¼ï¼è¯´ï¼âæçè¿ä¸ªTEACHER.tno = 5æ¯è¾å¯çï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ååäºTEACHERÃCOURSEï¼ä¹å°±æ¯ååäºå¡æ°ç§¯ï¼æè¦æ¯æTEACHER.tno = 5æ¾å°TEACHERä¸åæä¸äºæ°æ®è¿æ»¤æï¼å²ä¸æ¯ãããå®ç¾ï¼âè¯´çå°æä¹å¨çµèä¸æ²åºäºæTEACHER.tno = 5ä¸æ¨ä¹åçå³ç³»ä»£æ°è¡¨è¾¾å¼ã\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)ÃCOURSE))\n```\n\nå¤§æè¯´ï¼âå¯¹çï¼ä½ è¿æ ·ä¸æ¨ä¸æ¥ï¼çç¡®è½éä½è®¡ç®éï¼ä½ è¿åºç¨çæ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­çåéçÏF(A Ã B) == ÏF1(A) Ã ÏF2(B)ï¼é£ä½ ççï¼æ¢ç¶ä¸æ¨è¿ä¹å¥½ï¼æ¯ä¸æ¯æå½±ä¹è½ä¸æ¨ï¼âå°æçäºä¸ä¸ï¼å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­å¼éè¦å¯¹cnameè¿è¡æå½±ï¼é¡¿æ¶æ³å°äºï¼COURSEè¡¨è½ç¶æå¾å¤ä¸ªåï¼ä½æ¯æä»¬åªéè¦ä½¿ç¨cnameå°±å¤äºåï¼äºæ¯å°æå¨çµèä¸æ²äºæå½±ä¸æ¨çå³ç³»ä»£æ°è¡¨è¾¾å¼ã\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)Ã Î cname(COURSE)))\n```\n\nå¤§ææäºå°æçå¤´ä¸ä¸è¯´ï¼âç¬¨èï¼ä½ è¿æ ·ä¸æ¨æå½±ï¼TEACHER.tno=COURSE.tnoè¿æåæ³ååï¼âå°æé¡¿æ¶é¢æäºï¼å¦æåªå¨COURSEä¸å¯¹cnameåæå½±æ¶ä¸è¡çï¼ä¸å±ç»ç¹ææçè¡¨è¾¾å¼é½éè¦èèå°ï¼äºæ¯ä¿®æ¹äºè¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)Ã Î cname, tno(COURSE)))\n```\n\nâè¿è¿å·®ä¸å¤ãâå¤§æç¬çè¯´ï¼âè¿æ¯ä½¿ç¨çæå½±çä¸²æ¥çï¼ä¹æ¯ä¸ä¸ªéå¸¸éè¦çå³ç³»ä»£æ°ç­ä»·è§åï¼ç®åæä»¬å¯¹è¿ä¸ªè¡¨è¾¾å¼çä¼åä¸»è¦æ¯ä½¿ç¨äºéæ©ä¸æ¨ï¼åæå½±ä¸æ¨ï¼å¦æç¨SQLè¯­å¥æ¥è¡¨ç¤ºï¼å°±åè¿æ ·ãâå¤§æå¨çµèçè®°äºæ¬ä¸å¿«éçæå°åºäºä¸¤ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM TEACHER t, COURSE c WHERE t.tno = 5 AND t.tno = c.tno;\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE) cc WHERE tt.tno = cc.tno;\n```\n\nâä½ çè¿ä¸¤ä¸ªè¯­å¥ï¼å°±æ¯è°è¯ä¸æ¨åæå½±ä¸æ¨ååçå¯¹ç§è¯­å¥ãå¨åå¡æ°ç§¯ä¹åï¼ååäºè¿æ»¤ï¼è¿æ ·ç¬å¡å°ç§¯çè®¡ç®éä¼åå°ãâ\nå°æä»ç»çè§å¯çä»£æ°è¡¨è¾¾å¼åè¿ä¸¤ä¸ªSQLè¯­å¥ï¼ä»åç°ä¸ä¸ªé®é¢ï¼å°±æ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­æTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼è¿æ¯ä¸æ¯æå³çCOURSE.tnoä¹åºè¯¥ç­äº5å¢ï¼å°æç¶åè¯çå¨çµèä¸åäºä¸ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE WHERE tno=5) cc WHERE tt.tno = cc.tno;\n```\n\nç¶åå°æè¯´ï¼âä½ çï¼ç±äºæTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼æä»¬å¯ä»¥æ¯ä¸æ¯å¯ä»¥æ¨çåºä¸ä¸ªæ°çCOURSE.tno = 5çæ°ççº¦ææ¡ä»¶æ¥å¢ï¼è¿æ ·æä»¬è¿å¯ä»¥æè¿ä¸ªæ¡ä»¶ä¸æ¨å°COURSEè¡¨ä¸ï¼è¿æ ·ä¹è½éä½ç¬å¡å°ç§¯çè®¡ç®éãâ\n\nå¤§æè¯´ï¼âæ¯çï¼è¿å°±æ¯ç­ä»·æ¨çï¼PostgreSQLæ°æ®åºå¨æ¥è¯¢ä¼åçè¿ç¨ä¸­ï¼ä¼å°çº¦ææ¡ä»¶ä¸­ç­ä»·çé¨åé½è®°å½å°ç­ä»·ç±»ä¸­ï¼è¿æ ·å°±è½æ ¹æ®ç­ä»·ç±»çææ°ççº¦ææ¡ä»¶åºæ¥ï¼æ¯å¦ç¤ºä¾çè¯­å¥ä¸­å°±ä¼äº§çä¸ä¸ªç­ä»·ç±»{TEACHER.tno, COURSE.tno, 5}ï¼è¿æ¯ä¸ä¸ªå«æå¸¸éçç­ä»·ç±»ï¼æ¯æ¥è¯¢ä¼åå¨æ¯è¾åæ¬¢çç­ä»·ç±»ï¼è¿ç§ç­ä»·ç±»å¯ä»¥å¾å°åå±æ§åå¸¸éç»åæççº¦ææ¡ä»¶ï¼éå¸¸é½æ¯è½ä¸æ¨çãâ\n\nå°æå¿éå¾é«å´ï¼èªå·±éè¿ä»ç»è§å¯ï¼å¾å°äºç­ä»·ç±»çä¼åï¼æè§èªå·±æäºå­¦ä¹ çå¨åï¼å¿éç¾æ»æ»çï¼ç¶åå°±é®å¤§æï¼âé£ä¸é¢çSQLè¯­å¥è¿æä»ä¹å¯ä¼åçåï¼â\n\nå¤§æè§å¯äºä¸ä¸è¿ä¸ªè¯­å¥ï¼ç¶åè¯´ï¼âä½ çï¼æä»¬å·²ç»å¨TEACHERè¡¨ä¸è¿è¡äºTEACHER.tno = 5çè¿æ»¤ï¼å¨COURSEè¡¨ä¸ä¹åäºCOURSE.tno = 5çè¿æ»¤ï¼è¿æ ·å°±è¯´æå¨åç¬å¡å°ç§¯çæ¶åï¼å®éä¸å·²ç»ç¡®å®äºTEACHER.tno = COURSE.tno = 5ï¼ä¹å°±æ¯è¯´TEACHER.tno = COURSE.tnoè¿ä¸ªçº¦ææ¡ä»¶å·²ç»éå«æç«äºï¼ä¹å°±æ²¡ä»ä¹ç¨äºï¼æä»¬å¯ä»¥æå®å»æï¼æç»å½¢æä¸ä¸ªè¿æ ·çSQLè¯­å¥ãâå¤§æå¨è®°äºæ¬ä¸­æ²ä¸äºæç»çè¯­å¥ï¼\n\n```\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE WHERE tno=5) ccï¼\n```\n\nåæ¶ä¹æ²åºäºè¿ä¸ªè¯­å¥å¯¹åºçå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=5(TEACHER)Ã Î cname, tno(ÏCOURSE.tno=5(COURSE)))\n```\n\nç¶åå¤§æè¯´ï¼âç»è¿éæ©ä¸æ¨ãæå½±ä¸æ¨åç­ä»·ç±»æ¨çï¼æä»¬å¯¹è¿ä¸ªSQLè¯­å¥æèè¯´å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡äºä¼åï¼æç»éä½äºè®¡ç®éãâ\n \n![](./postgresql-optimizer-outline-4/1.png) \n\n![](./postgresql-optimizer-outline-4/1.png) \n \n\nå°ææè§å¯¹è°è¯ä¸æ¨å·²ç»çè§£äºï¼ç¶åè¯´ï¼âçä¸å»ä¹ä¸å¤æåï¼æåç°äºå¯ä»¥ä¸æ¨çéæ©æå°±ä¸æ¨ï¼å®å¨æ²¡æé®é¢åãâå¤§æç¬çè¯´ï¼âçç£ï¼æä»æªè§è¿å¦æ­¤åé¢æ è»ä¹äººï¼æä»¬ç°å¨ççè¿ä¸ªä¾å­ï¼åªä¸è¿æ¯æç®åçä¸ç§æåµåï¼ä½ å°±è¿æ ·å¤§è¨ä¸æ­ï¼ä½ çäººçå­å¸éè¿æç¾è»äºå­åï¼â\n\nå°ææ¤æ¤çè¯´ï¼âæçäººçæ²¡æå­å¸ãããâ\n\nå¤§æé®éï¼âæä»¬è¿ä¸ªä¾å­æä¸ä¸ªé®é¢ï¼å°±æ¯ä»æ¯åè¿æ¥ï¼å æ­¤æä»¬å¯ä»¥èæå¦ä¸ºçå°éæ©ä¸æ¨ä¸æ¥ï¼å¯ä»¥æ²¡ç¾æ²¡èçåç­ä»·ç±»æ¨çï¼ä½æ¯å¦ææ¯å¤è¿æ¥ï¼é£è¿è½è¿ä¹ååï¼â\n\nå°æé¡¿æ¶é·å¥äºè¦è¦çæ²æã\n","source":"_posts/postgresql-optimizer-outline-4.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(4) - ä¸æ¨ï¼ä¸æ¨ï¼\ndate: 2020-08-05 07:06:30\ntags:\n---\n\nå°æå¨å¤§æå®¶çä¹¦æ¿éæå¥½äºçº¸ç ï¼å¨ä¸ä»½è¿æçæ¥çº¸ä¸æ¥æ¯«æ³¼å¢¨ï¼âç²¾æ¨ç»æ²ææéï¼éå³æ¼«éä¸¤è«è«ï¼å¤åæç¯è¯»è¯éï¼è«è°èä¸²ä¸ç¤é¦ãâå¤§æçäºä¹åç¬éï¼âå¥½è¯å¥½è¯ï¼æ¥ï¼è®©æä»¬ç»§ç»­å¤åæç¯è¯»ä¼åï¼è«ä¸æ¯æ·¡è¯è¡·è ãâ\n\nå°æè¯´ï¼âåæ­ä¼å§ï¼æè§å¾è¦æ·±åº¦äºè§£æ¥è¯¢ä¼åæ²¡å¸æäºãâå¤§æçåºäºå°æå¯¹æ¥è¯¢ä¼åäº§çäºä¸ç¹çé¾æç»ªï¼å ä¸ºå°ææ¬æ¥ä»¥ä¸ºéè¿å¤§æçè®²è§£è½å¤å¿«éççè§£æ¥è¯¢ä¼åçæ¬è´¨ï¼ä½æ¯ä»éè¿å æ¬¡å¬åå¤§æçè®²è§£ä¹ååç°ï¼æ¥è¯¢ä¼åå¨è¿ä¸æ¯å æ¬¡è®²è§£å°±è½è§£å³çï¼å¤§æç®åç»ä»è®²è§£çè¿åªæ¯å¨åºç¨å±é¢çè®²è§£ï¼è¿æ²¡ææ·±å¥å°åææºç é¶æ®µï¼ä»ä»å¦æ­¤ï¼å¯¹å°ææ¥è¯´çè§£ä¸å°±å·²ç»æäºå°é¾äºï¼çæ¥è¦æ³æ·±åº¦çäºè§£æ¥è¯¢ä¼åå¨ï¼è¿éè¦ä¸æ´å¤§çåå¤«æè¡ã<!-- more -->\n\t\nå¤§æè¯´ï¼âå¥å«æåï¼æåå°±æ¯å¨ä½ åæä¸ä¸å»çæ¶åååæä¸ä¸ï¼æ¥å§ï¼Letâsç»§ç»­ãâè¯´çæçå°ææ¥å°å®¢åï¼ç»§ç»­æå¼äºçµèï¼âæä»¬ç»§ç»­è¯´ç¹å¥å¢ï¼ä¸æ¬¡è¯´å°äºå­è¿æ¥ï¼è¿æ¬¡æä»¬ç®åè¯´è¯´éæ©ä¸æ¨åç­ä»·ç±»å§ãâ\n\nå°ææ³äºæ³è¯´ï¼âéæ©ä¸æ¨åç­ä»·ç±»æ¯é»è¾åè§£ä¼åä¸­çåå®¹äºï¼å¯æ¯é»è¾éåä¼åéè¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤è¿äºå¤§åå¤´ä½ è¿æ²¡æç»æè®²è§£è¿åãâ\n\nå¤§æè¯´ï¼âè¿äºåçç»ä½ èªå·±å»çè§£ï¼å¦æçè§£ä¸äºåæ¥æ¾æå§ãé»è¾ä¼åçè§åå®éä¸è¿æ¯æ¯è¾å¤çï¼ä½æ¯æ¯å¯ä»¥éä¸ªå»ç ´çï¼ä¹å°±æ¯ä»ä»¬ä¹é´éå¸¸èè¨å¹¶æ²¡æå¤å¤§çå³èï¼æä»¬ä¸æç®å¨è¿ä¸é¢çº ç¼ å¤ªå¤æ¶é´ï¼æç¸ä¿¡ä»¥ä½ èªå·±çè½åæä»ä»¬æå®æ¯æ²¡æé®é¢çãâ\n\nâå¦ï¼æè§å¾æ¯ä½ ææå¨ä½ å®¶åå¤ªé¿æ¶é´ï¼æä½ åç©·å§ï¼âå°æå·ç¬çé®ã\n\nâæ¯çï¼åå¤§å°å­åæ­»èå­ï¼ä½ è¿é¥­æ¡¶å¤ªè½åäºï¼åé¥­çéåº¦æ¯éæ©ä¸æ¨çéåº¦è¿è¦å¿«ï¼åé¥­é½è¢«ä½ åäºï¼æä»å¤©ä¸­åé½æ²¡åé¥±åãâ\n\nâæè®°å¾ä½ è¯´è¿ï¼éæ©ä¸æ¨æ¯ä¸ºäºå°½æ©çè¿æ»¤æ°æ®ï¼è¿æ ·å°±è½å¨ä¸å±ç»ç¹éä½è®¡ç®éï¼æ¯å§ï¼â\n\nâæ¯çãâå¤§æç¹äºç¹å¤´ï¼âè¿æ¯éè¿ä¸ä¸ªå³ç³»ä»£æ°çç¤ºä¾æ¥è¯´æä¸ä¸å®å§ï¼é¡ºä¾¿æä»¬æç­ä»·ç±»æ¨çä¹å¯ä»¥è¯´ä¸è¯´ï¼æ¯å¦è¯´æä»¬æ³è¦è·å¾ç¼å·ä¸º5çèå¸æ¿æçææçè¯¾ç¨åå­ï¼æä»¬å¯ä»¥ç»åºå®çå³ç³»ä»£æ°è¡¨è¾¾å¼ãâè¯´çå¤§æå¨çµèä¸æ²äºä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=5â§TEACHER.tno=COURSE.tno (TEACHERÃCOURSE))\n```\n\nâå°æï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼æä¹ä¸æ¨éæ©æä½ï¼â\n\nå°æççå³ç³»ä»£æ°è¡¨è¾¾å¼æèäºä¸ä¼ï¼è¯´ï¼âæçè¿ä¸ªTEACHER.tno = 5æ¯è¾å¯çï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ååäºTEACHERÃCOURSEï¼ä¹å°±æ¯ååäºå¡æ°ç§¯ï¼æè¦æ¯æTEACHER.tno = 5æ¾å°TEACHERä¸åæä¸äºæ°æ®è¿æ»¤æï¼å²ä¸æ¯ãããå®ç¾ï¼âè¯´çå°æä¹å¨çµèä¸æ²åºäºæTEACHER.tno = 5ä¸æ¨ä¹åçå³ç³»ä»£æ°è¡¨è¾¾å¼ã\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)ÃCOURSE))\n```\n\nå¤§æè¯´ï¼âå¯¹çï¼ä½ è¿æ ·ä¸æ¨ä¸æ¥ï¼çç¡®è½éä½è®¡ç®éï¼ä½ è¿åºç¨çæ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­çåéçÏF(A Ã B) == ÏF1(A) Ã ÏF2(B)ï¼é£ä½ ççï¼æ¢ç¶ä¸æ¨è¿ä¹å¥½ï¼æ¯ä¸æ¯æå½±ä¹è½ä¸æ¨ï¼âå°æçäºä¸ä¸ï¼å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­å¼éè¦å¯¹cnameè¿è¡æå½±ï¼é¡¿æ¶æ³å°äºï¼COURSEè¡¨è½ç¶æå¾å¤ä¸ªåï¼ä½æ¯æä»¬åªéè¦ä½¿ç¨cnameå°±å¤äºåï¼äºæ¯å°æå¨çµèä¸æ²äºæå½±ä¸æ¨çå³ç³»ä»£æ°è¡¨è¾¾å¼ã\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)Ã Î cname(COURSE)))\n```\n\nå¤§ææäºå°æçå¤´ä¸ä¸è¯´ï¼âç¬¨èï¼ä½ è¿æ ·ä¸æ¨æå½±ï¼TEACHER.tno=COURSE.tnoè¿æåæ³ååï¼âå°æé¡¿æ¶é¢æäºï¼å¦æåªå¨COURSEä¸å¯¹cnameåæå½±æ¶ä¸è¡çï¼ä¸å±ç»ç¹ææçè¡¨è¾¾å¼é½éè¦èèå°ï¼äºæ¯ä¿®æ¹äºè¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=COURSE.tno (ÏTEACHER.tno=5(TEACHER)Ã Î cname, tno(COURSE)))\n```\n\nâè¿è¿å·®ä¸å¤ãâå¤§æç¬çè¯´ï¼âè¿æ¯ä½¿ç¨çæå½±çä¸²æ¥çï¼ä¹æ¯ä¸ä¸ªéå¸¸éè¦çå³ç³»ä»£æ°ç­ä»·è§åï¼ç®åæä»¬å¯¹è¿ä¸ªè¡¨è¾¾å¼çä¼åä¸»è¦æ¯ä½¿ç¨äºéæ©ä¸æ¨ï¼åæå½±ä¸æ¨ï¼å¦æç¨SQLè¯­å¥æ¥è¡¨ç¤ºï¼å°±åè¿æ ·ãâå¤§æå¨çµèçè®°äºæ¬ä¸å¿«éçæå°åºäºä¸¤ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM TEACHER t, COURSE c WHERE t.tno = 5 AND t.tno = c.tno;\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE) cc WHERE tt.tno = cc.tno;\n```\n\nâä½ çè¿ä¸¤ä¸ªè¯­å¥ï¼å°±æ¯è°è¯ä¸æ¨åæå½±ä¸æ¨ååçå¯¹ç§è¯­å¥ãå¨åå¡æ°ç§¯ä¹åï¼ååäºè¿æ»¤ï¼è¿æ ·ç¬å¡å°ç§¯çè®¡ç®éä¼åå°ãâ\nå°æä»ç»çè§å¯çä»£æ°è¡¨è¾¾å¼åè¿ä¸¤ä¸ªSQLè¯­å¥ï¼ä»åç°ä¸ä¸ªé®é¢ï¼å°±æ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­æTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼è¿æ¯ä¸æ¯æå³çCOURSE.tnoä¹åºè¯¥ç­äº5å¢ï¼å°æç¶åè¯çå¨çµèä¸åäºä¸ä¸ªSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE WHERE tno=5) cc WHERE tt.tno = cc.tno;\n```\n\nç¶åå°æè¯´ï¼âä½ çï¼ç±äºæTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼æä»¬å¯ä»¥æ¯ä¸æ¯å¯ä»¥æ¨çåºä¸ä¸ªæ°çCOURSE.tno = 5çæ°ççº¦ææ¡ä»¶æ¥å¢ï¼è¿æ ·æä»¬è¿å¯ä»¥æè¿ä¸ªæ¡ä»¶ä¸æ¨å°COURSEè¡¨ä¸ï¼è¿æ ·ä¹è½éä½ç¬å¡å°ç§¯çè®¡ç®éãâ\n\nå¤§æè¯´ï¼âæ¯çï¼è¿å°±æ¯ç­ä»·æ¨çï¼PostgreSQLæ°æ®åºå¨æ¥è¯¢ä¼åçè¿ç¨ä¸­ï¼ä¼å°çº¦ææ¡ä»¶ä¸­ç­ä»·çé¨åé½è®°å½å°ç­ä»·ç±»ä¸­ï¼è¿æ ·å°±è½æ ¹æ®ç­ä»·ç±»çææ°ççº¦ææ¡ä»¶åºæ¥ï¼æ¯å¦ç¤ºä¾çè¯­å¥ä¸­å°±ä¼äº§çä¸ä¸ªç­ä»·ç±»{TEACHER.tno, COURSE.tno, 5}ï¼è¿æ¯ä¸ä¸ªå«æå¸¸éçç­ä»·ç±»ï¼æ¯æ¥è¯¢ä¼åå¨æ¯è¾åæ¬¢çç­ä»·ç±»ï¼è¿ç§ç­ä»·ç±»å¯ä»¥å¾å°åå±æ§åå¸¸éç»åæççº¦ææ¡ä»¶ï¼éå¸¸é½æ¯è½ä¸æ¨çãâ\n\nå°æå¿éå¾é«å´ï¼èªå·±éè¿ä»ç»è§å¯ï¼å¾å°äºç­ä»·ç±»çä¼åï¼æè§èªå·±æäºå­¦ä¹ çå¨åï¼å¿éç¾æ»æ»çï¼ç¶åå°±é®å¤§æï¼âé£ä¸é¢çSQLè¯­å¥è¿æä»ä¹å¯ä¼åçåï¼â\n\nå¤§æè§å¯äºä¸ä¸è¿ä¸ªè¯­å¥ï¼ç¶åè¯´ï¼âä½ çï¼æä»¬å·²ç»å¨TEACHERè¡¨ä¸è¿è¡äºTEACHER.tno = 5çè¿æ»¤ï¼å¨COURSEè¡¨ä¸ä¹åäºCOURSE.tno = 5çè¿æ»¤ï¼è¿æ ·å°±è¯´æå¨åç¬å¡å°ç§¯çæ¶åï¼å®éä¸å·²ç»ç¡®å®äºTEACHER.tno = COURSE.tno = 5ï¼ä¹å°±æ¯è¯´TEACHER.tno = COURSE.tnoè¿ä¸ªçº¦ææ¡ä»¶å·²ç»éå«æç«äºï¼ä¹å°±æ²¡ä»ä¹ç¨äºï¼æä»¬å¯ä»¥æå®å»æï¼æç»å½¢æä¸ä¸ªè¿æ ·çSQLè¯­å¥ãâå¤§æå¨è®°äºæ¬ä¸­æ²ä¸äºæç»çè¯­å¥ï¼\n\n```\nSELECT sname FROM (SELECT * FROM TEACHER WHERE tno = 5) tt, (SELECT cname, tno FROM COURSE WHERE tno=5) ccï¼\n```\n\nåæ¶ä¹æ²åºäºè¿ä¸ªè¯­å¥å¯¹åºçå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼\n\n```\nÎ cname (ÏTEACHER.tno=5(TEACHER)Ã Î cname, tno(ÏCOURSE.tno=5(COURSE)))\n```\n\nç¶åå¤§æè¯´ï¼âç»è¿éæ©ä¸æ¨ãæå½±ä¸æ¨åç­ä»·ç±»æ¨çï¼æä»¬å¯¹è¿ä¸ªSQLè¯­å¥æèè¯´å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡äºä¼åï¼æç»éä½äºè®¡ç®éãâ\n \n![](./postgresql-optimizer-outline-4/1.png) \n\n![](./postgresql-optimizer-outline-4/1.png) \n \n\nå°ææè§å¯¹è°è¯ä¸æ¨å·²ç»çè§£äºï¼ç¶åè¯´ï¼âçä¸å»ä¹ä¸å¤æåï¼æåç°äºå¯ä»¥ä¸æ¨çéæ©æå°±ä¸æ¨ï¼å®å¨æ²¡æé®é¢åãâå¤§æç¬çè¯´ï¼âçç£ï¼æä»æªè§è¿å¦æ­¤åé¢æ è»ä¹äººï¼æä»¬ç°å¨ççè¿ä¸ªä¾å­ï¼åªä¸è¿æ¯æç®åçä¸ç§æåµåï¼ä½ å°±è¿æ ·å¤§è¨ä¸æ­ï¼ä½ çäººçå­å¸éè¿æç¾è»äºå­åï¼â\n\nå°ææ¤æ¤çè¯´ï¼âæçäººçæ²¡æå­å¸ãããâ\n\nå¤§æé®éï¼âæä»¬è¿ä¸ªä¾å­æä¸ä¸ªé®é¢ï¼å°±æ¯ä»æ¯åè¿æ¥ï¼å æ­¤æä»¬å¯ä»¥èæå¦ä¸ºçå°éæ©ä¸æ¨ä¸æ¥ï¼å¯ä»¥æ²¡ç¾æ²¡èçåç­ä»·ç±»æ¨çï¼ä½æ¯å¦ææ¯å¤è¿æ¥ï¼é£è¿è½è¿ä¹ååï¼â\n\nå°æé¡¿æ¶é·å¥äºè¦è¦çæ²æã\n","slug":"postgresql-optimizer-outline-4","published":1,"updated":"2020-08-04T23:18:17.000Z","_id":"ckdgkb6d30000mvs61pjfd9kp","comments":1,"layout":"post","photos":[],"link":"","content":"<p>å°æå¨å¤§æå®¶çä¹¦æ¿éæå¥½äºçº¸ç ï¼å¨ä¸ä»½è¿æçæ¥çº¸ä¸æ¥æ¯«æ³¼å¢¨ï¼âç²¾æ¨ç»æ²ææéï¼éå³æ¼«éä¸¤è«è«ï¼å¤åæç¯è¯»è¯éï¼è«è°èä¸²ä¸ç¤é¦ãâå¤§æçäºä¹åç¬éï¼âå¥½è¯å¥½è¯ï¼æ¥ï¼è®©æä»¬ç»§ç»­å¤åæç¯è¯»ä¼åï¼è«ä¸æ¯æ·¡è¯è¡·è ãâ</p>\n<p>å°æè¯´ï¼âåæ­ä¼å§ï¼æè§å¾è¦æ·±åº¦äºè§£æ¥è¯¢ä¼åæ²¡å¸æäºãâå¤§æçåºäºå°æå¯¹æ¥è¯¢ä¼åäº§çäºä¸ç¹çé¾æç»ªï¼å ä¸ºå°ææ¬æ¥ä»¥ä¸ºéè¿å¤§æçè®²è§£è½å¤å¿«éççè§£æ¥è¯¢ä¼åçæ¬è´¨ï¼ä½æ¯ä»éè¿å æ¬¡å¬åå¤§æçè®²è§£ä¹ååç°ï¼æ¥è¯¢ä¼åå¨è¿ä¸æ¯å æ¬¡è®²è§£å°±è½è§£å³çï¼å¤§æç®åç»ä»è®²è§£çè¿åªæ¯å¨åºç¨å±é¢çè®²è§£ï¼è¿æ²¡ææ·±å¥å°åææºç é¶æ®µï¼ä»ä»å¦æ­¤ï¼å¯¹å°ææ¥è¯´çè§£ä¸å°±å·²ç»æäºå°é¾äºï¼çæ¥è¦æ³æ·±åº¦çäºè§£æ¥è¯¢ä¼åå¨ï¼è¿éè¦ä¸æ´å¤§çåå¤«æè¡ã<a id=\"more\"></a></p>\n<p>å¤§æè¯´ï¼âå¥å«æåï¼æåå°±æ¯å¨ä½ åæä¸ä¸å»çæ¶åååæä¸ä¸ï¼æ¥å§ï¼Letâsç»§ç»­ãâè¯´çæçå°ææ¥å°å®¢åï¼ç»§ç»­æå¼äºçµèï¼âæä»¬ç»§ç»­è¯´ç¹å¥å¢ï¼ä¸æ¬¡è¯´å°äºå­è¿æ¥ï¼è¿æ¬¡æä»¬ç®åè¯´è¯´éæ©ä¸æ¨åç­ä»·ç±»å§ãâ</p>\n<p>å°ææ³äºæ³è¯´ï¼âéæ©ä¸æ¨åç­ä»·ç±»æ¯é»è¾åè§£ä¼åä¸­çåå®¹äºï¼å¯æ¯é»è¾éåä¼åéè¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤è¿äºå¤§åå¤´ä½ è¿æ²¡æç»æè®²è§£è¿åãâ</p>\n<p>å¤§æè¯´ï¼âè¿äºåçç»ä½ èªå·±å»çè§£ï¼å¦æçè§£ä¸äºåæ¥æ¾æå§ãé»è¾ä¼åçè§åå®éä¸è¿æ¯æ¯è¾å¤çï¼ä½æ¯æ¯å¯ä»¥éä¸ªå»ç ´çï¼ä¹å°±æ¯ä»ä»¬ä¹é´éå¸¸èè¨å¹¶æ²¡æå¤å¤§çå³èï¼æä»¬ä¸æç®å¨è¿ä¸é¢çº ç¼ å¤ªå¤æ¶é´ï¼æç¸ä¿¡ä»¥ä½ èªå·±çè½åæä»ä»¬æå®æ¯æ²¡æé®é¢çãâ</p>\n<p>âå¦ï¼æè§å¾æ¯ä½ ææå¨ä½ å®¶åå¤ªé¿æ¶é´ï¼æä½ åç©·å§ï¼âå°æå·ç¬çé®ã</p>\n<p>âæ¯çï¼åå¤§å°å­åæ­»èå­ï¼ä½ è¿é¥­æ¡¶å¤ªè½åäºï¼åé¥­çéåº¦æ¯éæ©ä¸æ¨çéåº¦è¿è¦å¿«ï¼åé¥­é½è¢«ä½ åäºï¼æä»å¤©ä¸­åé½æ²¡åé¥±åãâ</p>\n<p>âæè®°å¾ä½ è¯´è¿ï¼éæ©ä¸æ¨æ¯ä¸ºäºå°½æ©çè¿æ»¤æ°æ®ï¼è¿æ ·å°±è½å¨ä¸å±ç»ç¹éä½è®¡ç®éï¼æ¯å§ï¼â</p>\n<p>âæ¯çãâå¤§æç¹äºç¹å¤´ï¼âè¿æ¯éè¿ä¸ä¸ªå³ç³»ä»£æ°çç¤ºä¾æ¥è¯´æä¸ä¸å®å§ï¼é¡ºä¾¿æä»¬æç­ä»·ç±»æ¨çä¹å¯ä»¥è¯´ä¸è¯´ï¼æ¯å¦è¯´æä»¬æ³è¦è·å¾ç¼å·ä¸º5çèå¸æ¿æçææçè¯¾ç¨åå­ï¼æä»¬å¯ä»¥ç»åºå®çå³ç³»ä»£æ°è¡¨è¾¾å¼ãâè¯´çå¤§æå¨çµèä¸æ²äºä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;5â§TEACHER.tno&#x3D;COURSE.tno (TEACHERÃCOURSE))</span><br></pre></td></tr></table></figure>\n\n<p>âå°æï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼æä¹ä¸æ¨éæ©æä½ï¼â</p>\n<p>å°æççå³ç³»ä»£æ°è¡¨è¾¾å¼æèäºä¸ä¼ï¼è¯´ï¼âæçè¿ä¸ªTEACHER.tno = 5æ¯è¾å¯çï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ååäºTEACHERÃCOURSEï¼ä¹å°±æ¯ååäºå¡æ°ç§¯ï¼æè¦æ¯æTEACHER.tno = 5æ¾å°TEACHERä¸åæä¸äºæ°æ®è¿æ»¤æï¼å²ä¸æ¯ãããå®ç¾ï¼âè¯´çå°æä¹å¨çµèä¸æ²åºäºæTEACHER.tno = 5ä¸æ¨ä¹åçå³ç³»ä»£æ°è¡¨è¾¾å¼ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)ÃCOURSE))</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æè¯´ï¼âå¯¹çï¼ä½ è¿æ ·ä¸æ¨ä¸æ¥ï¼çç¡®è½éä½è®¡ç®éï¼ä½ è¿åºç¨çæ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­çåéçÏF(A Ã B) == ÏF1(A) Ã ÏF2(B)ï¼é£ä½ ççï¼æ¢ç¶ä¸æ¨è¿ä¹å¥½ï¼æ¯ä¸æ¯æå½±ä¹è½ä¸æ¨ï¼âå°æçäºä¸ä¸ï¼å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­å¼éè¦å¯¹cnameè¿è¡æå½±ï¼é¡¿æ¶æ³å°äºï¼COURSEè¡¨è½ç¶æå¾å¤ä¸ªåï¼ä½æ¯æä»¬åªéè¦ä½¿ç¨cnameå°±å¤äºåï¼äºæ¯å°æå¨çµèä¸æ²äºæå½±ä¸æ¨çå³ç³»ä»£æ°è¡¨è¾¾å¼ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææäºå°æçå¤´ä¸ä¸è¯´ï¼âç¬¨èï¼ä½ è¿æ ·ä¸æ¨æå½±ï¼TEACHER.tno=COURSE.tnoè¿æåæ³ååï¼âå°æé¡¿æ¶é¢æäºï¼å¦æåªå¨COURSEä¸å¯¹cnameåæå½±æ¶ä¸è¡çï¼ä¸å±ç»ç¹ææçè¡¨è¾¾å¼é½éè¦èèå°ï¼äºæ¯ä¿®æ¹äºè¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname, tno(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>âè¿è¿å·®ä¸å¤ãâå¤§æç¬çè¯´ï¼âè¿æ¯ä½¿ç¨çæå½±çä¸²æ¥çï¼ä¹æ¯ä¸ä¸ªéå¸¸éè¦çå³ç³»ä»£æ°ç­ä»·è§åï¼ç®åæä»¬å¯¹è¿ä¸ªè¡¨è¾¾å¼çä¼åä¸»è¦æ¯ä½¿ç¨äºéæ©ä¸æ¨ï¼åæå½±ä¸æ¨ï¼å¦æç¨SQLè¯­å¥æ¥è¡¨ç¤ºï¼å°±åè¿æ ·ãâå¤§æå¨çµèçè®°äºæ¬ä¸å¿«éçæå°åºäºä¸¤ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t, COURSE c WHERE t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE) cc WHERE tt.tno &#x3D; cc.tno;</span><br></pre></td></tr></table></figure>\n\n<p>âä½ çè¿ä¸¤ä¸ªè¯­å¥ï¼å°±æ¯è°è¯ä¸æ¨åæå½±ä¸æ¨ååçå¯¹ç§è¯­å¥ãå¨åå¡æ°ç§¯ä¹åï¼ååäºè¿æ»¤ï¼è¿æ ·ç¬å¡å°ç§¯çè®¡ç®éä¼åå°ãâ<br>å°æä»ç»çè§å¯çä»£æ°è¡¨è¾¾å¼åè¿ä¸¤ä¸ªSQLè¯­å¥ï¼ä»åç°ä¸ä¸ªé®é¢ï¼å°±æ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­æTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼è¿æ¯ä¸æ¯æå³çCOURSE.tnoä¹åºè¯¥ç­äº5å¢ï¼å°æç¶åè¯çå¨çµèä¸åäºä¸ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE WHERE tno&#x3D;5) cc WHERE tt.tno &#x3D; cc.tno;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æè¯´ï¼âä½ çï¼ç±äºæTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼æä»¬å¯ä»¥æ¯ä¸æ¯å¯ä»¥æ¨çåºä¸ä¸ªæ°çCOURSE.tno = 5çæ°ççº¦ææ¡ä»¶æ¥å¢ï¼è¿æ ·æä»¬è¿å¯ä»¥æè¿ä¸ªæ¡ä»¶ä¸æ¨å°COURSEè¡¨ä¸ï¼è¿æ ·ä¹è½éä½ç¬å¡å°ç§¯çè®¡ç®éãâ</p>\n<p>å¤§æè¯´ï¼âæ¯çï¼è¿å°±æ¯ç­ä»·æ¨çï¼PostgreSQLæ°æ®åºå¨æ¥è¯¢ä¼åçè¿ç¨ä¸­ï¼ä¼å°çº¦ææ¡ä»¶ä¸­ç­ä»·çé¨åé½è®°å½å°ç­ä»·ç±»ä¸­ï¼è¿æ ·å°±è½æ ¹æ®ç­ä»·ç±»çææ°ççº¦ææ¡ä»¶åºæ¥ï¼æ¯å¦ç¤ºä¾çè¯­å¥ä¸­å°±ä¼äº§çä¸ä¸ªç­ä»·ç±»{TEACHER.tno, COURSE.tno, 5}ï¼è¿æ¯ä¸ä¸ªå«æå¸¸éçç­ä»·ç±»ï¼æ¯æ¥è¯¢ä¼åå¨æ¯è¾åæ¬¢çç­ä»·ç±»ï¼è¿ç§ç­ä»·ç±»å¯ä»¥å¾å°åå±æ§åå¸¸éç»åæççº¦ææ¡ä»¶ï¼éå¸¸é½æ¯è½ä¸æ¨çãâ</p>\n<p>å°æå¿éå¾é«å´ï¼èªå·±éè¿ä»ç»è§å¯ï¼å¾å°äºç­ä»·ç±»çä¼åï¼æè§èªå·±æäºå­¦ä¹ çå¨åï¼å¿éç¾æ»æ»çï¼ç¶åå°±é®å¤§æï¼âé£ä¸é¢çSQLè¯­å¥è¿æä»ä¹å¯ä¼åçåï¼â</p>\n<p>å¤§æè§å¯äºä¸ä¸è¿ä¸ªè¯­å¥ï¼ç¶åè¯´ï¼âä½ çï¼æä»¬å·²ç»å¨TEACHERè¡¨ä¸è¿è¡äºTEACHER.tno = 5çè¿æ»¤ï¼å¨COURSEè¡¨ä¸ä¹åäºCOURSE.tno = 5çè¿æ»¤ï¼è¿æ ·å°±è¯´æå¨åç¬å¡å°ç§¯çæ¶åï¼å®éä¸å·²ç»ç¡®å®äºTEACHER.tno = COURSE.tno = 5ï¼ä¹å°±æ¯è¯´TEACHER.tno = COURSE.tnoè¿ä¸ªçº¦ææ¡ä»¶å·²ç»éå«æç«äºï¼ä¹å°±æ²¡ä»ä¹ç¨äºï¼æä»¬å¯ä»¥æå®å»æï¼æç»å½¢æä¸ä¸ªè¿æ ·çSQLè¯­å¥ãâå¤§æå¨è®°äºæ¬ä¸­æ²ä¸äºæç»çè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE WHERE tno&#x3D;5) ccï¼</span><br></pre></td></tr></table></figure>\n\n<p>åæ¶ä¹æ²åºäºè¿ä¸ªè¯­å¥å¯¹åºçå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname, tno(ÏCOURSE.tno&#x3D;5(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå¤§æè¯´ï¼âç»è¿éæ©ä¸æ¨ãæå½±ä¸æ¨åç­ä»·ç±»æ¨çï¼æä»¬å¯¹è¿ä¸ªSQLè¯­å¥æèè¯´å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡äºä¼åï¼æç»éä½äºè®¡ç®éãâ</p>\n<p><img src=\"/2020/08/05/postgresql-optimizer-outline-4/1.png\"> </p>\n<p><img src=\"/2020/08/05/postgresql-optimizer-outline-4/1.png\"> </p>\n<p>å°ææè§å¯¹è°è¯ä¸æ¨å·²ç»çè§£äºï¼ç¶åè¯´ï¼âçä¸å»ä¹ä¸å¤æåï¼æåç°äºå¯ä»¥ä¸æ¨çéæ©æå°±ä¸æ¨ï¼å®å¨æ²¡æé®é¢åãâå¤§æç¬çè¯´ï¼âçç£ï¼æä»æªè§è¿å¦æ­¤åé¢æ è»ä¹äººï¼æä»¬ç°å¨ççè¿ä¸ªä¾å­ï¼åªä¸è¿æ¯æç®åçä¸ç§æåµåï¼ä½ å°±è¿æ ·å¤§è¨ä¸æ­ï¼ä½ çäººçå­å¸éè¿æç¾è»äºå­åï¼â</p>\n<p>å°ææ¤æ¤çè¯´ï¼âæçäººçæ²¡æå­å¸ãããâ</p>\n<p>å¤§æé®éï¼âæä»¬è¿ä¸ªä¾å­æä¸ä¸ªé®é¢ï¼å°±æ¯ä»æ¯åè¿æ¥ï¼å æ­¤æä»¬å¯ä»¥èæå¦ä¸ºçå°éæ©ä¸æ¨ä¸æ¥ï¼å¯ä»¥æ²¡ç¾æ²¡èçåç­ä»·ç±»æ¨çï¼ä½æ¯å¦ææ¯å¤è¿æ¥ï¼é£è¿è½è¿ä¹ååï¼â</p>\n<p>å°æé¡¿æ¶é·å¥äºè¦è¦çæ²æã</p>\n","site":{"data":{}},"excerpt":"<p>å°æå¨å¤§æå®¶çä¹¦æ¿éæå¥½äºçº¸ç ï¼å¨ä¸ä»½è¿æçæ¥çº¸ä¸æ¥æ¯«æ³¼å¢¨ï¼âç²¾æ¨ç»æ²ææéï¼éå³æ¼«éä¸¤è«è«ï¼å¤åæç¯è¯»è¯éï¼è«è°èä¸²ä¸ç¤é¦ãâå¤§æçäºä¹åç¬éï¼âå¥½è¯å¥½è¯ï¼æ¥ï¼è®©æä»¬ç»§ç»­å¤åæç¯è¯»ä¼åï¼è«ä¸æ¯æ·¡è¯è¡·è ãâ</p>\n<p>å°æè¯´ï¼âåæ­ä¼å§ï¼æè§å¾è¦æ·±åº¦äºè§£æ¥è¯¢ä¼åæ²¡å¸æäºãâå¤§æçåºäºå°æå¯¹æ¥è¯¢ä¼åäº§çäºä¸ç¹çé¾æç»ªï¼å ä¸ºå°ææ¬æ¥ä»¥ä¸ºéè¿å¤§æçè®²è§£è½å¤å¿«éççè§£æ¥è¯¢ä¼åçæ¬è´¨ï¼ä½æ¯ä»éè¿å æ¬¡å¬åå¤§æçè®²è§£ä¹ååç°ï¼æ¥è¯¢ä¼åå¨è¿ä¸æ¯å æ¬¡è®²è§£å°±è½è§£å³çï¼å¤§æç®åç»ä»è®²è§£çè¿åªæ¯å¨åºç¨å±é¢çè®²è§£ï¼è¿æ²¡ææ·±å¥å°åææºç é¶æ®µï¼ä»ä»å¦æ­¤ï¼å¯¹å°ææ¥è¯´çè§£ä¸å°±å·²ç»æäºå°é¾äºï¼çæ¥è¦æ³æ·±åº¦çäºè§£æ¥è¯¢ä¼åå¨ï¼è¿éè¦ä¸æ´å¤§çåå¤«æè¡ã</p>","more":"<p></p>\n<p>å¤§æè¯´ï¼âå¥å«æåï¼æåå°±æ¯å¨ä½ åæä¸ä¸å»çæ¶åååæä¸ä¸ï¼æ¥å§ï¼Letâsç»§ç»­ãâè¯´çæçå°ææ¥å°å®¢åï¼ç»§ç»­æå¼äºçµèï¼âæä»¬ç»§ç»­è¯´ç¹å¥å¢ï¼ä¸æ¬¡è¯´å°äºå­è¿æ¥ï¼è¿æ¬¡æä»¬ç®åè¯´è¯´éæ©ä¸æ¨åç­ä»·ç±»å§ãâ</p>\n<p>å°ææ³äºæ³è¯´ï¼âéæ©ä¸æ¨åç­ä»·ç±»æ¯é»è¾åè§£ä¼åä¸­çåå®¹äºï¼å¯æ¯é»è¾éåä¼åéè¿æå­æ¥è¯¢æåãè¡¨è¾¾å¼é¢å¤çãå¤è¿æ¥æ¶é¤è¿äºå¤§åå¤´ä½ è¿æ²¡æç»æè®²è§£è¿åãâ</p>\n<p>å¤§æè¯´ï¼âè¿äºåçç»ä½ èªå·±å»çè§£ï¼å¦æçè§£ä¸äºåæ¥æ¾æå§ãé»è¾ä¼åçè§åå®éä¸è¿æ¯æ¯è¾å¤çï¼ä½æ¯æ¯å¯ä»¥éä¸ªå»ç ´çï¼ä¹å°±æ¯ä»ä»¬ä¹é´éå¸¸èè¨å¹¶æ²¡æå¤å¤§çå³èï¼æä»¬ä¸æç®å¨è¿ä¸é¢çº ç¼ å¤ªå¤æ¶é´ï¼æç¸ä¿¡ä»¥ä½ èªå·±çè½åæä»ä»¬æå®æ¯æ²¡æé®é¢çãâ</p>\n<p>âå¦ï¼æè§å¾æ¯ä½ ææå¨ä½ å®¶åå¤ªé¿æ¶é´ï¼æä½ åç©·å§ï¼âå°æå·ç¬çé®ã</p>\n<p>âæ¯çï¼åå¤§å°å­åæ­»èå­ï¼ä½ è¿é¥­æ¡¶å¤ªè½åäºï¼åé¥­çéåº¦æ¯éæ©ä¸æ¨çéåº¦è¿è¦å¿«ï¼åé¥­é½è¢«ä½ åäºï¼æä»å¤©ä¸­åé½æ²¡åé¥±åãâ</p>\n<p>âæè®°å¾ä½ è¯´è¿ï¼éæ©ä¸æ¨æ¯ä¸ºäºå°½æ©çè¿æ»¤æ°æ®ï¼è¿æ ·å°±è½å¨ä¸å±ç»ç¹éä½è®¡ç®éï¼æ¯å§ï¼â</p>\n<p>âæ¯çãâå¤§æç¹äºç¹å¤´ï¼âè¿æ¯éè¿ä¸ä¸ªå³ç³»ä»£æ°çç¤ºä¾æ¥è¯´æä¸ä¸å®å§ï¼é¡ºä¾¿æä»¬æç­ä»·ç±»æ¨çä¹å¯ä»¥è¯´ä¸è¯´ï¼æ¯å¦è¯´æä»¬æ³è¦è·å¾ç¼å·ä¸º5çèå¸æ¿æçææçè¯¾ç¨åå­ï¼æä»¬å¯ä»¥ç»åºå®çå³ç³»ä»£æ°è¡¨è¾¾å¼ãâè¯´çå¤§æå¨çµèä¸æ²äºä¸ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;5â§TEACHER.tno&#x3D;COURSE.tno (TEACHERÃCOURSE))</span><br></pre></td></tr></table></figure>\n\n<p>âå°æï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼æä¹ä¸æ¨éæ©æä½ï¼â</p>\n<p>å°æççå³ç³»ä»£æ°è¡¨è¾¾å¼æèäºä¸ä¼ï¼è¯´ï¼âæçè¿ä¸ªTEACHER.tno = 5æ¯è¾å¯çï¼ä½ çè¿ä¸ªå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼ååäºTEACHERÃCOURSEï¼ä¹å°±æ¯ååäºå¡æ°ç§¯ï¼æè¦æ¯æTEACHER.tno = 5æ¾å°TEACHERä¸åæä¸äºæ°æ®è¿æ»¤æï¼å²ä¸æ¯ãããå®ç¾ï¼âè¯´çå°æä¹å¨çµèä¸æ²åºäºæTEACHER.tno = 5ä¸æ¨ä¹åçå³ç³»ä»£æ°è¡¨è¾¾å¼ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)ÃCOURSE))</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æè¯´ï¼âå¯¹çï¼ä½ è¿æ ·ä¸æ¨ä¸æ¥ï¼çç¡®è½éä½è®¡ç®éï¼ä½ è¿åºç¨çæ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­çåéçÏF(A Ã B) == ÏF1(A) Ã ÏF2(B)ï¼é£ä½ ççï¼æ¢ç¶ä¸æ¨è¿ä¹å¥½ï¼æ¯ä¸æ¯æå½±ä¹è½ä¸æ¨ï¼âå°æçäºä¸ä¸ï¼å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­å¼éè¦å¯¹cnameè¿è¡æå½±ï¼é¡¿æ¶æ³å°äºï¼COURSEè¡¨è½ç¶æå¾å¤ä¸ªåï¼ä½æ¯æä»¬åªéè¦ä½¿ç¨cnameå°±å¤äºåï¼äºæ¯å°æå¨çµèä¸æ²äºæå½±ä¸æ¨çå³ç³»ä»£æ°è¡¨è¾¾å¼ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææäºå°æçå¤´ä¸ä¸è¯´ï¼âç¬¨èï¼ä½ è¿æ ·ä¸æ¨æå½±ï¼TEACHER.tno=COURSE.tnoè¿æåæ³ååï¼âå°æé¡¿æ¶é¢æäºï¼å¦æåªå¨COURSEä¸å¯¹cnameåæå½±æ¶ä¸è¡çï¼ä¸å±ç»ç¹ææçè¡¨è¾¾å¼é½éè¦èèå°ï¼äºæ¯ä¿®æ¹äºè¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;COURSE.tno (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname, tno(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>âè¿è¿å·®ä¸å¤ãâå¤§æç¬çè¯´ï¼âè¿æ¯ä½¿ç¨çæå½±çä¸²æ¥çï¼ä¹æ¯ä¸ä¸ªéå¸¸éè¦çå³ç³»ä»£æ°ç­ä»·è§åï¼ç®åæä»¬å¯¹è¿ä¸ªè¡¨è¾¾å¼çä¼åä¸»è¦æ¯ä½¿ç¨äºéæ©ä¸æ¨ï¼åæå½±ä¸æ¨ï¼å¦æç¨SQLè¯­å¥æ¥è¡¨ç¤ºï¼å°±åè¿æ ·ãâå¤§æå¨çµèçè®°äºæ¬ä¸å¿«éçæå°åºäºä¸¤ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t, COURSE c WHERE t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE) cc WHERE tt.tno &#x3D; cc.tno;</span><br></pre></td></tr></table></figure>\n\n<p>âä½ çè¿ä¸¤ä¸ªè¯­å¥ï¼å°±æ¯è°è¯ä¸æ¨åæå½±ä¸æ¨ååçå¯¹ç§è¯­å¥ãå¨åå¡æ°ç§¯ä¹åï¼ååäºè¿æ»¤ï¼è¿æ ·ç¬å¡å°ç§¯çè®¡ç®éä¼åå°ãâ<br>å°æä»ç»çè§å¯çä»£æ°è¡¨è¾¾å¼åè¿ä¸¤ä¸ªSQLè¯­å¥ï¼ä»åç°ä¸ä¸ªé®é¢ï¼å°±æ¯å³ç³»ä»£æ°è¡¨è¾¾å¼ä¸­æTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼è¿æ¯ä¸æ¯æå³çCOURSE.tnoä¹åºè¯¥ç­äº5å¢ï¼å°æç¶åè¯çå¨çµèä¸åäºä¸ä¸ªSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE WHERE tno&#x3D;5) cc WHERE tt.tno &#x3D; cc.tno;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æè¯´ï¼âä½ çï¼ç±äºæTEACHER.tno = 5åTEACHER.tno = COURSE.tnoè¿æ ·çä¸¤ä¸ªçº¦ææ¡ä»¶ï¼æä»¬å¯ä»¥æ¯ä¸æ¯å¯ä»¥æ¨çåºä¸ä¸ªæ°çCOURSE.tno = 5çæ°ççº¦ææ¡ä»¶æ¥å¢ï¼è¿æ ·æä»¬è¿å¯ä»¥æè¿ä¸ªæ¡ä»¶ä¸æ¨å°COURSEè¡¨ä¸ï¼è¿æ ·ä¹è½éä½ç¬å¡å°ç§¯çè®¡ç®éãâ</p>\n<p>å¤§æè¯´ï¼âæ¯çï¼è¿å°±æ¯ç­ä»·æ¨çï¼PostgreSQLæ°æ®åºå¨æ¥è¯¢ä¼åçè¿ç¨ä¸­ï¼ä¼å°çº¦ææ¡ä»¶ä¸­ç­ä»·çé¨åé½è®°å½å°ç­ä»·ç±»ä¸­ï¼è¿æ ·å°±è½æ ¹æ®ç­ä»·ç±»çææ°ççº¦ææ¡ä»¶åºæ¥ï¼æ¯å¦ç¤ºä¾çè¯­å¥ä¸­å°±ä¼äº§çä¸ä¸ªç­ä»·ç±»{TEACHER.tno, COURSE.tno, 5}ï¼è¿æ¯ä¸ä¸ªå«æå¸¸éçç­ä»·ç±»ï¼æ¯æ¥è¯¢ä¼åå¨æ¯è¾åæ¬¢çç­ä»·ç±»ï¼è¿ç§ç­ä»·ç±»å¯ä»¥å¾å°åå±æ§åå¸¸éç»åæççº¦ææ¡ä»¶ï¼éå¸¸é½æ¯è½ä¸æ¨çãâ</p>\n<p>å°æå¿éå¾é«å´ï¼èªå·±éè¿ä»ç»è§å¯ï¼å¾å°äºç­ä»·ç±»çä¼åï¼æè§èªå·±æäºå­¦ä¹ çå¨åï¼å¿éç¾æ»æ»çï¼ç¶åå°±é®å¤§æï¼âé£ä¸é¢çSQLè¯­å¥è¿æä»ä¹å¯ä¼åçåï¼â</p>\n<p>å¤§æè§å¯äºä¸ä¸è¿ä¸ªè¯­å¥ï¼ç¶åè¯´ï¼âä½ çï¼æä»¬å·²ç»å¨TEACHERè¡¨ä¸è¿è¡äºTEACHER.tno = 5çè¿æ»¤ï¼å¨COURSEè¡¨ä¸ä¹åäºCOURSE.tno = 5çè¿æ»¤ï¼è¿æ ·å°±è¯´æå¨åç¬å¡å°ç§¯çæ¶åï¼å®éä¸å·²ç»ç¡®å®äºTEACHER.tno = COURSE.tno = 5ï¼ä¹å°±æ¯è¯´TEACHER.tno = COURSE.tnoè¿ä¸ªçº¦ææ¡ä»¶å·²ç»éå«æç«äºï¼ä¹å°±æ²¡ä»ä¹ç¨äºï¼æä»¬å¯ä»¥æå®å»æï¼æç»å½¢æä¸ä¸ªè¿æ ·çSQLè¯­å¥ãâå¤§æå¨è®°äºæ¬ä¸­æ²ä¸äºæç»çè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM (SELECT * FROM TEACHER WHERE tno &#x3D; 5) tt, (SELECT cname, tno FROM COURSE WHERE tno&#x3D;5) ccï¼</span><br></pre></td></tr></table></figure>\n\n<p>åæ¶ä¹æ²åºäºè¿ä¸ªè¯­å¥å¯¹åºçå³ç³»ä»£æ°è¡¨è¾¾å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Î cname (ÏTEACHER.tno&#x3D;5(TEACHER)Ã Î cname, tno(ÏCOURSE.tno&#x3D;5(COURSE)))</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå¤§æè¯´ï¼âç»è¿éæ©ä¸æ¨ãæå½±ä¸æ¨åç­ä»·ç±»æ¨çï¼æä»¬å¯¹è¿ä¸ªSQLè¯­å¥æèè¯´å³ç³»ä»£æ°è¡¨è¾¾å¼è¿è¡äºä¼åï¼æç»éä½äºè®¡ç®éãâ</p>\n<p><img src=\"/2020/08/05/postgresql-optimizer-outline-4/1.png\"> </p>\n<p><img src=\"/2020/08/05/postgresql-optimizer-outline-4/1.png\"> </p>\n<p>å°ææè§å¯¹è°è¯ä¸æ¨å·²ç»çè§£äºï¼ç¶åè¯´ï¼âçä¸å»ä¹ä¸å¤æåï¼æåç°äºå¯ä»¥ä¸æ¨çéæ©æå°±ä¸æ¨ï¼å®å¨æ²¡æé®é¢åãâå¤§æç¬çè¯´ï¼âçç£ï¼æä»æªè§è¿å¦æ­¤åé¢æ è»ä¹äººï¼æä»¬ç°å¨ççè¿ä¸ªä¾å­ï¼åªä¸è¿æ¯æç®åçä¸ç§æåµåï¼ä½ å°±è¿æ ·å¤§è¨ä¸æ­ï¼ä½ çäººçå­å¸éè¿æç¾è»äºå­åï¼â</p>\n<p>å°ææ¤æ¤çè¯´ï¼âæçäººçæ²¡æå­å¸ãããâ</p>\n<p>å¤§æé®éï¼âæä»¬è¿ä¸ªä¾å­æä¸ä¸ªé®é¢ï¼å°±æ¯ä»æ¯åè¿æ¥ï¼å æ­¤æä»¬å¯ä»¥èæå¦ä¸ºçå°éæ©ä¸æ¨ä¸æ¥ï¼å¯ä»¥æ²¡ç¾æ²¡èçåç­ä»·ç±»æ¨çï¼ä½æ¯å¦ææ¯å¤è¿æ¥ï¼é£è¿è½è¿ä¹ååï¼â</p>\n<p>å°æé¡¿æ¶é·å¥äºè¦è¦çæ²æã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(5) - ä¸¥æ ¼è¦æ±èªå·±","date":"2020-08-14T15:40:53.000Z","_content":"\nå°æè¢«å¤§æå°äºä¸åï¼äºæ¯å¿éå¼å§åè®¡èµ·æ¥ï¼åå¦æ¯å¤è¿æ¥ï¼å¯è½ä¼å¯¹æä¸æ¹è¡¥NULLå¼ï¼è¿æ ·çè¯TEACHER.tno = COURSE.tnoè¿æ ·ççº¦ææ¡ä»¶å°±æ æ³ææç­ä»·ç±»äºåï¼ç¶åå°å¨çµèä¸é»é»çæ²äºä¸ä¸ªSQLè¯­å¥ï¼<!-- more -->\n\n```\nSELECT sname FROM TEACHER t LEFT JOIN COURSE c ON t.tno = 5 AND t.tno = c.tno;\n```\n\nç¶åå°æåç°ä¸ä½ç­ä»·ç±»å¯è½äº§çä¸äºäºï¼èä¸éæ©ä¸æ¨ä¹æ æ³è¿è¡äºï¼äºæ¯è¯´ï¼âè¿ä¸ªè¯­å¥ä¸­çTEACHER.tno=5ä¸è½ä¸æ¨äºï¼å ä¸ºå·¦è¿æ¥çè¯­ä¹æ¯å¤è¡¨çææçæ°æ®é½è¦è¾åºåºæ¥ï¼å¦ææTEACHER.tno=5ä¸æ¨å°TEACHERè¡¨ä¸ï¼é£å°±ä¼å¨åå·¦è¿æ¥ä¹ååå¯¹TEACHERè¡¨åè¿æ»¤ï¼å¯¼è´æ¥è¯¢ç»æçä¸ç­ä»·ï¼èä¸ç±äºè¡¥NULLå¼ï¼ç­ä»·ç±»ä¹çæä¸äºäºãâ\n\nå¤§æè¯´ï¼âå¯¹çï¼å°æåå­¦ä½ çè§£çå¾å¿«ï¼ç±äºå¤è¿æ¥è¡¥NULLå¼çå³ç³»ï¼ç¡®å®å¯¼è´æ æ³åè°è¯ä¸æ¨ï¼ä¸è¿ä½ å¯ä»¥çä¸ä¸ä¸é¢çè¿ä¸ªè¯­å¥ï¼ççæä»ä¹åºå«ãâç¶åå¤§æå¨çµèéè¾å¥äºå¦ä¸ä¸ªç±»ä¼¼çSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM TEACHER t LEFT JOIN COURSE c ON TRUE WHERE t.tno = 5 AND t.tno = c.tno;\n```\n\nå°æä»ç»çè§å¯ä¸é¢çä¾å¥åå½åè¿ä¸ªä¾å¥ï¼åç°çº¦ææ¡ä»¶ä¸ä¸ªå¤å¨ONåé¢ï¼å¦ä¸ä¸ªæ¯å¤å¨WHEREåé¢ï¼å°æå¥½åè¿ä¸æ¯å¾çè§£ä»ä»¬çå«ä¹ï¼äºæ¯åå¤§ææå»äºå¨è¯¢çç®åãå¤§æè¯´ï¼âæä»¬ç²ç¥çåä¸ä¸ï¼ONåé¢ççº¦ææ¡ä»¶æ¯è¿æ¥æ¡ä»¶ï¼WHEREåé¢ççº¦ææ¡ä»¶æ¯è¿æ»¤æ¡ä»¶ï¼è¿æ¥æ¡ä»¶åè¿æ»¤æ¡ä»¶æ¯ä¸åçãâ\n\nå°æå¥½åæå°äºä»ä¹ï¼æ¢çè¯´ï¼âæç¥éäºï¼ä¸ä¸ªæ¯è¿æ¥ä¸­çï¼ä¸ä¸ªæ¯è¿æ¥åçï¼å¯ä»¥è¿ä¹çè§£å§ï¼ä½ çï¼è¿æ¥æ¡ä»¶ä¼åä¸å°è¿æ¥æä½çè¿ç¨ä¸­ï¼æ»¡è¶³è¿æ¥æ¡ä»¶çä¼æ¾ç¤ºåºæ¥ï¼ä¸æ»¡è¶³è¿æ¥æ¡ä»¶çï¼æ ¹æ®è¿æ¥çç±»åè¿ä¼å³å®æ¯å¦è¡¥NULLå¼ï¼èè¿æ»¤æ¡ä»¶æ¯å¨è¿æ¥æä½ä¹åå¯¹è¿æ¥çç»æè¿è¡è¿æ»¤ãããâå°æåå¯¹å¤§ææå»äºæå¾çç¼ç¥ï¼è¿ç§ç¼ç¥æ¯ææå¾å°ä¸ç¹è¯å®ï¼å¤§æç¬çè¯´ï¼âå¯¹ï¼å¯ä»¥è¿ä¹çè§£ãâ\n\nå°æèµ¶ç´§è¯´ï¼âä½ åå«è®²ï¼è®©æççè¿ä¸ªå¸¦æè¿æ»¤æ¡ä»¶çSQLè¯­å¥æ¯ä¸æ¯è½ä¸æ¨ãâï¼ç¶åå°æå¯¹çè¿ä¸ªSQLè¯­å¥ä»ç»è§å¯èµ·æ¥ï¼å£ä¸­å¿µå¿µæè¯ï¼ä¼¼ä¹æ¯å·²ç»èµ°ç«å¥é­äºã\n\nå°æè§å¯äºåå¤©ï¼å¥½æ æ¶è·ï¼åªå¥½è¯´ï¼âæææä¸ç®ï¼è§å¾è¿ä¸ªçº¦ææ¡ä»¶æ¯è½ä¸æ¨çï¼èä¸ç­ä»·ç±»ä¹è½å»ºç«èµ·æ¥ãâ\n\nâä¸ºä»ä¹ï¼âå¤§æè¿½é®éã\n\nâä¸ä¸ºä»ä¹ï¼æèæµ·ä¸­çµåä¹ç°ï¼ææ¯ä¸ä¸ªä½ç³»çç¨åºåãâ\n\nâä½ æç¶æ²¡æäººççå­å¸ï¼æ³å¿ä½ å³ä½¿æäººçå­å¸ï¼ä½ ä¹æç¾è»äºå­ç»æ£æäºãâ\n\nå°æç¬çè¯´ï¼âæ¯çï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåãããâ\n\nå¤§æçå°æç«ç¶å±èµ·äºæ­ï¼æ¤æçè¯´ï¼âä¸è¦è¡é¹ï¼åè¡é¹æå°±è®©ä½ ä¸æ¯æ¬èªç±ï¼ä¸æ¯æ¬æ­»äº¡ãããâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âå®éä¸è¿éè¿æä¸ä¸ªä¸¥æ ¼çæ¦å¿µï¼ä»ä¹å«ä¸¥æ ¼å¢ï¼ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦æå®çè¾å¥æ¯NULLå¹¶ä¸è¾åºä¹æ¯NULLï¼é£ä¹æä»¬å°±è¯´è¿ä¸ªè¡¨è¾¾å¼æ¯ä¸¥æ ¼çï¼å¦å¤æä»¬å¯ä»¥æ©å±ä¸ä¸ä¸¥æ ¼çå®ä¹ï¼ä»èå®ä¹åºä¸ä¸ªå«åâå®½æ³çä¸¥æ ¼âçæ¦å¿µï¼å°±æ¯è¯´å¦æä¸ä¸ªè¡¨è¾¾å¼å®çè¾å¥æ¯NULLï¼å®çè¾åºæ¯NULLæèfalseï¼é£ä¹æä»¬å°±è¯´å®ç¬¦åå®½æ³çä¸¥æ ¼ãâ\n\nâé£ä¹ä¸¥æ ¼æä»ä¹ç¨å¢ï¼â\n\nâå¦æå¯¹ä¸ä¸ªåç»åºç¨çº¦ææ¡ä»¶ï¼å¦æçº¦ææ¡ä»¶æ±å¼è¿åçæ¯NULLå¼æèFALSEï¼å®éä¸ä»£è¡¨çæ¯è¿ä¸æ¡åç»ä¸è¾åºï¼æç½åï¼â\nâå¦ï¼é£å°±æ¯è¯´æä»¬è¡¥çNULLå¼å¦æéå°è¿ç§è¿æ»¤æ¡ä»¶ï¼å°±ä¸ä¼è¾åºåºæ¥å½ãâå°æåäºä¸ä¸ï¼çªç¶æ³å°äºäºä»ä¹ï¼ç»§ç»­é®éï¼âé£è¿ç§å¤è¿æ¥è¿è¡¥NULLå¼å¹²åï¼å²ä¸æ¯æ²¡æä»ä¹åµç¨äºï¼â\n\nâå¯¹å¤´ï¼è¿å°±æ¯å¤è¿æ¥æ¶é¤çåºæ¬åçï¼éä¸è¿ç§ä¸¥æ ¼ççº¦ææ¡ä»¶ï¼å¤è¿æ¥è¡¥çNULLå¼æ²¡æä»ä¹ç¨ï¼é£ä¹å°±è½¬åæåè¿æ¥å°±å¥½äºãé®é¢æ¥äºï¼å¦æåæäºåè¿æ¥ï¼æä»¬åè½èæå¦ä¸ºçéæ©ä¸æ¨ãæ²¡ç¾æ²¡èçåç­ä»·æ¨çäºï¼æä¸æåï¼æä¸æå¤ï¼â\n\nâååï¼é£ä½ è½ç»æä¸ä¸ªä¸ä¸¥æ ¼çä¾å­ä¸ï¼è®©æè§è¯ä¸ä¸ä¸ä¸¥æ ¼çè¡¨è¾¾å¼ãâ\n\nâæ¯å¦è¯´IS NOT NULLï¼è¾å¥æ¯NULLå¼ï¼è¾åºç«ç¶æ¯TRUEï¼è¿æCOALESCEå½æ°ï¼è¾å¥æ¯NULLå¼ï¼è¾åºæ¯å¥éä½ å®ãâ\n\nå°æè¯´ï¼âçæ¥è¡¨è¾¾å¼æ¯å¦ä¸¥æ ¼æ¯å¾éè¦çä¸ä¸ªæ¦å¿µï¼éè¿è¿ä¸ªæ¦å¿µæä»¬è½åå¤è¿æ¥æ¶é¤ï¼å¤è¿æ¥æ¶é¤åè½å¤å¯¼è´éæ©è½å¤ä¸æ¨ãããè¿æå°±æç½äºä¸ºä»ä¹è¦åå¤è¿æ¥æ¶é¤äºãâ\n\nâå¯ï¼å¤è¿æ¥æ¶é¤ä¸åªæ¯å°å¤è¿æ¥è½¬æ¢æåè¿æ¥ï¼å¶å®è¿æä¸ç§æåµï¼å®ä¹åæä»¬è¦è¯´çè¡¨è¾¾å¼çæ¡ä»¶æ¯å¦ä¸¥æ ¼æå³ï¼é£å°±æ¯å¯ä»¥å°å¤è¿æ¥è½¬æ¢æAntiJoinï¼æä»¬æ¥çè¿æ ·ä¸ä¸ªä¾å­ãâ\n\n```\nSELECT * FROM STUDENT LEFT JOIN SCORE ON STUDENT.sno = SCORE.sno WHERE SCORE.sno IS NULL;\n```\n\nâç±äºSTUDENT.sno = SCORE.snoæ¯ä¸¥æ ¼çï¼èä¸æ¯è¿æ¥æ¡ä»¶ï¼è¿æ ·å¨è¿æ¥çè¿ç¨ä¸­ä»ä¼å°å¨STUDENTè¡¨åSCOREè¡¨ä¸­åæçNULLå¼å»é¤æï¼åèç±äºSOCRE.sno IS NULLæ¯è¿æ»¤æ¡ä»¶ï¼å®èµ·å°äºè¿æ»¤ä½ç¨ï¼ä¼å°å¤è¿æ¥è¡¥åNULLå¼çæ°æ®å¨é¨ä¿çä¸æ¥ï¼è¿ä¸ªè¯­å¥çæ§è¡ç»æå®éä¸å°±ç¸å½äºåäºä¸ä¸ªAnti Joinï¼å æ­¤è¿ä¸ªè¯­å¥å¯ä»¥è½¬æ¢æä¸ºAnti Joinï¼å®è½¬æ¢çç»æç¸å½äºä¸é¢è¿ä¸ªè¯­å¥ãâå¤§æå¨çµèä¸æ²åºäºç­ä»·è¯­å¥ï¼åªåªåªããã\n\n```\nSELECT * FROM STUDENT ANTI JOIN SCORE ON STUDENT.sno = SCORE.sno\n```\n\nâä¸è¿éè¦æ³¨æï¼SQLè¯­æ³ä¸­æ¯æ²¡æANTI JOINçï¼è¿åªæ¯ä¸ä¸ªç­ä»·çè¯­å¥ï¼ä½æ¯å®æ æ³ç´æ¥æ§è¡ãå¦å¤å¨å¤è¿æ¥æ¶é¤çé¶æ®µè¿æä¸ä¸ªâå¾éå¤§âçä¸¾æªï¼å°±æ¯æå·¦å¤è¿æ¥å¨é¨è½¬æ¢æäºå³å¤è¿æ¥ï¼è¿æ ·å°±å¯ä»¥å¨åç»­çä»£ç ä¸­å°å¤çä¸ç§æåµï¼ç®åäºåé¢çä»£ç é»è¾ãâ\n\nâä¸¥æ ¼æç¶æ¯å¤ªæç¨äºï¼å¯æ¯ææä¹ç¥éä¸ä¸ªè¡¨è¾¾å¼æ¯ä¸æ¯ä¸¥æ ¼å¢ï¼â\n\nâå¯¹äºå½æ°èè¨ï¼å¨PG_PROCç³»ç»è¡¨ä¸­çproisstrictåå±æ§ä»£è¡¨äºå½åå½æ°æ¯å¦ä¸¥æ ¼ï¼å¦ææ¯æä½ç¬¦è¡¨è¾¾å¼ï¼å¨PostgreSQLæ°æ®åºä¸­æä½ç¬¦å®éé½è½¬æäºå¯¹åºçå½æ°ï¼å æ­¤ä¹å¯ä»¥ç¨proisstrictæ¥è¡¨ç¤ºæ¯å¦ä¸¥æ ¼ï¼èå¯¹åºäºIS [NOT] NULLäº§ççNullTestè¡¨è¾¾å¼éè¦åç¬å¤çï¼å¶ä¸­IS NOT NULLæ¯ä¸¥æ ¼çï¼IS NULLæ¯ä¸ä¸¥æ ¼çï¼å¤§ä½ä¸æä»¬å¯ä»¥åæè¿ä¹å ç±»ãâ\n\nå°ææè§èªå·±ä»å¤©å¥½åå­¦å°äºå¥½å¤ç¥è¯ï¼å¹¸å¥½èªå·±æä¸ªå¥å¥ï¼ä¸ç¶å¾é¾æäººè¿ä¹æèªå·±ï¼äºæ¯åèªåå¿çè¯´ï¼âOKï¼æåå¢å äºæ°çç¥è¯ï¼è°¢è°¢ãâ\n\nâä¸è¦è°¢æï¼ææ¯é·éï¼æä»¬é½æ¯å¨ä¸ºä¸­åä¹å´èµ·èè¯»ä¹¦ï¼æ³æ³æä»¬å¯æ¯ç¤¾ä¼ä¸»ä¹æ¥ç­äººåãããâå¤§ææè§èªå·±è¸åçä»¿ä½æçº¢é¢å·¾å¨è¿é£é£æ¬ï¼èä¸æ´å é²è³äºã\n","source":"_posts/postgresql-optimizer-outline-5.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(5) - ä¸¥æ ¼è¦æ±èªå·±\ndate: 2020-08-14 23:40:53\n---\n\nå°æè¢«å¤§æå°äºä¸åï¼äºæ¯å¿éå¼å§åè®¡èµ·æ¥ï¼åå¦æ¯å¤è¿æ¥ï¼å¯è½ä¼å¯¹æä¸æ¹è¡¥NULLå¼ï¼è¿æ ·çè¯TEACHER.tno = COURSE.tnoè¿æ ·ççº¦ææ¡ä»¶å°±æ æ³ææç­ä»·ç±»äºåï¼ç¶åå°å¨çµèä¸é»é»çæ²äºä¸ä¸ªSQLè¯­å¥ï¼<!-- more -->\n\n```\nSELECT sname FROM TEACHER t LEFT JOIN COURSE c ON t.tno = 5 AND t.tno = c.tno;\n```\n\nç¶åå°æåç°ä¸ä½ç­ä»·ç±»å¯è½äº§çä¸äºäºï¼èä¸éæ©ä¸æ¨ä¹æ æ³è¿è¡äºï¼äºæ¯è¯´ï¼âè¿ä¸ªè¯­å¥ä¸­çTEACHER.tno=5ä¸è½ä¸æ¨äºï¼å ä¸ºå·¦è¿æ¥çè¯­ä¹æ¯å¤è¡¨çææçæ°æ®é½è¦è¾åºåºæ¥ï¼å¦ææTEACHER.tno=5ä¸æ¨å°TEACHERè¡¨ä¸ï¼é£å°±ä¼å¨åå·¦è¿æ¥ä¹ååå¯¹TEACHERè¡¨åè¿æ»¤ï¼å¯¼è´æ¥è¯¢ç»æçä¸ç­ä»·ï¼èä¸ç±äºè¡¥NULLå¼ï¼ç­ä»·ç±»ä¹çæä¸äºäºãâ\n\nå¤§æè¯´ï¼âå¯¹çï¼å°æåå­¦ä½ çè§£çå¾å¿«ï¼ç±äºå¤è¿æ¥è¡¥NULLå¼çå³ç³»ï¼ç¡®å®å¯¼è´æ æ³åè°è¯ä¸æ¨ï¼ä¸è¿ä½ å¯ä»¥çä¸ä¸ä¸é¢çè¿ä¸ªè¯­å¥ï¼ççæä»ä¹åºå«ãâç¶åå¤§æå¨çµèéè¾å¥äºå¦ä¸ä¸ªç±»ä¼¼çSQLè¯­å¥ï¼\n\n```\nSELECT sname FROM TEACHER t LEFT JOIN COURSE c ON TRUE WHERE t.tno = 5 AND t.tno = c.tno;\n```\n\nå°æä»ç»çè§å¯ä¸é¢çä¾å¥åå½åè¿ä¸ªä¾å¥ï¼åç°çº¦ææ¡ä»¶ä¸ä¸ªå¤å¨ONåé¢ï¼å¦ä¸ä¸ªæ¯å¤å¨WHEREåé¢ï¼å°æå¥½åè¿ä¸æ¯å¾çè§£ä»ä»¬çå«ä¹ï¼äºæ¯åå¤§ææå»äºå¨è¯¢çç®åãå¤§æè¯´ï¼âæä»¬ç²ç¥çåä¸ä¸ï¼ONåé¢ççº¦ææ¡ä»¶æ¯è¿æ¥æ¡ä»¶ï¼WHEREåé¢ççº¦ææ¡ä»¶æ¯è¿æ»¤æ¡ä»¶ï¼è¿æ¥æ¡ä»¶åè¿æ»¤æ¡ä»¶æ¯ä¸åçãâ\n\nå°æå¥½åæå°äºä»ä¹ï¼æ¢çè¯´ï¼âæç¥éäºï¼ä¸ä¸ªæ¯è¿æ¥ä¸­çï¼ä¸ä¸ªæ¯è¿æ¥åçï¼å¯ä»¥è¿ä¹çè§£å§ï¼ä½ çï¼è¿æ¥æ¡ä»¶ä¼åä¸å°è¿æ¥æä½çè¿ç¨ä¸­ï¼æ»¡è¶³è¿æ¥æ¡ä»¶çä¼æ¾ç¤ºåºæ¥ï¼ä¸æ»¡è¶³è¿æ¥æ¡ä»¶çï¼æ ¹æ®è¿æ¥çç±»åè¿ä¼å³å®æ¯å¦è¡¥NULLå¼ï¼èè¿æ»¤æ¡ä»¶æ¯å¨è¿æ¥æä½ä¹åå¯¹è¿æ¥çç»æè¿è¡è¿æ»¤ãããâå°æåå¯¹å¤§ææå»äºæå¾çç¼ç¥ï¼è¿ç§ç¼ç¥æ¯ææå¾å°ä¸ç¹è¯å®ï¼å¤§æç¬çè¯´ï¼âå¯¹ï¼å¯ä»¥è¿ä¹çè§£ãâ\n\nå°æèµ¶ç´§è¯´ï¼âä½ åå«è®²ï¼è®©æççè¿ä¸ªå¸¦æè¿æ»¤æ¡ä»¶çSQLè¯­å¥æ¯ä¸æ¯è½ä¸æ¨ãâï¼ç¶åå°æå¯¹çè¿ä¸ªSQLè¯­å¥ä»ç»è§å¯èµ·æ¥ï¼å£ä¸­å¿µå¿µæè¯ï¼ä¼¼ä¹æ¯å·²ç»èµ°ç«å¥é­äºã\n\nå°æè§å¯äºåå¤©ï¼å¥½æ æ¶è·ï¼åªå¥½è¯´ï¼âæææä¸ç®ï¼è§å¾è¿ä¸ªçº¦ææ¡ä»¶æ¯è½ä¸æ¨çï¼èä¸ç­ä»·ç±»ä¹è½å»ºç«èµ·æ¥ãâ\n\nâä¸ºä»ä¹ï¼âå¤§æè¿½é®éã\n\nâä¸ä¸ºä»ä¹ï¼æèæµ·ä¸­çµåä¹ç°ï¼ææ¯ä¸ä¸ªä½ç³»çç¨åºåãâ\n\nâä½ æç¶æ²¡æäººççå­å¸ï¼æ³å¿ä½ å³ä½¿æäººçå­å¸ï¼ä½ ä¹æç¾è»äºå­ç»æ£æäºãâ\n\nå°æç¬çè¯´ï¼âæ¯çï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåãããâ\n\nå¤§æçå°æç«ç¶å±èµ·äºæ­ï¼æ¤æçè¯´ï¼âä¸è¦è¡é¹ï¼åè¡é¹æå°±è®©ä½ ä¸æ¯æ¬èªç±ï¼ä¸æ¯æ¬æ­»äº¡ãããâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âå®éä¸è¿éè¿æä¸ä¸ªä¸¥æ ¼çæ¦å¿µï¼ä»ä¹å«ä¸¥æ ¼å¢ï¼ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦æå®çè¾å¥æ¯NULLå¹¶ä¸è¾åºä¹æ¯NULLï¼é£ä¹æä»¬å°±è¯´è¿ä¸ªè¡¨è¾¾å¼æ¯ä¸¥æ ¼çï¼å¦å¤æä»¬å¯ä»¥æ©å±ä¸ä¸ä¸¥æ ¼çå®ä¹ï¼ä»èå®ä¹åºä¸ä¸ªå«åâå®½æ³çä¸¥æ ¼âçæ¦å¿µï¼å°±æ¯è¯´å¦æä¸ä¸ªè¡¨è¾¾å¼å®çè¾å¥æ¯NULLï¼å®çè¾åºæ¯NULLæèfalseï¼é£ä¹æä»¬å°±è¯´å®ç¬¦åå®½æ³çä¸¥æ ¼ãâ\n\nâé£ä¹ä¸¥æ ¼æä»ä¹ç¨å¢ï¼â\n\nâå¦æå¯¹ä¸ä¸ªåç»åºç¨çº¦ææ¡ä»¶ï¼å¦æçº¦ææ¡ä»¶æ±å¼è¿åçæ¯NULLå¼æèFALSEï¼å®éä¸ä»£è¡¨çæ¯è¿ä¸æ¡åç»ä¸è¾åºï¼æç½åï¼â\nâå¦ï¼é£å°±æ¯è¯´æä»¬è¡¥çNULLå¼å¦æéå°è¿ç§è¿æ»¤æ¡ä»¶ï¼å°±ä¸ä¼è¾åºåºæ¥å½ãâå°æåäºä¸ä¸ï¼çªç¶æ³å°äºäºä»ä¹ï¼ç»§ç»­é®éï¼âé£è¿ç§å¤è¿æ¥è¿è¡¥NULLå¼å¹²åï¼å²ä¸æ¯æ²¡æä»ä¹åµç¨äºï¼â\n\nâå¯¹å¤´ï¼è¿å°±æ¯å¤è¿æ¥æ¶é¤çåºæ¬åçï¼éä¸è¿ç§ä¸¥æ ¼ççº¦ææ¡ä»¶ï¼å¤è¿æ¥è¡¥çNULLå¼æ²¡æä»ä¹ç¨ï¼é£ä¹å°±è½¬åæåè¿æ¥å°±å¥½äºãé®é¢æ¥äºï¼å¦æåæäºåè¿æ¥ï¼æä»¬åè½èæå¦ä¸ºçéæ©ä¸æ¨ãæ²¡ç¾æ²¡èçåç­ä»·æ¨çäºï¼æä¸æåï¼æä¸æå¤ï¼â\n\nâååï¼é£ä½ è½ç»æä¸ä¸ªä¸ä¸¥æ ¼çä¾å­ä¸ï¼è®©æè§è¯ä¸ä¸ä¸ä¸¥æ ¼çè¡¨è¾¾å¼ãâ\n\nâæ¯å¦è¯´IS NOT NULLï¼è¾å¥æ¯NULLå¼ï¼è¾åºç«ç¶æ¯TRUEï¼è¿æCOALESCEå½æ°ï¼è¾å¥æ¯NULLå¼ï¼è¾åºæ¯å¥éä½ å®ãâ\n\nå°æè¯´ï¼âçæ¥è¡¨è¾¾å¼æ¯å¦ä¸¥æ ¼æ¯å¾éè¦çä¸ä¸ªæ¦å¿µï¼éè¿è¿ä¸ªæ¦å¿µæä»¬è½åå¤è¿æ¥æ¶é¤ï¼å¤è¿æ¥æ¶é¤åè½å¤å¯¼è´éæ©è½å¤ä¸æ¨ãããè¿æå°±æç½äºä¸ºä»ä¹è¦åå¤è¿æ¥æ¶é¤äºãâ\n\nâå¯ï¼å¤è¿æ¥æ¶é¤ä¸åªæ¯å°å¤è¿æ¥è½¬æ¢æåè¿æ¥ï¼å¶å®è¿æä¸ç§æåµï¼å®ä¹åæä»¬è¦è¯´çè¡¨è¾¾å¼çæ¡ä»¶æ¯å¦ä¸¥æ ¼æå³ï¼é£å°±æ¯å¯ä»¥å°å¤è¿æ¥è½¬æ¢æAntiJoinï¼æä»¬æ¥çè¿æ ·ä¸ä¸ªä¾å­ãâ\n\n```\nSELECT * FROM STUDENT LEFT JOIN SCORE ON STUDENT.sno = SCORE.sno WHERE SCORE.sno IS NULL;\n```\n\nâç±äºSTUDENT.sno = SCORE.snoæ¯ä¸¥æ ¼çï¼èä¸æ¯è¿æ¥æ¡ä»¶ï¼è¿æ ·å¨è¿æ¥çè¿ç¨ä¸­ä»ä¼å°å¨STUDENTè¡¨åSCOREè¡¨ä¸­åæçNULLå¼å»é¤æï¼åèç±äºSOCRE.sno IS NULLæ¯è¿æ»¤æ¡ä»¶ï¼å®èµ·å°äºè¿æ»¤ä½ç¨ï¼ä¼å°å¤è¿æ¥è¡¥åNULLå¼çæ°æ®å¨é¨ä¿çä¸æ¥ï¼è¿ä¸ªè¯­å¥çæ§è¡ç»æå®éä¸å°±ç¸å½äºåäºä¸ä¸ªAnti Joinï¼å æ­¤è¿ä¸ªè¯­å¥å¯ä»¥è½¬æ¢æä¸ºAnti Joinï¼å®è½¬æ¢çç»æç¸å½äºä¸é¢è¿ä¸ªè¯­å¥ãâå¤§æå¨çµèä¸æ²åºäºç­ä»·è¯­å¥ï¼åªåªåªããã\n\n```\nSELECT * FROM STUDENT ANTI JOIN SCORE ON STUDENT.sno = SCORE.sno\n```\n\nâä¸è¿éè¦æ³¨æï¼SQLè¯­æ³ä¸­æ¯æ²¡æANTI JOINçï¼è¿åªæ¯ä¸ä¸ªç­ä»·çè¯­å¥ï¼ä½æ¯å®æ æ³ç´æ¥æ§è¡ãå¦å¤å¨å¤è¿æ¥æ¶é¤çé¶æ®µè¿æä¸ä¸ªâå¾éå¤§âçä¸¾æªï¼å°±æ¯æå·¦å¤è¿æ¥å¨é¨è½¬æ¢æäºå³å¤è¿æ¥ï¼è¿æ ·å°±å¯ä»¥å¨åç»­çä»£ç ä¸­å°å¤çä¸ç§æåµï¼ç®åäºåé¢çä»£ç é»è¾ãâ\n\nâä¸¥æ ¼æç¶æ¯å¤ªæç¨äºï¼å¯æ¯ææä¹ç¥éä¸ä¸ªè¡¨è¾¾å¼æ¯ä¸æ¯ä¸¥æ ¼å¢ï¼â\n\nâå¯¹äºå½æ°èè¨ï¼å¨PG_PROCç³»ç»è¡¨ä¸­çproisstrictåå±æ§ä»£è¡¨äºå½åå½æ°æ¯å¦ä¸¥æ ¼ï¼å¦ææ¯æä½ç¬¦è¡¨è¾¾å¼ï¼å¨PostgreSQLæ°æ®åºä¸­æä½ç¬¦å®éé½è½¬æäºå¯¹åºçå½æ°ï¼å æ­¤ä¹å¯ä»¥ç¨proisstrictæ¥è¡¨ç¤ºæ¯å¦ä¸¥æ ¼ï¼èå¯¹åºäºIS [NOT] NULLäº§ççNullTestè¡¨è¾¾å¼éè¦åç¬å¤çï¼å¶ä¸­IS NOT NULLæ¯ä¸¥æ ¼çï¼IS NULLæ¯ä¸ä¸¥æ ¼çï¼å¤§ä½ä¸æä»¬å¯ä»¥åæè¿ä¹å ç±»ãâ\n\nå°ææè§èªå·±ä»å¤©å¥½åå­¦å°äºå¥½å¤ç¥è¯ï¼å¹¸å¥½èªå·±æä¸ªå¥å¥ï¼ä¸ç¶å¾é¾æäººè¿ä¹æèªå·±ï¼äºæ¯åèªåå¿çè¯´ï¼âOKï¼æåå¢å äºæ°çç¥è¯ï¼è°¢è°¢ãâ\n\nâä¸è¦è°¢æï¼ææ¯é·éï¼æä»¬é½æ¯å¨ä¸ºä¸­åä¹å´èµ·èè¯»ä¹¦ï¼æ³æ³æä»¬å¯æ¯ç¤¾ä¼ä¸»ä¹æ¥ç­äººåãããâå¤§ææè§èªå·±è¸åçä»¿ä½æçº¢é¢å·¾å¨è¿é£é£æ¬ï¼èä¸æ´å é²è³äºã\n","slug":"postgresql-optimizer-outline-5","published":1,"updated":"2020-08-14T15:45:18.000Z","_id":"ckduejkln0000ox9k0nxvhd01","comments":1,"layout":"post","photos":[],"link":"","content":"<p>å°æè¢«å¤§æå°äºä¸åï¼äºæ¯å¿éå¼å§åè®¡èµ·æ¥ï¼åå¦æ¯å¤è¿æ¥ï¼å¯è½ä¼å¯¹æä¸æ¹è¡¥NULLå¼ï¼è¿æ ·çè¯TEACHER.tno = COURSE.tnoè¿æ ·ççº¦ææ¡ä»¶å°±æ æ³ææç­ä»·ç±»äºåï¼ç¶åå°å¨çµèä¸é»é»çæ²äºä¸ä¸ªSQLè¯­å¥ï¼<a id=\"more\"></a></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t LEFT JOIN COURSE c ON t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æåç°ä¸ä½ç­ä»·ç±»å¯è½äº§çä¸äºäºï¼èä¸éæ©ä¸æ¨ä¹æ æ³è¿è¡äºï¼äºæ¯è¯´ï¼âè¿ä¸ªè¯­å¥ä¸­çTEACHER.tno=5ä¸è½ä¸æ¨äºï¼å ä¸ºå·¦è¿æ¥çè¯­ä¹æ¯å¤è¡¨çææçæ°æ®é½è¦è¾åºåºæ¥ï¼å¦ææTEACHER.tno=5ä¸æ¨å°TEACHERè¡¨ä¸ï¼é£å°±ä¼å¨åå·¦è¿æ¥ä¹ååå¯¹TEACHERè¡¨åè¿æ»¤ï¼å¯¼è´æ¥è¯¢ç»æçä¸ç­ä»·ï¼èä¸ç±äºè¡¥NULLå¼ï¼ç­ä»·ç±»ä¹çæä¸äºäºãâ</p>\n<p>å¤§æè¯´ï¼âå¯¹çï¼å°æåå­¦ä½ çè§£çå¾å¿«ï¼ç±äºå¤è¿æ¥è¡¥NULLå¼çå³ç³»ï¼ç¡®å®å¯¼è´æ æ³åè°è¯ä¸æ¨ï¼ä¸è¿ä½ å¯ä»¥çä¸ä¸ä¸é¢çè¿ä¸ªè¯­å¥ï¼ççæä»ä¹åºå«ãâç¶åå¤§æå¨çµèéè¾å¥äºå¦ä¸ä¸ªç±»ä¼¼çSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t LEFT JOIN COURSE c ON TRUE WHERE t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br></pre></td></tr></table></figure>\n\n<p>å°æä»ç»çè§å¯ä¸é¢çä¾å¥åå½åè¿ä¸ªä¾å¥ï¼åç°çº¦ææ¡ä»¶ä¸ä¸ªå¤å¨ONåé¢ï¼å¦ä¸ä¸ªæ¯å¤å¨WHEREåé¢ï¼å°æå¥½åè¿ä¸æ¯å¾çè§£ä»ä»¬çå«ä¹ï¼äºæ¯åå¤§ææå»äºå¨è¯¢çç®åãå¤§æè¯´ï¼âæä»¬ç²ç¥çåä¸ä¸ï¼ONåé¢ççº¦ææ¡ä»¶æ¯è¿æ¥æ¡ä»¶ï¼WHEREåé¢ççº¦ææ¡ä»¶æ¯è¿æ»¤æ¡ä»¶ï¼è¿æ¥æ¡ä»¶åè¿æ»¤æ¡ä»¶æ¯ä¸åçãâ</p>\n<p>å°æå¥½åæå°äºä»ä¹ï¼æ¢çè¯´ï¼âæç¥éäºï¼ä¸ä¸ªæ¯è¿æ¥ä¸­çï¼ä¸ä¸ªæ¯è¿æ¥åçï¼å¯ä»¥è¿ä¹çè§£å§ï¼ä½ çï¼è¿æ¥æ¡ä»¶ä¼åä¸å°è¿æ¥æä½çè¿ç¨ä¸­ï¼æ»¡è¶³è¿æ¥æ¡ä»¶çä¼æ¾ç¤ºåºæ¥ï¼ä¸æ»¡è¶³è¿æ¥æ¡ä»¶çï¼æ ¹æ®è¿æ¥çç±»åè¿ä¼å³å®æ¯å¦è¡¥NULLå¼ï¼èè¿æ»¤æ¡ä»¶æ¯å¨è¿æ¥æä½ä¹åå¯¹è¿æ¥çç»æè¿è¡è¿æ»¤ãããâå°æåå¯¹å¤§ææå»äºæå¾çç¼ç¥ï¼è¿ç§ç¼ç¥æ¯ææå¾å°ä¸ç¹è¯å®ï¼å¤§æç¬çè¯´ï¼âå¯¹ï¼å¯ä»¥è¿ä¹çè§£ãâ</p>\n<p>å°æèµ¶ç´§è¯´ï¼âä½ åå«è®²ï¼è®©æççè¿ä¸ªå¸¦æè¿æ»¤æ¡ä»¶çSQLè¯­å¥æ¯ä¸æ¯è½ä¸æ¨ãâï¼ç¶åå°æå¯¹çè¿ä¸ªSQLè¯­å¥ä»ç»è§å¯èµ·æ¥ï¼å£ä¸­å¿µå¿µæè¯ï¼ä¼¼ä¹æ¯å·²ç»èµ°ç«å¥é­äºã</p>\n<p>å°æè§å¯äºåå¤©ï¼å¥½æ æ¶è·ï¼åªå¥½è¯´ï¼âæææä¸ç®ï¼è§å¾è¿ä¸ªçº¦ææ¡ä»¶æ¯è½ä¸æ¨çï¼èä¸ç­ä»·ç±»ä¹è½å»ºç«èµ·æ¥ãâ</p>\n<p>âä¸ºä»ä¹ï¼âå¤§æè¿½é®éã</p>\n<p>âä¸ä¸ºä»ä¹ï¼æèæµ·ä¸­çµåä¹ç°ï¼ææ¯ä¸ä¸ªä½ç³»çç¨åºåãâ</p>\n<p>âä½ æç¶æ²¡æäººççå­å¸ï¼æ³å¿ä½ å³ä½¿æäººçå­å¸ï¼ä½ ä¹æç¾è»äºå­ç»æ£æäºãâ</p>\n<p>å°æç¬çè¯´ï¼âæ¯çï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåãããâ</p>\n<p>å¤§æçå°æç«ç¶å±èµ·äºæ­ï¼æ¤æçè¯´ï¼âä¸è¦è¡é¹ï¼åè¡é¹æå°±è®©ä½ ä¸æ¯æ¬èªç±ï¼ä¸æ¯æ¬æ­»äº¡ãããâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âå®éä¸è¿éè¿æä¸ä¸ªä¸¥æ ¼çæ¦å¿µï¼ä»ä¹å«ä¸¥æ ¼å¢ï¼ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦æå®çè¾å¥æ¯NULLå¹¶ä¸è¾åºä¹æ¯NULLï¼é£ä¹æä»¬å°±è¯´è¿ä¸ªè¡¨è¾¾å¼æ¯ä¸¥æ ¼çï¼å¦å¤æä»¬å¯ä»¥æ©å±ä¸ä¸ä¸¥æ ¼çå®ä¹ï¼ä»èå®ä¹åºä¸ä¸ªå«åâå®½æ³çä¸¥æ ¼âçæ¦å¿µï¼å°±æ¯è¯´å¦æä¸ä¸ªè¡¨è¾¾å¼å®çè¾å¥æ¯NULLï¼å®çè¾åºæ¯NULLæèfalseï¼é£ä¹æä»¬å°±è¯´å®ç¬¦åå®½æ³çä¸¥æ ¼ãâ</p>\n<p>âé£ä¹ä¸¥æ ¼æä»ä¹ç¨å¢ï¼â</p>\n<p>âå¦æå¯¹ä¸ä¸ªåç»åºç¨çº¦ææ¡ä»¶ï¼å¦æçº¦ææ¡ä»¶æ±å¼è¿åçæ¯NULLå¼æèFALSEï¼å®éä¸ä»£è¡¨çæ¯è¿ä¸æ¡åç»ä¸è¾åºï¼æç½åï¼â<br>âå¦ï¼é£å°±æ¯è¯´æä»¬è¡¥çNULLå¼å¦æéå°è¿ç§è¿æ»¤æ¡ä»¶ï¼å°±ä¸ä¼è¾åºåºæ¥å½ãâå°æåäºä¸ä¸ï¼çªç¶æ³å°äºäºä»ä¹ï¼ç»§ç»­é®éï¼âé£è¿ç§å¤è¿æ¥è¿è¡¥NULLå¼å¹²åï¼å²ä¸æ¯æ²¡æä»ä¹åµç¨äºï¼â</p>\n<p>âå¯¹å¤´ï¼è¿å°±æ¯å¤è¿æ¥æ¶é¤çåºæ¬åçï¼éä¸è¿ç§ä¸¥æ ¼ççº¦ææ¡ä»¶ï¼å¤è¿æ¥è¡¥çNULLå¼æ²¡æä»ä¹ç¨ï¼é£ä¹å°±è½¬åæåè¿æ¥å°±å¥½äºãé®é¢æ¥äºï¼å¦æåæäºåè¿æ¥ï¼æä»¬åè½èæå¦ä¸ºçéæ©ä¸æ¨ãæ²¡ç¾æ²¡èçåç­ä»·æ¨çäºï¼æä¸æåï¼æä¸æå¤ï¼â</p>\n<p>âååï¼é£ä½ è½ç»æä¸ä¸ªä¸ä¸¥æ ¼çä¾å­ä¸ï¼è®©æè§è¯ä¸ä¸ä¸ä¸¥æ ¼çè¡¨è¾¾å¼ãâ</p>\n<p>âæ¯å¦è¯´IS NOT NULLï¼è¾å¥æ¯NULLå¼ï¼è¾åºç«ç¶æ¯TRUEï¼è¿æCOALESCEå½æ°ï¼è¾å¥æ¯NULLå¼ï¼è¾åºæ¯å¥éä½ å®ãâ</p>\n<p>å°æè¯´ï¼âçæ¥è¡¨è¾¾å¼æ¯å¦ä¸¥æ ¼æ¯å¾éè¦çä¸ä¸ªæ¦å¿µï¼éè¿è¿ä¸ªæ¦å¿µæä»¬è½åå¤è¿æ¥æ¶é¤ï¼å¤è¿æ¥æ¶é¤åè½å¤å¯¼è´éæ©è½å¤ä¸æ¨ãããè¿æå°±æç½äºä¸ºä»ä¹è¦åå¤è¿æ¥æ¶é¤äºãâ</p>\n<p>âå¯ï¼å¤è¿æ¥æ¶é¤ä¸åªæ¯å°å¤è¿æ¥è½¬æ¢æåè¿æ¥ï¼å¶å®è¿æä¸ç§æåµï¼å®ä¹åæä»¬è¦è¯´çè¡¨è¾¾å¼çæ¡ä»¶æ¯å¦ä¸¥æ ¼æå³ï¼é£å°±æ¯å¯ä»¥å°å¤è¿æ¥è½¬æ¢æAntiJoinï¼æä»¬æ¥çè¿æ ·ä¸ä¸ªä¾å­ãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT LEFT JOIN SCORE ON STUDENT.sno &#x3D; SCORE.sno WHERE SCORE.sno IS NULL;</span><br></pre></td></tr></table></figure>\n\n<p>âç±äºSTUDENT.sno = SCORE.snoæ¯ä¸¥æ ¼çï¼èä¸æ¯è¿æ¥æ¡ä»¶ï¼è¿æ ·å¨è¿æ¥çè¿ç¨ä¸­ä»ä¼å°å¨STUDENTè¡¨åSCOREè¡¨ä¸­åæçNULLå¼å»é¤æï¼åèç±äºSOCRE.sno IS NULLæ¯è¿æ»¤æ¡ä»¶ï¼å®èµ·å°äºè¿æ»¤ä½ç¨ï¼ä¼å°å¤è¿æ¥è¡¥åNULLå¼çæ°æ®å¨é¨ä¿çä¸æ¥ï¼è¿ä¸ªè¯­å¥çæ§è¡ç»æå®éä¸å°±ç¸å½äºåäºä¸ä¸ªAnti Joinï¼å æ­¤è¿ä¸ªè¯­å¥å¯ä»¥è½¬æ¢æä¸ºAnti Joinï¼å®è½¬æ¢çç»æç¸å½äºä¸é¢è¿ä¸ªè¯­å¥ãâå¤§æå¨çµèä¸æ²åºäºç­ä»·è¯­å¥ï¼åªåªåªããã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT ANTI JOIN SCORE ON STUDENT.sno &#x3D; SCORE.sno</span><br></pre></td></tr></table></figure>\n\n<p>âä¸è¿éè¦æ³¨æï¼SQLè¯­æ³ä¸­æ¯æ²¡æANTI JOINçï¼è¿åªæ¯ä¸ä¸ªç­ä»·çè¯­å¥ï¼ä½æ¯å®æ æ³ç´æ¥æ§è¡ãå¦å¤å¨å¤è¿æ¥æ¶é¤çé¶æ®µè¿æä¸ä¸ªâå¾éå¤§âçä¸¾æªï¼å°±æ¯æå·¦å¤è¿æ¥å¨é¨è½¬æ¢æäºå³å¤è¿æ¥ï¼è¿æ ·å°±å¯ä»¥å¨åç»­çä»£ç ä¸­å°å¤çä¸ç§æåµï¼ç®åäºåé¢çä»£ç é»è¾ãâ</p>\n<p>âä¸¥æ ¼æç¶æ¯å¤ªæç¨äºï¼å¯æ¯ææä¹ç¥éä¸ä¸ªè¡¨è¾¾å¼æ¯ä¸æ¯ä¸¥æ ¼å¢ï¼â</p>\n<p>âå¯¹äºå½æ°èè¨ï¼å¨PG_PROCç³»ç»è¡¨ä¸­çproisstrictåå±æ§ä»£è¡¨äºå½åå½æ°æ¯å¦ä¸¥æ ¼ï¼å¦ææ¯æä½ç¬¦è¡¨è¾¾å¼ï¼å¨PostgreSQLæ°æ®åºä¸­æä½ç¬¦å®éé½è½¬æäºå¯¹åºçå½æ°ï¼å æ­¤ä¹å¯ä»¥ç¨proisstrictæ¥è¡¨ç¤ºæ¯å¦ä¸¥æ ¼ï¼èå¯¹åºäºIS [NOT] NULLäº§ççNullTestè¡¨è¾¾å¼éè¦åç¬å¤çï¼å¶ä¸­IS NOT NULLæ¯ä¸¥æ ¼çï¼IS NULLæ¯ä¸ä¸¥æ ¼çï¼å¤§ä½ä¸æä»¬å¯ä»¥åæè¿ä¹å ç±»ãâ</p>\n<p>å°ææè§èªå·±ä»å¤©å¥½åå­¦å°äºå¥½å¤ç¥è¯ï¼å¹¸å¥½èªå·±æä¸ªå¥å¥ï¼ä¸ç¶å¾é¾æäººè¿ä¹æèªå·±ï¼äºæ¯åèªåå¿çè¯´ï¼âOKï¼æåå¢å äºæ°çç¥è¯ï¼è°¢è°¢ãâ</p>\n<p>âä¸è¦è°¢æï¼ææ¯é·éï¼æä»¬é½æ¯å¨ä¸ºä¸­åä¹å´èµ·èè¯»ä¹¦ï¼æ³æ³æä»¬å¯æ¯ç¤¾ä¼ä¸»ä¹æ¥ç­äººåãããâå¤§ææè§èªå·±è¸åçä»¿ä½æçº¢é¢å·¾å¨è¿é£é£æ¬ï¼èä¸æ´å é²è³äºã</p>\n","site":{"data":{}},"excerpt":"<p>å°æè¢«å¤§æå°äºä¸åï¼äºæ¯å¿éå¼å§åè®¡èµ·æ¥ï¼åå¦æ¯å¤è¿æ¥ï¼å¯è½ä¼å¯¹æä¸æ¹è¡¥NULLå¼ï¼è¿æ ·çè¯TEACHER.tno = COURSE.tnoè¿æ ·ççº¦ææ¡ä»¶å°±æ æ³ææç­ä»·ç±»äºåï¼ç¶åå°å¨çµèä¸é»é»çæ²äºä¸ä¸ªSQLè¯­å¥ï¼</p>","more":"<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t LEFT JOIN COURSE c ON t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æåç°ä¸ä½ç­ä»·ç±»å¯è½äº§çä¸äºäºï¼èä¸éæ©ä¸æ¨ä¹æ æ³è¿è¡äºï¼äºæ¯è¯´ï¼âè¿ä¸ªè¯­å¥ä¸­çTEACHER.tno=5ä¸è½ä¸æ¨äºï¼å ä¸ºå·¦è¿æ¥çè¯­ä¹æ¯å¤è¡¨çææçæ°æ®é½è¦è¾åºåºæ¥ï¼å¦ææTEACHER.tno=5ä¸æ¨å°TEACHERè¡¨ä¸ï¼é£å°±ä¼å¨åå·¦è¿æ¥ä¹ååå¯¹TEACHERè¡¨åè¿æ»¤ï¼å¯¼è´æ¥è¯¢ç»æçä¸ç­ä»·ï¼èä¸ç±äºè¡¥NULLå¼ï¼ç­ä»·ç±»ä¹çæä¸äºäºãâ</p>\n<p>å¤§æè¯´ï¼âå¯¹çï¼å°æåå­¦ä½ çè§£çå¾å¿«ï¼ç±äºå¤è¿æ¥è¡¥NULLå¼çå³ç³»ï¼ç¡®å®å¯¼è´æ æ³åè°è¯ä¸æ¨ï¼ä¸è¿ä½ å¯ä»¥çä¸ä¸ä¸é¢çè¿ä¸ªè¯­å¥ï¼ççæä»ä¹åºå«ãâç¶åå¤§æå¨çµèéè¾å¥äºå¦ä¸ä¸ªç±»ä¼¼çSQLè¯­å¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT sname FROM TEACHER t LEFT JOIN COURSE c ON TRUE WHERE t.tno &#x3D; 5 AND t.tno &#x3D; c.tno;</span><br></pre></td></tr></table></figure>\n\n<p>å°æä»ç»çè§å¯ä¸é¢çä¾å¥åå½åè¿ä¸ªä¾å¥ï¼åç°çº¦ææ¡ä»¶ä¸ä¸ªå¤å¨ONåé¢ï¼å¦ä¸ä¸ªæ¯å¤å¨WHEREåé¢ï¼å°æå¥½åè¿ä¸æ¯å¾çè§£ä»ä»¬çå«ä¹ï¼äºæ¯åå¤§ææå»äºå¨è¯¢çç®åãå¤§æè¯´ï¼âæä»¬ç²ç¥çåä¸ä¸ï¼ONåé¢ççº¦ææ¡ä»¶æ¯è¿æ¥æ¡ä»¶ï¼WHEREåé¢ççº¦ææ¡ä»¶æ¯è¿æ»¤æ¡ä»¶ï¼è¿æ¥æ¡ä»¶åè¿æ»¤æ¡ä»¶æ¯ä¸åçãâ</p>\n<p>å°æå¥½åæå°äºä»ä¹ï¼æ¢çè¯´ï¼âæç¥éäºï¼ä¸ä¸ªæ¯è¿æ¥ä¸­çï¼ä¸ä¸ªæ¯è¿æ¥åçï¼å¯ä»¥è¿ä¹çè§£å§ï¼ä½ çï¼è¿æ¥æ¡ä»¶ä¼åä¸å°è¿æ¥æä½çè¿ç¨ä¸­ï¼æ»¡è¶³è¿æ¥æ¡ä»¶çä¼æ¾ç¤ºåºæ¥ï¼ä¸æ»¡è¶³è¿æ¥æ¡ä»¶çï¼æ ¹æ®è¿æ¥çç±»åè¿ä¼å³å®æ¯å¦è¡¥NULLå¼ï¼èè¿æ»¤æ¡ä»¶æ¯å¨è¿æ¥æä½ä¹åå¯¹è¿æ¥çç»æè¿è¡è¿æ»¤ãããâå°æåå¯¹å¤§ææå»äºæå¾çç¼ç¥ï¼è¿ç§ç¼ç¥æ¯ææå¾å°ä¸ç¹è¯å®ï¼å¤§æç¬çè¯´ï¼âå¯¹ï¼å¯ä»¥è¿ä¹çè§£ãâ</p>\n<p>å°æèµ¶ç´§è¯´ï¼âä½ åå«è®²ï¼è®©æççè¿ä¸ªå¸¦æè¿æ»¤æ¡ä»¶çSQLè¯­å¥æ¯ä¸æ¯è½ä¸æ¨ãâï¼ç¶åå°æå¯¹çè¿ä¸ªSQLè¯­å¥ä»ç»è§å¯èµ·æ¥ï¼å£ä¸­å¿µå¿µæè¯ï¼ä¼¼ä¹æ¯å·²ç»èµ°ç«å¥é­äºã</p>\n<p>å°æè§å¯äºåå¤©ï¼å¥½æ æ¶è·ï¼åªå¥½è¯´ï¼âæææä¸ç®ï¼è§å¾è¿ä¸ªçº¦ææ¡ä»¶æ¯è½ä¸æ¨çï¼èä¸ç­ä»·ç±»ä¹è½å»ºç«èµ·æ¥ãâ</p>\n<p>âä¸ºä»ä¹ï¼âå¤§æè¿½é®éã</p>\n<p>âä¸ä¸ºä»ä¹ï¼æèæµ·ä¸­çµåä¹ç°ï¼ææ¯ä¸ä¸ªä½ç³»çç¨åºåãâ</p>\n<p>âä½ æç¶æ²¡æäººççå­å¸ï¼æ³å¿ä½ å³ä½¿æäººçå­å¸ï¼ä½ ä¹æç¾è»äºå­ç»æ£æäºãâ</p>\n<p>å°æç¬çè¯´ï¼âæ¯çï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåãããâ</p>\n<p>å¤§æçå°æç«ç¶å±èµ·äºæ­ï¼æ¤æçè¯´ï¼âä¸è¦è¡é¹ï¼åè¡é¹æå°±è®©ä½ ä¸æ¯æ¬èªç±ï¼ä¸æ¯æ¬æ­»äº¡ãããâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âå®éä¸è¿éè¿æä¸ä¸ªä¸¥æ ¼çæ¦å¿µï¼ä»ä¹å«ä¸¥æ ¼å¢ï¼ä¸ä¸ªè¡¨è¾¾å¼ï¼å¦æå®çè¾å¥æ¯NULLå¹¶ä¸è¾åºä¹æ¯NULLï¼é£ä¹æä»¬å°±è¯´è¿ä¸ªè¡¨è¾¾å¼æ¯ä¸¥æ ¼çï¼å¦å¤æä»¬å¯ä»¥æ©å±ä¸ä¸ä¸¥æ ¼çå®ä¹ï¼ä»èå®ä¹åºä¸ä¸ªå«åâå®½æ³çä¸¥æ ¼âçæ¦å¿µï¼å°±æ¯è¯´å¦æä¸ä¸ªè¡¨è¾¾å¼å®çè¾å¥æ¯NULLï¼å®çè¾åºæ¯NULLæèfalseï¼é£ä¹æä»¬å°±è¯´å®ç¬¦åå®½æ³çä¸¥æ ¼ãâ</p>\n<p>âé£ä¹ä¸¥æ ¼æä»ä¹ç¨å¢ï¼â</p>\n<p>âå¦æå¯¹ä¸ä¸ªåç»åºç¨çº¦ææ¡ä»¶ï¼å¦æçº¦ææ¡ä»¶æ±å¼è¿åçæ¯NULLå¼æèFALSEï¼å®éä¸ä»£è¡¨çæ¯è¿ä¸æ¡åç»ä¸è¾åºï¼æç½åï¼â<br>âå¦ï¼é£å°±æ¯è¯´æä»¬è¡¥çNULLå¼å¦æéå°è¿ç§è¿æ»¤æ¡ä»¶ï¼å°±ä¸ä¼è¾åºåºæ¥å½ãâå°æåäºä¸ä¸ï¼çªç¶æ³å°äºäºä»ä¹ï¼ç»§ç»­é®éï¼âé£è¿ç§å¤è¿æ¥è¿è¡¥NULLå¼å¹²åï¼å²ä¸æ¯æ²¡æä»ä¹åµç¨äºï¼â</p>\n<p>âå¯¹å¤´ï¼è¿å°±æ¯å¤è¿æ¥æ¶é¤çåºæ¬åçï¼éä¸è¿ç§ä¸¥æ ¼ççº¦ææ¡ä»¶ï¼å¤è¿æ¥è¡¥çNULLå¼æ²¡æä»ä¹ç¨ï¼é£ä¹å°±è½¬åæåè¿æ¥å°±å¥½äºãé®é¢æ¥äºï¼å¦æåæäºåè¿æ¥ï¼æä»¬åè½èæå¦ä¸ºçéæ©ä¸æ¨ãæ²¡ç¾æ²¡èçåç­ä»·æ¨çäºï¼æä¸æåï¼æä¸æå¤ï¼â</p>\n<p>âååï¼é£ä½ è½ç»æä¸ä¸ªä¸ä¸¥æ ¼çä¾å­ä¸ï¼è®©æè§è¯ä¸ä¸ä¸ä¸¥æ ¼çè¡¨è¾¾å¼ãâ</p>\n<p>âæ¯å¦è¯´IS NOT NULLï¼è¾å¥æ¯NULLå¼ï¼è¾åºç«ç¶æ¯TRUEï¼è¿æCOALESCEå½æ°ï¼è¾å¥æ¯NULLå¼ï¼è¾åºæ¯å¥éä½ å®ãâ</p>\n<p>å°æè¯´ï¼âçæ¥è¡¨è¾¾å¼æ¯å¦ä¸¥æ ¼æ¯å¾éè¦çä¸ä¸ªæ¦å¿µï¼éè¿è¿ä¸ªæ¦å¿µæä»¬è½åå¤è¿æ¥æ¶é¤ï¼å¤è¿æ¥æ¶é¤åè½å¤å¯¼è´éæ©è½å¤ä¸æ¨ãããè¿æå°±æç½äºä¸ºä»ä¹è¦åå¤è¿æ¥æ¶é¤äºãâ</p>\n<p>âå¯ï¼å¤è¿æ¥æ¶é¤ä¸åªæ¯å°å¤è¿æ¥è½¬æ¢æåè¿æ¥ï¼å¶å®è¿æä¸ç§æåµï¼å®ä¹åæä»¬è¦è¯´çè¡¨è¾¾å¼çæ¡ä»¶æ¯å¦ä¸¥æ ¼æå³ï¼é£å°±æ¯å¯ä»¥å°å¤è¿æ¥è½¬æ¢æAntiJoinï¼æä»¬æ¥çè¿æ ·ä¸ä¸ªä¾å­ãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT LEFT JOIN SCORE ON STUDENT.sno &#x3D; SCORE.sno WHERE SCORE.sno IS NULL;</span><br></pre></td></tr></table></figure>\n\n<p>âç±äºSTUDENT.sno = SCORE.snoæ¯ä¸¥æ ¼çï¼èä¸æ¯è¿æ¥æ¡ä»¶ï¼è¿æ ·å¨è¿æ¥çè¿ç¨ä¸­ä»ä¼å°å¨STUDENTè¡¨åSCOREè¡¨ä¸­åæçNULLå¼å»é¤æï¼åèç±äºSOCRE.sno IS NULLæ¯è¿æ»¤æ¡ä»¶ï¼å®èµ·å°äºè¿æ»¤ä½ç¨ï¼ä¼å°å¤è¿æ¥è¡¥åNULLå¼çæ°æ®å¨é¨ä¿çä¸æ¥ï¼è¿ä¸ªè¯­å¥çæ§è¡ç»æå®éä¸å°±ç¸å½äºåäºä¸ä¸ªAnti Joinï¼å æ­¤è¿ä¸ªè¯­å¥å¯ä»¥è½¬æ¢æä¸ºAnti Joinï¼å®è½¬æ¢çç»æç¸å½äºä¸é¢è¿ä¸ªè¯­å¥ãâå¤§æå¨çµèä¸æ²åºäºç­ä»·è¯­å¥ï¼åªåªåªããã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM STUDENT ANTI JOIN SCORE ON STUDENT.sno &#x3D; SCORE.sno</span><br></pre></td></tr></table></figure>\n\n<p>âä¸è¿éè¦æ³¨æï¼SQLè¯­æ³ä¸­æ¯æ²¡æANTI JOINçï¼è¿åªæ¯ä¸ä¸ªç­ä»·çè¯­å¥ï¼ä½æ¯å®æ æ³ç´æ¥æ§è¡ãå¦å¤å¨å¤è¿æ¥æ¶é¤çé¶æ®µè¿æä¸ä¸ªâå¾éå¤§âçä¸¾æªï¼å°±æ¯æå·¦å¤è¿æ¥å¨é¨è½¬æ¢æäºå³å¤è¿æ¥ï¼è¿æ ·å°±å¯ä»¥å¨åç»­çä»£ç ä¸­å°å¤çä¸ç§æåµï¼ç®åäºåé¢çä»£ç é»è¾ãâ</p>\n<p>âä¸¥æ ¼æç¶æ¯å¤ªæç¨äºï¼å¯æ¯ææä¹ç¥éä¸ä¸ªè¡¨è¾¾å¼æ¯ä¸æ¯ä¸¥æ ¼å¢ï¼â</p>\n<p>âå¯¹äºå½æ°èè¨ï¼å¨PG_PROCç³»ç»è¡¨ä¸­çproisstrictåå±æ§ä»£è¡¨äºå½åå½æ°æ¯å¦ä¸¥æ ¼ï¼å¦ææ¯æä½ç¬¦è¡¨è¾¾å¼ï¼å¨PostgreSQLæ°æ®åºä¸­æä½ç¬¦å®éé½è½¬æäºå¯¹åºçå½æ°ï¼å æ­¤ä¹å¯ä»¥ç¨proisstrictæ¥è¡¨ç¤ºæ¯å¦ä¸¥æ ¼ï¼èå¯¹åºäºIS [NOT] NULLäº§ççNullTestè¡¨è¾¾å¼éè¦åç¬å¤çï¼å¶ä¸­IS NOT NULLæ¯ä¸¥æ ¼çï¼IS NULLæ¯ä¸ä¸¥æ ¼çï¼å¤§ä½ä¸æä»¬å¯ä»¥åæè¿ä¹å ç±»ãâ</p>\n<p>å°ææè§èªå·±ä»å¤©å¥½åå­¦å°äºå¥½å¤ç¥è¯ï¼å¹¸å¥½èªå·±æä¸ªå¥å¥ï¼ä¸ç¶å¾é¾æäººè¿ä¹æèªå·±ï¼äºæ¯åèªåå¿çè¯´ï¼âOKï¼æåå¢å äºæ°çç¥è¯ï¼è°¢è°¢ãâ</p>\n<p>âä¸è¦è°¢æï¼ææ¯é·éï¼æä»¬é½æ¯å¨ä¸ºä¸­åä¹å´èµ·èè¯»ä¹¦ï¼æ³æ³æä»¬å¯æ¯ç¤¾ä¼ä¸»ä¹æ¥ç­äººåãããâå¤§ææè§èªå·±è¸åçä»¿ä½æçº¢é¢å·¾å¨è¿é£é£æ¬ï¼èä¸æ´å é²è³äºã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(6) - ç»è®¡å±æçæ³æ°´","date":"2020-10-03T00:23:35.000Z","_content":"\n\nâåååãããåååâé¨å¤ä¼ æ¥äºæ²é¨å£°ï¼å¤§æå»æå¼æ¿é¨ä¸çï¼è¿æ¥çåæ¥æ¯èªå·±çåäºçäºå¥ï¼çäºå¥æ¯ä¸é¨ä»äºæ°æ®åºæ¥è¯¢ä¼åå¼åçç åï¼ä¹æåå å¹´çä»ä¸ç»éªäºï¼å¤§ææå°éå¸¸happyï¼å ä¸ºè¿ä¸¤å¤©ç»å°æè®²æ¥è¯¢ä¼åå¨å¹²å°æäºååï¼ä»å¤©çäºå¥æ¥äºï¼å¯ä»¥å¸®å©èªå·±ç»å°ææ¥è®²æ¥è¯¢ä¼åå¨äºï¼äºæ¯åçäºå¥è¯´ï¼âçäºåå¿ï¼æ¥äºå°±å«èµ°äºï¼ä»å¤©å¤§è°å­å çº¢éç®¡å¤ï¼ä½ æ¥å¸®æä¸ªå¿ãâ\n\nçäºå¥æ¯å¤§è°å­ç±å¥½èï¼å¬è¯´æå¤§è°å­ï¼é¡¿æ¶æè§æµèº«é¸¡è¡ç¿»è¾ï¼è¿å¿è¯´ï¼âæ²¡é®é¢ï¼ä¸è¿è¦å¸®ä»ä¹å¿ï¼â\n<!-- more -->\nå¤§æè¯´ï¼âæçå¼å¼å°ææè¿å¨å­¦æ ¡è¦è¿è¡æ°æ®åºåçå®è·µï¼æè¿æ»æ¥é®æä¼åå¨çé®é¢ï¼å¯æå¯¹ä¼åå¨ä¹æ¯ä¸ç¥åè§£ï¼è¿ä¸ä½ æ¥äºï¼ä½ å¯ä»¥å¸®æå¼å¼è®²è®²ä¼åå¨äºãâ\n\nçäºå¥çå¿«çè¯´ï¼âè¿é¾ä¸åæï¼éæ¶é½å¯ä»¥è®²ãâ\n\nå¤§æè¯´ï¼âå¥½åï¼æåç»æçå¼å¼å°ææä¸ªçµè¯ï¼åä»è¯´æä¼åå¨é«ææ¥äºï¼èµ¶ç´§è¿æ¥è¯·æãâ\n\nâ¦â¦ï¼æ­¤å¤ç¥å»è¿åå­ï¼\n\nå°ææ©å°±å¬è¯´è¿çäºå¥çåå­ï¼æ®è¯´å¯¹æ¥è¯¢ä¼åéå¸¸äºè§£ï¼æ²¡æ³å°çäºå¥ç«ç¶åèªå·±çå¥å¥æ¯åäºï¼äºæ¯èµ¶ç´§æ¥å°äºå¤§æå®¶ï¼çå°çäºå¥çæ´æ§çæ ¼å­è¡«ååç§çååï¼æè§å°±åå°æå¯ºçæ«å°å§ä¸æ ·ï¼äºæ¯èµ¶ç´§è¯´ï¼âæè¿æè¿æ­£å¨æ¥çåºäºä»£ä»·çä¼åï¼æè§ä»åºäºå¾å¤ä»£ä»·ï¼ä½æ¶è·çå¾®åï¼ææä»å¤©è½å¾å°çäºå¥çæå¯¼ãâ\n\nçäºå¥è¯´ï¼âä¸å®¢æ°ï¼ææ¯ä¹æ¯åå°äºå¤§è°å­åçº¢éçè¯±æï¼ä¼°è®¡ä»å¤©ä¹è¦ä»åºæ¨ççä»£ä»·ããããä½ æä»ä¹é®é¢å°½ç®¡é®ï¼ææ¡æä¼çåç­ãâççå°æç¨å«©çè¸åºï¼çäºå¥çªç¶æ³èµ·äºèªå·±åå¼å§ä»äºæ°æ®åºåæ ¸å¼åçæ¥å­ï¼å¿åºç¿»è¾èµ·ä¸è¡æ²åæï¼é£æ¯ä¸æ®µä¸å ªåé¦çè¡æ³ªå²åï¼æè¡ãææ³ªãæããã\n\nçäºå¥çªç¶æ³å°äºä»ä¹ï¼ç»§ç»­è¯´éï¼âè¯´å°ä»£ä»·ï¼æè§å¾æä¸ªä¸è¥¿æ¯ç»ä¸è¿å»çï¼é£å°±æ¯ç»è®¡ä¿¡æ¯åéæ©çï¼PostgreSQLæ°æ®åºçç©çä¼åéè¦è®¡ç®åç§ç©çè·¯å¾çä»£ä»·ï¼èä»£ä»·ä¼°ç®çè¿ç¨ä¸¥éçä¾èµäºæ°æ®åºçç»è®¡ä¿¡æ¯ï¼ç»è®¡ä¿¡æ¯æ¯å¦è½åç¡®çæè¿°è¡¨ä¸­çæ°æ®åå¸æåµæ¯å³å®ä»£ä»·çåç¡®æ§çéè¦æ¡ä»¶ä¹ä¸ãâ\n\nå°æè¯´ï¼âå¤§æåæè¯´è¿ï¼æ°æ®åºæå¾å¤çç©çè·¯å¾ï¼è¿äºç©çè·¯å¾æä»¬ä¹å«ä»ä»¬ç©çç®å­ï¼åé»è¾ç®å­ä¸åï¼ç©çç®å­æ¯æ¥è¯¢æ§è¡å¨çæ§è¡æ¹æ³ï¼æä»¬åªéè¦è®¡ç®ç©çç®å­æ¯ä¸ªæ­¥éª¤çä»£ä»·ï¼æ±æ»èµ·æ¥å°±æ¯è·¯å¾çä»£ä»·äºï¼é£è¦ç»è®¡ä¿¡æ¯æä»ä¹ç¨å¢ï¼â\n\nçäºå¥çäºçå¤§æï¼æææ¯è®©å¤§ææ¥è¯´ï¼ä¸è¿å¤§ææ­£å¨ä¸å¿çæ¥åäºåå¤åAPPï¼æ¾å¤§è°å­åçº¢éï¼å¹¶æ²¡æçå°çäºå¥çç¼ç¥ï¼çäºå¥åªå¥½å°´å°¬çè¯´ï¼âæ¯çï¼æä»¬å°±æ¯è¦è®¡ç®ä¸ä¸ªç©çç®å­çä»£ä»·ï¼ä½æ¯ç©çç®å­çè®¡ç®éå¹¶ä¸æ¯ä¸æä¸åçãâè¯´ççäºå¥ä»æè¾¹çä¹¦æ¡ä¸æ¿æ¥çº¸åç¬ï¼å¨çº¸ä¸åäºä¸¤ä¸ªSQLè¯­å¥ã\n\n```\n\tSELECT A+B FROM TEST_A WHERE A > 1;\n\tSELECT A+B FROM TEST_A WHERE A > 100000000;\n```\n\t\nç¶åçäºå¥è¯´ï¼âä½ çï¼è¿ä¸¤ä¸ªè¯­å¥å¯ä»¥ç¨åæ ·çç©çç®å­æ¥å®æï¼ä½æ¯ä»ä»¬çè®¡ç®éä¸æ ·åï¼â\n\nå°æå¿æ³ï¼A > 1åA > 1000000000é½æ¯è¿æ»¤æ¡ä»¶ï¼ç»è¿è¿æ»¤ä¹åï¼ä»ä»¬äº§ççæ°æ®éå°±ä¸åäºï¼è¿æ ·æå½±ä¸­çA+Bçè®¡ç®çæ¬¡æ°å°±ä¸åäºï¼æä»¥ä»ä»¬çä»£ä»·åºè¯¥æ¯ä¸åçï¼é£å®åç»è®¡ä¿¡æ¯æä»ä¹å³ç³»å¢ï¼å°ææè§çµåä¸éªï¼é©¬ä¸è¯´ï¼âæç¥éäºï¼æå¨è®¡ç®ç©çç®å­çä»£ä»·çæ¶åï¼è¦ç¥éA > 1ä¹åè¿å©ä¸å¤å°æ°æ®æèA > 1000000000ä¹åè¿å©ä¸å¤å°æ°æ®ï¼å¦ææä»¬æåå¯¹è¡¨ä¸çæ°æ®åå®¹åäºç»è®¡ï¼å©ä¸å¤å°æ°æ®å°±ä¸é¾è®¡ç®äºï¼æä»¥å¿é¡»è¦æç»è®¡ä¿¡æ¯ãâ\n\nçäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯ï¼éè¿ç»è®¡ä¿¡æ¯ï¼ä»£ä»·ä¼°ç®ç³»ç»å°±å¯ä»¥äºè§£ä¸ä¸ªè¡¨æå¤å°è¡æ°æ®ãç¨äºå¤å°ä¸ªæ°æ®é¡µé¢ãæä¸ªå¼åºç°çé¢çç­ç­ï¼ç¶åå°±è½æ ¹æ®è¿äºä¿¡æ¯è®¡ç®åºä¸ä¸ªçº¦ææ¡ä»¶è½è¿æ»¤æå¤å°æ°æ®ï¼è¿ç§çº¦ææ¡ä»¶è¿æ»¤åºçæ°æ®å æ»æ°æ®éçæ¯ä¾ç§°ä¹ä¸ºâéæ©çâï¼æè°éæ©çå°±æ¯ä¸ä¸ªæ¯ä¾ï¼å®çå¬å¼æ¯è¿æ ·çãâè¯´ççäºå¥ç»§ç»­å¨çº¸ä¸åäºéæ©ççå¬å¼ï¼\néæ©ç=çº¦ææ¡ä»¶è¿æ»¤åçåç»æ°/çº¦ææ¡ä»¶è¿æ»¤åçæ»åç»æ°\n\nâä¸è¿ä¸é¢çç¤ºä¾æç¹ç®åäºï¼å®éåºç¨ä¸­éå¸¸çº¦ææ¡ä»¶ä¼æ¯è¾å¤ï¼èä¸æ¯è¾å¤æï¼éå¸¸æä»¬ä¼è®¡ç®æ¯ä¸ªå­çº¦ææ¡ä»¶çéæ©çï¼ç¶åå°±å¯ä»¥æ ¹æ®ANDè¿ç®ç¬¦åORè¿ç®ç¬¦è®¡ç®å®ä»¬çç»¼åçéæ©çï¼ANDè¿ç®ç¬¦åORè¿ç®ç¬¦çéæ©çè®¡ç®æ¯åºäºæ¦ççï¼ä½ çè¿éçæ¦çå¬å¼ãâè¯´çï¼çäºå¥åç»§ç»­å¨çº¸ä¸åèµ·æ¥ã\n\n```\nP(A+B)=P(A)+P(B)-P(AB)\nP(AB)=P(A)ÃP(B)\n```\n\nâæäºè¿äºï¼æä»¬å°±å¯ä»¥æ±è§£å¤ç§ç±»åççº¦ææ¡ä»¶çéæ©çäºï¼æ¯å¦ãããâçäºå¥ç»§ç»­å¨çº¸ä¸ç»èµ·æ¥ï¼\n\n```\n    P(ssex IS NOT NULL OR sno > 5) \n  = P(ssex IS NOT NULL) + P(sno > 5) â P(ssex IS NOT NULL AND sno > 5)\n  = P(ssex IS NOT NULL) + P(sno > 5) â P(ssex IS NOT NULL) Ã P(no > 5)\n```\n\nå°æè§å¾çäºå¥çè¿å±æç¹å¿«ï¼èµ¶ç´§é®ï¼âé£ä¹ç»è®¡ä¿¡æ¯æ¯ä»ä¹å½¢å¼çå¢ï¼â\n\nçäºå¥æ æ å¤´ï¼è¯´ï¼âè¿ä¸ªè¿çæ¯æç¹éº»ç¦ï¼æä»¬è¯´å¸¸ç¨çç»è®¡ä¿¡æ¯çå½¢å¼å°±æ¯distinctçãNULLå¼çãé«é¢å¼ãç´æ¹å¾ãç¸å³ç³»æ°è¿äºï¼ä»ä»¬åå«æä¸åçä½ç¨ï¼æ¯å¦è¯´distinctçï¼ä½ å¯ä»¥è·ç¥æä¸åæå¤å°ä¸ªç¬ç«å¼ï¼è¿ç§ä¿¡æ¯å¯¹äºåæ§å«è¿ç§åå°±æ¾å¾ç¹å«æç¨ï¼NULLå¼çå¢ï¼å¨ç»è®¡çè¿ç¨ä¸­ï¼NULLå¼æ¯ä¸å¥½å¤ççï¼å æ­¤æå®ç¬ç«åºæ¥ï¼å½¢æNULLå¼çï¼è¿æ ·å¨é«é¢å¼ãç´æ¹å¾è¿äºéé¢å°±ä¸ç¨èèNULLå¼çæåµäºï¼é«é¢å¼å±äºå¥å¼å¼ï¼é¡¾åæä¹ï¼å°±æ¯åºç°çæ¯è¾å¤çä¸äºåå¼ï¼å»æäºNULLå¼ï¼åå»æé«é¢å¼ï¼å©ä¸çå¼å¯ä»¥ç¨æ¥åä¸ä¸ªç­é¢çç´æ¹å¾ããããâ\n \nâåãããâå°ææè§è·ä¸ä¸çäºå¥çéåº¦äºï¼äºæ¯è¯´ï¼âæç¹å¿«ï¼ææç¹è·ä¸ä¸äºãâ\n\t\nè¿æ¶å¤§æå·²ç»ç¹å®äºå¤åï¼è¿æ¥è¯´ï¼âå«æ¥ï¼å¤åæ²¡æé£ä¹å¿«éå°ï¼è³äºç»è®¡ä¿¡æ¯åï¼ä¸»è¦çè¿æ¯é«é¢å¼ãç´æ¹å¾åç¸å³ç³»æ°ï¼å®éä¸æå»ºè®®è¿æ¯ä¸è¦çº ç»äºç»è®¡ä¿¡æ¯æåªäºå½¢å¼ï¼æä»¬åªè¦ç¥éå®æ¯ç¨æ¥ç®ä»£ä»·çå°±å¯ä»¥äºãâ\n\nçäºå¥å¯¹å¤§æè¯´ï¼âè¿æä¹å¯ä»¥ï¼æè¿æ²¡æè¯´ç»è®¡ä¿¡æ¯æ¯å¦ä½çæçå¢ï¼æ¯å¦å®éè¿äºä¸¤é¶æ®µéæ ·ï¼ç¶åå¯¹æ ·æ¬è¿è¡ç»è®¡æ¶ä½¿ç¨çç»è®¡æ¹æ³ï¼åªäºå¼å¯ä»¥ä½ä¸ºé«é¢å¼ï¼ç´æ¹å¾æå ä¸ªæ¡¶ï¼ç¸å³ç³»æ°æ¯æä¹è®¡ç®çï¼ç¸å³ç³»æ°å¨è®¡ç®ç´¢å¼æ«æè·¯å¾ä»£ä»·çæ¶åæä¹ç¨çï¼èä¸æåä½ è¯´ï¼PostgreSQLè¿åºäºåºäºå¤åçæ©å±ç»è®¡ä¿¡æ¯ï¼å¤åç»è®¡ä¿¡æ¯åæäºåªäºç±»åï¼åå«æ¯ä»ä¹å«ä¹ï¼åèªæ¯æä¹è®¡ç®çï¼è¿æéæ©çæ¯æä¹ç»åç»è®¡ä¿¡æ¯è®¡ç®çï¼è¿äºæè¿æ²¡è¯´å¢ãããâ\n\nå¤§æè¯´ï¼âä½ å¿«é­å´å§ï¼åä½ è¿æ ·è®²ä¼åå¨ï¼å²ä¸æ¯è¦åºä¸æ¬ä¹¦ãâ\n\nçäºå¥åçè¦ç¶ï¼âé£å¥½å§ï¼ç»è®¡ä¿¡æ¯æä»¬å°±è¯´å°è¿éå§ï¼ä½æ¯å®ç¡®å®æ¯ä»£ä»·è®¡ç®çåºç³ï¼å°æåå­¦ï¼ä½ çè§£äºå®çä½ç¨å°±å¯ä»¥äºãâ\n\nå°æçè¦çè¯´ï¼âçäºå¥ï¼ä½ è¯´äºè¿ä¹å¤ï¼é½ä¸åè¯æç­æ¡ï¼ææè§è¦å­¦çåå®¹å¥½å¤åãâ\n\nå¤§æç¬çè¯´ï¼âä¸ç¨è¿ä¹çè¦åï¼æ²¡æå¥äºæ¯ä¸é¡¿ç§ç¤ä¸è½è§£å³çï¼å¦ææï¼é£å°±æ¯ä¸¤é¡¿ãâç¶åå¤§æç»§ç»­ç¥ç§çè¯´ï¼âå®éä¸ç»è®¡ä¿¡æ¯å¾å¾ä¹ä¸åï¼ä½ æ³æ³æ¬æ¥å°±æ¯éæ ·çç»æåï¼æ ·æ¬æ¯å¦æ¾èåæ ¹å°±ä¸å¥½è¯´ï¼èä¸éçåºç¨ç¨åºå¯¹è¡¨çæ´æ°ï¼ç»è®¡ä¿¡æ¯å¯è½æ´æ°ä¸åæ¶ï¼é£å°±æ´ä¼åºç°åå·®ãæ´ä¸¥éçæ¯ï¼å¦ææä»¬éå°a > bè¿æ ·ççº¦ææ¡ä»¶ï¼ä½¿ç¨ç»è®¡ä¿¡æ¯è®¡ç®éæ©çä¹å¾ä¸å¥½è®¡ç®ï¼å³ä½¿ç®åºæ¥ï¼ä¹ä¸ååãâ\n\nçäºå¥è¯´ï¼âæ¯çï¼ç»è®¡ä¿¡æ¯ç¡®å®ä¹æä¸åç¡®çé®é¢ï¼æå¬è¯´æä¸ªDBAï¼ä»å®¶ç¥åæè¾¹åºäºä¸å£æ³æ°´ï¼ä»ç¸ç¸è§å¾æ¯ååï¼å»æ¾é£æ°´å¤§å¸çä¸çï¼é£æ°´å¤§å¸ææç®ä¸ç®ï¼è¯´ï¼ä½ å¿å­æ¯ä¸ªDBAï¼æ¯æ¬¡æ°æ®åºæ§è½æ¢å°±ç¥éæ´æ°ç»è®¡ä¿¡æ¯ï¼å¯æ¯ç»è®¡ä¿¡æ¯å¤ªæ°´äºï¼é½ä»ä½ å®¶ç¥åååºæ¥äºãâ\n\nä¸ä¸ªäººé¡¿æ¶ç¬åä¸å¢ï¼æ°æ°ä»çè¦åæ¢å¤å°äºæ´»æ³¼ï¼å¤§æè¯´ï¼âå­¦ä¹ æ¥è¯¢ä¼åå¨ç¡®å®è¿æ¯æ¯è¾ç¹ççï¼ç»å¯¹ä¸æ¯æä»¬éè¿ä¸ä¸¤æ¬¡è®²è§£å°±è½è®©ä½ åå¾ç²¾éçï¼è¿ä¸ªå­¦ä¹ çæ²çº¿è¿æ¯æ¯è¾é¡å³­çãâ\n\nå°æç¹äºç¹å¤´è¯´ï¼âå¥½å§ï¼æäºä¸¤ä½å¸åï¼åå ä¸æèªå·±å¤©èµèªæ§ãé£æµåå¥ãçæ ä¸´é£ãé«å¤§å¨æ­¦ãéª¨éª¼æå¥ï¼æç¸ä¿¡ä¸å®è½å°ä¼åå¨æå®ãâ\n\nå¤§æåçäºå¥é½æåå¨å°ä¸ããã\n","source":"_posts/postgresql-optimizer-outline-6.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(6) - ç»è®¡å±æçæ³æ°´\ndate: 2020-10-03 08:23:35\n---\n\n\nâåååãããåååâé¨å¤ä¼ æ¥äºæ²é¨å£°ï¼å¤§æå»æå¼æ¿é¨ä¸çï¼è¿æ¥çåæ¥æ¯èªå·±çåäºçäºå¥ï¼çäºå¥æ¯ä¸é¨ä»äºæ°æ®åºæ¥è¯¢ä¼åå¼åçç åï¼ä¹æåå å¹´çä»ä¸ç»éªäºï¼å¤§ææå°éå¸¸happyï¼å ä¸ºè¿ä¸¤å¤©ç»å°æè®²æ¥è¯¢ä¼åå¨å¹²å°æäºååï¼ä»å¤©çäºå¥æ¥äºï¼å¯ä»¥å¸®å©èªå·±ç»å°ææ¥è®²æ¥è¯¢ä¼åå¨äºï¼äºæ¯åçäºå¥è¯´ï¼âçäºåå¿ï¼æ¥äºå°±å«èµ°äºï¼ä»å¤©å¤§è°å­å çº¢éç®¡å¤ï¼ä½ æ¥å¸®æä¸ªå¿ãâ\n\nçäºå¥æ¯å¤§è°å­ç±å¥½èï¼å¬è¯´æå¤§è°å­ï¼é¡¿æ¶æè§æµèº«é¸¡è¡ç¿»è¾ï¼è¿å¿è¯´ï¼âæ²¡é®é¢ï¼ä¸è¿è¦å¸®ä»ä¹å¿ï¼â\n<!-- more -->\nå¤§æè¯´ï¼âæçå¼å¼å°ææè¿å¨å­¦æ ¡è¦è¿è¡æ°æ®åºåçå®è·µï¼æè¿æ»æ¥é®æä¼åå¨çé®é¢ï¼å¯æå¯¹ä¼åå¨ä¹æ¯ä¸ç¥åè§£ï¼è¿ä¸ä½ æ¥äºï¼ä½ å¯ä»¥å¸®æå¼å¼è®²è®²ä¼åå¨äºãâ\n\nçäºå¥çå¿«çè¯´ï¼âè¿é¾ä¸åæï¼éæ¶é½å¯ä»¥è®²ãâ\n\nå¤§æè¯´ï¼âå¥½åï¼æåç»æçå¼å¼å°ææä¸ªçµè¯ï¼åä»è¯´æä¼åå¨é«ææ¥äºï¼èµ¶ç´§è¿æ¥è¯·æãâ\n\nâ¦â¦ï¼æ­¤å¤ç¥å»è¿åå­ï¼\n\nå°ææ©å°±å¬è¯´è¿çäºå¥çåå­ï¼æ®è¯´å¯¹æ¥è¯¢ä¼åéå¸¸äºè§£ï¼æ²¡æ³å°çäºå¥ç«ç¶åèªå·±çå¥å¥æ¯åäºï¼äºæ¯èµ¶ç´§æ¥å°äºå¤§æå®¶ï¼çå°çäºå¥çæ´æ§çæ ¼å­è¡«ååç§çååï¼æè§å°±åå°æå¯ºçæ«å°å§ä¸æ ·ï¼äºæ¯èµ¶ç´§è¯´ï¼âæè¿æè¿æ­£å¨æ¥çåºäºä»£ä»·çä¼åï¼æè§ä»åºäºå¾å¤ä»£ä»·ï¼ä½æ¶è·çå¾®åï¼ææä»å¤©è½å¾å°çäºå¥çæå¯¼ãâ\n\nçäºå¥è¯´ï¼âä¸å®¢æ°ï¼ææ¯ä¹æ¯åå°äºå¤§è°å­åçº¢éçè¯±æï¼ä¼°è®¡ä»å¤©ä¹è¦ä»åºæ¨ççä»£ä»·ããããä½ æä»ä¹é®é¢å°½ç®¡é®ï¼ææ¡æä¼çåç­ãâççå°æç¨å«©çè¸åºï¼çäºå¥çªç¶æ³èµ·äºèªå·±åå¼å§ä»äºæ°æ®åºåæ ¸å¼åçæ¥å­ï¼å¿åºç¿»è¾èµ·ä¸è¡æ²åæï¼é£æ¯ä¸æ®µä¸å ªåé¦çè¡æ³ªå²åï¼æè¡ãææ³ªãæããã\n\nçäºå¥çªç¶æ³å°äºä»ä¹ï¼ç»§ç»­è¯´éï¼âè¯´å°ä»£ä»·ï¼æè§å¾æä¸ªä¸è¥¿æ¯ç»ä¸è¿å»çï¼é£å°±æ¯ç»è®¡ä¿¡æ¯åéæ©çï¼PostgreSQLæ°æ®åºçç©çä¼åéè¦è®¡ç®åç§ç©çè·¯å¾çä»£ä»·ï¼èä»£ä»·ä¼°ç®çè¿ç¨ä¸¥éçä¾èµäºæ°æ®åºçç»è®¡ä¿¡æ¯ï¼ç»è®¡ä¿¡æ¯æ¯å¦è½åç¡®çæè¿°è¡¨ä¸­çæ°æ®åå¸æåµæ¯å³å®ä»£ä»·çåç¡®æ§çéè¦æ¡ä»¶ä¹ä¸ãâ\n\nå°æè¯´ï¼âå¤§æåæè¯´è¿ï¼æ°æ®åºæå¾å¤çç©çè·¯å¾ï¼è¿äºç©çè·¯å¾æä»¬ä¹å«ä»ä»¬ç©çç®å­ï¼åé»è¾ç®å­ä¸åï¼ç©çç®å­æ¯æ¥è¯¢æ§è¡å¨çæ§è¡æ¹æ³ï¼æä»¬åªéè¦è®¡ç®ç©çç®å­æ¯ä¸ªæ­¥éª¤çä»£ä»·ï¼æ±æ»èµ·æ¥å°±æ¯è·¯å¾çä»£ä»·äºï¼é£è¦ç»è®¡ä¿¡æ¯æä»ä¹ç¨å¢ï¼â\n\nçäºå¥çäºçå¤§æï¼æææ¯è®©å¤§ææ¥è¯´ï¼ä¸è¿å¤§ææ­£å¨ä¸å¿çæ¥åäºåå¤åAPPï¼æ¾å¤§è°å­åçº¢éï¼å¹¶æ²¡æçå°çäºå¥çç¼ç¥ï¼çäºå¥åªå¥½å°´å°¬çè¯´ï¼âæ¯çï¼æä»¬å°±æ¯è¦è®¡ç®ä¸ä¸ªç©çç®å­çä»£ä»·ï¼ä½æ¯ç©çç®å­çè®¡ç®éå¹¶ä¸æ¯ä¸æä¸åçãâè¯´ççäºå¥ä»æè¾¹çä¹¦æ¡ä¸æ¿æ¥çº¸åç¬ï¼å¨çº¸ä¸åäºä¸¤ä¸ªSQLè¯­å¥ã\n\n```\n\tSELECT A+B FROM TEST_A WHERE A > 1;\n\tSELECT A+B FROM TEST_A WHERE A > 100000000;\n```\n\t\nç¶åçäºå¥è¯´ï¼âä½ çï¼è¿ä¸¤ä¸ªè¯­å¥å¯ä»¥ç¨åæ ·çç©çç®å­æ¥å®æï¼ä½æ¯ä»ä»¬çè®¡ç®éä¸æ ·åï¼â\n\nå°æå¿æ³ï¼A > 1åA > 1000000000é½æ¯è¿æ»¤æ¡ä»¶ï¼ç»è¿è¿æ»¤ä¹åï¼ä»ä»¬äº§ççæ°æ®éå°±ä¸åäºï¼è¿æ ·æå½±ä¸­çA+Bçè®¡ç®çæ¬¡æ°å°±ä¸åäºï¼æä»¥ä»ä»¬çä»£ä»·åºè¯¥æ¯ä¸åçï¼é£å®åç»è®¡ä¿¡æ¯æä»ä¹å³ç³»å¢ï¼å°ææè§çµåä¸éªï¼é©¬ä¸è¯´ï¼âæç¥éäºï¼æå¨è®¡ç®ç©çç®å­çä»£ä»·çæ¶åï¼è¦ç¥éA > 1ä¹åè¿å©ä¸å¤å°æ°æ®æèA > 1000000000ä¹åè¿å©ä¸å¤å°æ°æ®ï¼å¦ææä»¬æåå¯¹è¡¨ä¸çæ°æ®åå®¹åäºç»è®¡ï¼å©ä¸å¤å°æ°æ®å°±ä¸é¾è®¡ç®äºï¼æä»¥å¿é¡»è¦æç»è®¡ä¿¡æ¯ãâ\n\nçäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯ï¼éè¿ç»è®¡ä¿¡æ¯ï¼ä»£ä»·ä¼°ç®ç³»ç»å°±å¯ä»¥äºè§£ä¸ä¸ªè¡¨æå¤å°è¡æ°æ®ãç¨äºå¤å°ä¸ªæ°æ®é¡µé¢ãæä¸ªå¼åºç°çé¢çç­ç­ï¼ç¶åå°±è½æ ¹æ®è¿äºä¿¡æ¯è®¡ç®åºä¸ä¸ªçº¦ææ¡ä»¶è½è¿æ»¤æå¤å°æ°æ®ï¼è¿ç§çº¦ææ¡ä»¶è¿æ»¤åºçæ°æ®å æ»æ°æ®éçæ¯ä¾ç§°ä¹ä¸ºâéæ©çâï¼æè°éæ©çå°±æ¯ä¸ä¸ªæ¯ä¾ï¼å®çå¬å¼æ¯è¿æ ·çãâè¯´ççäºå¥ç»§ç»­å¨çº¸ä¸åäºéæ©ççå¬å¼ï¼\néæ©ç=çº¦ææ¡ä»¶è¿æ»¤åçåç»æ°/çº¦ææ¡ä»¶è¿æ»¤åçæ»åç»æ°\n\nâä¸è¿ä¸é¢çç¤ºä¾æç¹ç®åäºï¼å®éåºç¨ä¸­éå¸¸çº¦ææ¡ä»¶ä¼æ¯è¾å¤ï¼èä¸æ¯è¾å¤æï¼éå¸¸æä»¬ä¼è®¡ç®æ¯ä¸ªå­çº¦ææ¡ä»¶çéæ©çï¼ç¶åå°±å¯ä»¥æ ¹æ®ANDè¿ç®ç¬¦åORè¿ç®ç¬¦è®¡ç®å®ä»¬çç»¼åçéæ©çï¼ANDè¿ç®ç¬¦åORè¿ç®ç¬¦çéæ©çè®¡ç®æ¯åºäºæ¦ççï¼ä½ çè¿éçæ¦çå¬å¼ãâè¯´çï¼çäºå¥åç»§ç»­å¨çº¸ä¸åèµ·æ¥ã\n\n```\nP(A+B)=P(A)+P(B)-P(AB)\nP(AB)=P(A)ÃP(B)\n```\n\nâæäºè¿äºï¼æä»¬å°±å¯ä»¥æ±è§£å¤ç§ç±»åççº¦ææ¡ä»¶çéæ©çäºï¼æ¯å¦ãããâçäºå¥ç»§ç»­å¨çº¸ä¸ç»èµ·æ¥ï¼\n\n```\n    P(ssex IS NOT NULL OR sno > 5) \n  = P(ssex IS NOT NULL) + P(sno > 5) â P(ssex IS NOT NULL AND sno > 5)\n  = P(ssex IS NOT NULL) + P(sno > 5) â P(ssex IS NOT NULL) Ã P(no > 5)\n```\n\nå°æè§å¾çäºå¥çè¿å±æç¹å¿«ï¼èµ¶ç´§é®ï¼âé£ä¹ç»è®¡ä¿¡æ¯æ¯ä»ä¹å½¢å¼çå¢ï¼â\n\nçäºå¥æ æ å¤´ï¼è¯´ï¼âè¿ä¸ªè¿çæ¯æç¹éº»ç¦ï¼æä»¬è¯´å¸¸ç¨çç»è®¡ä¿¡æ¯çå½¢å¼å°±æ¯distinctçãNULLå¼çãé«é¢å¼ãç´æ¹å¾ãç¸å³ç³»æ°è¿äºï¼ä»ä»¬åå«æä¸åçä½ç¨ï¼æ¯å¦è¯´distinctçï¼ä½ å¯ä»¥è·ç¥æä¸åæå¤å°ä¸ªç¬ç«å¼ï¼è¿ç§ä¿¡æ¯å¯¹äºåæ§å«è¿ç§åå°±æ¾å¾ç¹å«æç¨ï¼NULLå¼çå¢ï¼å¨ç»è®¡çè¿ç¨ä¸­ï¼NULLå¼æ¯ä¸å¥½å¤ççï¼å æ­¤æå®ç¬ç«åºæ¥ï¼å½¢æNULLå¼çï¼è¿æ ·å¨é«é¢å¼ãç´æ¹å¾è¿äºéé¢å°±ä¸ç¨èèNULLå¼çæåµäºï¼é«é¢å¼å±äºå¥å¼å¼ï¼é¡¾åæä¹ï¼å°±æ¯åºç°çæ¯è¾å¤çä¸äºåå¼ï¼å»æäºNULLå¼ï¼åå»æé«é¢å¼ï¼å©ä¸çå¼å¯ä»¥ç¨æ¥åä¸ä¸ªç­é¢çç´æ¹å¾ããããâ\n \nâåãããâå°ææè§è·ä¸ä¸çäºå¥çéåº¦äºï¼äºæ¯è¯´ï¼âæç¹å¿«ï¼ææç¹è·ä¸ä¸äºãâ\n\t\nè¿æ¶å¤§æå·²ç»ç¹å®äºå¤åï¼è¿æ¥è¯´ï¼âå«æ¥ï¼å¤åæ²¡æé£ä¹å¿«éå°ï¼è³äºç»è®¡ä¿¡æ¯åï¼ä¸»è¦çè¿æ¯é«é¢å¼ãç´æ¹å¾åç¸å³ç³»æ°ï¼å®éä¸æå»ºè®®è¿æ¯ä¸è¦çº ç»äºç»è®¡ä¿¡æ¯æåªäºå½¢å¼ï¼æä»¬åªè¦ç¥éå®æ¯ç¨æ¥ç®ä»£ä»·çå°±å¯ä»¥äºãâ\n\nçäºå¥å¯¹å¤§æè¯´ï¼âè¿æä¹å¯ä»¥ï¼æè¿æ²¡æè¯´ç»è®¡ä¿¡æ¯æ¯å¦ä½çæçå¢ï¼æ¯å¦å®éè¿äºä¸¤é¶æ®µéæ ·ï¼ç¶åå¯¹æ ·æ¬è¿è¡ç»è®¡æ¶ä½¿ç¨çç»è®¡æ¹æ³ï¼åªäºå¼å¯ä»¥ä½ä¸ºé«é¢å¼ï¼ç´æ¹å¾æå ä¸ªæ¡¶ï¼ç¸å³ç³»æ°æ¯æä¹è®¡ç®çï¼ç¸å³ç³»æ°å¨è®¡ç®ç´¢å¼æ«æè·¯å¾ä»£ä»·çæ¶åæä¹ç¨çï¼èä¸æåä½ è¯´ï¼PostgreSQLè¿åºäºåºäºå¤åçæ©å±ç»è®¡ä¿¡æ¯ï¼å¤åç»è®¡ä¿¡æ¯åæäºåªäºç±»åï¼åå«æ¯ä»ä¹å«ä¹ï¼åèªæ¯æä¹è®¡ç®çï¼è¿æéæ©çæ¯æä¹ç»åç»è®¡ä¿¡æ¯è®¡ç®çï¼è¿äºæè¿æ²¡è¯´å¢ãããâ\n\nå¤§æè¯´ï¼âä½ å¿«é­å´å§ï¼åä½ è¿æ ·è®²ä¼åå¨ï¼å²ä¸æ¯è¦åºä¸æ¬ä¹¦ãâ\n\nçäºå¥åçè¦ç¶ï¼âé£å¥½å§ï¼ç»è®¡ä¿¡æ¯æä»¬å°±è¯´å°è¿éå§ï¼ä½æ¯å®ç¡®å®æ¯ä»£ä»·è®¡ç®çåºç³ï¼å°æåå­¦ï¼ä½ çè§£äºå®çä½ç¨å°±å¯ä»¥äºãâ\n\nå°æçè¦çè¯´ï¼âçäºå¥ï¼ä½ è¯´äºè¿ä¹å¤ï¼é½ä¸åè¯æç­æ¡ï¼ææè§è¦å­¦çåå®¹å¥½å¤åãâ\n\nå¤§æç¬çè¯´ï¼âä¸ç¨è¿ä¹çè¦åï¼æ²¡æå¥äºæ¯ä¸é¡¿ç§ç¤ä¸è½è§£å³çï¼å¦ææï¼é£å°±æ¯ä¸¤é¡¿ãâç¶åå¤§æç»§ç»­ç¥ç§çè¯´ï¼âå®éä¸ç»è®¡ä¿¡æ¯å¾å¾ä¹ä¸åï¼ä½ æ³æ³æ¬æ¥å°±æ¯éæ ·çç»æåï¼æ ·æ¬æ¯å¦æ¾èåæ ¹å°±ä¸å¥½è¯´ï¼èä¸éçåºç¨ç¨åºå¯¹è¡¨çæ´æ°ï¼ç»è®¡ä¿¡æ¯å¯è½æ´æ°ä¸åæ¶ï¼é£å°±æ´ä¼åºç°åå·®ãæ´ä¸¥éçæ¯ï¼å¦ææä»¬éå°a > bè¿æ ·ççº¦ææ¡ä»¶ï¼ä½¿ç¨ç»è®¡ä¿¡æ¯è®¡ç®éæ©çä¹å¾ä¸å¥½è®¡ç®ï¼å³ä½¿ç®åºæ¥ï¼ä¹ä¸ååãâ\n\nçäºå¥è¯´ï¼âæ¯çï¼ç»è®¡ä¿¡æ¯ç¡®å®ä¹æä¸åç¡®çé®é¢ï¼æå¬è¯´æä¸ªDBAï¼ä»å®¶ç¥åæè¾¹åºäºä¸å£æ³æ°´ï¼ä»ç¸ç¸è§å¾æ¯ååï¼å»æ¾é£æ°´å¤§å¸çä¸çï¼é£æ°´å¤§å¸ææç®ä¸ç®ï¼è¯´ï¼ä½ å¿å­æ¯ä¸ªDBAï¼æ¯æ¬¡æ°æ®åºæ§è½æ¢å°±ç¥éæ´æ°ç»è®¡ä¿¡æ¯ï¼å¯æ¯ç»è®¡ä¿¡æ¯å¤ªæ°´äºï¼é½ä»ä½ å®¶ç¥åååºæ¥äºãâ\n\nä¸ä¸ªäººé¡¿æ¶ç¬åä¸å¢ï¼æ°æ°ä»çè¦åæ¢å¤å°äºæ´»æ³¼ï¼å¤§æè¯´ï¼âå­¦ä¹ æ¥è¯¢ä¼åå¨ç¡®å®è¿æ¯æ¯è¾ç¹ççï¼ç»å¯¹ä¸æ¯æä»¬éè¿ä¸ä¸¤æ¬¡è®²è§£å°±è½è®©ä½ åå¾ç²¾éçï¼è¿ä¸ªå­¦ä¹ çæ²çº¿è¿æ¯æ¯è¾é¡å³­çãâ\n\nå°æç¹äºç¹å¤´è¯´ï¼âå¥½å§ï¼æäºä¸¤ä½å¸åï¼åå ä¸æèªå·±å¤©èµèªæ§ãé£æµåå¥ãçæ ä¸´é£ãé«å¤§å¨æ­¦ãéª¨éª¼æå¥ï¼æç¸ä¿¡ä¸å®è½å°ä¼åå¨æå®ãâ\n\nå¤§æåçäºå¥é½æåå¨å°ä¸ããã\n","slug":"postgresql-optimizer-outline-6","published":1,"updated":"2020-10-03T00:35:54.000Z","_id":"ckfsy1s6g0000nw9ke9283mf0","comments":1,"layout":"post","photos":[],"link":"","content":"<p>âåååãããåååâé¨å¤ä¼ æ¥äºæ²é¨å£°ï¼å¤§æå»æå¼æ¿é¨ä¸çï¼è¿æ¥çåæ¥æ¯èªå·±çåäºçäºå¥ï¼çäºå¥æ¯ä¸é¨ä»äºæ°æ®åºæ¥è¯¢ä¼åå¼åçç åï¼ä¹æåå å¹´çä»ä¸ç»éªäºï¼å¤§ææå°éå¸¸happyï¼å ä¸ºè¿ä¸¤å¤©ç»å°æè®²æ¥è¯¢ä¼åå¨å¹²å°æäºååï¼ä»å¤©çäºå¥æ¥äºï¼å¯ä»¥å¸®å©èªå·±ç»å°ææ¥è®²æ¥è¯¢ä¼åå¨äºï¼äºæ¯åçäºå¥è¯´ï¼âçäºåå¿ï¼æ¥äºå°±å«èµ°äºï¼ä»å¤©å¤§è°å­å çº¢éç®¡å¤ï¼ä½ æ¥å¸®æä¸ªå¿ãâ</p>\n<p>çäºå¥æ¯å¤§è°å­ç±å¥½èï¼å¬è¯´æå¤§è°å­ï¼é¡¿æ¶æè§æµèº«é¸¡è¡ç¿»è¾ï¼è¿å¿è¯´ï¼âæ²¡é®é¢ï¼ä¸è¿è¦å¸®ä»ä¹å¿ï¼â</p>\n<a id=\"more\"></a>\n<p>å¤§æè¯´ï¼âæçå¼å¼å°ææè¿å¨å­¦æ ¡è¦è¿è¡æ°æ®åºåçå®è·µï¼æè¿æ»æ¥é®æä¼åå¨çé®é¢ï¼å¯æå¯¹ä¼åå¨ä¹æ¯ä¸ç¥åè§£ï¼è¿ä¸ä½ æ¥äºï¼ä½ å¯ä»¥å¸®æå¼å¼è®²è®²ä¼åå¨äºãâ</p>\n<p>çäºå¥çå¿«çè¯´ï¼âè¿é¾ä¸åæï¼éæ¶é½å¯ä»¥è®²ãâ</p>\n<p>å¤§æè¯´ï¼âå¥½åï¼æåç»æçå¼å¼å°ææä¸ªçµè¯ï¼åä»è¯´æä¼åå¨é«ææ¥äºï¼èµ¶ç´§è¿æ¥è¯·æãâ</p>\n<p>â¦â¦ï¼æ­¤å¤ç¥å»è¿åå­ï¼</p>\n<p>å°ææ©å°±å¬è¯´è¿çäºå¥çåå­ï¼æ®è¯´å¯¹æ¥è¯¢ä¼åéå¸¸äºè§£ï¼æ²¡æ³å°çäºå¥ç«ç¶åèªå·±çå¥å¥æ¯åäºï¼äºæ¯èµ¶ç´§æ¥å°äºå¤§æå®¶ï¼çå°çäºå¥çæ´æ§çæ ¼å­è¡«ååç§çååï¼æè§å°±åå°æå¯ºçæ«å°å§ä¸æ ·ï¼äºæ¯èµ¶ç´§è¯´ï¼âæè¿æè¿æ­£å¨æ¥çåºäºä»£ä»·çä¼åï¼æè§ä»åºäºå¾å¤ä»£ä»·ï¼ä½æ¶è·çå¾®åï¼ææä»å¤©è½å¾å°çäºå¥çæå¯¼ãâ</p>\n<p>çäºå¥è¯´ï¼âä¸å®¢æ°ï¼ææ¯ä¹æ¯åå°äºå¤§è°å­åçº¢éçè¯±æï¼ä¼°è®¡ä»å¤©ä¹è¦ä»åºæ¨ççä»£ä»·ããããä½ æä»ä¹é®é¢å°½ç®¡é®ï¼ææ¡æä¼çåç­ãâççå°æç¨å«©çè¸åºï¼çäºå¥çªç¶æ³èµ·äºèªå·±åå¼å§ä»äºæ°æ®åºåæ ¸å¼åçæ¥å­ï¼å¿åºç¿»è¾èµ·ä¸è¡æ²åæï¼é£æ¯ä¸æ®µä¸å ªåé¦çè¡æ³ªå²åï¼æè¡ãææ³ªãæããã</p>\n<p>çäºå¥çªç¶æ³å°äºä»ä¹ï¼ç»§ç»­è¯´éï¼âè¯´å°ä»£ä»·ï¼æè§å¾æä¸ªä¸è¥¿æ¯ç»ä¸è¿å»çï¼é£å°±æ¯ç»è®¡ä¿¡æ¯åéæ©çï¼PostgreSQLæ°æ®åºçç©çä¼åéè¦è®¡ç®åç§ç©çè·¯å¾çä»£ä»·ï¼èä»£ä»·ä¼°ç®çè¿ç¨ä¸¥éçä¾èµäºæ°æ®åºçç»è®¡ä¿¡æ¯ï¼ç»è®¡ä¿¡æ¯æ¯å¦è½åç¡®çæè¿°è¡¨ä¸­çæ°æ®åå¸æåµæ¯å³å®ä»£ä»·çåç¡®æ§çéè¦æ¡ä»¶ä¹ä¸ãâ</p>\n<p>å°æè¯´ï¼âå¤§æåæè¯´è¿ï¼æ°æ®åºæå¾å¤çç©çè·¯å¾ï¼è¿äºç©çè·¯å¾æä»¬ä¹å«ä»ä»¬ç©çç®å­ï¼åé»è¾ç®å­ä¸åï¼ç©çç®å­æ¯æ¥è¯¢æ§è¡å¨çæ§è¡æ¹æ³ï¼æä»¬åªéè¦è®¡ç®ç©çç®å­æ¯ä¸ªæ­¥éª¤çä»£ä»·ï¼æ±æ»èµ·æ¥å°±æ¯è·¯å¾çä»£ä»·äºï¼é£è¦ç»è®¡ä¿¡æ¯æä»ä¹ç¨å¢ï¼â</p>\n<p>çäºå¥çäºçå¤§æï¼æææ¯è®©å¤§ææ¥è¯´ï¼ä¸è¿å¤§ææ­£å¨ä¸å¿çæ¥åäºåå¤åAPPï¼æ¾å¤§è°å­åçº¢éï¼å¹¶æ²¡æçå°çäºå¥çç¼ç¥ï¼çäºå¥åªå¥½å°´å°¬çè¯´ï¼âæ¯çï¼æä»¬å°±æ¯è¦è®¡ç®ä¸ä¸ªç©çç®å­çä»£ä»·ï¼ä½æ¯ç©çç®å­çè®¡ç®éå¹¶ä¸æ¯ä¸æä¸åçãâè¯´ççäºå¥ä»æè¾¹çä¹¦æ¡ä¸æ¿æ¥çº¸åç¬ï¼å¨çº¸ä¸åäºä¸¤ä¸ªSQLè¯­å¥ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT A+B FROM TEST_A WHERE A &gt; 1;</span><br><span class=\"line\">SELECT A+B FROM TEST_A WHERE A &gt; 100000000;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åçäºå¥è¯´ï¼âä½ çï¼è¿ä¸¤ä¸ªè¯­å¥å¯ä»¥ç¨åæ ·çç©çç®å­æ¥å®æï¼ä½æ¯ä»ä»¬çè®¡ç®éä¸æ ·åï¼â</p>\n<p>å°æå¿æ³ï¼A &gt; 1åA &gt; 1000000000é½æ¯è¿æ»¤æ¡ä»¶ï¼ç»è¿è¿æ»¤ä¹åï¼ä»ä»¬äº§ççæ°æ®éå°±ä¸åäºï¼è¿æ ·æå½±ä¸­çA+Bçè®¡ç®çæ¬¡æ°å°±ä¸åäºï¼æä»¥ä»ä»¬çä»£ä»·åºè¯¥æ¯ä¸åçï¼é£å®åç»è®¡ä¿¡æ¯æä»ä¹å³ç³»å¢ï¼å°ææè§çµåä¸éªï¼é©¬ä¸è¯´ï¼âæç¥éäºï¼æå¨è®¡ç®ç©çç®å­çä»£ä»·çæ¶åï¼è¦ç¥éA &gt; 1ä¹åè¿å©ä¸å¤å°æ°æ®æèA &gt; 1000000000ä¹åè¿å©ä¸å¤å°æ°æ®ï¼å¦ææä»¬æåå¯¹è¡¨ä¸çæ°æ®åå®¹åäºç»è®¡ï¼å©ä¸å¤å°æ°æ®å°±ä¸é¾è®¡ç®äºï¼æä»¥å¿é¡»è¦æç»è®¡ä¿¡æ¯ãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯ï¼éè¿ç»è®¡ä¿¡æ¯ï¼ä»£ä»·ä¼°ç®ç³»ç»å°±å¯ä»¥äºè§£ä¸ä¸ªè¡¨æå¤å°è¡æ°æ®ãç¨äºå¤å°ä¸ªæ°æ®é¡µé¢ãæä¸ªå¼åºç°çé¢çç­ç­ï¼ç¶åå°±è½æ ¹æ®è¿äºä¿¡æ¯è®¡ç®åºä¸ä¸ªçº¦ææ¡ä»¶è½è¿æ»¤æå¤å°æ°æ®ï¼è¿ç§çº¦ææ¡ä»¶è¿æ»¤åºçæ°æ®å æ»æ°æ®éçæ¯ä¾ç§°ä¹ä¸ºâéæ©çâï¼æè°éæ©çå°±æ¯ä¸ä¸ªæ¯ä¾ï¼å®çå¬å¼æ¯è¿æ ·çãâè¯´ççäºå¥ç»§ç»­å¨çº¸ä¸åäºéæ©ççå¬å¼ï¼<br>éæ©ç=çº¦ææ¡ä»¶è¿æ»¤åçåç»æ°/çº¦ææ¡ä»¶è¿æ»¤åçæ»åç»æ°</p>\n<p>âä¸è¿ä¸é¢çç¤ºä¾æç¹ç®åäºï¼å®éåºç¨ä¸­éå¸¸çº¦ææ¡ä»¶ä¼æ¯è¾å¤ï¼èä¸æ¯è¾å¤æï¼éå¸¸æä»¬ä¼è®¡ç®æ¯ä¸ªå­çº¦ææ¡ä»¶çéæ©çï¼ç¶åå°±å¯ä»¥æ ¹æ®ANDè¿ç®ç¬¦åORè¿ç®ç¬¦è®¡ç®å®ä»¬çç»¼åçéæ©çï¼ANDè¿ç®ç¬¦åORè¿ç®ç¬¦çéæ©çè®¡ç®æ¯åºäºæ¦ççï¼ä½ çè¿éçæ¦çå¬å¼ãâè¯´çï¼çäºå¥åç»§ç»­å¨çº¸ä¸åèµ·æ¥ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">P(A+B)&#x3D;P(A)+P(B)-P(AB)</span><br><span class=\"line\">P(AB)&#x3D;P(A)ÃP(B)</span><br></pre></td></tr></table></figure>\n\n<p>âæäºè¿äºï¼æä»¬å°±å¯ä»¥æ±è§£å¤ç§ç±»åççº¦ææ¡ä»¶çéæ©çäºï¼æ¯å¦ãããâçäºå¥ç»§ç»­å¨çº¸ä¸ç»èµ·æ¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  P(ssex IS NOT NULL OR sno &gt; 5) </span><br><span class=\"line\">&#x3D; P(ssex IS NOT NULL) + P(sno &gt; 5) â P(ssex IS NOT NULL AND sno &gt; 5)</span><br><span class=\"line\">&#x3D; P(ssex IS NOT NULL) + P(sno &gt; 5) â P(ssex IS NOT NULL) Ã P(no &gt; 5)</span><br></pre></td></tr></table></figure>\n\n<p>å°æè§å¾çäºå¥çè¿å±æç¹å¿«ï¼èµ¶ç´§é®ï¼âé£ä¹ç»è®¡ä¿¡æ¯æ¯ä»ä¹å½¢å¼çå¢ï¼â</p>\n<p>çäºå¥æ æ å¤´ï¼è¯´ï¼âè¿ä¸ªè¿çæ¯æç¹éº»ç¦ï¼æä»¬è¯´å¸¸ç¨çç»è®¡ä¿¡æ¯çå½¢å¼å°±æ¯distinctçãNULLå¼çãé«é¢å¼ãç´æ¹å¾ãç¸å³ç³»æ°è¿äºï¼ä»ä»¬åå«æä¸åçä½ç¨ï¼æ¯å¦è¯´distinctçï¼ä½ å¯ä»¥è·ç¥æä¸åæå¤å°ä¸ªç¬ç«å¼ï¼è¿ç§ä¿¡æ¯å¯¹äºåæ§å«è¿ç§åå°±æ¾å¾ç¹å«æç¨ï¼NULLå¼çå¢ï¼å¨ç»è®¡çè¿ç¨ä¸­ï¼NULLå¼æ¯ä¸å¥½å¤ççï¼å æ­¤æå®ç¬ç«åºæ¥ï¼å½¢æNULLå¼çï¼è¿æ ·å¨é«é¢å¼ãç´æ¹å¾è¿äºéé¢å°±ä¸ç¨èèNULLå¼çæåµäºï¼é«é¢å¼å±äºå¥å¼å¼ï¼é¡¾åæä¹ï¼å°±æ¯åºç°çæ¯è¾å¤çä¸äºåå¼ï¼å»æäºNULLå¼ï¼åå»æé«é¢å¼ï¼å©ä¸çå¼å¯ä»¥ç¨æ¥åä¸ä¸ªç­é¢çç´æ¹å¾ããããâ</p>\n<p>âåãããâå°ææè§è·ä¸ä¸çäºå¥çéåº¦äºï¼äºæ¯è¯´ï¼âæç¹å¿«ï¼ææç¹è·ä¸ä¸äºãâ</p>\n<p>è¿æ¶å¤§æå·²ç»ç¹å®äºå¤åï¼è¿æ¥è¯´ï¼âå«æ¥ï¼å¤åæ²¡æé£ä¹å¿«éå°ï¼è³äºç»è®¡ä¿¡æ¯åï¼ä¸»è¦çè¿æ¯é«é¢å¼ãç´æ¹å¾åç¸å³ç³»æ°ï¼å®éä¸æå»ºè®®è¿æ¯ä¸è¦çº ç»äºç»è®¡ä¿¡æ¯æåªäºå½¢å¼ï¼æä»¬åªè¦ç¥éå®æ¯ç¨æ¥ç®ä»£ä»·çå°±å¯ä»¥äºãâ</p>\n<p>çäºå¥å¯¹å¤§æè¯´ï¼âè¿æä¹å¯ä»¥ï¼æè¿æ²¡æè¯´ç»è®¡ä¿¡æ¯æ¯å¦ä½çæçå¢ï¼æ¯å¦å®éè¿äºä¸¤é¶æ®µéæ ·ï¼ç¶åå¯¹æ ·æ¬è¿è¡ç»è®¡æ¶ä½¿ç¨çç»è®¡æ¹æ³ï¼åªäºå¼å¯ä»¥ä½ä¸ºé«é¢å¼ï¼ç´æ¹å¾æå ä¸ªæ¡¶ï¼ç¸å³ç³»æ°æ¯æä¹è®¡ç®çï¼ç¸å³ç³»æ°å¨è®¡ç®ç´¢å¼æ«æè·¯å¾ä»£ä»·çæ¶åæä¹ç¨çï¼èä¸æåä½ è¯´ï¼PostgreSQLè¿åºäºåºäºå¤åçæ©å±ç»è®¡ä¿¡æ¯ï¼å¤åç»è®¡ä¿¡æ¯åæäºåªäºç±»åï¼åå«æ¯ä»ä¹å«ä¹ï¼åèªæ¯æä¹è®¡ç®çï¼è¿æéæ©çæ¯æä¹ç»åç»è®¡ä¿¡æ¯è®¡ç®çï¼è¿äºæè¿æ²¡è¯´å¢ãããâ</p>\n<p>å¤§æè¯´ï¼âä½ å¿«é­å´å§ï¼åä½ è¿æ ·è®²ä¼åå¨ï¼å²ä¸æ¯è¦åºä¸æ¬ä¹¦ãâ</p>\n<p>çäºå¥åçè¦ç¶ï¼âé£å¥½å§ï¼ç»è®¡ä¿¡æ¯æä»¬å°±è¯´å°è¿éå§ï¼ä½æ¯å®ç¡®å®æ¯ä»£ä»·è®¡ç®çåºç³ï¼å°æåå­¦ï¼ä½ çè§£äºå®çä½ç¨å°±å¯ä»¥äºãâ</p>\n<p>å°æçè¦çè¯´ï¼âçäºå¥ï¼ä½ è¯´äºè¿ä¹å¤ï¼é½ä¸åè¯æç­æ¡ï¼ææè§è¦å­¦çåå®¹å¥½å¤åãâ</p>\n<p>å¤§æç¬çè¯´ï¼âä¸ç¨è¿ä¹çè¦åï¼æ²¡æå¥äºæ¯ä¸é¡¿ç§ç¤ä¸è½è§£å³çï¼å¦ææï¼é£å°±æ¯ä¸¤é¡¿ãâç¶åå¤§æç»§ç»­ç¥ç§çè¯´ï¼âå®éä¸ç»è®¡ä¿¡æ¯å¾å¾ä¹ä¸åï¼ä½ æ³æ³æ¬æ¥å°±æ¯éæ ·çç»æåï¼æ ·æ¬æ¯å¦æ¾èåæ ¹å°±ä¸å¥½è¯´ï¼èä¸éçåºç¨ç¨åºå¯¹è¡¨çæ´æ°ï¼ç»è®¡ä¿¡æ¯å¯è½æ´æ°ä¸åæ¶ï¼é£å°±æ´ä¼åºç°åå·®ãæ´ä¸¥éçæ¯ï¼å¦ææä»¬éå°a &gt; bè¿æ ·ççº¦ææ¡ä»¶ï¼ä½¿ç¨ç»è®¡ä¿¡æ¯è®¡ç®éæ©çä¹å¾ä¸å¥½è®¡ç®ï¼å³ä½¿ç®åºæ¥ï¼ä¹ä¸ååãâ</p>\n<p>çäºå¥è¯´ï¼âæ¯çï¼ç»è®¡ä¿¡æ¯ç¡®å®ä¹æä¸åç¡®çé®é¢ï¼æå¬è¯´æä¸ªDBAï¼ä»å®¶ç¥åæè¾¹åºäºä¸å£æ³æ°´ï¼ä»ç¸ç¸è§å¾æ¯ååï¼å»æ¾é£æ°´å¤§å¸çä¸çï¼é£æ°´å¤§å¸ææç®ä¸ç®ï¼è¯´ï¼ä½ å¿å­æ¯ä¸ªDBAï¼æ¯æ¬¡æ°æ®åºæ§è½æ¢å°±ç¥éæ´æ°ç»è®¡ä¿¡æ¯ï¼å¯æ¯ç»è®¡ä¿¡æ¯å¤ªæ°´äºï¼é½ä»ä½ å®¶ç¥åååºæ¥äºãâ</p>\n<p>ä¸ä¸ªäººé¡¿æ¶ç¬åä¸å¢ï¼æ°æ°ä»çè¦åæ¢å¤å°äºæ´»æ³¼ï¼å¤§æè¯´ï¼âå­¦ä¹ æ¥è¯¢ä¼åå¨ç¡®å®è¿æ¯æ¯è¾ç¹ççï¼ç»å¯¹ä¸æ¯æä»¬éè¿ä¸ä¸¤æ¬¡è®²è§£å°±è½è®©ä½ åå¾ç²¾éçï¼è¿ä¸ªå­¦ä¹ çæ²çº¿è¿æ¯æ¯è¾é¡å³­çãâ</p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¥½å§ï¼æäºä¸¤ä½å¸åï¼åå ä¸æèªå·±å¤©èµèªæ§ãé£æµåå¥ãçæ ä¸´é£ãé«å¤§å¨æ­¦ãéª¨éª¼æå¥ï¼æç¸ä¿¡ä¸å®è½å°ä¼åå¨æå®ãâ</p>\n<p>å¤§æåçäºå¥é½æåå¨å°ä¸ããã</p>\n","site":{"data":{}},"excerpt":"<p>âåååãããåååâé¨å¤ä¼ æ¥äºæ²é¨å£°ï¼å¤§æå»æå¼æ¿é¨ä¸çï¼è¿æ¥çåæ¥æ¯èªå·±çåäºçäºå¥ï¼çäºå¥æ¯ä¸é¨ä»äºæ°æ®åºæ¥è¯¢ä¼åå¼åçç åï¼ä¹æåå å¹´çä»ä¸ç»éªäºï¼å¤§ææå°éå¸¸happyï¼å ä¸ºè¿ä¸¤å¤©ç»å°æè®²æ¥è¯¢ä¼åå¨å¹²å°æäºååï¼ä»å¤©çäºå¥æ¥äºï¼å¯ä»¥å¸®å©èªå·±ç»å°ææ¥è®²æ¥è¯¢ä¼åå¨äºï¼äºæ¯åçäºå¥è¯´ï¼âçäºåå¿ï¼æ¥äºå°±å«èµ°äºï¼ä»å¤©å¤§è°å­å çº¢éç®¡å¤ï¼ä½ æ¥å¸®æä¸ªå¿ãâ</p>\n<p>çäºå¥æ¯å¤§è°å­ç±å¥½èï¼å¬è¯´æå¤§è°å­ï¼é¡¿æ¶æè§æµèº«é¸¡è¡ç¿»è¾ï¼è¿å¿è¯´ï¼âæ²¡é®é¢ï¼ä¸è¿è¦å¸®ä»ä¹å¿ï¼â</p>","more":"<p>å¤§æè¯´ï¼âæçå¼å¼å°ææè¿å¨å­¦æ ¡è¦è¿è¡æ°æ®åºåçå®è·µï¼æè¿æ»æ¥é®æä¼åå¨çé®é¢ï¼å¯æå¯¹ä¼åå¨ä¹æ¯ä¸ç¥åè§£ï¼è¿ä¸ä½ æ¥äºï¼ä½ å¯ä»¥å¸®æå¼å¼è®²è®²ä¼åå¨äºãâ</p>\n<p>çäºå¥çå¿«çè¯´ï¼âè¿é¾ä¸åæï¼éæ¶é½å¯ä»¥è®²ãâ</p>\n<p>å¤§æè¯´ï¼âå¥½åï¼æåç»æçå¼å¼å°ææä¸ªçµè¯ï¼åä»è¯´æä¼åå¨é«ææ¥äºï¼èµ¶ç´§è¿æ¥è¯·æãâ</p>\n<p>â¦â¦ï¼æ­¤å¤ç¥å»è¿åå­ï¼</p>\n<p>å°ææ©å°±å¬è¯´è¿çäºå¥çåå­ï¼æ®è¯´å¯¹æ¥è¯¢ä¼åéå¸¸äºè§£ï¼æ²¡æ³å°çäºå¥ç«ç¶åèªå·±çå¥å¥æ¯åäºï¼äºæ¯èµ¶ç´§æ¥å°äºå¤§æå®¶ï¼çå°çäºå¥çæ´æ§çæ ¼å­è¡«ååç§çååï¼æè§å°±åå°æå¯ºçæ«å°å§ä¸æ ·ï¼äºæ¯èµ¶ç´§è¯´ï¼âæè¿æè¿æ­£å¨æ¥çåºäºä»£ä»·çä¼åï¼æè§ä»åºäºå¾å¤ä»£ä»·ï¼ä½æ¶è·çå¾®åï¼ææä»å¤©è½å¾å°çäºå¥çæå¯¼ãâ</p>\n<p>çäºå¥è¯´ï¼âä¸å®¢æ°ï¼ææ¯ä¹æ¯åå°äºå¤§è°å­åçº¢éçè¯±æï¼ä¼°è®¡ä»å¤©ä¹è¦ä»åºæ¨ççä»£ä»·ããããä½ æä»ä¹é®é¢å°½ç®¡é®ï¼ææ¡æä¼çåç­ãâççå°æç¨å«©çè¸åºï¼çäºå¥çªç¶æ³èµ·äºèªå·±åå¼å§ä»äºæ°æ®åºåæ ¸å¼åçæ¥å­ï¼å¿åºç¿»è¾èµ·ä¸è¡æ²åæï¼é£æ¯ä¸æ®µä¸å ªåé¦çè¡æ³ªå²åï¼æè¡ãææ³ªãæããã</p>\n<p>çäºå¥çªç¶æ³å°äºä»ä¹ï¼ç»§ç»­è¯´éï¼âè¯´å°ä»£ä»·ï¼æè§å¾æä¸ªä¸è¥¿æ¯ç»ä¸è¿å»çï¼é£å°±æ¯ç»è®¡ä¿¡æ¯åéæ©çï¼PostgreSQLæ°æ®åºçç©çä¼åéè¦è®¡ç®åç§ç©çè·¯å¾çä»£ä»·ï¼èä»£ä»·ä¼°ç®çè¿ç¨ä¸¥éçä¾èµäºæ°æ®åºçç»è®¡ä¿¡æ¯ï¼ç»è®¡ä¿¡æ¯æ¯å¦è½åç¡®çæè¿°è¡¨ä¸­çæ°æ®åå¸æåµæ¯å³å®ä»£ä»·çåç¡®æ§çéè¦æ¡ä»¶ä¹ä¸ãâ</p>\n<p>å°æè¯´ï¼âå¤§æåæè¯´è¿ï¼æ°æ®åºæå¾å¤çç©çè·¯å¾ï¼è¿äºç©çè·¯å¾æä»¬ä¹å«ä»ä»¬ç©çç®å­ï¼åé»è¾ç®å­ä¸åï¼ç©çç®å­æ¯æ¥è¯¢æ§è¡å¨çæ§è¡æ¹æ³ï¼æä»¬åªéè¦è®¡ç®ç©çç®å­æ¯ä¸ªæ­¥éª¤çä»£ä»·ï¼æ±æ»èµ·æ¥å°±æ¯è·¯å¾çä»£ä»·äºï¼é£è¦ç»è®¡ä¿¡æ¯æä»ä¹ç¨å¢ï¼â</p>\n<p>çäºå¥çäºçå¤§æï¼æææ¯è®©å¤§ææ¥è¯´ï¼ä¸è¿å¤§ææ­£å¨ä¸å¿çæ¥åäºåå¤åAPPï¼æ¾å¤§è°å­åçº¢éï¼å¹¶æ²¡æçå°çäºå¥çç¼ç¥ï¼çäºå¥åªå¥½å°´å°¬çè¯´ï¼âæ¯çï¼æä»¬å°±æ¯è¦è®¡ç®ä¸ä¸ªç©çç®å­çä»£ä»·ï¼ä½æ¯ç©çç®å­çè®¡ç®éå¹¶ä¸æ¯ä¸æä¸åçãâè¯´ççäºå¥ä»æè¾¹çä¹¦æ¡ä¸æ¿æ¥çº¸åç¬ï¼å¨çº¸ä¸åäºä¸¤ä¸ªSQLè¯­å¥ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT A+B FROM TEST_A WHERE A &gt; 1;</span><br><span class=\"line\">SELECT A+B FROM TEST_A WHERE A &gt; 100000000;</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åçäºå¥è¯´ï¼âä½ çï¼è¿ä¸¤ä¸ªè¯­å¥å¯ä»¥ç¨åæ ·çç©çç®å­æ¥å®æï¼ä½æ¯ä»ä»¬çè®¡ç®éä¸æ ·åï¼â</p>\n<p>å°æå¿æ³ï¼A &gt; 1åA &gt; 1000000000é½æ¯è¿æ»¤æ¡ä»¶ï¼ç»è¿è¿æ»¤ä¹åï¼ä»ä»¬äº§ççæ°æ®éå°±ä¸åäºï¼è¿æ ·æå½±ä¸­çA+Bçè®¡ç®çæ¬¡æ°å°±ä¸åäºï¼æä»¥ä»ä»¬çä»£ä»·åºè¯¥æ¯ä¸åçï¼é£å®åç»è®¡ä¿¡æ¯æä»ä¹å³ç³»å¢ï¼å°ææè§çµåä¸éªï¼é©¬ä¸è¯´ï¼âæç¥éäºï¼æå¨è®¡ç®ç©çç®å­çä»£ä»·çæ¶åï¼è¦ç¥éA &gt; 1ä¹åè¿å©ä¸å¤å°æ°æ®æèA &gt; 1000000000ä¹åè¿å©ä¸å¤å°æ°æ®ï¼å¦ææä»¬æåå¯¹è¡¨ä¸çæ°æ®åå®¹åäºç»è®¡ï¼å©ä¸å¤å°æ°æ®å°±ä¸é¾è®¡ç®äºï¼æä»¥å¿é¡»è¦æç»è®¡ä¿¡æ¯ãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯ï¼éè¿ç»è®¡ä¿¡æ¯ï¼ä»£ä»·ä¼°ç®ç³»ç»å°±å¯ä»¥äºè§£ä¸ä¸ªè¡¨æå¤å°è¡æ°æ®ãç¨äºå¤å°ä¸ªæ°æ®é¡µé¢ãæä¸ªå¼åºç°çé¢çç­ç­ï¼ç¶åå°±è½æ ¹æ®è¿äºä¿¡æ¯è®¡ç®åºä¸ä¸ªçº¦ææ¡ä»¶è½è¿æ»¤æå¤å°æ°æ®ï¼è¿ç§çº¦ææ¡ä»¶è¿æ»¤åºçæ°æ®å æ»æ°æ®éçæ¯ä¾ç§°ä¹ä¸ºâéæ©çâï¼æè°éæ©çå°±æ¯ä¸ä¸ªæ¯ä¾ï¼å®çå¬å¼æ¯è¿æ ·çãâè¯´ççäºå¥ç»§ç»­å¨çº¸ä¸åäºéæ©ççå¬å¼ï¼<br>éæ©ç=çº¦ææ¡ä»¶è¿æ»¤åçåç»æ°/çº¦ææ¡ä»¶è¿æ»¤åçæ»åç»æ°</p>\n<p>âä¸è¿ä¸é¢çç¤ºä¾æç¹ç®åäºï¼å®éåºç¨ä¸­éå¸¸çº¦ææ¡ä»¶ä¼æ¯è¾å¤ï¼èä¸æ¯è¾å¤æï¼éå¸¸æä»¬ä¼è®¡ç®æ¯ä¸ªå­çº¦ææ¡ä»¶çéæ©çï¼ç¶åå°±å¯ä»¥æ ¹æ®ANDè¿ç®ç¬¦åORè¿ç®ç¬¦è®¡ç®å®ä»¬çç»¼åçéæ©çï¼ANDè¿ç®ç¬¦åORè¿ç®ç¬¦çéæ©çè®¡ç®æ¯åºäºæ¦ççï¼ä½ çè¿éçæ¦çå¬å¼ãâè¯´çï¼çäºå¥åç»§ç»­å¨çº¸ä¸åèµ·æ¥ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">P(A+B)&#x3D;P(A)+P(B)-P(AB)</span><br><span class=\"line\">P(AB)&#x3D;P(A)ÃP(B)</span><br></pre></td></tr></table></figure>\n\n<p>âæäºè¿äºï¼æä»¬å°±å¯ä»¥æ±è§£å¤ç§ç±»åççº¦ææ¡ä»¶çéæ©çäºï¼æ¯å¦ãããâçäºå¥ç»§ç»­å¨çº¸ä¸ç»èµ·æ¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  P(ssex IS NOT NULL OR sno &gt; 5) </span><br><span class=\"line\">&#x3D; P(ssex IS NOT NULL) + P(sno &gt; 5) â P(ssex IS NOT NULL AND sno &gt; 5)</span><br><span class=\"line\">&#x3D; P(ssex IS NOT NULL) + P(sno &gt; 5) â P(ssex IS NOT NULL) Ã P(no &gt; 5)</span><br></pre></td></tr></table></figure>\n\n<p>å°æè§å¾çäºå¥çè¿å±æç¹å¿«ï¼èµ¶ç´§é®ï¼âé£ä¹ç»è®¡ä¿¡æ¯æ¯ä»ä¹å½¢å¼çå¢ï¼â</p>\n<p>çäºå¥æ æ å¤´ï¼è¯´ï¼âè¿ä¸ªè¿çæ¯æç¹éº»ç¦ï¼æä»¬è¯´å¸¸ç¨çç»è®¡ä¿¡æ¯çå½¢å¼å°±æ¯distinctçãNULLå¼çãé«é¢å¼ãç´æ¹å¾ãç¸å³ç³»æ°è¿äºï¼ä»ä»¬åå«æä¸åçä½ç¨ï¼æ¯å¦è¯´distinctçï¼ä½ å¯ä»¥è·ç¥æä¸åæå¤å°ä¸ªç¬ç«å¼ï¼è¿ç§ä¿¡æ¯å¯¹äºåæ§å«è¿ç§åå°±æ¾å¾ç¹å«æç¨ï¼NULLå¼çå¢ï¼å¨ç»è®¡çè¿ç¨ä¸­ï¼NULLå¼æ¯ä¸å¥½å¤ççï¼å æ­¤æå®ç¬ç«åºæ¥ï¼å½¢æNULLå¼çï¼è¿æ ·å¨é«é¢å¼ãç´æ¹å¾è¿äºéé¢å°±ä¸ç¨èèNULLå¼çæåµäºï¼é«é¢å¼å±äºå¥å¼å¼ï¼é¡¾åæä¹ï¼å°±æ¯åºç°çæ¯è¾å¤çä¸äºåå¼ï¼å»æäºNULLå¼ï¼åå»æé«é¢å¼ï¼å©ä¸çå¼å¯ä»¥ç¨æ¥åä¸ä¸ªç­é¢çç´æ¹å¾ããããâ</p>\n<p>âåãããâå°ææè§è·ä¸ä¸çäºå¥çéåº¦äºï¼äºæ¯è¯´ï¼âæç¹å¿«ï¼ææç¹è·ä¸ä¸äºãâ</p>\n<p>è¿æ¶å¤§æå·²ç»ç¹å®äºå¤åï¼è¿æ¥è¯´ï¼âå«æ¥ï¼å¤åæ²¡æé£ä¹å¿«éå°ï¼è³äºç»è®¡ä¿¡æ¯åï¼ä¸»è¦çè¿æ¯é«é¢å¼ãç´æ¹å¾åç¸å³ç³»æ°ï¼å®éä¸æå»ºè®®è¿æ¯ä¸è¦çº ç»äºç»è®¡ä¿¡æ¯æåªäºå½¢å¼ï¼æä»¬åªè¦ç¥éå®æ¯ç¨æ¥ç®ä»£ä»·çå°±å¯ä»¥äºãâ</p>\n<p>çäºå¥å¯¹å¤§æè¯´ï¼âè¿æä¹å¯ä»¥ï¼æè¿æ²¡æè¯´ç»è®¡ä¿¡æ¯æ¯å¦ä½çæçå¢ï¼æ¯å¦å®éè¿äºä¸¤é¶æ®µéæ ·ï¼ç¶åå¯¹æ ·æ¬è¿è¡ç»è®¡æ¶ä½¿ç¨çç»è®¡æ¹æ³ï¼åªäºå¼å¯ä»¥ä½ä¸ºé«é¢å¼ï¼ç´æ¹å¾æå ä¸ªæ¡¶ï¼ç¸å³ç³»æ°æ¯æä¹è®¡ç®çï¼ç¸å³ç³»æ°å¨è®¡ç®ç´¢å¼æ«æè·¯å¾ä»£ä»·çæ¶åæä¹ç¨çï¼èä¸æåä½ è¯´ï¼PostgreSQLè¿åºäºåºäºå¤åçæ©å±ç»è®¡ä¿¡æ¯ï¼å¤åç»è®¡ä¿¡æ¯åæäºåªäºç±»åï¼åå«æ¯ä»ä¹å«ä¹ï¼åèªæ¯æä¹è®¡ç®çï¼è¿æéæ©çæ¯æä¹ç»åç»è®¡ä¿¡æ¯è®¡ç®çï¼è¿äºæè¿æ²¡è¯´å¢ãããâ</p>\n<p>å¤§æè¯´ï¼âä½ å¿«é­å´å§ï¼åä½ è¿æ ·è®²ä¼åå¨ï¼å²ä¸æ¯è¦åºä¸æ¬ä¹¦ãâ</p>\n<p>çäºå¥åçè¦ç¶ï¼âé£å¥½å§ï¼ç»è®¡ä¿¡æ¯æä»¬å°±è¯´å°è¿éå§ï¼ä½æ¯å®ç¡®å®æ¯ä»£ä»·è®¡ç®çåºç³ï¼å°æåå­¦ï¼ä½ çè§£äºå®çä½ç¨å°±å¯ä»¥äºãâ</p>\n<p>å°æçè¦çè¯´ï¼âçäºå¥ï¼ä½ è¯´äºè¿ä¹å¤ï¼é½ä¸åè¯æç­æ¡ï¼ææè§è¦å­¦çåå®¹å¥½å¤åãâ</p>\n<p>å¤§æç¬çè¯´ï¼âä¸ç¨è¿ä¹çè¦åï¼æ²¡æå¥äºæ¯ä¸é¡¿ç§ç¤ä¸è½è§£å³çï¼å¦ææï¼é£å°±æ¯ä¸¤é¡¿ãâç¶åå¤§æç»§ç»­ç¥ç§çè¯´ï¼âå®éä¸ç»è®¡ä¿¡æ¯å¾å¾ä¹ä¸åï¼ä½ æ³æ³æ¬æ¥å°±æ¯éæ ·çç»æåï¼æ ·æ¬æ¯å¦æ¾èåæ ¹å°±ä¸å¥½è¯´ï¼èä¸éçåºç¨ç¨åºå¯¹è¡¨çæ´æ°ï¼ç»è®¡ä¿¡æ¯å¯è½æ´æ°ä¸åæ¶ï¼é£å°±æ´ä¼åºç°åå·®ãæ´ä¸¥éçæ¯ï¼å¦ææä»¬éå°a &gt; bè¿æ ·ççº¦ææ¡ä»¶ï¼ä½¿ç¨ç»è®¡ä¿¡æ¯è®¡ç®éæ©çä¹å¾ä¸å¥½è®¡ç®ï¼å³ä½¿ç®åºæ¥ï¼ä¹ä¸ååãâ</p>\n<p>çäºå¥è¯´ï¼âæ¯çï¼ç»è®¡ä¿¡æ¯ç¡®å®ä¹æä¸åç¡®çé®é¢ï¼æå¬è¯´æä¸ªDBAï¼ä»å®¶ç¥åæè¾¹åºäºä¸å£æ³æ°´ï¼ä»ç¸ç¸è§å¾æ¯ååï¼å»æ¾é£æ°´å¤§å¸çä¸çï¼é£æ°´å¤§å¸ææç®ä¸ç®ï¼è¯´ï¼ä½ å¿å­æ¯ä¸ªDBAï¼æ¯æ¬¡æ°æ®åºæ§è½æ¢å°±ç¥éæ´æ°ç»è®¡ä¿¡æ¯ï¼å¯æ¯ç»è®¡ä¿¡æ¯å¤ªæ°´äºï¼é½ä»ä½ å®¶ç¥åååºæ¥äºãâ</p>\n<p>ä¸ä¸ªäººé¡¿æ¶ç¬åä¸å¢ï¼æ°æ°ä»çè¦åæ¢å¤å°äºæ´»æ³¼ï¼å¤§æè¯´ï¼âå­¦ä¹ æ¥è¯¢ä¼åå¨ç¡®å®è¿æ¯æ¯è¾ç¹ççï¼ç»å¯¹ä¸æ¯æä»¬éè¿ä¸ä¸¤æ¬¡è®²è§£å°±è½è®©ä½ åå¾ç²¾éçï¼è¿ä¸ªå­¦ä¹ çæ²çº¿è¿æ¯æ¯è¾é¡å³­çãâ</p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¥½å§ï¼æäºä¸¤ä½å¸åï¼åå ä¸æèªå·±å¤©èµèªæ§ãé£æµåå¥ãçæ ä¸´é£ãé«å¤§å¨æ­¦ãéª¨éª¼æå¥ï¼æç¸ä¿¡ä¸å®è½å°ä¼åå¨æå®ãâ</p>\n<p>å¤§æåçäºå¥é½æåå¨å°ä¸ããã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(7) - ä½ èµ°ä½ çé³å³é","date":"2020-10-03T00:36:07.000Z","_content":"\nå°æâæéâäºæåçå¤§æåçäºå¥ï¼ç¶åè¯´ï¼âè¶çå¤§è°å­åçº¢éè¿æ²¡éå°ï¼ä¸å¦ç»æè¯´è¯´ç©çè·¯å¾å§ï¼è½ç¶æä»¬ä»£ä»·è®¡ç®æ¥è®¡ç®å»ï¼æç»è¿æ¯ä¸ºç©çè·¯å¾è®¡ç®ä»£ä»·åãâ\n\nå¤§ææ¤æçè¯´ï¼âè®²ç©çè·¯å¾å¯ä»¥ï¼ä¸è¿ä½ å¦æåè¿ä¹å¹åèªå·±ï¼å±ä¿©å°±å¿ä¸ä¸¤ç«ï¼ä½ èµ°ä½ çé³å³éï¼æè¿æçç¬æ¨æ¡¥ãâ\n\nçäºå¥ç¬çè¯´ï¼âæçè¿æ¯åç®ç®èµ°é³å³éåç®è¿æ¯èµ°ç¬æ¨æ¡¥åç®å§ï¼åæ ·ä¸ä»¶äºï¼æ¢å¯ä»¥èµ°é³å³éï¼ä¹å¯ä»¥èµ°ç¬æ¨æ¡¥ï¼æè°æ®éåå½äºå°½åï¼ä¸è¿æä»¬è¿æ¯å¾ç¥éåªä¸ä¸ªéåèªå·±ãâ<!-- more -->\n\nå°æè¯´ï¼âå¤§æåæè¯´è¿è¿äºé³å³éåç¬æ¨æ¡¥ï¼å®å¤§ä½ä¸åææ«æè·¯å¾åè¿æ¥è·¯å¾ï¼ææ¥è¿ä¸äºæ¥è¯¢ä¼åå¨çè¯´æï¼æç¥éæ«æè·¯å¾æé¡ºåºæ«æè·¯å¾ãç´¢å¼æ«æè·¯å¾ãä½å¾æ«æè·¯å¾ç­ç­ï¼èè¿æ¥è·¯å¾éå¸¸æåµå¥å¾ªç¯è¿æ¥è·¯å¾ãåå¸è¿æ¥è·¯å¾ãå½å¹¶è¿æ¥è·¯å¾ï¼å¦å¤è¿æä¸äºå¶ä»çè·¯å¾ï¼æ¯å¦æåºè·¯å¾ãç©åè·¯å¾ç­ç­ãâ\n\nçäºå¥è¯´ï¼âæ¯çï¼æä»¬å°±æ¥è¯´è¯´è¿äºè·¯å¾çå«ä¹å§ãå¦æè¦è·å¾ä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼æåºç¡çæ¹æ³å°±æ¯å°è¡¨ä¸­çææçæ°æ®é½éåä¸éï¼ä»ä¸­æéåºç¬¦åæ¡ä»¶çæ°æ®ï¼è¿ç§æ¹å¼å°±æ¯é¡ºåºæ«æè·¯å¾ï¼é¡ºåºæ«æè·¯å¾çä¼ç¹æ¯å¶å·æå¹¿æ³çéç¨æ§ï¼åç§è¡¨é½å¯ä»¥ç¨è¿ç§æ¹æ³ï¼å®ç¼ºç¹èªç¶æ¯ä»£ä»·éå¸¸æ¯è¾é«ï¼å ä¸ºè¦æææçæ°æ®é½éåä¸éãâå¤§æè¶ççäºå¥è¯´é¡ºåºæ«æè·¯å¾çæ¶åï¼å¨çº¸ä¸ç»äºä¸ªå¾ï¼è¯´ï¼âè¿ä¸ªå¾å¤§æ¦å°±æ¯é¡ºåºæ«æè·¯å¾ãâ\n\n![](./postgresql-optimizer-outline-7/1.jpg) \n\nçäºå¥åç»§ç»­è¯´ï¼âå¦æå°æ°æ®åä¸äºé¢å¤çï¼æ¯å¦å»ºç«ä¸ä¸ªç´¢å¼ï¼å¦æè¦æ³è·å¾ä¸ä¸ªè¡¨çæ°æ®ï¼å¯ä»¥éè¿æ«æç´¢å¼è·å¾æéæ°æ®çâå°åâï¼ç¶åéè¿å°åå°éè¦çæ°æ®è·ååºæ¥ï¼å°¤å¶æ¯å¨éæ©æä½å¸¦æçº¦ææ¡ä»¶çæåµä¸ï¼å¨ç´¢å¼åçº¦ææ¡ä»¶å±åçä½ç¨ä¸ï¼è¡¨ä¸­çæäºæ°æ®å°±ä¸ç¨åéåäºï¼å ä¸ºéè¿ç´¢å¼å°±å¾å®¹æç¥éè¿äºæ°æ®æ¯ä¸ç¬¦åçº¦ææ¡ä»¶çï¼æ´æçèï¼å ä¸ºç´¢å¼ä¸ä¹ä¿å­äºæ°æ®ï¼å®çæ°æ®åå³ç³»ä¸­çæ°æ®æ¯ä¸è´çï¼å æ­¤å¦æç´¢å¼ä¸çæ°æ®å°±è½æ»¡è¶³è¦æ±ï¼å°±åªéè¦æ«æç´¢å¼å°±å¯ä»¥è·å¾æéçæ°æ®äºï¼ä¹å°±æ¯è¯´å¨æ«æè·¯å¾ä¸­è¿å¯ä»¥æç´¢å¼æ«æè·¯å¾åå¿«éç´¢å¼æ«æè·¯å¾ä¸¤ç§æ¹å¼ãâ\n\nå¤§æåç»§ç»­ä¸ºçäºå¥âæ§åâï¼å¨çº¸ä¸ç»ä¸äºç´¢å¼æ«æåå¿«éç´¢å¼æ«æçå¾ã\n\n![](./postgresql-optimizer-outline-7/2.png) \n \nå°æçå°å¤§æç¹æå¨å¾éåä¸äºâéæºè¯»âä¸ä¸ªå­ï¼äºæ¯é®éï¼âæçè¿ä¸ªç´¢å¼æ«ææéæºè¯»çé®é¢ï¼è¿ä¸ªé®é¢è½å¦æå®è§£å³æå¢ï¼ä¹å°±æ¯è¯´å³å©ç¨äºç´¢å¼ï¼è¿é¿åäºéæºè¯»çé®é¢ï¼æè¿æ ·çåæ³åï¼â\n\nçäºå¥è¯´ï¼âç´¢å¼æ«æè·¯å¾ç¡®å®å¸¦æ¥éæºè¯»çé®é¢ï¼å ä¸ºç´¢å¼ä¸­è®°å½çæ¯æ°æ®åç»çå°åï¼ç´¢å¼æ«ææ¯éè¿æ«æç´¢å¼è·å¾åç»å°åï¼ç¶åéè¿åç»å°åè®¿é®æ°æ®ï¼ç´¢å¼ä¸­ä¿å­çâæåºâçå°åï¼å°æ°æ®ä¸­å°±å¯è½æ¯éæºçäºï¼ä½å¾æ«æå°±è½è§£å³è¿ä¸ªé®é¢ï¼å®éè¿ä½å¾å°å°åä¿å­èµ·æ¥ï¼æå°åæ¶éèµ·æ¥ä¹åï¼ç¶åè®©å°ååå¾æåºï¼è¿æ ·å°±éè¿ä¸­é´çä½å¾æéæºè¯»æ¶è§£æäºãâå¤§æåç»§ç»­å¨çº¸ä¸ç»ä¸äºä½å¾æ«æçç¤ºæå¾ã\n\n![](./postgresql-optimizer-outline-7/3.png) \n \nä¸è¿å¤§æä¸çå¿ä¸ç´âç«å¨æ¡å­éé¢âï¼ä¹æ³âç«å°æ¡å­å¤é¢âæ¿æä¸ä¸âéåâçè§è²ï¼äºæ¯è¯´éï¼âæ«æçè¿ç¨ä¸­è¿ä¼ç»åä¸äºç¹æ®çæåµæä¸äºéå¸¸é«æçæ«æè·¯å¾ï¼æ¯å¦TIDæ«æè·¯å¾ï¼TIDå®éä¸æ¯åç»å¨ç£çä¸çå­å¨å°åï¼æä»¬è½å¤æ ¹æ®TIDç´æ¥å°±è·å¾åç»ï¼è¿æ ·æ¥è¯¢çæçå°±éå¸¸é«äºãâ\n\nçäºå¥ç¹äºç¹å¤´ç»§ç»­è¯´å°ï¼âæ«æè·¯å¾éå¸¸æ¯æ§è¡è®¡åä¸­çå¶å­ç»ç¹ï¼ä¹å°±æ¯å¨æåºå±å¯¹è¡¨è¿è¡æ«æçç»ç¹ï¼æ«æè·¯å¾å°±æ¯ä¸ºè¿æ¥è·¯å¾ååå¤çï¼æ«æåºæ¥çæ°æ®å°±å¯ä»¥ç»è¿æ¥è·¯å¾æ¥å®ç°è¿æ¥æä½äºãâ\n\nå¤§æä¸è¾¹å¨çº¸ä¸ç»ä¸è¾¹è¯´éï¼âè¦å¯¹ä¸¤ä¸ªå³ç³»åè¿æ¥ï¼åç¬å¡å°ç§¯çå¯åï¼å¯ä»¥ç¨ä¸ä¸ªç®æ³å¤æåº¦æ¯O(mn)çæ¹æ³æ¥å®ç°ï¼æä»¬å«å®Nestlooped Joinæ¹æ³ï¼è¿ç§æ¹æ³è½ç¶å¤æåº¦æ¯è¾é«ï¼ä½æ¯åé¡ºåºæ«æä¸æ ·ï¼èå¨å·ææ®éæ§ãâ\n\nçäºå¥è¯´ï¼âåµå¥å¾ªç¯è¿æ¥è¿ç§æ¹æ³çå¤æåº¦æ¯è¾é«ï¼çä¸å»æ²¡ä»ä¹æä¹ï¼ä½æ¯å¦æNestlooped Joinçåè¡¨çè·¯å¾æ¯ä¸ä¸ªç´¢å¼æ«æè·¯å¾ï¼é£ä¹ç®æ³çå¤æåº¦å°±ä¼éä¸æ¥ï¼ç´¢å¼æ«æçç®æ³å¤æåº¦æ¯O(logn)ï¼å æ­¤å¦æNestlooped Joinçåè¡¨æ¯ä¸ä¸ªç´¢å¼æ«æï¼å®çæ´ä½çç®æ³å¤æåº¦å°±åæäºO(mlogn)ï¼çä¸å»è¿æ ·ä¹æ¯å¯ä»¥æ¥åçãâ\n\n![](./postgresql-optimizer-outline-7/4.png) \n\nå°æç¹äºç¹å¤´è¯´ï¼âå¯ï¼ç´¢å¼å®éä¸æ¯å¯¹æ°æ®åäºä¸äºé¢å¤çï¼ææ³å¦æåå¸è¿æ¥æ¹æ³å°±æ¯å°åè¡¨åä¸ä¸ªåå¸è¡¨ï¼è¿æ ·ä¹ç­äºå°åè¡¨çæ°æ®åäºé¢å¤çï¼ä¹è½æ¹ä¾¿å¤è¡¨çåç»å¨éé¢æ¢æµå§ï¼â\n\nçäºå¥ç¹äºç¹å¤´è¯´ï¼âåè®¾Hashè¡¨æNä¸ªæ¡¶ï¼åè¡¨æ°æ®ååçåå¸å¨åä¸ªæ¡¶ä¸­ï¼é£ä¹Hash Joinçæ¶é´å¤æåº¦å°±æ¯O(m * n /N)ï¼å½ç¶ï¼è¿éæä»¬æ²¡æèèä¸å»ºç«Hashè¡¨çä»£ä»·ãâ\n\nå¤§æåå¨çº¸ä¸ç»åºäºHashè¿æ¥çç¤ºæå¾ï¼å¹¶ä¸è¡¥åéï¼âHashè¿æ¥éå¸¸åªè½ç¨æ¥åç­å¼å¤æ­ãâ\n\n![](./postgresql-optimizer-outline-7/5.png) \n \nçäºå¥ç»§ç»­è¯´ï¼âå¦æå°ä¸¤ä¸ªè¡¨åæåºï¼é£ä¹å°±å¯ä»¥å¼å¥ç¬¬ä¸ç§è¿æ¥æ¹å¼ï¼Merge Joinï¼è¿ç§è¿æ¥æ¹å¼çä»£ä»·ä¸»è¦æµªè´¹å¨æåºä¸ï¼å¦æä¸¤ä¸ªå³ç³»çæ°æ®éé½æ¯è¾å°ï¼é£ä¹æåºçä»£ä»·æ¯å¯æ§çï¼MergeJoinå°±æ¯éç¨çï¼å¦å¤å¦æå³ç³»ä¸ææåºçç´¢å¼ï¼é£ä¹å°±å¯ä»¥ä¸ç¨åç¬æåºäºï¼è¿æ ·ä¹æ¯è¾éç¨äºMergeJoinãä½ çæç»çè¿ä¸ªå½å¹¶è¿æ¥çç¤ºæå¾ï¼å¤è¡¨æ¯éè¦æåºçï¼èåè¡¨ååç¨äºåæçç´¢å¼çé¡ºåºï¼æ¶é¤äºæåºçæ¶é´ï¼éä½äºç©çè·¯å¾çä»£ä»·ãâ\n\n![](./postgresql-optimizer-outline-7/6.png) \n \nâè¿äºè·¯å¾å±äºSPJè·¯å¾ï¼å¨PostgreSQLçä¼åå¨ä¸­ï¼éå¸¸ä¼åçæSPJçè·¯å¾ï¼ç¶åå¨è¿åºç¡ä¸åå å Non-SPJçè·¯å¾ï¼æ¯å¦è¯´èéæä½ãæåºæä½ãlimitæä½ãåç»æä½ããããâçäºå¥ç»§ç»­è¡¥åéã\n\nâåååï¼åååâæ²é¨å£°åäºï¼åäºåå¤åä¸æ¥äºä¸ä¸ªäººæç±çå¤§è°å­ï¼åå¤§è°å­çæè§å®å¨åä¸ä¸æ¥ï¼è³äºä¼åå¨ãããåè®©å®è§é¬¼å»å§ã\n","source":"_posts/postgresql-optimizer-outline-7.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(7) - ä½ èµ°ä½ çé³å³é\ndate: 2020-10-03 08:36:07\ntags: è·¯å¾ Path é¡ºåºæ«æ ç´¢å¼æ«æ ä½å¾æ«æ Join\n---\n\nå°æâæéâäºæåçå¤§æåçäºå¥ï¼ç¶åè¯´ï¼âè¶çå¤§è°å­åçº¢éè¿æ²¡éå°ï¼ä¸å¦ç»æè¯´è¯´ç©çè·¯å¾å§ï¼è½ç¶æä»¬ä»£ä»·è®¡ç®æ¥è®¡ç®å»ï¼æç»è¿æ¯ä¸ºç©çè·¯å¾è®¡ç®ä»£ä»·åãâ\n\nå¤§ææ¤æçè¯´ï¼âè®²ç©çè·¯å¾å¯ä»¥ï¼ä¸è¿ä½ å¦æåè¿ä¹å¹åèªå·±ï¼å±ä¿©å°±å¿ä¸ä¸¤ç«ï¼ä½ èµ°ä½ çé³å³éï¼æè¿æçç¬æ¨æ¡¥ãâ\n\nçäºå¥ç¬çè¯´ï¼âæçè¿æ¯åç®ç®èµ°é³å³éåç®è¿æ¯èµ°ç¬æ¨æ¡¥åç®å§ï¼åæ ·ä¸ä»¶äºï¼æ¢å¯ä»¥èµ°é³å³éï¼ä¹å¯ä»¥èµ°ç¬æ¨æ¡¥ï¼æè°æ®éåå½äºå°½åï¼ä¸è¿æä»¬è¿æ¯å¾ç¥éåªä¸ä¸ªéåèªå·±ãâ<!-- more -->\n\nå°æè¯´ï¼âå¤§æåæè¯´è¿è¿äºé³å³éåç¬æ¨æ¡¥ï¼å®å¤§ä½ä¸åææ«æè·¯å¾åè¿æ¥è·¯å¾ï¼ææ¥è¿ä¸äºæ¥è¯¢ä¼åå¨çè¯´æï¼æç¥éæ«æè·¯å¾æé¡ºåºæ«æè·¯å¾ãç´¢å¼æ«æè·¯å¾ãä½å¾æ«æè·¯å¾ç­ç­ï¼èè¿æ¥è·¯å¾éå¸¸æåµå¥å¾ªç¯è¿æ¥è·¯å¾ãåå¸è¿æ¥è·¯å¾ãå½å¹¶è¿æ¥è·¯å¾ï¼å¦å¤è¿æä¸äºå¶ä»çè·¯å¾ï¼æ¯å¦æåºè·¯å¾ãç©åè·¯å¾ç­ç­ãâ\n\nçäºå¥è¯´ï¼âæ¯çï¼æä»¬å°±æ¥è¯´è¯´è¿äºè·¯å¾çå«ä¹å§ãå¦æè¦è·å¾ä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼æåºç¡çæ¹æ³å°±æ¯å°è¡¨ä¸­çææçæ°æ®é½éåä¸éï¼ä»ä¸­æéåºç¬¦åæ¡ä»¶çæ°æ®ï¼è¿ç§æ¹å¼å°±æ¯é¡ºåºæ«æè·¯å¾ï¼é¡ºåºæ«æè·¯å¾çä¼ç¹æ¯å¶å·æå¹¿æ³çéç¨æ§ï¼åç§è¡¨é½å¯ä»¥ç¨è¿ç§æ¹æ³ï¼å®ç¼ºç¹èªç¶æ¯ä»£ä»·éå¸¸æ¯è¾é«ï¼å ä¸ºè¦æææçæ°æ®é½éåä¸éãâå¤§æè¶ççäºå¥è¯´é¡ºåºæ«æè·¯å¾çæ¶åï¼å¨çº¸ä¸ç»äºä¸ªå¾ï¼è¯´ï¼âè¿ä¸ªå¾å¤§æ¦å°±æ¯é¡ºåºæ«æè·¯å¾ãâ\n\n![](./postgresql-optimizer-outline-7/1.jpg) \n\nçäºå¥åç»§ç»­è¯´ï¼âå¦æå°æ°æ®åä¸äºé¢å¤çï¼æ¯å¦å»ºç«ä¸ä¸ªç´¢å¼ï¼å¦æè¦æ³è·å¾ä¸ä¸ªè¡¨çæ°æ®ï¼å¯ä»¥éè¿æ«æç´¢å¼è·å¾æéæ°æ®çâå°åâï¼ç¶åéè¿å°åå°éè¦çæ°æ®è·ååºæ¥ï¼å°¤å¶æ¯å¨éæ©æä½å¸¦æçº¦ææ¡ä»¶çæåµä¸ï¼å¨ç´¢å¼åçº¦ææ¡ä»¶å±åçä½ç¨ä¸ï¼è¡¨ä¸­çæäºæ°æ®å°±ä¸ç¨åéåäºï¼å ä¸ºéè¿ç´¢å¼å°±å¾å®¹æç¥éè¿äºæ°æ®æ¯ä¸ç¬¦åçº¦ææ¡ä»¶çï¼æ´æçèï¼å ä¸ºç´¢å¼ä¸ä¹ä¿å­äºæ°æ®ï¼å®çæ°æ®åå³ç³»ä¸­çæ°æ®æ¯ä¸è´çï¼å æ­¤å¦æç´¢å¼ä¸çæ°æ®å°±è½æ»¡è¶³è¦æ±ï¼å°±åªéè¦æ«æç´¢å¼å°±å¯ä»¥è·å¾æéçæ°æ®äºï¼ä¹å°±æ¯è¯´å¨æ«æè·¯å¾ä¸­è¿å¯ä»¥æç´¢å¼æ«æè·¯å¾åå¿«éç´¢å¼æ«æè·¯å¾ä¸¤ç§æ¹å¼ãâ\n\nå¤§æåç»§ç»­ä¸ºçäºå¥âæ§åâï¼å¨çº¸ä¸ç»ä¸äºç´¢å¼æ«æåå¿«éç´¢å¼æ«æçå¾ã\n\n![](./postgresql-optimizer-outline-7/2.png) \n \nå°æçå°å¤§æç¹æå¨å¾éåä¸äºâéæºè¯»âä¸ä¸ªå­ï¼äºæ¯é®éï¼âæçè¿ä¸ªç´¢å¼æ«ææéæºè¯»çé®é¢ï¼è¿ä¸ªé®é¢è½å¦æå®è§£å³æå¢ï¼ä¹å°±æ¯è¯´å³å©ç¨äºç´¢å¼ï¼è¿é¿åäºéæºè¯»çé®é¢ï¼æè¿æ ·çåæ³åï¼â\n\nçäºå¥è¯´ï¼âç´¢å¼æ«æè·¯å¾ç¡®å®å¸¦æ¥éæºè¯»çé®é¢ï¼å ä¸ºç´¢å¼ä¸­è®°å½çæ¯æ°æ®åç»çå°åï¼ç´¢å¼æ«ææ¯éè¿æ«æç´¢å¼è·å¾åç»å°åï¼ç¶åéè¿åç»å°åè®¿é®æ°æ®ï¼ç´¢å¼ä¸­ä¿å­çâæåºâçå°åï¼å°æ°æ®ä¸­å°±å¯è½æ¯éæºçäºï¼ä½å¾æ«æå°±è½è§£å³è¿ä¸ªé®é¢ï¼å®éè¿ä½å¾å°å°åä¿å­èµ·æ¥ï¼æå°åæ¶éèµ·æ¥ä¹åï¼ç¶åè®©å°ååå¾æåºï¼è¿æ ·å°±éè¿ä¸­é´çä½å¾æéæºè¯»æ¶è§£æäºãâå¤§æåç»§ç»­å¨çº¸ä¸ç»ä¸äºä½å¾æ«æçç¤ºæå¾ã\n\n![](./postgresql-optimizer-outline-7/3.png) \n \nä¸è¿å¤§æä¸çå¿ä¸ç´âç«å¨æ¡å­éé¢âï¼ä¹æ³âç«å°æ¡å­å¤é¢âæ¿æä¸ä¸âéåâçè§è²ï¼äºæ¯è¯´éï¼âæ«æçè¿ç¨ä¸­è¿ä¼ç»åä¸äºç¹æ®çæåµæä¸äºéå¸¸é«æçæ«æè·¯å¾ï¼æ¯å¦TIDæ«æè·¯å¾ï¼TIDå®éä¸æ¯åç»å¨ç£çä¸çå­å¨å°åï¼æä»¬è½å¤æ ¹æ®TIDç´æ¥å°±è·å¾åç»ï¼è¿æ ·æ¥è¯¢çæçå°±éå¸¸é«äºãâ\n\nçäºå¥ç¹äºç¹å¤´ç»§ç»­è¯´å°ï¼âæ«æè·¯å¾éå¸¸æ¯æ§è¡è®¡åä¸­çå¶å­ç»ç¹ï¼ä¹å°±æ¯å¨æåºå±å¯¹è¡¨è¿è¡æ«æçç»ç¹ï¼æ«æè·¯å¾å°±æ¯ä¸ºè¿æ¥è·¯å¾ååå¤çï¼æ«æåºæ¥çæ°æ®å°±å¯ä»¥ç»è¿æ¥è·¯å¾æ¥å®ç°è¿æ¥æä½äºãâ\n\nå¤§æä¸è¾¹å¨çº¸ä¸ç»ä¸è¾¹è¯´éï¼âè¦å¯¹ä¸¤ä¸ªå³ç³»åè¿æ¥ï¼åç¬å¡å°ç§¯çå¯åï¼å¯ä»¥ç¨ä¸ä¸ªç®æ³å¤æåº¦æ¯O(mn)çæ¹æ³æ¥å®ç°ï¼æä»¬å«å®Nestlooped Joinæ¹æ³ï¼è¿ç§æ¹æ³è½ç¶å¤æåº¦æ¯è¾é«ï¼ä½æ¯åé¡ºåºæ«æä¸æ ·ï¼èå¨å·ææ®éæ§ãâ\n\nçäºå¥è¯´ï¼âåµå¥å¾ªç¯è¿æ¥è¿ç§æ¹æ³çå¤æåº¦æ¯è¾é«ï¼çä¸å»æ²¡ä»ä¹æä¹ï¼ä½æ¯å¦æNestlooped Joinçåè¡¨çè·¯å¾æ¯ä¸ä¸ªç´¢å¼æ«æè·¯å¾ï¼é£ä¹ç®æ³çå¤æåº¦å°±ä¼éä¸æ¥ï¼ç´¢å¼æ«æçç®æ³å¤æåº¦æ¯O(logn)ï¼å æ­¤å¦æNestlooped Joinçåè¡¨æ¯ä¸ä¸ªç´¢å¼æ«æï¼å®çæ´ä½çç®æ³å¤æåº¦å°±åæäºO(mlogn)ï¼çä¸å»è¿æ ·ä¹æ¯å¯ä»¥æ¥åçãâ\n\n![](./postgresql-optimizer-outline-7/4.png) \n\nå°æç¹äºç¹å¤´è¯´ï¼âå¯ï¼ç´¢å¼å®éä¸æ¯å¯¹æ°æ®åäºä¸äºé¢å¤çï¼ææ³å¦æåå¸è¿æ¥æ¹æ³å°±æ¯å°åè¡¨åä¸ä¸ªåå¸è¡¨ï¼è¿æ ·ä¹ç­äºå°åè¡¨çæ°æ®åäºé¢å¤çï¼ä¹è½æ¹ä¾¿å¤è¡¨çåç»å¨éé¢æ¢æµå§ï¼â\n\nçäºå¥ç¹äºç¹å¤´è¯´ï¼âåè®¾Hashè¡¨æNä¸ªæ¡¶ï¼åè¡¨æ°æ®ååçåå¸å¨åä¸ªæ¡¶ä¸­ï¼é£ä¹Hash Joinçæ¶é´å¤æåº¦å°±æ¯O(m * n /N)ï¼å½ç¶ï¼è¿éæä»¬æ²¡æèèä¸å»ºç«Hashè¡¨çä»£ä»·ãâ\n\nå¤§æåå¨çº¸ä¸ç»åºäºHashè¿æ¥çç¤ºæå¾ï¼å¹¶ä¸è¡¥åéï¼âHashè¿æ¥éå¸¸åªè½ç¨æ¥åç­å¼å¤æ­ãâ\n\n![](./postgresql-optimizer-outline-7/5.png) \n \nçäºå¥ç»§ç»­è¯´ï¼âå¦æå°ä¸¤ä¸ªè¡¨åæåºï¼é£ä¹å°±å¯ä»¥å¼å¥ç¬¬ä¸ç§è¿æ¥æ¹å¼ï¼Merge Joinï¼è¿ç§è¿æ¥æ¹å¼çä»£ä»·ä¸»è¦æµªè´¹å¨æåºä¸ï¼å¦æä¸¤ä¸ªå³ç³»çæ°æ®éé½æ¯è¾å°ï¼é£ä¹æåºçä»£ä»·æ¯å¯æ§çï¼MergeJoinå°±æ¯éç¨çï¼å¦å¤å¦æå³ç³»ä¸ææåºçç´¢å¼ï¼é£ä¹å°±å¯ä»¥ä¸ç¨åç¬æåºäºï¼è¿æ ·ä¹æ¯è¾éç¨äºMergeJoinãä½ çæç»çè¿ä¸ªå½å¹¶è¿æ¥çç¤ºæå¾ï¼å¤è¡¨æ¯éè¦æåºçï¼èåè¡¨ååç¨äºåæçç´¢å¼çé¡ºåºï¼æ¶é¤äºæåºçæ¶é´ï¼éä½äºç©çè·¯å¾çä»£ä»·ãâ\n\n![](./postgresql-optimizer-outline-7/6.png) \n \nâè¿äºè·¯å¾å±äºSPJè·¯å¾ï¼å¨PostgreSQLçä¼åå¨ä¸­ï¼éå¸¸ä¼åçæSPJçè·¯å¾ï¼ç¶åå¨è¿åºç¡ä¸åå å Non-SPJçè·¯å¾ï¼æ¯å¦è¯´èéæä½ãæåºæä½ãlimitæä½ãåç»æä½ããããâçäºå¥ç»§ç»­è¡¥åéã\n\nâåååï¼åååâæ²é¨å£°åäºï¼åäºåå¤åä¸æ¥äºä¸ä¸ªäººæç±çå¤§è°å­ï¼åå¤§è°å­çæè§å®å¨åä¸ä¸æ¥ï¼è³äºä¼åå¨ãããåè®©å®è§é¬¼å»å§ã\n","slug":"postgresql-optimizer-outline-7","published":1,"updated":"2020-10-03T01:12:47.000Z","_id":"ckfszbzyj0000ro9kgeuy15hy","comments":1,"layout":"post","photos":[],"link":"","content":"<p>å°æâæéâäºæåçå¤§æåçäºå¥ï¼ç¶åè¯´ï¼âè¶çå¤§è°å­åçº¢éè¿æ²¡éå°ï¼ä¸å¦ç»æè¯´è¯´ç©çè·¯å¾å§ï¼è½ç¶æä»¬ä»£ä»·è®¡ç®æ¥è®¡ç®å»ï¼æç»è¿æ¯ä¸ºç©çè·¯å¾è®¡ç®ä»£ä»·åãâ</p>\n<p>å¤§ææ¤æçè¯´ï¼âè®²ç©çè·¯å¾å¯ä»¥ï¼ä¸è¿ä½ å¦æåè¿ä¹å¹åèªå·±ï¼å±ä¿©å°±å¿ä¸ä¸¤ç«ï¼ä½ èµ°ä½ çé³å³éï¼æè¿æçç¬æ¨æ¡¥ãâ</p>\n<p>çäºå¥ç¬çè¯´ï¼âæçè¿æ¯åç®ç®èµ°é³å³éåç®è¿æ¯èµ°ç¬æ¨æ¡¥åç®å§ï¼åæ ·ä¸ä»¶äºï¼æ¢å¯ä»¥èµ°é³å³éï¼ä¹å¯ä»¥èµ°ç¬æ¨æ¡¥ï¼æè°æ®éåå½äºå°½åï¼ä¸è¿æä»¬è¿æ¯å¾ç¥éåªä¸ä¸ªéåèªå·±ãâ<a id=\"more\"></a></p>\n<p>å°æè¯´ï¼âå¤§æåæè¯´è¿è¿äºé³å³éåç¬æ¨æ¡¥ï¼å®å¤§ä½ä¸åææ«æè·¯å¾åè¿æ¥è·¯å¾ï¼ææ¥è¿ä¸äºæ¥è¯¢ä¼åå¨çè¯´æï¼æç¥éæ«æè·¯å¾æé¡ºåºæ«æè·¯å¾ãç´¢å¼æ«æè·¯å¾ãä½å¾æ«æè·¯å¾ç­ç­ï¼èè¿æ¥è·¯å¾éå¸¸æåµå¥å¾ªç¯è¿æ¥è·¯å¾ãåå¸è¿æ¥è·¯å¾ãå½å¹¶è¿æ¥è·¯å¾ï¼å¦å¤è¿æä¸äºå¶ä»çè·¯å¾ï¼æ¯å¦æåºè·¯å¾ãç©åè·¯å¾ç­ç­ãâ</p>\n<p>çäºå¥è¯´ï¼âæ¯çï¼æä»¬å°±æ¥è¯´è¯´è¿äºè·¯å¾çå«ä¹å§ãå¦æè¦è·å¾ä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼æåºç¡çæ¹æ³å°±æ¯å°è¡¨ä¸­çææçæ°æ®é½éåä¸éï¼ä»ä¸­æéåºç¬¦åæ¡ä»¶çæ°æ®ï¼è¿ç§æ¹å¼å°±æ¯é¡ºåºæ«æè·¯å¾ï¼é¡ºåºæ«æè·¯å¾çä¼ç¹æ¯å¶å·æå¹¿æ³çéç¨æ§ï¼åç§è¡¨é½å¯ä»¥ç¨è¿ç§æ¹æ³ï¼å®ç¼ºç¹èªç¶æ¯ä»£ä»·éå¸¸æ¯è¾é«ï¼å ä¸ºè¦æææçæ°æ®é½éåä¸éãâå¤§æè¶ççäºå¥è¯´é¡ºåºæ«æè·¯å¾çæ¶åï¼å¨çº¸ä¸ç»äºä¸ªå¾ï¼è¯´ï¼âè¿ä¸ªå¾å¤§æ¦å°±æ¯é¡ºåºæ«æè·¯å¾ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/1.jpg\"> </p>\n<p>çäºå¥åç»§ç»­è¯´ï¼âå¦æå°æ°æ®åä¸äºé¢å¤çï¼æ¯å¦å»ºç«ä¸ä¸ªç´¢å¼ï¼å¦æè¦æ³è·å¾ä¸ä¸ªè¡¨çæ°æ®ï¼å¯ä»¥éè¿æ«æç´¢å¼è·å¾æéæ°æ®çâå°åâï¼ç¶åéè¿å°åå°éè¦çæ°æ®è·ååºæ¥ï¼å°¤å¶æ¯å¨éæ©æä½å¸¦æçº¦ææ¡ä»¶çæåµä¸ï¼å¨ç´¢å¼åçº¦ææ¡ä»¶å±åçä½ç¨ä¸ï¼è¡¨ä¸­çæäºæ°æ®å°±ä¸ç¨åéåäºï¼å ä¸ºéè¿ç´¢å¼å°±å¾å®¹æç¥éè¿äºæ°æ®æ¯ä¸ç¬¦åçº¦ææ¡ä»¶çï¼æ´æçèï¼å ä¸ºç´¢å¼ä¸ä¹ä¿å­äºæ°æ®ï¼å®çæ°æ®åå³ç³»ä¸­çæ°æ®æ¯ä¸è´çï¼å æ­¤å¦æç´¢å¼ä¸çæ°æ®å°±è½æ»¡è¶³è¦æ±ï¼å°±åªéè¦æ«æç´¢å¼å°±å¯ä»¥è·å¾æéçæ°æ®äºï¼ä¹å°±æ¯è¯´å¨æ«æè·¯å¾ä¸­è¿å¯ä»¥æç´¢å¼æ«æè·¯å¾åå¿«éç´¢å¼æ«æè·¯å¾ä¸¤ç§æ¹å¼ãâ</p>\n<p>å¤§æåç»§ç»­ä¸ºçäºå¥âæ§åâï¼å¨çº¸ä¸ç»ä¸äºç´¢å¼æ«æåå¿«éç´¢å¼æ«æçå¾ã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/2.png\"> </p>\n<p>å°æçå°å¤§æç¹æå¨å¾éåä¸äºâéæºè¯»âä¸ä¸ªå­ï¼äºæ¯é®éï¼âæçè¿ä¸ªç´¢å¼æ«ææéæºè¯»çé®é¢ï¼è¿ä¸ªé®é¢è½å¦æå®è§£å³æå¢ï¼ä¹å°±æ¯è¯´å³å©ç¨äºç´¢å¼ï¼è¿é¿åäºéæºè¯»çé®é¢ï¼æè¿æ ·çåæ³åï¼â</p>\n<p>çäºå¥è¯´ï¼âç´¢å¼æ«æè·¯å¾ç¡®å®å¸¦æ¥éæºè¯»çé®é¢ï¼å ä¸ºç´¢å¼ä¸­è®°å½çæ¯æ°æ®åç»çå°åï¼ç´¢å¼æ«ææ¯éè¿æ«æç´¢å¼è·å¾åç»å°åï¼ç¶åéè¿åç»å°åè®¿é®æ°æ®ï¼ç´¢å¼ä¸­ä¿å­çâæåºâçå°åï¼å°æ°æ®ä¸­å°±å¯è½æ¯éæºçäºï¼ä½å¾æ«æå°±è½è§£å³è¿ä¸ªé®é¢ï¼å®éè¿ä½å¾å°å°åä¿å­èµ·æ¥ï¼æå°åæ¶éèµ·æ¥ä¹åï¼ç¶åè®©å°ååå¾æåºï¼è¿æ ·å°±éè¿ä¸­é´çä½å¾æéæºè¯»æ¶è§£æäºãâå¤§æåç»§ç»­å¨çº¸ä¸ç»ä¸äºä½å¾æ«æçç¤ºæå¾ã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/3.png\"> </p>\n<p>ä¸è¿å¤§æä¸çå¿ä¸ç´âç«å¨æ¡å­éé¢âï¼ä¹æ³âç«å°æ¡å­å¤é¢âæ¿æä¸ä¸âéåâçè§è²ï¼äºæ¯è¯´éï¼âæ«æçè¿ç¨ä¸­è¿ä¼ç»åä¸äºç¹æ®çæåµæä¸äºéå¸¸é«æçæ«æè·¯å¾ï¼æ¯å¦TIDæ«æè·¯å¾ï¼TIDå®éä¸æ¯åç»å¨ç£çä¸çå­å¨å°åï¼æä»¬è½å¤æ ¹æ®TIDç´æ¥å°±è·å¾åç»ï¼è¿æ ·æ¥è¯¢çæçå°±éå¸¸é«äºãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ç»§ç»­è¯´å°ï¼âæ«æè·¯å¾éå¸¸æ¯æ§è¡è®¡åä¸­çå¶å­ç»ç¹ï¼ä¹å°±æ¯å¨æåºå±å¯¹è¡¨è¿è¡æ«æçç»ç¹ï¼æ«æè·¯å¾å°±æ¯ä¸ºè¿æ¥è·¯å¾ååå¤çï¼æ«æåºæ¥çæ°æ®å°±å¯ä»¥ç»è¿æ¥è·¯å¾æ¥å®ç°è¿æ¥æä½äºãâ</p>\n<p>å¤§æä¸è¾¹å¨çº¸ä¸ç»ä¸è¾¹è¯´éï¼âè¦å¯¹ä¸¤ä¸ªå³ç³»åè¿æ¥ï¼åç¬å¡å°ç§¯çå¯åï¼å¯ä»¥ç¨ä¸ä¸ªç®æ³å¤æåº¦æ¯O(mn)çæ¹æ³æ¥å®ç°ï¼æä»¬å«å®Nestlooped Joinæ¹æ³ï¼è¿ç§æ¹æ³è½ç¶å¤æåº¦æ¯è¾é«ï¼ä½æ¯åé¡ºåºæ«æä¸æ ·ï¼èå¨å·ææ®éæ§ãâ</p>\n<p>çäºå¥è¯´ï¼âåµå¥å¾ªç¯è¿æ¥è¿ç§æ¹æ³çå¤æåº¦æ¯è¾é«ï¼çä¸å»æ²¡ä»ä¹æä¹ï¼ä½æ¯å¦æNestlooped Joinçåè¡¨çè·¯å¾æ¯ä¸ä¸ªç´¢å¼æ«æè·¯å¾ï¼é£ä¹ç®æ³çå¤æåº¦å°±ä¼éä¸æ¥ï¼ç´¢å¼æ«æçç®æ³å¤æåº¦æ¯O(logn)ï¼å æ­¤å¦æNestlooped Joinçåè¡¨æ¯ä¸ä¸ªç´¢å¼æ«æï¼å®çæ´ä½çç®æ³å¤æåº¦å°±åæäºO(mlogn)ï¼çä¸å»è¿æ ·ä¹æ¯å¯ä»¥æ¥åçãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/4.png\"> </p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¯ï¼ç´¢å¼å®éä¸æ¯å¯¹æ°æ®åäºä¸äºé¢å¤çï¼ææ³å¦æåå¸è¿æ¥æ¹æ³å°±æ¯å°åè¡¨åä¸ä¸ªåå¸è¡¨ï¼è¿æ ·ä¹ç­äºå°åè¡¨çæ°æ®åäºé¢å¤çï¼ä¹è½æ¹ä¾¿å¤è¡¨çåç»å¨éé¢æ¢æµå§ï¼â</p>\n<p>çäºå¥ç¹äºç¹å¤´è¯´ï¼âåè®¾Hashè¡¨æNä¸ªæ¡¶ï¼åè¡¨æ°æ®ååçåå¸å¨åä¸ªæ¡¶ä¸­ï¼é£ä¹Hash Joinçæ¶é´å¤æåº¦å°±æ¯O(m * n /N)ï¼å½ç¶ï¼è¿éæä»¬æ²¡æèèä¸å»ºç«Hashè¡¨çä»£ä»·ãâ</p>\n<p>å¤§æåå¨çº¸ä¸ç»åºäºHashè¿æ¥çç¤ºæå¾ï¼å¹¶ä¸è¡¥åéï¼âHashè¿æ¥éå¸¸åªè½ç¨æ¥åç­å¼å¤æ­ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/5.png\"> </p>\n<p>çäºå¥ç»§ç»­è¯´ï¼âå¦æå°ä¸¤ä¸ªè¡¨åæåºï¼é£ä¹å°±å¯ä»¥å¼å¥ç¬¬ä¸ç§è¿æ¥æ¹å¼ï¼Merge Joinï¼è¿ç§è¿æ¥æ¹å¼çä»£ä»·ä¸»è¦æµªè´¹å¨æåºä¸ï¼å¦æä¸¤ä¸ªå³ç³»çæ°æ®éé½æ¯è¾å°ï¼é£ä¹æåºçä»£ä»·æ¯å¯æ§çï¼MergeJoinå°±æ¯éç¨çï¼å¦å¤å¦æå³ç³»ä¸ææåºçç´¢å¼ï¼é£ä¹å°±å¯ä»¥ä¸ç¨åç¬æåºäºï¼è¿æ ·ä¹æ¯è¾éç¨äºMergeJoinãä½ çæç»çè¿ä¸ªå½å¹¶è¿æ¥çç¤ºæå¾ï¼å¤è¡¨æ¯éè¦æåºçï¼èåè¡¨ååç¨äºåæçç´¢å¼çé¡ºåºï¼æ¶é¤äºæåºçæ¶é´ï¼éä½äºç©çè·¯å¾çä»£ä»·ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/6.png\"> </p>\n<p>âè¿äºè·¯å¾å±äºSPJè·¯å¾ï¼å¨PostgreSQLçä¼åå¨ä¸­ï¼éå¸¸ä¼åçæSPJçè·¯å¾ï¼ç¶åå¨è¿åºç¡ä¸åå å Non-SPJçè·¯å¾ï¼æ¯å¦è¯´èéæä½ãæåºæä½ãlimitæä½ãåç»æä½ããããâçäºå¥ç»§ç»­è¡¥åéã</p>\n<p>âåååï¼åååâæ²é¨å£°åäºï¼åäºåå¤åä¸æ¥äºä¸ä¸ªäººæç±çå¤§è°å­ï¼åå¤§è°å­çæè§å®å¨åä¸ä¸æ¥ï¼è³äºä¼åå¨ãããåè®©å®è§é¬¼å»å§ã</p>\n","site":{"data":{}},"excerpt":"<p>å°æâæéâäºæåçå¤§æåçäºå¥ï¼ç¶åè¯´ï¼âè¶çå¤§è°å­åçº¢éè¿æ²¡éå°ï¼ä¸å¦ç»æè¯´è¯´ç©çè·¯å¾å§ï¼è½ç¶æä»¬ä»£ä»·è®¡ç®æ¥è®¡ç®å»ï¼æç»è¿æ¯ä¸ºç©çè·¯å¾è®¡ç®ä»£ä»·åãâ</p>\n<p>å¤§ææ¤æçè¯´ï¼âè®²ç©çè·¯å¾å¯ä»¥ï¼ä¸è¿ä½ å¦æåè¿ä¹å¹åèªå·±ï¼å±ä¿©å°±å¿ä¸ä¸¤ç«ï¼ä½ èµ°ä½ çé³å³éï¼æè¿æçç¬æ¨æ¡¥ãâ</p>\n<p>çäºå¥ç¬çè¯´ï¼âæçè¿æ¯åç®ç®èµ°é³å³éåç®è¿æ¯èµ°ç¬æ¨æ¡¥åç®å§ï¼åæ ·ä¸ä»¶äºï¼æ¢å¯ä»¥èµ°é³å³éï¼ä¹å¯ä»¥èµ°ç¬æ¨æ¡¥ï¼æè°æ®éåå½äºå°½åï¼ä¸è¿æä»¬è¿æ¯å¾ç¥éåªä¸ä¸ªéåèªå·±ãâ</p>","more":"<p></p>\n<p>å°æè¯´ï¼âå¤§æåæè¯´è¿è¿äºé³å³éåç¬æ¨æ¡¥ï¼å®å¤§ä½ä¸åææ«æè·¯å¾åè¿æ¥è·¯å¾ï¼ææ¥è¿ä¸äºæ¥è¯¢ä¼åå¨çè¯´æï¼æç¥éæ«æè·¯å¾æé¡ºåºæ«æè·¯å¾ãç´¢å¼æ«æè·¯å¾ãä½å¾æ«æè·¯å¾ç­ç­ï¼èè¿æ¥è·¯å¾éå¸¸æåµå¥å¾ªç¯è¿æ¥è·¯å¾ãåå¸è¿æ¥è·¯å¾ãå½å¹¶è¿æ¥è·¯å¾ï¼å¦å¤è¿æä¸äºå¶ä»çè·¯å¾ï¼æ¯å¦æåºè·¯å¾ãç©åè·¯å¾ç­ç­ãâ</p>\n<p>çäºå¥è¯´ï¼âæ¯çï¼æä»¬å°±æ¥è¯´è¯´è¿äºè·¯å¾çå«ä¹å§ãå¦æè¦è·å¾ä¸ä¸ªè¡¨ä¸­çæ°æ®ï¼æåºç¡çæ¹æ³å°±æ¯å°è¡¨ä¸­çææçæ°æ®é½éåä¸éï¼ä»ä¸­æéåºç¬¦åæ¡ä»¶çæ°æ®ï¼è¿ç§æ¹å¼å°±æ¯é¡ºåºæ«æè·¯å¾ï¼é¡ºåºæ«æè·¯å¾çä¼ç¹æ¯å¶å·æå¹¿æ³çéç¨æ§ï¼åç§è¡¨é½å¯ä»¥ç¨è¿ç§æ¹æ³ï¼å®ç¼ºç¹èªç¶æ¯ä»£ä»·éå¸¸æ¯è¾é«ï¼å ä¸ºè¦æææçæ°æ®é½éåä¸éãâå¤§æè¶ççäºå¥è¯´é¡ºåºæ«æè·¯å¾çæ¶åï¼å¨çº¸ä¸ç»äºä¸ªå¾ï¼è¯´ï¼âè¿ä¸ªå¾å¤§æ¦å°±æ¯é¡ºåºæ«æè·¯å¾ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/1.jpg\"> </p>\n<p>çäºå¥åç»§ç»­è¯´ï¼âå¦æå°æ°æ®åä¸äºé¢å¤çï¼æ¯å¦å»ºç«ä¸ä¸ªç´¢å¼ï¼å¦æè¦æ³è·å¾ä¸ä¸ªè¡¨çæ°æ®ï¼å¯ä»¥éè¿æ«æç´¢å¼è·å¾æéæ°æ®çâå°åâï¼ç¶åéè¿å°åå°éè¦çæ°æ®è·ååºæ¥ï¼å°¤å¶æ¯å¨éæ©æä½å¸¦æçº¦ææ¡ä»¶çæåµä¸ï¼å¨ç´¢å¼åçº¦ææ¡ä»¶å±åçä½ç¨ä¸ï¼è¡¨ä¸­çæäºæ°æ®å°±ä¸ç¨åéåäºï¼å ä¸ºéè¿ç´¢å¼å°±å¾å®¹æç¥éè¿äºæ°æ®æ¯ä¸ç¬¦åçº¦ææ¡ä»¶çï¼æ´æçèï¼å ä¸ºç´¢å¼ä¸ä¹ä¿å­äºæ°æ®ï¼å®çæ°æ®åå³ç³»ä¸­çæ°æ®æ¯ä¸è´çï¼å æ­¤å¦æç´¢å¼ä¸çæ°æ®å°±è½æ»¡è¶³è¦æ±ï¼å°±åªéè¦æ«æç´¢å¼å°±å¯ä»¥è·å¾æéçæ°æ®äºï¼ä¹å°±æ¯è¯´å¨æ«æè·¯å¾ä¸­è¿å¯ä»¥æç´¢å¼æ«æè·¯å¾åå¿«éç´¢å¼æ«æè·¯å¾ä¸¤ç§æ¹å¼ãâ</p>\n<p>å¤§æåç»§ç»­ä¸ºçäºå¥âæ§åâï¼å¨çº¸ä¸ç»ä¸äºç´¢å¼æ«æåå¿«éç´¢å¼æ«æçå¾ã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/2.png\"> </p>\n<p>å°æçå°å¤§æç¹æå¨å¾éåä¸äºâéæºè¯»âä¸ä¸ªå­ï¼äºæ¯é®éï¼âæçè¿ä¸ªç´¢å¼æ«ææéæºè¯»çé®é¢ï¼è¿ä¸ªé®é¢è½å¦æå®è§£å³æå¢ï¼ä¹å°±æ¯è¯´å³å©ç¨äºç´¢å¼ï¼è¿é¿åäºéæºè¯»çé®é¢ï¼æè¿æ ·çåæ³åï¼â</p>\n<p>çäºå¥è¯´ï¼âç´¢å¼æ«æè·¯å¾ç¡®å®å¸¦æ¥éæºè¯»çé®é¢ï¼å ä¸ºç´¢å¼ä¸­è®°å½çæ¯æ°æ®åç»çå°åï¼ç´¢å¼æ«ææ¯éè¿æ«æç´¢å¼è·å¾åç»å°åï¼ç¶åéè¿åç»å°åè®¿é®æ°æ®ï¼ç´¢å¼ä¸­ä¿å­çâæåºâçå°åï¼å°æ°æ®ä¸­å°±å¯è½æ¯éæºçäºï¼ä½å¾æ«æå°±è½è§£å³è¿ä¸ªé®é¢ï¼å®éè¿ä½å¾å°å°åä¿å­èµ·æ¥ï¼æå°åæ¶éèµ·æ¥ä¹åï¼ç¶åè®©å°ååå¾æåºï¼è¿æ ·å°±éè¿ä¸­é´çä½å¾æéæºè¯»æ¶è§£æäºãâå¤§æåç»§ç»­å¨çº¸ä¸ç»ä¸äºä½å¾æ«æçç¤ºæå¾ã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/3.png\"> </p>\n<p>ä¸è¿å¤§æä¸çå¿ä¸ç´âç«å¨æ¡å­éé¢âï¼ä¹æ³âç«å°æ¡å­å¤é¢âæ¿æä¸ä¸âéåâçè§è²ï¼äºæ¯è¯´éï¼âæ«æçè¿ç¨ä¸­è¿ä¼ç»åä¸äºç¹æ®çæåµæä¸äºéå¸¸é«æçæ«æè·¯å¾ï¼æ¯å¦TIDæ«æè·¯å¾ï¼TIDå®éä¸æ¯åç»å¨ç£çä¸çå­å¨å°åï¼æä»¬è½å¤æ ¹æ®TIDç´æ¥å°±è·å¾åç»ï¼è¿æ ·æ¥è¯¢çæçå°±éå¸¸é«äºãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ç»§ç»­è¯´å°ï¼âæ«æè·¯å¾éå¸¸æ¯æ§è¡è®¡åä¸­çå¶å­ç»ç¹ï¼ä¹å°±æ¯å¨æåºå±å¯¹è¡¨è¿è¡æ«æçç»ç¹ï¼æ«æè·¯å¾å°±æ¯ä¸ºè¿æ¥è·¯å¾ååå¤çï¼æ«æåºæ¥çæ°æ®å°±å¯ä»¥ç»è¿æ¥è·¯å¾æ¥å®ç°è¿æ¥æä½äºãâ</p>\n<p>å¤§æä¸è¾¹å¨çº¸ä¸ç»ä¸è¾¹è¯´éï¼âè¦å¯¹ä¸¤ä¸ªå³ç³»åè¿æ¥ï¼åç¬å¡å°ç§¯çå¯åï¼å¯ä»¥ç¨ä¸ä¸ªç®æ³å¤æåº¦æ¯O(mn)çæ¹æ³æ¥å®ç°ï¼æä»¬å«å®Nestlooped Joinæ¹æ³ï¼è¿ç§æ¹æ³è½ç¶å¤æåº¦æ¯è¾é«ï¼ä½æ¯åé¡ºåºæ«æä¸æ ·ï¼èå¨å·ææ®éæ§ãâ</p>\n<p>çäºå¥è¯´ï¼âåµå¥å¾ªç¯è¿æ¥è¿ç§æ¹æ³çå¤æåº¦æ¯è¾é«ï¼çä¸å»æ²¡ä»ä¹æä¹ï¼ä½æ¯å¦æNestlooped Joinçåè¡¨çè·¯å¾æ¯ä¸ä¸ªç´¢å¼æ«æè·¯å¾ï¼é£ä¹ç®æ³çå¤æåº¦å°±ä¼éä¸æ¥ï¼ç´¢å¼æ«æçç®æ³å¤æåº¦æ¯O(logn)ï¼å æ­¤å¦æNestlooped Joinçåè¡¨æ¯ä¸ä¸ªç´¢å¼æ«æï¼å®çæ´ä½çç®æ³å¤æåº¦å°±åæäºO(mlogn)ï¼çä¸å»è¿æ ·ä¹æ¯å¯ä»¥æ¥åçãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/4.png\"> </p>\n<p>å°æç¹äºç¹å¤´è¯´ï¼âå¯ï¼ç´¢å¼å®éä¸æ¯å¯¹æ°æ®åäºä¸äºé¢å¤çï¼ææ³å¦æåå¸è¿æ¥æ¹æ³å°±æ¯å°åè¡¨åä¸ä¸ªåå¸è¡¨ï¼è¿æ ·ä¹ç­äºå°åè¡¨çæ°æ®åäºé¢å¤çï¼ä¹è½æ¹ä¾¿å¤è¡¨çåç»å¨éé¢æ¢æµå§ï¼â</p>\n<p>çäºå¥ç¹äºç¹å¤´è¯´ï¼âåè®¾Hashè¡¨æNä¸ªæ¡¶ï¼åè¡¨æ°æ®ååçåå¸å¨åä¸ªæ¡¶ä¸­ï¼é£ä¹Hash Joinçæ¶é´å¤æåº¦å°±æ¯O(m * n /N)ï¼å½ç¶ï¼è¿éæä»¬æ²¡æèèä¸å»ºç«Hashè¡¨çä»£ä»·ãâ</p>\n<p>å¤§æåå¨çº¸ä¸ç»åºäºHashè¿æ¥çç¤ºæå¾ï¼å¹¶ä¸è¡¥åéï¼âHashè¿æ¥éå¸¸åªè½ç¨æ¥åç­å¼å¤æ­ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/5.png\"> </p>\n<p>çäºå¥ç»§ç»­è¯´ï¼âå¦æå°ä¸¤ä¸ªè¡¨åæåºï¼é£ä¹å°±å¯ä»¥å¼å¥ç¬¬ä¸ç§è¿æ¥æ¹å¼ï¼Merge Joinï¼è¿ç§è¿æ¥æ¹å¼çä»£ä»·ä¸»è¦æµªè´¹å¨æåºä¸ï¼å¦æä¸¤ä¸ªå³ç³»çæ°æ®éé½æ¯è¾å°ï¼é£ä¹æåºçä»£ä»·æ¯å¯æ§çï¼MergeJoinå°±æ¯éç¨çï¼å¦å¤å¦æå³ç³»ä¸ææåºçç´¢å¼ï¼é£ä¹å°±å¯ä»¥ä¸ç¨åç¬æåºäºï¼è¿æ ·ä¹æ¯è¾éç¨äºMergeJoinãä½ çæç»çè¿ä¸ªå½å¹¶è¿æ¥çç¤ºæå¾ï¼å¤è¡¨æ¯éè¦æåºçï¼èåè¡¨ååç¨äºåæçç´¢å¼çé¡ºåºï¼æ¶é¤äºæåºçæ¶é´ï¼éä½äºç©çè·¯å¾çä»£ä»·ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-7/6.png\"> </p>\n<p>âè¿äºè·¯å¾å±äºSPJè·¯å¾ï¼å¨PostgreSQLçä¼åå¨ä¸­ï¼éå¸¸ä¼åçæSPJçè·¯å¾ï¼ç¶åå¨è¿åºç¡ä¸åå å Non-SPJçè·¯å¾ï¼æ¯å¦è¯´èéæä½ãæåºæä½ãlimitæä½ãåç»æä½ããããâçäºå¥ç»§ç»­è¡¥åéã</p>\n<p>âåååï¼åååâæ²é¨å£°åäºï¼åäºåå¤åä¸æ¥äºä¸ä¸ªäººæç±çå¤§è°å­ï¼åå¤§è°å­çæè§å®å¨åä¸ä¸æ¥ï¼è³äºä¼åå¨ãããåè®©å®è§é¬¼å»å§ã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(8) - ç®è®¡ä¸å°å°±åç©·","date":"2020-10-03T00:55:42.000Z","_content":"\nâä¿è¯è¯´åï¼åä¸ç©·ï¼ç©¿ä¸ç©·ï¼ç®è®¡ä¸å°å°±åç©·ãâå¤§æä¸è¾¹åçå¤§è°å­ï¼ä¸è¾¹è¯´ï¼âæä»¥è¯¥åå°±å¾åï¼åæ¯åä¸ç©·çãâ\n\t\nå°æè¯´ï¼âå¯æ¯ç®æ¥ç®å»ï¼ç©çè·¯å¾çä»£ä»·è¿æ¯æéä¸åçæ¶ååãâ\n\nçäºå¥è¯´ï¼âå°æä½ å·²ç»èµ°ç«å¥é­äºï¼æä»¬æ­£å¨ç¾ç¾çåé¥­ï¼ä½ çå¤§æåå¾ç«¹ç­¾å­é½åç«æå­ï¼ä½ éè¦æ¯å°ä¼åå¨ï¼å¤ªæ«å´äºï¼å¥½äºï¼æåé¥±äºï¼ææ¥åä½ èèãâè¯´ççäºå¥æ½äºå¼ çº¸å·¾æ¦äºæ¦å´ï¼çº¸å·¾è¢«å´è§çæ²¹æµ¸æéæç¶ï¼é£æ æ çè¢«çäºå¥å¼¹è¿äºåå¾ç­ï¼ç¶åçäºå¥ææ¸çèªå·±æ²æ»¡å£å¹³çèå­ï¼æ¢æ¡æ¯ççè¯´ï¼âæä¼è·¯å¾éçä¸åæ¯è°çåå ï¼é£å°±æ¯ä»£ä»·æ¨¡åä¸è¡åï¼ä»£ä»·æ¨¡åä¸è¡èµè°ï¼é£å°±æ¯ç¨åºåæ²¡å»ºå¥½åï¼æä»¥è¦æªå°±è¦æªå°ç¨åºåèªå·±å¤´ä¸ãâ\n<!-- more -->\n\nå°æé®éï¼âå¯æ¯æçPostgreSQLæ°æ®åºçä»£ä»·è®¡ç®å·²ç»å¾å¤æäºåï¼â\n\nâå¯æ¯æ°æ®åºçå¨è¾¹ç¯å¢æ´å¤æåãä½ æ³æ³ï¼å¨å®éåºç¨ä¸­ï¼æ°æ®åºç¨æ·çéç½®ç¡¬ä»¶ç¯å¢åå·®ä¸å«ï¼CPUçé¢çãä¸»å­çå¤§å°åç£çä»è´¨çæ§è´¨é½ä¼å½±åæ§è¡è®¡åå¨å®éæ§è¡æ¶çæçãâçäºå¥è¯´å®ï¼åäºä¸å£çº¢éã\n\nå¤§ææ¥è¿æ¥ç»§ç»­è¯´éï¼âè½ç¶å¨ä»£ä»·ä¼°ç®çè¿ç¨ä¸­ï¼æä»¬æ æ³è·å¾âç»å¯¹çå®âçä»£ä»·ï¼ä½æ¯âç»å¯¹çå®âçä»£ä»·ä¹æ¯ä¸å¿è¦çï¼å ä¸ºæä»¬åªæ¯æ³ä»å¤ä¸ªè·¯å¾ï¼Pathï¼ä¸­æ¾å°ä¸ä¸ªä»£ä»·æå°çè·¯å¾ï¼åªè¦è¿äºè·¯å¾çä»£ä»·æ¯å¯ä»¥âç¸äºæ¯è¾âçå°±å¯ä»¥äºï¼å æ­¤å¯ä»¥è®¾å®ä¸ä¸ªâç¸å¯¹âçä»£ä»·çåä½1ï¼åä¸ä¸ªæ¥è¯¢ä¸­ææçç©çè·¯å¾é½åºäºè¿ä¸ªâç¸å¯¹âçåä½1æ¥è®¡ç®çä»£ä»·ï¼è¿æ ·è®¡ç®åºæ¥çä»£ä»·å°±æ¯å¯ä»¥æ¯è¾çï¼ä¹å°±è½ç¨æ¥å¯¹è·¯å¾è¿è¡æéäºãâ\n\nç¶åå¤§æç»çäºå¥éäºæ ¹ä¸­åçï¼è¯´ï¼âé¥­åä¸æ ¹çï¼èµè¿æ´»ç¥ä»ï¼æ¥ï¼æ½ä¸æ ¹ãâçäºå¥æ¥è¿çï¼å¤§ææç«éäºè¿æ¥ï¼çäºå¥ç¹ä¸äºçï¼ææç«æºæå°è¶å ä¸ï¼ç¶åæ·±å¸äºä¸å£ï¼å·äºåé¾çè¯´ï¼âPostgreSQLæ°æ®åºéç¨é¡ºåºè¯»åä¸ä¸ªé¡µé¢çIOä»£ä»·ä½ä¸ºåä½1ï¼èæéæºIOå®ä½äºé¡ºåºIOç4åâ\n\nå°æè¯´ï¼âæç¥éï¼æç¥éï¼è¿ä¸ªææ¥è¿ç¸å³çä¹¦ï¼é¦åï¼ç®åçå­å¨ä»è´¨å¾å¤§é¨åä»ç¶æ¯æºæ¢°ç¡¬çï¼æºæ¢°ç¡¬ççç£å¤´å¨è·å¾æ°æ®åºçæ¶åéè¦ä»åºå¯»éæ¶é´ï¼å¦æè¦è¯»åçæ¯ä¸ä¸²å¨ç£çä¸è¿ç»­çæ°æ®ï¼å°±å¯ä»¥èçå¯»éæ¶é´ï¼æé«IOæ§è½ï¼èå¦æéæºè¯»åç£çä¸ä»»ææåºçæ°æ®ï¼é£ä¹ä¼æå¤§éçæ¶é´æµªè´¹å¨å¯»éä¸ãå¶æ¬¡ï¼å¤§é¨åç£çæ¬èº«å¸¦æç¼å­ï¼è¿å°±å½¢æäºä¸»å­->ç£çç¼å­->ç£ççä¸çº§ç»æï¼å¨å°ç£ççåå®¹å è½½å°åå­çæ¶åï¼èèå°ç£ççIOæ§è½ï¼ç£çä¼è¿è¡æ°æ®çé¢è¯»ï¼æé¢è¯»å°çæ°æ®ä¿å­å¨ç£ççç¼å­ä¸­ï¼ä¹å°±æ¯è¯´å¦æç¨æ·åªæç®ä»ç£çè¯»å100ä¸ªå­èçæ°æ®ï¼é£ä¹ç£çå¯è½ä¼è¿ç»­çè¯»åç£çä¸­ç512å­èï¼ä¸åçç£çé¢è¯»çæ°éå¯è½ä¸åï¼å¹¶å°å¶ä¿å­å°ç£çç¼å­ï¼å¦æä¸ä¸æ¬¡æ¯é¡ºåºè¯»å100ä¸ªå­èä¹åçåå®¹ï¼é£ä¹é¢è¯»ç512å­èçæ°æ®å°±ä¼åæ¥ä½ç¨ï¼æ§è½ä¼å¤§å¤§çå¢å ï¼èå¦æè¯»åçåå®¹è¶åºäº512å­èçèå´ï¼é£ä¹é¢è¯»çæ°æ®å°±æ²¡æåæ¥ä½ç¨ï¼ç£ççIOæ§è½å°±ä¼ä¸éãâè¯´å®å°æå¾æçè¯´ï¼âæä¹æ ·ï¼æè¯´çå¯¹å§ï¼â\n\nçäºå¥è¯´ï¼âä½ è¯´çå¯¹ï¼ç®åPostgreSQLçæ¥è¯¢ä¼åå¤§éçèèäºéæºIOåé¡ºåºIOæå¸¦æ¥çæ§è½å·®å«ï¼å¨è¿æ¹é¢åäºä¸å°ä¼åï¼ä½æ¯ç°å¨çç£çææ¯è¶æ¥è¶åè¾¾äºï¼ä»¥åéæºIOåé¡ºåºIOæ¯ä¸æ¯è¿å·®è¿ä¹å¤ï¼å°±å¼å¾åæ¦·äºãâ\n\nâé£å°åºè¿æé£äºä»£ä»·åºååä½å¢ï¼âå°æç»§ç»­é®éã\n\nå¤§æåç­éï¼âåºäºç£çIOçä»£ä»·åä½å½ç¶å°±æ¯åPageæå³çäºï¼ä¹å°±æ¯è¯´æä»¬åæè¯´çé¡ºåºIOåéæºIOé½å±äºIOæ¹é¢çåºåä»£ä»·ãè®©åè®©çäºå¥ç»ä½ ä»ç»ä¸ä¸CPUæ¹é¢çä»£ä»·åºååä½ï¼æåå»åä¸ªé¸¡ãâ\n\nçäºå¥è¯´ï¼âCPUæ¹é¢çåºååä½æåªäºå¢ï¼æ¯å¦è¯´æä»¬éè¿IOæç£çé¡µé¢è¯»å°äºç¼å­ï¼ä½æä»¬è¦å¤ççæ¯åç»åï¼æä»¥è¿éè¦æåç»ä»é¡µé¢éè§£åºæ¥ï¼è¿è¦å¤çåç»ï¼è¿é¨åä¸»è¦æ¶èçæ¯CPUï¼æä»¥ä¼æä¸ä¸ªåç»å¤ççä»£ä»·åºååä½ï¼å¦å¤ï¼æä»¬å¨æå½±ãçº¦ææ¡ä»¶éæå¤§éçè¡¨è¾¾å¼ï¼è¿äºè¡¨è¾¾å¼æ±è§£ä¹ä¸»è¦æ¶èCPUèµæºï¼æä»¥è¿æä¸ä¸ªè¡¨è¾¾å¼ä»£ä»·çåºååä½ãâ\n\nçäºå¥å¼¹äºå¼¹çç°ï¼ç»§ç»­è¯´éï¼âç°å¨PostgreSQLæ°æ®åºå¢å äºå¾å¤å¹¶è¡è·¯å¾ï¼å æ­¤å®ä¹äº§çäºéä¿¡ä»£ä»·ï¼è¿ä¸ªä¹éè¦è®¡ç®çãâ\n\nå°æå¬äºä¹åï¼è¯´ï¼âé£æä»¬å°±è½å¾å°ä¸ä¸ªè¿æ ·çå¬å¼ãâè¯´çå¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼\n```\n\t\tæ»ä»£ä»· = CPUä»£ä»· + IOä»£ä»· + éä¿¡ä»£ä»·\n```\n\nç¶åå°æç»§ç»­è¯´ï¼âå¯æ¯æéè¿EXPLAINè¿æ¥çè¿PostgreSQLçæ§è¡è®¡åï¼æä»æ§è¡è®¡åä¸­è¿çå°æå¯å¨ä»£ä»·åæ»ä»£ä»·ï¼è¿æ¯æä¹åäºå¢ï¼â\n\nçäºå¥å¬äºä¹åï¼æ³äºæ³ï¼å¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼\n\n```\n\t\tæ»ä»£ä»· = å¯å¨ä»£ä»· + æ§è¡ä»£ä»·\n```\n\nç¶åçäºå¥è¯´ï¼âè¿æ¯ä»å¦ä¸ä¸ªè§åº¦æ¥è®¡ç®ä»£ä»·ï¼å¯å¨ä»£ä»·æ¯æä»è¯­å¥å¼å§æ§è¡å°æ¥è¯¢å¼æè¿åç¬¬ä¸æ¡åç»çä»£ä»·ï¼å¦ä¸ç§è¯´æ³æ¯åå¤å¥½å»è·å¾ç¬¬ä¸æ¡åç»çä»£ä»·ï¼ï¼æ»ä»£ä»·æ¯SQLè¯­å¥ä»å¼å§æ§è¡å°ç»æçææä»£ä»·ãâ\n\t\nâå¯æ¯ãããä¸ºä»ä¹è¦åºåå¯å¨ä»£ä»·åæ§è¡ä»£ä»·å¢ï¼â\n\nâè¿ä¸ªåããããâçäºå¥æèäºä¸ä¸ï¼è§å¾ä¸å¥ä¸¤å¥ä¸å®¹æè¯´æ¸æ¥ï¼äºæ¯åäºä¸ªä¾å­ï¼\n\n```\n\tSELECT * FROM TEST_A WHERE a > 1 ORDER BY a LIMIT 1;\n```\n\nâæä»¬åè®¾è¿ä¸ªå¨TEST_A(a)ä¸æä¸ä¸ªBæ ç´¢å¼ï¼æå¾ä¸ï¼é£è¿ä¸ªè¯­å¥å¯è½ä¼å½¢æä»ä¹æ ·çæ§è¡è®¡åå¢ï¼â\n\nå°ææ³äºæ³ï¼è§å¾ç©ºæ³å¯è½æç¹å°é¾ï¼äºæ¯å¨çº¸ä¸ç»äºä¸èµ·ï¼æç»ä»ç»äºä¸¤ä¸ªæ§è¡è·¯å¾ï¼\n\n```\n\tæ§è¡è·¯å¾1ï¼LIMIT 1\n       \t\t\t\t-> SORT(a)\n                       -> SeqScan WHERE A > 1;\n\tæ§è¡è·¯å¾2ï¼LIMIT 1\n\t\t\t\t\t-> IndexScan WHERE A > 1; \n\t\t\t\t\tï¼å°ææ³¨ï¼Bæ ç´¢å¼æåºï¼ä¸ç¨åæåºäºï¼\n```\n\nå°æè¯´ï¼âæè§å¾è¿ä¸¤ä¸ªé½å¯ä»¥ï¼ä¸è¿æè§å¾ç¬¬äºä¸ªæ´å¥½ï¼å ä¸ºå®èçäºæåºçæ¶é´ãâ\n\nçäºå¥é®ï¼âä½ ç¥éçï¼PostgreSQLæ°æ®åºéç¨å¨æè§åçæ¹æ³æ¥å®ç°è·¯å¾çæç´¢ï¼å®æ¯ä¸ç§èªåºåä¸çæ¹æ³ï¼ä¹å°±æ¯è¯´ä¼åå»ºç«ç­éæ«æè·¯å¾ï¼ç¶åç¨ç­éåçæ«æè·¯å¾åå»å½¢æè¿æ¥è·¯å¾ï¼é£ä¹å¨æä»¬ç­éæ«æè·¯å¾çæ¶åï¼æ¯ä¸ç¥éå®çä¸å±ææ²¡æLIMITçï¼è¿æ¶åå¦æåç¬çSeqScan + SORTåIndexScanä½ è§å¾åªä¸ªå¥½å¢ï¼â\n\nâå¯ï¼æç¥éé·é±å¨åªéï¼å¤§æåæè¯´è¿ï¼A > 1çéæ©çé«çè¯ä¼éæ©é¡ºåºæ«æï¼èA > 1çéæ©çä½çæåµä¸ï¼ä¼éæ©ç´¢å¼æ«æï¼è¿æ¯å ä¸ºç´¢å¼æ«æä¼äº§çéæºIOï¼ä¹å°±æ¯è¯´å¨éæ©çé«çæåµä¸ï¼æå¯è½SeqScan + SORTä¼ä¼äºIndexScanï¼è½ç¶SeqScan + SORTä¼ææåºï¼ä½æ¯IndexScançéæºIOå®å¨æ¯å¤ªå¯è§äºãâ\n\nçäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯¹çï¼åè®¾éæ©çæ¯è¾é«ï¼è¿æ¶åéæ©äºSeqScan + SORTï¼æ¯å ä¸ºå®ä¸ç¥éåä¸å±æ¯LIMIT 1ï¼å¦æä¸é¢æ¯LIMIT 1ï¼å°±ä¼å¯¼è´ç´¢å¼æ«æä¸ç¨å¨é¨æ«å®ï¼åªè¦æ«ä¸ä¸¢ä¸¢å°±å¯ä»¥äºï¼è¿æ¶åéæºIOå°±å¾å°äºï¼ä½æ¯SeqScan + SORTå°±è¿å¿é¡»å¨é¨æ§è¡å®æè½è·åå°LIMIT 1ï¼ä¹å°±æ¯è¯´SeqScan + SORTãæèè¯´SORTè¦è·åç¬¬ä¸æ¡åç»çå¯å¨ä»£ä»·æ¯æ¯è¾é«çï¼å¦æä¸é¢æLIMIT 1è¿æ ·çå­å¥ï¼é£ä¹å¯å¨ä»£ä»·é«çè·¯å¾å¯è½å°±æ²¡æä¼å¿äºï¼è¿å°±æ¯å¯å¨ä»£ä»·çä½ç¨ãâ\n\nå°ææç¶å¤§æï¼è¯´ï¼âSORTè¦å¨é¨åå®æè½è·åç¬¬ä¸æ¡åç»ï¼å®çå¯å¨ä»£ä»·å¤§ï¼ä½æ¯æ»ä»£ä»·å°ï¼èç´¢å¼æ«æå¢ï¼å ä¸ºæ¬èº«æåºï¼å®çå¯å¨ä»£ä»·æ¯å°çï¼ä½æ¯ç±äºæéæºIOï¼æä»¥å®çæ»ä»£ä»·æ¯å¤§çï¼å¦ææä»¬åªæç§æ»ä»£ä»·è¿è¡ç­éï¼å°±æ²¡åæ³è·å¾æä¼çä»£ä»·äºãâ\n\nâä»ä¹ä»ä¹ï¼å¯å¨ä»£ä»·ãããä½ ä»¬è¿å±å¾å¿«åãâè¿æ¶å¤§æè·è¿æ¥ï¼è¯´ï¼âè®©æä»¬æ³ä¸ä¸æä¸åç¹ä»ä¹å§ï¼â\n\nå°æï¼âåç¹å¥½çï¼å¾æå¿è¦ãæè¿èç»èå·²ç»å¿«ç¨æ²¡äºãâ\n","source":"_posts/postgresql-optimizer-outline-8.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(8) - ç®è®¡ä¸å°å°±åç©·\ndate: 2020-10-03 08:55:42\ntags: ä»£ä»· å¯å¨ä»£ä»· IOä»£ä»· CPUä»£ä»·\n---\n\nâä¿è¯è¯´åï¼åä¸ç©·ï¼ç©¿ä¸ç©·ï¼ç®è®¡ä¸å°å°±åç©·ãâå¤§æä¸è¾¹åçå¤§è°å­ï¼ä¸è¾¹è¯´ï¼âæä»¥è¯¥åå°±å¾åï¼åæ¯åä¸ç©·çãâ\n\t\nå°æè¯´ï¼âå¯æ¯ç®æ¥ç®å»ï¼ç©çè·¯å¾çä»£ä»·è¿æ¯æéä¸åçæ¶ååãâ\n\nçäºå¥è¯´ï¼âå°æä½ å·²ç»èµ°ç«å¥é­äºï¼æä»¬æ­£å¨ç¾ç¾çåé¥­ï¼ä½ çå¤§æåå¾ç«¹ç­¾å­é½åç«æå­ï¼ä½ éè¦æ¯å°ä¼åå¨ï¼å¤ªæ«å´äºï¼å¥½äºï¼æåé¥±äºï¼ææ¥åä½ èèãâè¯´ççäºå¥æ½äºå¼ çº¸å·¾æ¦äºæ¦å´ï¼çº¸å·¾è¢«å´è§çæ²¹æµ¸æéæç¶ï¼é£æ æ çè¢«çäºå¥å¼¹è¿äºåå¾ç­ï¼ç¶åçäºå¥ææ¸çèªå·±æ²æ»¡å£å¹³çèå­ï¼æ¢æ¡æ¯ççè¯´ï¼âæä¼è·¯å¾éçä¸åæ¯è°çåå ï¼é£å°±æ¯ä»£ä»·æ¨¡åä¸è¡åï¼ä»£ä»·æ¨¡åä¸è¡èµè°ï¼é£å°±æ¯ç¨åºåæ²¡å»ºå¥½åï¼æä»¥è¦æªå°±è¦æªå°ç¨åºåèªå·±å¤´ä¸ãâ\n<!-- more -->\n\nå°æé®éï¼âå¯æ¯æçPostgreSQLæ°æ®åºçä»£ä»·è®¡ç®å·²ç»å¾å¤æäºåï¼â\n\nâå¯æ¯æ°æ®åºçå¨è¾¹ç¯å¢æ´å¤æåãä½ æ³æ³ï¼å¨å®éåºç¨ä¸­ï¼æ°æ®åºç¨æ·çéç½®ç¡¬ä»¶ç¯å¢åå·®ä¸å«ï¼CPUçé¢çãä¸»å­çå¤§å°åç£çä»è´¨çæ§è´¨é½ä¼å½±åæ§è¡è®¡åå¨å®éæ§è¡æ¶çæçãâçäºå¥è¯´å®ï¼åäºä¸å£çº¢éã\n\nå¤§ææ¥è¿æ¥ç»§ç»­è¯´éï¼âè½ç¶å¨ä»£ä»·ä¼°ç®çè¿ç¨ä¸­ï¼æä»¬æ æ³è·å¾âç»å¯¹çå®âçä»£ä»·ï¼ä½æ¯âç»å¯¹çå®âçä»£ä»·ä¹æ¯ä¸å¿è¦çï¼å ä¸ºæä»¬åªæ¯æ³ä»å¤ä¸ªè·¯å¾ï¼Pathï¼ä¸­æ¾å°ä¸ä¸ªä»£ä»·æå°çè·¯å¾ï¼åªè¦è¿äºè·¯å¾çä»£ä»·æ¯å¯ä»¥âç¸äºæ¯è¾âçå°±å¯ä»¥äºï¼å æ­¤å¯ä»¥è®¾å®ä¸ä¸ªâç¸å¯¹âçä»£ä»·çåä½1ï¼åä¸ä¸ªæ¥è¯¢ä¸­ææçç©çè·¯å¾é½åºäºè¿ä¸ªâç¸å¯¹âçåä½1æ¥è®¡ç®çä»£ä»·ï¼è¿æ ·è®¡ç®åºæ¥çä»£ä»·å°±æ¯å¯ä»¥æ¯è¾çï¼ä¹å°±è½ç¨æ¥å¯¹è·¯å¾è¿è¡æéäºãâ\n\nç¶åå¤§æç»çäºå¥éäºæ ¹ä¸­åçï¼è¯´ï¼âé¥­åä¸æ ¹çï¼èµè¿æ´»ç¥ä»ï¼æ¥ï¼æ½ä¸æ ¹ãâçäºå¥æ¥è¿çï¼å¤§ææç«éäºè¿æ¥ï¼çäºå¥ç¹ä¸äºçï¼ææç«æºæå°è¶å ä¸ï¼ç¶åæ·±å¸äºä¸å£ï¼å·äºåé¾çè¯´ï¼âPostgreSQLæ°æ®åºéç¨é¡ºåºè¯»åä¸ä¸ªé¡µé¢çIOä»£ä»·ä½ä¸ºåä½1ï¼èæéæºIOå®ä½äºé¡ºåºIOç4åâ\n\nå°æè¯´ï¼âæç¥éï¼æç¥éï¼è¿ä¸ªææ¥è¿ç¸å³çä¹¦ï¼é¦åï¼ç®åçå­å¨ä»è´¨å¾å¤§é¨åä»ç¶æ¯æºæ¢°ç¡¬çï¼æºæ¢°ç¡¬ççç£å¤´å¨è·å¾æ°æ®åºçæ¶åéè¦ä»åºå¯»éæ¶é´ï¼å¦æè¦è¯»åçæ¯ä¸ä¸²å¨ç£çä¸è¿ç»­çæ°æ®ï¼å°±å¯ä»¥èçå¯»éæ¶é´ï¼æé«IOæ§è½ï¼èå¦æéæºè¯»åç£çä¸ä»»ææåºçæ°æ®ï¼é£ä¹ä¼æå¤§éçæ¶é´æµªè´¹å¨å¯»éä¸ãå¶æ¬¡ï¼å¤§é¨åç£çæ¬èº«å¸¦æç¼å­ï¼è¿å°±å½¢æäºä¸»å­->ç£çç¼å­->ç£ççä¸çº§ç»æï¼å¨å°ç£ççåå®¹å è½½å°åå­çæ¶åï¼èèå°ç£ççIOæ§è½ï¼ç£çä¼è¿è¡æ°æ®çé¢è¯»ï¼æé¢è¯»å°çæ°æ®ä¿å­å¨ç£ççç¼å­ä¸­ï¼ä¹å°±æ¯è¯´å¦æç¨æ·åªæç®ä»ç£çè¯»å100ä¸ªå­èçæ°æ®ï¼é£ä¹ç£çå¯è½ä¼è¿ç»­çè¯»åç£çä¸­ç512å­èï¼ä¸åçç£çé¢è¯»çæ°éå¯è½ä¸åï¼å¹¶å°å¶ä¿å­å°ç£çç¼å­ï¼å¦æä¸ä¸æ¬¡æ¯é¡ºåºè¯»å100ä¸ªå­èä¹åçåå®¹ï¼é£ä¹é¢è¯»ç512å­èçæ°æ®å°±ä¼åæ¥ä½ç¨ï¼æ§è½ä¼å¤§å¤§çå¢å ï¼èå¦æè¯»åçåå®¹è¶åºäº512å­èçèå´ï¼é£ä¹é¢è¯»çæ°æ®å°±æ²¡æåæ¥ä½ç¨ï¼ç£ççIOæ§è½å°±ä¼ä¸éãâè¯´å®å°æå¾æçè¯´ï¼âæä¹æ ·ï¼æè¯´çå¯¹å§ï¼â\n\nçäºå¥è¯´ï¼âä½ è¯´çå¯¹ï¼ç®åPostgreSQLçæ¥è¯¢ä¼åå¤§éçèèäºéæºIOåé¡ºåºIOæå¸¦æ¥çæ§è½å·®å«ï¼å¨è¿æ¹é¢åäºä¸å°ä¼åï¼ä½æ¯ç°å¨çç£çææ¯è¶æ¥è¶åè¾¾äºï¼ä»¥åéæºIOåé¡ºåºIOæ¯ä¸æ¯è¿å·®è¿ä¹å¤ï¼å°±å¼å¾åæ¦·äºãâ\n\nâé£å°åºè¿æé£äºä»£ä»·åºååä½å¢ï¼âå°æç»§ç»­é®éã\n\nå¤§æåç­éï¼âåºäºç£çIOçä»£ä»·åä½å½ç¶å°±æ¯åPageæå³çäºï¼ä¹å°±æ¯è¯´æä»¬åæè¯´çé¡ºåºIOåéæºIOé½å±äºIOæ¹é¢çåºåä»£ä»·ãè®©åè®©çäºå¥ç»ä½ ä»ç»ä¸ä¸CPUæ¹é¢çä»£ä»·åºååä½ï¼æåå»åä¸ªé¸¡ãâ\n\nçäºå¥è¯´ï¼âCPUæ¹é¢çåºååä½æåªäºå¢ï¼æ¯å¦è¯´æä»¬éè¿IOæç£çé¡µé¢è¯»å°äºç¼å­ï¼ä½æä»¬è¦å¤ççæ¯åç»åï¼æä»¥è¿éè¦æåç»ä»é¡µé¢éè§£åºæ¥ï¼è¿è¦å¤çåç»ï¼è¿é¨åä¸»è¦æ¶èçæ¯CPUï¼æä»¥ä¼æä¸ä¸ªåç»å¤ççä»£ä»·åºååä½ï¼å¦å¤ï¼æä»¬å¨æå½±ãçº¦ææ¡ä»¶éæå¤§éçè¡¨è¾¾å¼ï¼è¿äºè¡¨è¾¾å¼æ±è§£ä¹ä¸»è¦æ¶èCPUèµæºï¼æä»¥è¿æä¸ä¸ªè¡¨è¾¾å¼ä»£ä»·çåºååä½ãâ\n\nçäºå¥å¼¹äºå¼¹çç°ï¼ç»§ç»­è¯´éï¼âç°å¨PostgreSQLæ°æ®åºå¢å äºå¾å¤å¹¶è¡è·¯å¾ï¼å æ­¤å®ä¹äº§çäºéä¿¡ä»£ä»·ï¼è¿ä¸ªä¹éè¦è®¡ç®çãâ\n\nå°æå¬äºä¹åï¼è¯´ï¼âé£æä»¬å°±è½å¾å°ä¸ä¸ªè¿æ ·çå¬å¼ãâè¯´çå¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼\n```\n\t\tæ»ä»£ä»· = CPUä»£ä»· + IOä»£ä»· + éä¿¡ä»£ä»·\n```\n\nç¶åå°æç»§ç»­è¯´ï¼âå¯æ¯æéè¿EXPLAINè¿æ¥çè¿PostgreSQLçæ§è¡è®¡åï¼æä»æ§è¡è®¡åä¸­è¿çå°æå¯å¨ä»£ä»·åæ»ä»£ä»·ï¼è¿æ¯æä¹åäºå¢ï¼â\n\nçäºå¥å¬äºä¹åï¼æ³äºæ³ï¼å¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼\n\n```\n\t\tæ»ä»£ä»· = å¯å¨ä»£ä»· + æ§è¡ä»£ä»·\n```\n\nç¶åçäºå¥è¯´ï¼âè¿æ¯ä»å¦ä¸ä¸ªè§åº¦æ¥è®¡ç®ä»£ä»·ï¼å¯å¨ä»£ä»·æ¯æä»è¯­å¥å¼å§æ§è¡å°æ¥è¯¢å¼æè¿åç¬¬ä¸æ¡åç»çä»£ä»·ï¼å¦ä¸ç§è¯´æ³æ¯åå¤å¥½å»è·å¾ç¬¬ä¸æ¡åç»çä»£ä»·ï¼ï¼æ»ä»£ä»·æ¯SQLè¯­å¥ä»å¼å§æ§è¡å°ç»æçææä»£ä»·ãâ\n\t\nâå¯æ¯ãããä¸ºä»ä¹è¦åºåå¯å¨ä»£ä»·åæ§è¡ä»£ä»·å¢ï¼â\n\nâè¿ä¸ªåããããâçäºå¥æèäºä¸ä¸ï¼è§å¾ä¸å¥ä¸¤å¥ä¸å®¹æè¯´æ¸æ¥ï¼äºæ¯åäºä¸ªä¾å­ï¼\n\n```\n\tSELECT * FROM TEST_A WHERE a > 1 ORDER BY a LIMIT 1;\n```\n\nâæä»¬åè®¾è¿ä¸ªå¨TEST_A(a)ä¸æä¸ä¸ªBæ ç´¢å¼ï¼æå¾ä¸ï¼é£è¿ä¸ªè¯­å¥å¯è½ä¼å½¢æä»ä¹æ ·çæ§è¡è®¡åå¢ï¼â\n\nå°ææ³äºæ³ï¼è§å¾ç©ºæ³å¯è½æç¹å°é¾ï¼äºæ¯å¨çº¸ä¸ç»äºä¸èµ·ï¼æç»ä»ç»äºä¸¤ä¸ªæ§è¡è·¯å¾ï¼\n\n```\n\tæ§è¡è·¯å¾1ï¼LIMIT 1\n       \t\t\t\t-> SORT(a)\n                       -> SeqScan WHERE A > 1;\n\tæ§è¡è·¯å¾2ï¼LIMIT 1\n\t\t\t\t\t-> IndexScan WHERE A > 1; \n\t\t\t\t\tï¼å°ææ³¨ï¼Bæ ç´¢å¼æåºï¼ä¸ç¨åæåºäºï¼\n```\n\nå°æè¯´ï¼âæè§å¾è¿ä¸¤ä¸ªé½å¯ä»¥ï¼ä¸è¿æè§å¾ç¬¬äºä¸ªæ´å¥½ï¼å ä¸ºå®èçäºæåºçæ¶é´ãâ\n\nçäºå¥é®ï¼âä½ ç¥éçï¼PostgreSQLæ°æ®åºéç¨å¨æè§åçæ¹æ³æ¥å®ç°è·¯å¾çæç´¢ï¼å®æ¯ä¸ç§èªåºåä¸çæ¹æ³ï¼ä¹å°±æ¯è¯´ä¼åå»ºç«ç­éæ«æè·¯å¾ï¼ç¶åç¨ç­éåçæ«æè·¯å¾åå»å½¢æè¿æ¥è·¯å¾ï¼é£ä¹å¨æä»¬ç­éæ«æè·¯å¾çæ¶åï¼æ¯ä¸ç¥éå®çä¸å±ææ²¡æLIMITçï¼è¿æ¶åå¦æåç¬çSeqScan + SORTåIndexScanä½ è§å¾åªä¸ªå¥½å¢ï¼â\n\nâå¯ï¼æç¥éé·é±å¨åªéï¼å¤§æåæè¯´è¿ï¼A > 1çéæ©çé«çè¯ä¼éæ©é¡ºåºæ«æï¼èA > 1çéæ©çä½çæåµä¸ï¼ä¼éæ©ç´¢å¼æ«æï¼è¿æ¯å ä¸ºç´¢å¼æ«æä¼äº§çéæºIOï¼ä¹å°±æ¯è¯´å¨éæ©çé«çæåµä¸ï¼æå¯è½SeqScan + SORTä¼ä¼äºIndexScanï¼è½ç¶SeqScan + SORTä¼ææåºï¼ä½æ¯IndexScançéæºIOå®å¨æ¯å¤ªå¯è§äºãâ\n\nçäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯¹çï¼åè®¾éæ©çæ¯è¾é«ï¼è¿æ¶åéæ©äºSeqScan + SORTï¼æ¯å ä¸ºå®ä¸ç¥éåä¸å±æ¯LIMIT 1ï¼å¦æä¸é¢æ¯LIMIT 1ï¼å°±ä¼å¯¼è´ç´¢å¼æ«æä¸ç¨å¨é¨æ«å®ï¼åªè¦æ«ä¸ä¸¢ä¸¢å°±å¯ä»¥äºï¼è¿æ¶åéæºIOå°±å¾å°äºï¼ä½æ¯SeqScan + SORTå°±è¿å¿é¡»å¨é¨æ§è¡å®æè½è·åå°LIMIT 1ï¼ä¹å°±æ¯è¯´SeqScan + SORTãæèè¯´SORTè¦è·åç¬¬ä¸æ¡åç»çå¯å¨ä»£ä»·æ¯æ¯è¾é«çï¼å¦æä¸é¢æLIMIT 1è¿æ ·çå­å¥ï¼é£ä¹å¯å¨ä»£ä»·é«çè·¯å¾å¯è½å°±æ²¡æä¼å¿äºï¼è¿å°±æ¯å¯å¨ä»£ä»·çä½ç¨ãâ\n\nå°ææç¶å¤§æï¼è¯´ï¼âSORTè¦å¨é¨åå®æè½è·åç¬¬ä¸æ¡åç»ï¼å®çå¯å¨ä»£ä»·å¤§ï¼ä½æ¯æ»ä»£ä»·å°ï¼èç´¢å¼æ«æå¢ï¼å ä¸ºæ¬èº«æåºï¼å®çå¯å¨ä»£ä»·æ¯å°çï¼ä½æ¯ç±äºæéæºIOï¼æä»¥å®çæ»ä»£ä»·æ¯å¤§çï¼å¦ææä»¬åªæç§æ»ä»£ä»·è¿è¡ç­éï¼å°±æ²¡åæ³è·å¾æä¼çä»£ä»·äºãâ\n\nâä»ä¹ä»ä¹ï¼å¯å¨ä»£ä»·ãããä½ ä»¬è¿å±å¾å¿«åãâè¿æ¶å¤§æè·è¿æ¥ï¼è¯´ï¼âè®©æä»¬æ³ä¸ä¸æä¸åç¹ä»ä¹å§ï¼â\n\nå°æï¼âåç¹å¥½çï¼å¾æå¿è¦ãæè¿èç»èå·²ç»å¿«ç¨æ²¡äºãâ\n","slug":"postgresql-optimizer-outline-8","published":1,"updated":"2020-10-03T01:01:03.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckfszbzyk0001ro9kakdf920l","content":"<p>âä¿è¯è¯´åï¼åä¸ç©·ï¼ç©¿ä¸ç©·ï¼ç®è®¡ä¸å°å°±åç©·ãâå¤§æä¸è¾¹åçå¤§è°å­ï¼ä¸è¾¹è¯´ï¼âæä»¥è¯¥åå°±å¾åï¼åæ¯åä¸ç©·çãâ</p>\n<p>å°æè¯´ï¼âå¯æ¯ç®æ¥ç®å»ï¼ç©çè·¯å¾çä»£ä»·è¿æ¯æéä¸åçæ¶ååãâ</p>\n<p>çäºå¥è¯´ï¼âå°æä½ å·²ç»èµ°ç«å¥é­äºï¼æä»¬æ­£å¨ç¾ç¾çåé¥­ï¼ä½ çå¤§æåå¾ç«¹ç­¾å­é½åç«æå­ï¼ä½ éè¦æ¯å°ä¼åå¨ï¼å¤ªæ«å´äºï¼å¥½äºï¼æåé¥±äºï¼ææ¥åä½ èèãâè¯´ççäºå¥æ½äºå¼ çº¸å·¾æ¦äºæ¦å´ï¼çº¸å·¾è¢«å´è§çæ²¹æµ¸æéæç¶ï¼é£æ æ çè¢«çäºå¥å¼¹è¿äºåå¾ç­ï¼ç¶åçäºå¥ææ¸çèªå·±æ²æ»¡å£å¹³çèå­ï¼æ¢æ¡æ¯ççè¯´ï¼âæä¼è·¯å¾éçä¸åæ¯è°çåå ï¼é£å°±æ¯ä»£ä»·æ¨¡åä¸è¡åï¼ä»£ä»·æ¨¡åä¸è¡èµè°ï¼é£å°±æ¯ç¨åºåæ²¡å»ºå¥½åï¼æä»¥è¦æªå°±è¦æªå°ç¨åºåèªå·±å¤´ä¸ãâ</p>\n<a id=\"more\"></a>\n\n<p>å°æé®éï¼âå¯æ¯æçPostgreSQLæ°æ®åºçä»£ä»·è®¡ç®å·²ç»å¾å¤æäºåï¼â</p>\n<p>âå¯æ¯æ°æ®åºçå¨è¾¹ç¯å¢æ´å¤æåãä½ æ³æ³ï¼å¨å®éåºç¨ä¸­ï¼æ°æ®åºç¨æ·çéç½®ç¡¬ä»¶ç¯å¢åå·®ä¸å«ï¼CPUçé¢çãä¸»å­çå¤§å°åç£çä»è´¨çæ§è´¨é½ä¼å½±åæ§è¡è®¡åå¨å®éæ§è¡æ¶çæçãâçäºå¥è¯´å®ï¼åäºä¸å£çº¢éã</p>\n<p>å¤§ææ¥è¿æ¥ç»§ç»­è¯´éï¼âè½ç¶å¨ä»£ä»·ä¼°ç®çè¿ç¨ä¸­ï¼æä»¬æ æ³è·å¾âç»å¯¹çå®âçä»£ä»·ï¼ä½æ¯âç»å¯¹çå®âçä»£ä»·ä¹æ¯ä¸å¿è¦çï¼å ä¸ºæä»¬åªæ¯æ³ä»å¤ä¸ªè·¯å¾ï¼Pathï¼ä¸­æ¾å°ä¸ä¸ªä»£ä»·æå°çè·¯å¾ï¼åªè¦è¿äºè·¯å¾çä»£ä»·æ¯å¯ä»¥âç¸äºæ¯è¾âçå°±å¯ä»¥äºï¼å æ­¤å¯ä»¥è®¾å®ä¸ä¸ªâç¸å¯¹âçä»£ä»·çåä½1ï¼åä¸ä¸ªæ¥è¯¢ä¸­ææçç©çè·¯å¾é½åºäºè¿ä¸ªâç¸å¯¹âçåä½1æ¥è®¡ç®çä»£ä»·ï¼è¿æ ·è®¡ç®åºæ¥çä»£ä»·å°±æ¯å¯ä»¥æ¯è¾çï¼ä¹å°±è½ç¨æ¥å¯¹è·¯å¾è¿è¡æéäºãâ</p>\n<p>ç¶åå¤§æç»çäºå¥éäºæ ¹ä¸­åçï¼è¯´ï¼âé¥­åä¸æ ¹çï¼èµè¿æ´»ç¥ä»ï¼æ¥ï¼æ½ä¸æ ¹ãâçäºå¥æ¥è¿çï¼å¤§ææç«éäºè¿æ¥ï¼çäºå¥ç¹ä¸äºçï¼ææç«æºæå°è¶å ä¸ï¼ç¶åæ·±å¸äºä¸å£ï¼å·äºåé¾çè¯´ï¼âPostgreSQLæ°æ®åºéç¨é¡ºåºè¯»åä¸ä¸ªé¡µé¢çIOä»£ä»·ä½ä¸ºåä½1ï¼èæéæºIOå®ä½äºé¡ºåºIOç4åâ</p>\n<p>å°æè¯´ï¼âæç¥éï¼æç¥éï¼è¿ä¸ªææ¥è¿ç¸å³çä¹¦ï¼é¦åï¼ç®åçå­å¨ä»è´¨å¾å¤§é¨åä»ç¶æ¯æºæ¢°ç¡¬çï¼æºæ¢°ç¡¬ççç£å¤´å¨è·å¾æ°æ®åºçæ¶åéè¦ä»åºå¯»éæ¶é´ï¼å¦æè¦è¯»åçæ¯ä¸ä¸²å¨ç£çä¸è¿ç»­çæ°æ®ï¼å°±å¯ä»¥èçå¯»éæ¶é´ï¼æé«IOæ§è½ï¼èå¦æéæºè¯»åç£çä¸ä»»ææåºçæ°æ®ï¼é£ä¹ä¼æå¤§éçæ¶é´æµªè´¹å¨å¯»éä¸ãå¶æ¬¡ï¼å¤§é¨åç£çæ¬èº«å¸¦æç¼å­ï¼è¿å°±å½¢æäºä¸»å­-&gt;ç£çç¼å­-&gt;ç£ççä¸çº§ç»æï¼å¨å°ç£ççåå®¹å è½½å°åå­çæ¶åï¼èèå°ç£ççIOæ§è½ï¼ç£çä¼è¿è¡æ°æ®çé¢è¯»ï¼æé¢è¯»å°çæ°æ®ä¿å­å¨ç£ççç¼å­ä¸­ï¼ä¹å°±æ¯è¯´å¦æç¨æ·åªæç®ä»ç£çè¯»å100ä¸ªå­èçæ°æ®ï¼é£ä¹ç£çå¯è½ä¼è¿ç»­çè¯»åç£çä¸­ç512å­èï¼ä¸åçç£çé¢è¯»çæ°éå¯è½ä¸åï¼å¹¶å°å¶ä¿å­å°ç£çç¼å­ï¼å¦æä¸ä¸æ¬¡æ¯é¡ºåºè¯»å100ä¸ªå­èä¹åçåå®¹ï¼é£ä¹é¢è¯»ç512å­èçæ°æ®å°±ä¼åæ¥ä½ç¨ï¼æ§è½ä¼å¤§å¤§çå¢å ï¼èå¦æè¯»åçåå®¹è¶åºäº512å­èçèå´ï¼é£ä¹é¢è¯»çæ°æ®å°±æ²¡æåæ¥ä½ç¨ï¼ç£ççIOæ§è½å°±ä¼ä¸éãâè¯´å®å°æå¾æçè¯´ï¼âæä¹æ ·ï¼æè¯´çå¯¹å§ï¼â</p>\n<p>çäºå¥è¯´ï¼âä½ è¯´çå¯¹ï¼ç®åPostgreSQLçæ¥è¯¢ä¼åå¤§éçèèäºéæºIOåé¡ºåºIOæå¸¦æ¥çæ§è½å·®å«ï¼å¨è¿æ¹é¢åäºä¸å°ä¼åï¼ä½æ¯ç°å¨çç£çææ¯è¶æ¥è¶åè¾¾äºï¼ä»¥åéæºIOåé¡ºåºIOæ¯ä¸æ¯è¿å·®è¿ä¹å¤ï¼å°±å¼å¾åæ¦·äºãâ</p>\n<p>âé£å°åºè¿æé£äºä»£ä»·åºååä½å¢ï¼âå°æç»§ç»­é®éã</p>\n<p>å¤§æåç­éï¼âåºäºç£çIOçä»£ä»·åä½å½ç¶å°±æ¯åPageæå³çäºï¼ä¹å°±æ¯è¯´æä»¬åæè¯´çé¡ºåºIOåéæºIOé½å±äºIOæ¹é¢çåºåä»£ä»·ãè®©åè®©çäºå¥ç»ä½ ä»ç»ä¸ä¸CPUæ¹é¢çä»£ä»·åºååä½ï¼æåå»åä¸ªé¸¡ãâ</p>\n<p>çäºå¥è¯´ï¼âCPUæ¹é¢çåºååä½æåªäºå¢ï¼æ¯å¦è¯´æä»¬éè¿IOæç£çé¡µé¢è¯»å°äºç¼å­ï¼ä½æä»¬è¦å¤ççæ¯åç»åï¼æä»¥è¿éè¦æåç»ä»é¡µé¢éè§£åºæ¥ï¼è¿è¦å¤çåç»ï¼è¿é¨åä¸»è¦æ¶èçæ¯CPUï¼æä»¥ä¼æä¸ä¸ªåç»å¤ççä»£ä»·åºååä½ï¼å¦å¤ï¼æä»¬å¨æå½±ãçº¦ææ¡ä»¶éæå¤§éçè¡¨è¾¾å¼ï¼è¿äºè¡¨è¾¾å¼æ±è§£ä¹ä¸»è¦æ¶èCPUèµæºï¼æä»¥è¿æä¸ä¸ªè¡¨è¾¾å¼ä»£ä»·çåºååä½ãâ</p>\n<p>çäºå¥å¼¹äºå¼¹çç°ï¼ç»§ç»­è¯´éï¼âç°å¨PostgreSQLæ°æ®åºå¢å äºå¾å¤å¹¶è¡è·¯å¾ï¼å æ­¤å®ä¹äº§çäºéä¿¡ä»£ä»·ï¼è¿ä¸ªä¹éè¦è®¡ç®çãâ</p>\n<p>å°æå¬äºä¹åï¼è¯´ï¼âé£æä»¬å°±è½å¾å°ä¸ä¸ªè¿æ ·çå¬å¼ãâè¯´çå¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ»ä»£ä»· &#x3D; CPUä»£ä»· + IOä»£ä»· + éä¿¡ä»£ä»·</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æç»§ç»­è¯´ï¼âå¯æ¯æéè¿EXPLAINè¿æ¥çè¿PostgreSQLçæ§è¡è®¡åï¼æä»æ§è¡è®¡åä¸­è¿çå°æå¯å¨ä»£ä»·åæ»ä»£ä»·ï¼è¿æ¯æä¹åäºå¢ï¼â</p>\n<p>çäºå¥å¬äºä¹åï¼æ³äºæ³ï¼å¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ»ä»£ä»· &#x3D; å¯å¨ä»£ä»· + æ§è¡ä»£ä»·</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åçäºå¥è¯´ï¼âè¿æ¯ä»å¦ä¸ä¸ªè§åº¦æ¥è®¡ç®ä»£ä»·ï¼å¯å¨ä»£ä»·æ¯æä»è¯­å¥å¼å§æ§è¡å°æ¥è¯¢å¼æè¿åç¬¬ä¸æ¡åç»çä»£ä»·ï¼å¦ä¸ç§è¯´æ³æ¯åå¤å¥½å»è·å¾ç¬¬ä¸æ¡åç»çä»£ä»·ï¼ï¼æ»ä»£ä»·æ¯SQLè¯­å¥ä»å¼å§æ§è¡å°ç»æçææä»£ä»·ãâ</p>\n<p>âå¯æ¯ãããä¸ºä»ä¹è¦åºåå¯å¨ä»£ä»·åæ§è¡ä»£ä»·å¢ï¼â</p>\n<p>âè¿ä¸ªåããããâçäºå¥æèäºä¸ä¸ï¼è§å¾ä¸å¥ä¸¤å¥ä¸å®¹æè¯´æ¸æ¥ï¼äºæ¯åäºä¸ªä¾å­ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM TEST_A WHERE a &gt; 1 ORDER BY a LIMIT 1;</span><br></pre></td></tr></table></figure>\n\n<p>âæä»¬åè®¾è¿ä¸ªå¨TEST_A(a)ä¸æä¸ä¸ªBæ ç´¢å¼ï¼æå¾ä¸ï¼é£è¿ä¸ªè¯­å¥å¯è½ä¼å½¢æä»ä¹æ ·çæ§è¡è®¡åå¢ï¼â</p>\n<p>å°ææ³äºæ³ï¼è§å¾ç©ºæ³å¯è½æç¹å°é¾ï¼äºæ¯å¨çº¸ä¸ç»äºä¸èµ·ï¼æç»ä»ç»äºä¸¤ä¸ªæ§è¡è·¯å¾ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ§è¡è·¯å¾1ï¼LIMIT 1</span><br><span class=\"line\">                      -&gt; SORT(a)</span><br><span class=\"line\">                      -&gt; SeqScan WHERE A &gt; 1;</span><br><span class=\"line\">æ§è¡è·¯å¾2ï¼LIMIT 1</span><br><span class=\"line\">                -&gt; IndexScan WHERE A &gt; 1; </span><br><span class=\"line\">                ï¼å°ææ³¨ï¼Bæ ç´¢å¼æåºï¼ä¸ç¨åæåºäºï¼</span><br></pre></td></tr></table></figure>\n\n<p>å°æè¯´ï¼âæè§å¾è¿ä¸¤ä¸ªé½å¯ä»¥ï¼ä¸è¿æè§å¾ç¬¬äºä¸ªæ´å¥½ï¼å ä¸ºå®èçäºæåºçæ¶é´ãâ</p>\n<p>çäºå¥é®ï¼âä½ ç¥éçï¼PostgreSQLæ°æ®åºéç¨å¨æè§åçæ¹æ³æ¥å®ç°è·¯å¾çæç´¢ï¼å®æ¯ä¸ç§èªåºåä¸çæ¹æ³ï¼ä¹å°±æ¯è¯´ä¼åå»ºç«ç­éæ«æè·¯å¾ï¼ç¶åç¨ç­éåçæ«æè·¯å¾åå»å½¢æè¿æ¥è·¯å¾ï¼é£ä¹å¨æä»¬ç­éæ«æè·¯å¾çæ¶åï¼æ¯ä¸ç¥éå®çä¸å±ææ²¡æLIMITçï¼è¿æ¶åå¦æåç¬çSeqScan + SORTåIndexScanä½ è§å¾åªä¸ªå¥½å¢ï¼â</p>\n<p>âå¯ï¼æç¥éé·é±å¨åªéï¼å¤§æåæè¯´è¿ï¼A &gt; 1çéæ©çé«çè¯ä¼éæ©é¡ºåºæ«æï¼èA &gt; 1çéæ©çä½çæåµä¸ï¼ä¼éæ©ç´¢å¼æ«æï¼è¿æ¯å ä¸ºç´¢å¼æ«æä¼äº§çéæºIOï¼ä¹å°±æ¯è¯´å¨éæ©çé«çæåµä¸ï¼æå¯è½SeqScan + SORTä¼ä¼äºIndexScanï¼è½ç¶SeqScan + SORTä¼ææåºï¼ä½æ¯IndexScançéæºIOå®å¨æ¯å¤ªå¯è§äºãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯¹çï¼åè®¾éæ©çæ¯è¾é«ï¼è¿æ¶åéæ©äºSeqScan + SORTï¼æ¯å ä¸ºå®ä¸ç¥éåä¸å±æ¯LIMIT 1ï¼å¦æä¸é¢æ¯LIMIT 1ï¼å°±ä¼å¯¼è´ç´¢å¼æ«æä¸ç¨å¨é¨æ«å®ï¼åªè¦æ«ä¸ä¸¢ä¸¢å°±å¯ä»¥äºï¼è¿æ¶åéæºIOå°±å¾å°äºï¼ä½æ¯SeqScan + SORTå°±è¿å¿é¡»å¨é¨æ§è¡å®æè½è·åå°LIMIT 1ï¼ä¹å°±æ¯è¯´SeqScan + SORTãæèè¯´SORTè¦è·åç¬¬ä¸æ¡åç»çå¯å¨ä»£ä»·æ¯æ¯è¾é«çï¼å¦æä¸é¢æLIMIT 1è¿æ ·çå­å¥ï¼é£ä¹å¯å¨ä»£ä»·é«çè·¯å¾å¯è½å°±æ²¡æä¼å¿äºï¼è¿å°±æ¯å¯å¨ä»£ä»·çä½ç¨ãâ</p>\n<p>å°ææç¶å¤§æï¼è¯´ï¼âSORTè¦å¨é¨åå®æè½è·åç¬¬ä¸æ¡åç»ï¼å®çå¯å¨ä»£ä»·å¤§ï¼ä½æ¯æ»ä»£ä»·å°ï¼èç´¢å¼æ«æå¢ï¼å ä¸ºæ¬èº«æåºï¼å®çå¯å¨ä»£ä»·æ¯å°çï¼ä½æ¯ç±äºæéæºIOï¼æä»¥å®çæ»ä»£ä»·æ¯å¤§çï¼å¦ææä»¬åªæç§æ»ä»£ä»·è¿è¡ç­éï¼å°±æ²¡åæ³è·å¾æä¼çä»£ä»·äºãâ</p>\n<p>âä»ä¹ä»ä¹ï¼å¯å¨ä»£ä»·ãããä½ ä»¬è¿å±å¾å¿«åãâè¿æ¶å¤§æè·è¿æ¥ï¼è¯´ï¼âè®©æä»¬æ³ä¸ä¸æä¸åç¹ä»ä¹å§ï¼â</p>\n<p>å°æï¼âåç¹å¥½çï¼å¾æå¿è¦ãæè¿èç»èå·²ç»å¿«ç¨æ²¡äºãâ</p>\n","site":{"data":{}},"excerpt":"<p>âä¿è¯è¯´åï¼åä¸ç©·ï¼ç©¿ä¸ç©·ï¼ç®è®¡ä¸å°å°±åç©·ãâå¤§æä¸è¾¹åçå¤§è°å­ï¼ä¸è¾¹è¯´ï¼âæä»¥è¯¥åå°±å¾åï¼åæ¯åä¸ç©·çãâ</p>\n<p>å°æè¯´ï¼âå¯æ¯ç®æ¥ç®å»ï¼ç©çè·¯å¾çä»£ä»·è¿æ¯æéä¸åçæ¶ååãâ</p>\n<p>çäºå¥è¯´ï¼âå°æä½ å·²ç»èµ°ç«å¥é­äºï¼æä»¬æ­£å¨ç¾ç¾çåé¥­ï¼ä½ çå¤§æåå¾ç«¹ç­¾å­é½åç«æå­ï¼ä½ éè¦æ¯å°ä¼åå¨ï¼å¤ªæ«å´äºï¼å¥½äºï¼æåé¥±äºï¼ææ¥åä½ èèãâè¯´ççäºå¥æ½äºå¼ çº¸å·¾æ¦äºæ¦å´ï¼çº¸å·¾è¢«å´è§çæ²¹æµ¸æéæç¶ï¼é£æ æ çè¢«çäºå¥å¼¹è¿äºåå¾ç­ï¼ç¶åçäºå¥ææ¸çèªå·±æ²æ»¡å£å¹³çèå­ï¼æ¢æ¡æ¯ççè¯´ï¼âæä¼è·¯å¾éçä¸åæ¯è°çåå ï¼é£å°±æ¯ä»£ä»·æ¨¡åä¸è¡åï¼ä»£ä»·æ¨¡åä¸è¡èµè°ï¼é£å°±æ¯ç¨åºåæ²¡å»ºå¥½åï¼æä»¥è¦æªå°±è¦æªå°ç¨åºåèªå·±å¤´ä¸ãâ</p>","more":"<p>å°æé®éï¼âå¯æ¯æçPostgreSQLæ°æ®åºçä»£ä»·è®¡ç®å·²ç»å¾å¤æäºåï¼â</p>\n<p>âå¯æ¯æ°æ®åºçå¨è¾¹ç¯å¢æ´å¤æåãä½ æ³æ³ï¼å¨å®éåºç¨ä¸­ï¼æ°æ®åºç¨æ·çéç½®ç¡¬ä»¶ç¯å¢åå·®ä¸å«ï¼CPUçé¢çãä¸»å­çå¤§å°åç£çä»è´¨çæ§è´¨é½ä¼å½±åæ§è¡è®¡åå¨å®éæ§è¡æ¶çæçãâçäºå¥è¯´å®ï¼åäºä¸å£çº¢éã</p>\n<p>å¤§ææ¥è¿æ¥ç»§ç»­è¯´éï¼âè½ç¶å¨ä»£ä»·ä¼°ç®çè¿ç¨ä¸­ï¼æä»¬æ æ³è·å¾âç»å¯¹çå®âçä»£ä»·ï¼ä½æ¯âç»å¯¹çå®âçä»£ä»·ä¹æ¯ä¸å¿è¦çï¼å ä¸ºæä»¬åªæ¯æ³ä»å¤ä¸ªè·¯å¾ï¼Pathï¼ä¸­æ¾å°ä¸ä¸ªä»£ä»·æå°çè·¯å¾ï¼åªè¦è¿äºè·¯å¾çä»£ä»·æ¯å¯ä»¥âç¸äºæ¯è¾âçå°±å¯ä»¥äºï¼å æ­¤å¯ä»¥è®¾å®ä¸ä¸ªâç¸å¯¹âçä»£ä»·çåä½1ï¼åä¸ä¸ªæ¥è¯¢ä¸­ææçç©çè·¯å¾é½åºäºè¿ä¸ªâç¸å¯¹âçåä½1æ¥è®¡ç®çä»£ä»·ï¼è¿æ ·è®¡ç®åºæ¥çä»£ä»·å°±æ¯å¯ä»¥æ¯è¾çï¼ä¹å°±è½ç¨æ¥å¯¹è·¯å¾è¿è¡æéäºãâ</p>\n<p>ç¶åå¤§æç»çäºå¥éäºæ ¹ä¸­åçï¼è¯´ï¼âé¥­åä¸æ ¹çï¼èµè¿æ´»ç¥ä»ï¼æ¥ï¼æ½ä¸æ ¹ãâçäºå¥æ¥è¿çï¼å¤§ææç«éäºè¿æ¥ï¼çäºå¥ç¹ä¸äºçï¼ææç«æºæå°è¶å ä¸ï¼ç¶åæ·±å¸äºä¸å£ï¼å·äºåé¾çè¯´ï¼âPostgreSQLæ°æ®åºéç¨é¡ºåºè¯»åä¸ä¸ªé¡µé¢çIOä»£ä»·ä½ä¸ºåä½1ï¼èæéæºIOå®ä½äºé¡ºåºIOç4åâ</p>\n<p>å°æè¯´ï¼âæç¥éï¼æç¥éï¼è¿ä¸ªææ¥è¿ç¸å³çä¹¦ï¼é¦åï¼ç®åçå­å¨ä»è´¨å¾å¤§é¨åä»ç¶æ¯æºæ¢°ç¡¬çï¼æºæ¢°ç¡¬ççç£å¤´å¨è·å¾æ°æ®åºçæ¶åéè¦ä»åºå¯»éæ¶é´ï¼å¦æè¦è¯»åçæ¯ä¸ä¸²å¨ç£çä¸è¿ç»­çæ°æ®ï¼å°±å¯ä»¥èçå¯»éæ¶é´ï¼æé«IOæ§è½ï¼èå¦æéæºè¯»åç£çä¸ä»»ææåºçæ°æ®ï¼é£ä¹ä¼æå¤§éçæ¶é´æµªè´¹å¨å¯»éä¸ãå¶æ¬¡ï¼å¤§é¨åç£çæ¬èº«å¸¦æç¼å­ï¼è¿å°±å½¢æäºä¸»å­-&gt;ç£çç¼å­-&gt;ç£ççä¸çº§ç»æï¼å¨å°ç£ççåå®¹å è½½å°åå­çæ¶åï¼èèå°ç£ççIOæ§è½ï¼ç£çä¼è¿è¡æ°æ®çé¢è¯»ï¼æé¢è¯»å°çæ°æ®ä¿å­å¨ç£ççç¼å­ä¸­ï¼ä¹å°±æ¯è¯´å¦æç¨æ·åªæç®ä»ç£çè¯»å100ä¸ªå­èçæ°æ®ï¼é£ä¹ç£çå¯è½ä¼è¿ç»­çè¯»åç£çä¸­ç512å­èï¼ä¸åçç£çé¢è¯»çæ°éå¯è½ä¸åï¼å¹¶å°å¶ä¿å­å°ç£çç¼å­ï¼å¦æä¸ä¸æ¬¡æ¯é¡ºåºè¯»å100ä¸ªå­èä¹åçåå®¹ï¼é£ä¹é¢è¯»ç512å­èçæ°æ®å°±ä¼åæ¥ä½ç¨ï¼æ§è½ä¼å¤§å¤§çå¢å ï¼èå¦æè¯»åçåå®¹è¶åºäº512å­èçèå´ï¼é£ä¹é¢è¯»çæ°æ®å°±æ²¡æåæ¥ä½ç¨ï¼ç£ççIOæ§è½å°±ä¼ä¸éãâè¯´å®å°æå¾æçè¯´ï¼âæä¹æ ·ï¼æè¯´çå¯¹å§ï¼â</p>\n<p>çäºå¥è¯´ï¼âä½ è¯´çå¯¹ï¼ç®åPostgreSQLçæ¥è¯¢ä¼åå¤§éçèèäºéæºIOåé¡ºåºIOæå¸¦æ¥çæ§è½å·®å«ï¼å¨è¿æ¹é¢åäºä¸å°ä¼åï¼ä½æ¯ç°å¨çç£çææ¯è¶æ¥è¶åè¾¾äºï¼ä»¥åéæºIOåé¡ºåºIOæ¯ä¸æ¯è¿å·®è¿ä¹å¤ï¼å°±å¼å¾åæ¦·äºãâ</p>\n<p>âé£å°åºè¿æé£äºä»£ä»·åºååä½å¢ï¼âå°æç»§ç»­é®éã</p>\n<p>å¤§æåç­éï¼âåºäºç£çIOçä»£ä»·åä½å½ç¶å°±æ¯åPageæå³çäºï¼ä¹å°±æ¯è¯´æä»¬åæè¯´çé¡ºåºIOåéæºIOé½å±äºIOæ¹é¢çåºåä»£ä»·ãè®©åè®©çäºå¥ç»ä½ ä»ç»ä¸ä¸CPUæ¹é¢çä»£ä»·åºååä½ï¼æåå»åä¸ªé¸¡ãâ</p>\n<p>çäºå¥è¯´ï¼âCPUæ¹é¢çåºååä½æåªäºå¢ï¼æ¯å¦è¯´æä»¬éè¿IOæç£çé¡µé¢è¯»å°äºç¼å­ï¼ä½æä»¬è¦å¤ççæ¯åç»åï¼æä»¥è¿éè¦æåç»ä»é¡µé¢éè§£åºæ¥ï¼è¿è¦å¤çåç»ï¼è¿é¨åä¸»è¦æ¶èçæ¯CPUï¼æä»¥ä¼æä¸ä¸ªåç»å¤ççä»£ä»·åºååä½ï¼å¦å¤ï¼æä»¬å¨æå½±ãçº¦ææ¡ä»¶éæå¤§éçè¡¨è¾¾å¼ï¼è¿äºè¡¨è¾¾å¼æ±è§£ä¹ä¸»è¦æ¶èCPUèµæºï¼æä»¥è¿æä¸ä¸ªè¡¨è¾¾å¼ä»£ä»·çåºååä½ãâ</p>\n<p>çäºå¥å¼¹äºå¼¹çç°ï¼ç»§ç»­è¯´éï¼âç°å¨PostgreSQLæ°æ®åºå¢å äºå¾å¤å¹¶è¡è·¯å¾ï¼å æ­¤å®ä¹äº§çäºéä¿¡ä»£ä»·ï¼è¿ä¸ªä¹éè¦è®¡ç®çãâ</p>\n<p>å°æå¬äºä¹åï¼è¯´ï¼âé£æä»¬å°±è½å¾å°ä¸ä¸ªè¿æ ·çå¬å¼ãâè¯´çå¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ»ä»£ä»· &#x3D; CPUä»£ä»· + IOä»£ä»· + éä¿¡ä»£ä»·</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åå°æç»§ç»­è¯´ï¼âå¯æ¯æéè¿EXPLAINè¿æ¥çè¿PostgreSQLçæ§è¡è®¡åï¼æä»æ§è¡è®¡åä¸­è¿çå°æå¯å¨ä»£ä»·åæ»ä»£ä»·ï¼è¿æ¯æä¹åäºå¢ï¼â</p>\n<p>çäºå¥å¬äºä¹åï¼æ³äºæ³ï¼å¨çº¸ä¸åäºä¸ä¸ªå¬å¼ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ»ä»£ä»· &#x3D; å¯å¨ä»£ä»· + æ§è¡ä»£ä»·</span><br></pre></td></tr></table></figure>\n\n<p>ç¶åçäºå¥è¯´ï¼âè¿æ¯ä»å¦ä¸ä¸ªè§åº¦æ¥è®¡ç®ä»£ä»·ï¼å¯å¨ä»£ä»·æ¯æä»è¯­å¥å¼å§æ§è¡å°æ¥è¯¢å¼æè¿åç¬¬ä¸æ¡åç»çä»£ä»·ï¼å¦ä¸ç§è¯´æ³æ¯åå¤å¥½å»è·å¾ç¬¬ä¸æ¡åç»çä»£ä»·ï¼ï¼æ»ä»£ä»·æ¯SQLè¯­å¥ä»å¼å§æ§è¡å°ç»æçææä»£ä»·ãâ</p>\n<p>âå¯æ¯ãããä¸ºä»ä¹è¦åºåå¯å¨ä»£ä»·åæ§è¡ä»£ä»·å¢ï¼â</p>\n<p>âè¿ä¸ªåããããâçäºå¥æèäºä¸ä¸ï¼è§å¾ä¸å¥ä¸¤å¥ä¸å®¹æè¯´æ¸æ¥ï¼äºæ¯åäºä¸ªä¾å­ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT * FROM TEST_A WHERE a &gt; 1 ORDER BY a LIMIT 1;</span><br></pre></td></tr></table></figure>\n\n<p>âæä»¬åè®¾è¿ä¸ªå¨TEST_A(a)ä¸æä¸ä¸ªBæ ç´¢å¼ï¼æå¾ä¸ï¼é£è¿ä¸ªè¯­å¥å¯è½ä¼å½¢æä»ä¹æ ·çæ§è¡è®¡åå¢ï¼â</p>\n<p>å°ææ³äºæ³ï¼è§å¾ç©ºæ³å¯è½æç¹å°é¾ï¼äºæ¯å¨çº¸ä¸ç»äºä¸èµ·ï¼æç»ä»ç»äºä¸¤ä¸ªæ§è¡è·¯å¾ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ§è¡è·¯å¾1ï¼LIMIT 1</span><br><span class=\"line\">                      -&gt; SORT(a)</span><br><span class=\"line\">                      -&gt; SeqScan WHERE A &gt; 1;</span><br><span class=\"line\">æ§è¡è·¯å¾2ï¼LIMIT 1</span><br><span class=\"line\">                -&gt; IndexScan WHERE A &gt; 1; </span><br><span class=\"line\">                ï¼å°ææ³¨ï¼Bæ ç´¢å¼æåºï¼ä¸ç¨åæåºäºï¼</span><br></pre></td></tr></table></figure>\n\n<p>å°æè¯´ï¼âæè§å¾è¿ä¸¤ä¸ªé½å¯ä»¥ï¼ä¸è¿æè§å¾ç¬¬äºä¸ªæ´å¥½ï¼å ä¸ºå®èçäºæåºçæ¶é´ãâ</p>\n<p>çäºå¥é®ï¼âä½ ç¥éçï¼PostgreSQLæ°æ®åºéç¨å¨æè§åçæ¹æ³æ¥å®ç°è·¯å¾çæç´¢ï¼å®æ¯ä¸ç§èªåºåä¸çæ¹æ³ï¼ä¹å°±æ¯è¯´ä¼åå»ºç«ç­éæ«æè·¯å¾ï¼ç¶åç¨ç­éåçæ«æè·¯å¾åå»å½¢æè¿æ¥è·¯å¾ï¼é£ä¹å¨æä»¬ç­éæ«æè·¯å¾çæ¶åï¼æ¯ä¸ç¥éå®çä¸å±ææ²¡æLIMITçï¼è¿æ¶åå¦æåç¬çSeqScan + SORTåIndexScanä½ è§å¾åªä¸ªå¥½å¢ï¼â</p>\n<p>âå¯ï¼æç¥éé·é±å¨åªéï¼å¤§æåæè¯´è¿ï¼A &gt; 1çéæ©çé«çè¯ä¼éæ©é¡ºåºæ«æï¼èA &gt; 1çéæ©çä½çæåµä¸ï¼ä¼éæ©ç´¢å¼æ«æï¼è¿æ¯å ä¸ºç´¢å¼æ«æä¼äº§çéæºIOï¼ä¹å°±æ¯è¯´å¨éæ©çé«çæåµä¸ï¼æå¯è½SeqScan + SORTä¼ä¼äºIndexScanï¼è½ç¶SeqScan + SORTä¼ææåºï¼ä½æ¯IndexScançéæºIOå®å¨æ¯å¤ªå¯è§äºãâ</p>\n<p>çäºå¥ç¹äºç¹å¤´ï¼è¯´ï¼âå¯¹çï¼åè®¾éæ©çæ¯è¾é«ï¼è¿æ¶åéæ©äºSeqScan + SORTï¼æ¯å ä¸ºå®ä¸ç¥éåä¸å±æ¯LIMIT 1ï¼å¦æä¸é¢æ¯LIMIT 1ï¼å°±ä¼å¯¼è´ç´¢å¼æ«æä¸ç¨å¨é¨æ«å®ï¼åªè¦æ«ä¸ä¸¢ä¸¢å°±å¯ä»¥äºï¼è¿æ¶åéæºIOå°±å¾å°äºï¼ä½æ¯SeqScan + SORTå°±è¿å¿é¡»å¨é¨æ§è¡å®æè½è·åå°LIMIT 1ï¼ä¹å°±æ¯è¯´SeqScan + SORTãæèè¯´SORTè¦è·åç¬¬ä¸æ¡åç»çå¯å¨ä»£ä»·æ¯æ¯è¾é«çï¼å¦æä¸é¢æLIMIT 1è¿æ ·çå­å¥ï¼é£ä¹å¯å¨ä»£ä»·é«çè·¯å¾å¯è½å°±æ²¡æä¼å¿äºï¼è¿å°±æ¯å¯å¨ä»£ä»·çä½ç¨ãâ</p>\n<p>å°ææç¶å¤§æï¼è¯´ï¼âSORTè¦å¨é¨åå®æè½è·åç¬¬ä¸æ¡åç»ï¼å®çå¯å¨ä»£ä»·å¤§ï¼ä½æ¯æ»ä»£ä»·å°ï¼èç´¢å¼æ«æå¢ï¼å ä¸ºæ¬èº«æåºï¼å®çå¯å¨ä»£ä»·æ¯å°çï¼ä½æ¯ç±äºæéæºIOï¼æä»¥å®çæ»ä»£ä»·æ¯å¤§çï¼å¦ææä»¬åªæç§æ»ä»£ä»·è¿è¡ç­éï¼å°±æ²¡åæ³è·å¾æä¼çä»£ä»·äºãâ</p>\n<p>âä»ä¹ä»ä¹ï¼å¯å¨ä»£ä»·ãããä½ ä»¬è¿å±å¾å¿«åãâè¿æ¶å¤§æè·è¿æ¥ï¼è¯´ï¼âè®©æä»¬æ³ä¸ä¸æä¸åç¹ä»ä¹å§ï¼â</p>\n<p>å°æï¼âåç¹å¥½çï¼å¾æå¿è¦ãæè¿èç»èå·²ç»å¿«ç¨æ²¡äºãâ</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(9) - æ¾é¥­åº","date":"2020-10-03T01:01:40.000Z","_content":"\n\nå°æãå¤§æåçäºå¥å¨å¤§åç¹è¯éæç´¢éè¿å¥½çé¥­åºï¼ææ¥æå»æ»æ¯æè§ä¸å¤ªé è°±ï¼ä¸æ¯å«çæé®é¢ï¼å°±æ¯å³éä¸å¤æ­£å®ï¼å¤§ææå¹éï¼âçï¼è¿å°±æ¯èæµ·ï¼æä»¬å¯ä»¥åä¸æä¸ä¸ªAIç¹è¯ï¼åªè½æ¨èæä¼çé¥­åºåï¼æåç¡®çæ¾å°äºåè´§ä»¬ççç¹ï¼è¿éé¢éå«çå¾å¤§çåæºåï¼â\n\nçäºå¥ç¥äºå®ä¸ç¼è¯´ï¼âAIæ¨èå½ç¶å¥½åï¼å¯æ¯è¦æ¨èçåæè¡åï¼å¯æ¯ä¸ä¸ªäººä¸ä¸ªå£å³ï¼ä½ è¿ä¸ªéæ±å¤ªâæºè½âäºï¼æä¼°è®¡ä¸å¥½å¼ãâ\n\nå°æçªç¶æ³å°èªå·±æè¿å¨å­¦æ ¡çç®æ³è¯¾ä¸èå¸è®²è¿ä¸äºæ±æä¼è§£é®é¢çæ¹æ³ï¼ç¶åè¯´ï¼âæç¥éï¼æç¥éï¼ææè¿å¨ç®æ³è¯¾ä¸å­¦è¿ä¸äºæä¼è§£é®é¢çè§£å³æ¹æ³ï¼åºè¯¥å¯ä»¥ç¨å¾ä¸ãâ\n\n<!-- more -->\n\nçäºå¥å¹å£æ°éï¼âå¯æ¯è¿äºæ¹æ³ç¨å°ä¼åå¨éé½ä¸ä¸å®å¤ç¨ï¼ä½åµç¨å°ä¸ä¸ªæ´å æºè½çé¡¹ç®ä¸å¢ï¼â\n\nâå¯ï¼ä¼åå¨éä¹ç¨å°äºæä¼è§£é®é¢çæ¹æ³äºåï¼æä»¬å­¦è¿å¨æè§åãè´ªå¿ç®æ³ãããâå°æå¦æ°å®¶ççè¯´èµ·æ¥ã\n\nå¤§æè¯´ï¼âç¨å°äºåï¼ è½ç¶ç©çè·¯å¾çä¸å»ä¹ä¸å¤ï¼ä½å®éä¸æä¸¾èµ·æ¥ï¼å®çæç´¢ç©ºé´ä¹ä¸å°ãä¾å¦å¨æ«æè·¯å¾ä¸­ï¼æä»¬å°±å¯ä»¥æé¡ºåºæ«æãç´¢å¼æ«æåä½å¾æ«æï¼åå¦ä¸ä¸ªè¡¨ä¸æå¤ä¸ªç´¢å¼ï¼é£ä¹å°±å¯è½äº§çå¤ä¸ªä¸åçç´¢å¼æ«æï¼é£ä¹åªä¸ªç´¢å¼æ«æè·¯å¾å¥½å¢ï¼èç´¢å¼æ«æåé¡ºåºæ«æãä½å¾æ«æç¸æ¯ï¼åªä¸ªå¥½å¢ï¼â\n\nå¤§æççå°æè¿·ç¦»çç¼ç¥ï¼åé¡¿äºä¸ä¸ï¼ç»ä»è¶³å¤çæèç©ºé´ä¹åç»§ç»­è¯´éï¼âæ°æ®åºè·¯å¾çæç´¢æ¹æ³éå¸¸æ3ç§ç±»åï¼èªåºåä¸æ¹æ³ãèªé¡¶åä¸æ¹æ³ãéæºæ¹æ³ï¼èPostgreSQLéç¨äºå¶ä¸­çä¸¤ç§æ¹æ³å¢ãâ\n\nâéç¨äºåªä¸¤ç§æ¹æ³å¢ï¼âçäºå¥æç¥æé®éã\n\nâéç¨äºèªåºåä¸çæ¹æ³åéæºæ¹æ³ï¼å¶ä¸­èªåºåä¸çæ¹æ³æ¯éç¨çå¨æè§åæ¹æ³ï¼èéæºæ¹æ³éç¨çæ¯éä¼ ç®æ³ãâ\n\nâé£æè°ä½¿ç¨äºèªé¡¶åä¸çæ¹æ³å¢ï¼âçäºå¥ç»§ç»­âæ§åâéã\n\nâå¯ãããè¿ä¸ªåï¼Pivotalå¬å¸çå¼æºä¼åå¨ORCAç¨çå°±æ¯èªé¡¶åä¸çæ¹æ³ãå¯ä»¥è®©çäºåç»ä½ è¯´è¯´æä¹æ ·ç¨å¨æè§åæ¹æ³æç´¢æä¼ç©çè·¯å¾ãâ\n\nçäºå¥æ¿åºçº¸æ¥ï¼å¨çº¸ä¸ç»äºå ä¸ªåï¼ç¶åè¯´ï¼âè¿ä»£è¡¨4ä¸ªè¡¨ï¼èªåºåä¸åï¼æä»¥æ¯ä»åºä¸åä¸å ç§¯ï¼è¿æ¯æåºå±ï¼æä»¬å«å®ç¬¬ä¸å±âã\n\n![](./postgresql-optimizer-outline-9/1.png) \n\nâå¨æè§åæ¹æ³é¦åèèä¸¤ä¸ªè¡¨çè¿æ¥ï¼å¶ä¸­ä¼åèèæè¿æ¥å³ç³»çè¡¨è¿è¡è¿æ¥ï¼ä¸¤ä¸ªè¡¨çè¿æ¥å¯ä»¥å»ºç«ä¸ä¸ªæ°çè¡¨ï¼æä»¬æè¿äºæ°è¡¨å«åç¬¬äºå±ãâçäºå¥éè¿è¿çº¿ï¼äº§çäºä¸äºæ°çâè¡¨âã\n\n![](./postgresql-optimizer-outline-9/2.png) \n\nâç¬¬äºå±çè¡¨åç¬¬ä¸å±çè¡¨åè¿æ¥ï¼å¯ä»¥çæåºäº3ä¸ªè¡¨è¿æ¥çæ°çâè¡¨âï¼è¿æ ·å°±åååæ¨è¿äºä¸å±ï¼æä»¬äº§çäºç¬¬ä¸å±â\n\n![](./postgresql-optimizer-outline-9/3.png) \n \nâç¶ååç¨ç¬¬ä¸å±çè¡¨åç¬¬ä¸å±çè¡¨è¿è¡è¿æ¥ï¼æç»çææ´ä¸ªé®é¢çæä¼è·¯å¾ãâ\n\n![](./postgresql-optimizer-outline-9/4.png) \n \nâå¯æ¯ï¼è¿ä¸å°±æ¯ç©·ä¸¾åï¼âå°æé®éã\n\nçäºå¥è§£éè¯´ï¼âå¨æè§åæä¸¤ä¸ªç¹ç¹ï¼ä¸ä¸ªæ¯è¦éå¤çå©ç¨å­é®é¢çè§£ï¼è¿æ ·è½åå°è®¡ç®éï¼éä½å¤æåº¦ï¼å¦å¤ä¸ç¹å°±æ¯éè¿å­é®é¢çæä¼è§£è½å¤æé åºæç»çæä¼è§£ï¼ä¹å°±æ¯è¯´éè¦å·ææä¼å­ç»æçæ§è´¨ï¼æä»¥å¨æè§åçå¤æåº¦åç©·ä¸¾æ¯ä¸ä¸æ ·çãâ\n\nå¤§æç»§ç»­è§£éè¯´ï¼âè¿æï¼è½ç¶ä½ çå¾éçè¿çº¿æ¯è¾å¤ï¼ä½å¨å®éæåµéï¼å¹¶ä¸æ¯ææçååä¹é´é½è½äº§çè¿çº¿ï¼è¿æ¥å³ç³»ä¹æä¸ªåæ³æ§çé®é¢åï¼æä»¥å¤æåº¦æ¯å¯ä»¥æ§å¶ä½çãâ\n\nå°ææè§å¥½åæç½äºä¸ç¹ï¼ç¶åèµ¶ç´§è¿½é®ï¼âé£éä¼ ç®æ³å¢ï¼â\n\nå¤§æè¯´ï¼âè½ç¶å¨æè§åçå¤æåº¦æ¯å¯ä»¥æ§å¶çï¼ä½æ¯å¦æè¡¨æ¯è¾å¤ï¼å®çæç´¢ç©ºé´è¿æ¯å¾å¤§ï¼æä»¥å¦æå¨è¡¨æ¯è¾å¤çæ¶åï¼å¯ä»¥å°è¯ä½¿éä¼ ç®æ³ï¼è¿ä¸ªç®æ³è·å¾çä¸ä¸å®æ¯å¨å±æä¼è§£ï¼å®è·å¾çå¯è½æ¯å±é¨æä¼è§£ãâ\n\nâé£éä¼ ç®æ³æ¯æä¹å®ç°ç©çè·¯å¾æç´¢çå¢ï¼âå°æé®ã\n\nçäºå¥å»å¤§æçä¹¦æéæ¾å°äºä¸æ¬ç®æ³çä¹¦ï¼æ°å¥½éé¢æéä¼ ç®æ³çä»ç»ï¼äºæ¯æè¯»äºèµ·æ¥ï¼âéä¼ ç®æ³çå®ç°æ­¥éª¤å¦ä¸ï¼1ï¼ç§ç¾¤åå§åï¼å¯¹åºå è¿è¡ç¼ç ï¼å¹¶éè¿å¯¹åºå è¿è¡éæºçæåç»åï¼çæå¤ä¸ªæè²ä½ï¼è¿äºæè²ä½ææä¸ä¸ªæ°çç§ç¾¤ï¼å¦å¤ï¼å¨çææè²ä½çè¿ç¨ä¸­åæ¶è®¡ç®æè²ä½çéåºåº¦ï¼2ï¼éæ©æè²ä½ï¼éè¿éæºéæ©ï¼å®éä¸éè¿åºäºæ¦ççéæºæ°çæç®æ³ï¼è¿æ ·è½å¾åäºéæ©åºä¼ç§çæè²ä½ï¼ï¼éæ©åºç¨äºäº¤åååå¼çæè²ä½ï¼3ï¼äº¤åæä½ï¼æè²ä½è¿è¡äº¤åï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼4ï¼åå¼æä½ï¼å¯¹æè²ä½è¿è¡åå¼æä½ï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼5ï¼éåºåº¦è®¡ç®ï¼å¯¹ä¸è¯çæè²ä½è¿è¡æ·æ±°ãâ\n\nå¤§æç¬çè¯´ï¼âå°½ä¿¡ä¹¦ä¸å¦æ ä¹¦ï¼ææ¥è¯´ä¸ä¸éä¼ ç®æ³æ¯å¦ä½è§£å³è´§éé®é¢çãæä»¬å¯ä»¥å°åå¸ä½ä¸ºåºå ï¼èµ°éåä¸ªåå¸çè·¯å¾ä½ä¸ºæè²ä½ï¼è·¯å¾çæ»é¿åº¦ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°è´è´£ç­éææ¯è¾é¿çè·¯å¾ï¼ä¿çè¾ç­çè·¯å¾ï¼ç®æ³çæ­¥éª¤å¦ä¸ï¼1ï¼å¯¹åä¸ªåå¸è¿è¡ç¼å·ï¼å°åä¸ªåå¸æ ¹æ®ç¼å·è¿è¡æåç»åï¼çæå¤æ¡æ°çè·¯å¾ï¼æè²ä½ï¼ï¼ç¶åæ ¹æ®ååå¸é´çè·ç¦»è®¡ç®æ´ä½è·¯å¾é¿åº¦ï¼éåºåº¦ï¼ï¼å¤æ¡æ°è·¯å¾ææä¸ä¸ªç§ç¾¤ï¼2ï¼éæ©ä¸¤ä¸ªè·¯å¾è¿è¡äº¤åï¼éè¦æ³¨æäº¤åçææ°æè²ä½ä¸­ä¸è½éå¤åºç°åä¸ä¸ªåå¸ï¼ï¼å¯¹äº¤åæä½äº§ççæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼3ï¼éæºéæ©æè²ä½è¿è¡åå¼ï¼éå¸¸æ¹æ³æ¯äº¤æ¢åå¸å¨è·¯å¾ä¸­çä½ç½®ï¼ï¼å¯¹åå¼æä½åçæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼4ï¼å¯¹ç§ç¾¤ä¸­ææè·¯å¾è¿è¡åºäºè·¯å¾é¿åº¦æå°å°å¤§æåºï¼æ·æ±°ææåé åçè·¯å¾ãâå¤§æä¸å£æ°è¯´å®äºæ´ä¸ªæµç¨ï¼é¿åºäºä¸å£æ°ï¼ç¶åç»§ç»­è¯´ï¼âæä¹æ ·ï¼æ¯ä¸æ¯so easy?â\n\nå°ææ³äºæ³çäºå¥åå¤§æè¯´çæµç¨ï¼ç¶åè¯´ï¼âææ¥çæ³ä¸ä¸PostgreSQLæ¯å¦ä½å®ç°éä¼ ç®æ³çï¼PostgreSQLåºè¯¥æ¯æ¨¡æäºè§£å³è´§éé®é¢çæ¹æ³ï¼å®å°è¡¨ä½ä¸ºåºå ãæç»çæçæ§è¡è®¡åä½ä¸ºæè²ä½ãæ§è¡è®¡åçæ»ä»£ä»·ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°åæ¯åºäºè·¯å¾çä»£ä»·è¿è¡ç­éï¼å¯¹ä¸å¯¹ï¼â\n\nçäºå¥èµå¹éï¼âè¯´å¾éå¸¸å¥½ï¼ä¸è¿é PostgreSQLæ°æ®åºçåºå ç®æ³å®ç°æ¹å¼åéå¸¸çéä¼ ç®æ³ç¥æä¸åå¨äºå¶æ²¡æåå¼çè¿ç¨ï¼åªéè¿äº¤åäº§çæ°çæè²ä½ï¼ä¸è¿è¿é½ä¸æ¯éç¹äºãâ\n\nå¤§æè¯´ï¼âåååï¼æä»¬ä¸æ¯å¨æç´¢é¥­åºåï¼æä¹æç´¢èµ·æ¥æä¼è·¯å¾äºï¼ä¸è¦åè¯´ä¼åå¨äºï¼åæç¹é¥­é½æ²¡å¾åäºãâ\näºæ¯ä¸ä¸ªäººåç­ç«æå¤©çæèµ·é¥­åºæ¥äºã\n\n\n","source":"_posts/postgresql-optimizer-outline-9.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(9) - æ¾é¥­åº\ndate: 2020-10-03 09:01:40\ntags: å¨æè§å èªåºåä¸ èªé¡¶åä¸\n---\n\n\nå°æãå¤§æåçäºå¥å¨å¤§åç¹è¯éæç´¢éè¿å¥½çé¥­åºï¼ææ¥æå»æ»æ¯æè§ä¸å¤ªé è°±ï¼ä¸æ¯å«çæé®é¢ï¼å°±æ¯å³éä¸å¤æ­£å®ï¼å¤§ææå¹éï¼âçï¼è¿å°±æ¯èæµ·ï¼æä»¬å¯ä»¥åä¸æä¸ä¸ªAIç¹è¯ï¼åªè½æ¨èæä¼çé¥­åºåï¼æåç¡®çæ¾å°äºåè´§ä»¬ççç¹ï¼è¿éé¢éå«çå¾å¤§çåæºåï¼â\n\nçäºå¥ç¥äºå®ä¸ç¼è¯´ï¼âAIæ¨èå½ç¶å¥½åï¼å¯æ¯è¦æ¨èçåæè¡åï¼å¯æ¯ä¸ä¸ªäººä¸ä¸ªå£å³ï¼ä½ è¿ä¸ªéæ±å¤ªâæºè½âäºï¼æä¼°è®¡ä¸å¥½å¼ãâ\n\nå°æçªç¶æ³å°èªå·±æè¿å¨å­¦æ ¡çç®æ³è¯¾ä¸èå¸è®²è¿ä¸äºæ±æä¼è§£é®é¢çæ¹æ³ï¼ç¶åè¯´ï¼âæç¥éï¼æç¥éï¼ææè¿å¨ç®æ³è¯¾ä¸å­¦è¿ä¸äºæä¼è§£é®é¢çè§£å³æ¹æ³ï¼åºè¯¥å¯ä»¥ç¨å¾ä¸ãâ\n\n<!-- more -->\n\nçäºå¥å¹å£æ°éï¼âå¯æ¯è¿äºæ¹æ³ç¨å°ä¼åå¨éé½ä¸ä¸å®å¤ç¨ï¼ä½åµç¨å°ä¸ä¸ªæ´å æºè½çé¡¹ç®ä¸å¢ï¼â\n\nâå¯ï¼ä¼åå¨éä¹ç¨å°äºæä¼è§£é®é¢çæ¹æ³äºåï¼æä»¬å­¦è¿å¨æè§åãè´ªå¿ç®æ³ãããâå°æå¦æ°å®¶ççè¯´èµ·æ¥ã\n\nå¤§æè¯´ï¼âç¨å°äºåï¼ è½ç¶ç©çè·¯å¾çä¸å»ä¹ä¸å¤ï¼ä½å®éä¸æä¸¾èµ·æ¥ï¼å®çæç´¢ç©ºé´ä¹ä¸å°ãä¾å¦å¨æ«æè·¯å¾ä¸­ï¼æä»¬å°±å¯ä»¥æé¡ºåºæ«æãç´¢å¼æ«æåä½å¾æ«æï¼åå¦ä¸ä¸ªè¡¨ä¸æå¤ä¸ªç´¢å¼ï¼é£ä¹å°±å¯è½äº§çå¤ä¸ªä¸åçç´¢å¼æ«æï¼é£ä¹åªä¸ªç´¢å¼æ«æè·¯å¾å¥½å¢ï¼èç´¢å¼æ«æåé¡ºåºæ«æãä½å¾æ«æç¸æ¯ï¼åªä¸ªå¥½å¢ï¼â\n\nå¤§æççå°æè¿·ç¦»çç¼ç¥ï¼åé¡¿äºä¸ä¸ï¼ç»ä»è¶³å¤çæèç©ºé´ä¹åç»§ç»­è¯´éï¼âæ°æ®åºè·¯å¾çæç´¢æ¹æ³éå¸¸æ3ç§ç±»åï¼èªåºåä¸æ¹æ³ãèªé¡¶åä¸æ¹æ³ãéæºæ¹æ³ï¼èPostgreSQLéç¨äºå¶ä¸­çä¸¤ç§æ¹æ³å¢ãâ\n\nâéç¨äºåªä¸¤ç§æ¹æ³å¢ï¼âçäºå¥æç¥æé®éã\n\nâéç¨äºèªåºåä¸çæ¹æ³åéæºæ¹æ³ï¼å¶ä¸­èªåºåä¸çæ¹æ³æ¯éç¨çå¨æè§åæ¹æ³ï¼èéæºæ¹æ³éç¨çæ¯éä¼ ç®æ³ãâ\n\nâé£æè°ä½¿ç¨äºèªé¡¶åä¸çæ¹æ³å¢ï¼âçäºå¥ç»§ç»­âæ§åâéã\n\nâå¯ãããè¿ä¸ªåï¼Pivotalå¬å¸çå¼æºä¼åå¨ORCAç¨çå°±æ¯èªé¡¶åä¸çæ¹æ³ãå¯ä»¥è®©çäºåç»ä½ è¯´è¯´æä¹æ ·ç¨å¨æè§åæ¹æ³æç´¢æä¼ç©çè·¯å¾ãâ\n\nçäºå¥æ¿åºçº¸æ¥ï¼å¨çº¸ä¸ç»äºå ä¸ªåï¼ç¶åè¯´ï¼âè¿ä»£è¡¨4ä¸ªè¡¨ï¼èªåºåä¸åï¼æä»¥æ¯ä»åºä¸åä¸å ç§¯ï¼è¿æ¯æåºå±ï¼æä»¬å«å®ç¬¬ä¸å±âã\n\n![](./postgresql-optimizer-outline-9/1.png) \n\nâå¨æè§åæ¹æ³é¦åèèä¸¤ä¸ªè¡¨çè¿æ¥ï¼å¶ä¸­ä¼åèèæè¿æ¥å³ç³»çè¡¨è¿è¡è¿æ¥ï¼ä¸¤ä¸ªè¡¨çè¿æ¥å¯ä»¥å»ºç«ä¸ä¸ªæ°çè¡¨ï¼æä»¬æè¿äºæ°è¡¨å«åç¬¬äºå±ãâçäºå¥éè¿è¿çº¿ï¼äº§çäºä¸äºæ°çâè¡¨âã\n\n![](./postgresql-optimizer-outline-9/2.png) \n\nâç¬¬äºå±çè¡¨åç¬¬ä¸å±çè¡¨åè¿æ¥ï¼å¯ä»¥çæåºäº3ä¸ªè¡¨è¿æ¥çæ°çâè¡¨âï¼è¿æ ·å°±åååæ¨è¿äºä¸å±ï¼æä»¬äº§çäºç¬¬ä¸å±â\n\n![](./postgresql-optimizer-outline-9/3.png) \n \nâç¶ååç¨ç¬¬ä¸å±çè¡¨åç¬¬ä¸å±çè¡¨è¿è¡è¿æ¥ï¼æç»çææ´ä¸ªé®é¢çæä¼è·¯å¾ãâ\n\n![](./postgresql-optimizer-outline-9/4.png) \n \nâå¯æ¯ï¼è¿ä¸å°±æ¯ç©·ä¸¾åï¼âå°æé®éã\n\nçäºå¥è§£éè¯´ï¼âå¨æè§åæä¸¤ä¸ªç¹ç¹ï¼ä¸ä¸ªæ¯è¦éå¤çå©ç¨å­é®é¢çè§£ï¼è¿æ ·è½åå°è®¡ç®éï¼éä½å¤æåº¦ï¼å¦å¤ä¸ç¹å°±æ¯éè¿å­é®é¢çæä¼è§£è½å¤æé åºæç»çæä¼è§£ï¼ä¹å°±æ¯è¯´éè¦å·ææä¼å­ç»æçæ§è´¨ï¼æä»¥å¨æè§åçå¤æåº¦åç©·ä¸¾æ¯ä¸ä¸æ ·çãâ\n\nå¤§æç»§ç»­è§£éè¯´ï¼âè¿æï¼è½ç¶ä½ çå¾éçè¿çº¿æ¯è¾å¤ï¼ä½å¨å®éæåµéï¼å¹¶ä¸æ¯ææçååä¹é´é½è½äº§çè¿çº¿ï¼è¿æ¥å³ç³»ä¹æä¸ªåæ³æ§çé®é¢åï¼æä»¥å¤æåº¦æ¯å¯ä»¥æ§å¶ä½çãâ\n\nå°ææè§å¥½åæç½äºä¸ç¹ï¼ç¶åèµ¶ç´§è¿½é®ï¼âé£éä¼ ç®æ³å¢ï¼â\n\nå¤§æè¯´ï¼âè½ç¶å¨æè§åçå¤æåº¦æ¯å¯ä»¥æ§å¶çï¼ä½æ¯å¦æè¡¨æ¯è¾å¤ï¼å®çæç´¢ç©ºé´è¿æ¯å¾å¤§ï¼æä»¥å¦æå¨è¡¨æ¯è¾å¤çæ¶åï¼å¯ä»¥å°è¯ä½¿éä¼ ç®æ³ï¼è¿ä¸ªç®æ³è·å¾çä¸ä¸å®æ¯å¨å±æä¼è§£ï¼å®è·å¾çå¯è½æ¯å±é¨æä¼è§£ãâ\n\nâé£éä¼ ç®æ³æ¯æä¹å®ç°ç©çè·¯å¾æç´¢çå¢ï¼âå°æé®ã\n\nçäºå¥å»å¤§æçä¹¦æéæ¾å°äºä¸æ¬ç®æ³çä¹¦ï¼æ°å¥½éé¢æéä¼ ç®æ³çä»ç»ï¼äºæ¯æè¯»äºèµ·æ¥ï¼âéä¼ ç®æ³çå®ç°æ­¥éª¤å¦ä¸ï¼1ï¼ç§ç¾¤åå§åï¼å¯¹åºå è¿è¡ç¼ç ï¼å¹¶éè¿å¯¹åºå è¿è¡éæºçæåç»åï¼çæå¤ä¸ªæè²ä½ï¼è¿äºæè²ä½ææä¸ä¸ªæ°çç§ç¾¤ï¼å¦å¤ï¼å¨çææè²ä½çè¿ç¨ä¸­åæ¶è®¡ç®æè²ä½çéåºåº¦ï¼2ï¼éæ©æè²ä½ï¼éè¿éæºéæ©ï¼å®éä¸éè¿åºäºæ¦ççéæºæ°çæç®æ³ï¼è¿æ ·è½å¾åäºéæ©åºä¼ç§çæè²ä½ï¼ï¼éæ©åºç¨äºäº¤åååå¼çæè²ä½ï¼3ï¼äº¤åæä½ï¼æè²ä½è¿è¡äº¤åï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼4ï¼åå¼æä½ï¼å¯¹æè²ä½è¿è¡åå¼æä½ï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼5ï¼éåºåº¦è®¡ç®ï¼å¯¹ä¸è¯çæè²ä½è¿è¡æ·æ±°ãâ\n\nå¤§æç¬çè¯´ï¼âå°½ä¿¡ä¹¦ä¸å¦æ ä¹¦ï¼ææ¥è¯´ä¸ä¸éä¼ ç®æ³æ¯å¦ä½è§£å³è´§éé®é¢çãæä»¬å¯ä»¥å°åå¸ä½ä¸ºåºå ï¼èµ°éåä¸ªåå¸çè·¯å¾ä½ä¸ºæè²ä½ï¼è·¯å¾çæ»é¿åº¦ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°è´è´£ç­éææ¯è¾é¿çè·¯å¾ï¼ä¿çè¾ç­çè·¯å¾ï¼ç®æ³çæ­¥éª¤å¦ä¸ï¼1ï¼å¯¹åä¸ªåå¸è¿è¡ç¼å·ï¼å°åä¸ªåå¸æ ¹æ®ç¼å·è¿è¡æåç»åï¼çæå¤æ¡æ°çè·¯å¾ï¼æè²ä½ï¼ï¼ç¶åæ ¹æ®ååå¸é´çè·ç¦»è®¡ç®æ´ä½è·¯å¾é¿åº¦ï¼éåºåº¦ï¼ï¼å¤æ¡æ°è·¯å¾ææä¸ä¸ªç§ç¾¤ï¼2ï¼éæ©ä¸¤ä¸ªè·¯å¾è¿è¡äº¤åï¼éè¦æ³¨æäº¤åçææ°æè²ä½ä¸­ä¸è½éå¤åºç°åä¸ä¸ªåå¸ï¼ï¼å¯¹äº¤åæä½äº§ççæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼3ï¼éæºéæ©æè²ä½è¿è¡åå¼ï¼éå¸¸æ¹æ³æ¯äº¤æ¢åå¸å¨è·¯å¾ä¸­çä½ç½®ï¼ï¼å¯¹åå¼æä½åçæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼4ï¼å¯¹ç§ç¾¤ä¸­ææè·¯å¾è¿è¡åºäºè·¯å¾é¿åº¦æå°å°å¤§æåºï¼æ·æ±°ææåé åçè·¯å¾ãâå¤§æä¸å£æ°è¯´å®äºæ´ä¸ªæµç¨ï¼é¿åºäºä¸å£æ°ï¼ç¶åç»§ç»­è¯´ï¼âæä¹æ ·ï¼æ¯ä¸æ¯so easy?â\n\nå°ææ³äºæ³çäºå¥åå¤§æè¯´çæµç¨ï¼ç¶åè¯´ï¼âææ¥çæ³ä¸ä¸PostgreSQLæ¯å¦ä½å®ç°éä¼ ç®æ³çï¼PostgreSQLåºè¯¥æ¯æ¨¡æäºè§£å³è´§éé®é¢çæ¹æ³ï¼å®å°è¡¨ä½ä¸ºåºå ãæç»çæçæ§è¡è®¡åä½ä¸ºæè²ä½ãæ§è¡è®¡åçæ»ä»£ä»·ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°åæ¯åºäºè·¯å¾çä»£ä»·è¿è¡ç­éï¼å¯¹ä¸å¯¹ï¼â\n\nçäºå¥èµå¹éï¼âè¯´å¾éå¸¸å¥½ï¼ä¸è¿é PostgreSQLæ°æ®åºçåºå ç®æ³å®ç°æ¹å¼åéå¸¸çéä¼ ç®æ³ç¥æä¸åå¨äºå¶æ²¡æåå¼çè¿ç¨ï¼åªéè¿äº¤åäº§çæ°çæè²ä½ï¼ä¸è¿è¿é½ä¸æ¯éç¹äºãâ\n\nå¤§æè¯´ï¼âåååï¼æä»¬ä¸æ¯å¨æç´¢é¥­åºåï¼æä¹æç´¢èµ·æ¥æä¼è·¯å¾äºï¼ä¸è¦åè¯´ä¼åå¨äºï¼åæç¹é¥­é½æ²¡å¾åäºãâ\näºæ¯ä¸ä¸ªäººåç­ç«æå¤©çæèµ·é¥­åºæ¥äºã\n\n\n","slug":"postgresql-optimizer-outline-9","published":1,"updated":"2020-10-03T01:13:29.000Z","_id":"ckfszbzyo0003ro9k3ejk08ql","comments":1,"layout":"post","photos":[],"link":"","content":"<p>å°æãå¤§æåçäºå¥å¨å¤§åç¹è¯éæç´¢éè¿å¥½çé¥­åºï¼ææ¥æå»æ»æ¯æè§ä¸å¤ªé è°±ï¼ä¸æ¯å«çæé®é¢ï¼å°±æ¯å³éä¸å¤æ­£å®ï¼å¤§ææå¹éï¼âçï¼è¿å°±æ¯èæµ·ï¼æä»¬å¯ä»¥åä¸æä¸ä¸ªAIç¹è¯ï¼åªè½æ¨èæä¼çé¥­åºåï¼æåç¡®çæ¾å°äºåè´§ä»¬ççç¹ï¼è¿éé¢éå«çå¾å¤§çåæºåï¼â</p>\n<p>çäºå¥ç¥äºå®ä¸ç¼è¯´ï¼âAIæ¨èå½ç¶å¥½åï¼å¯æ¯è¦æ¨èçåæè¡åï¼å¯æ¯ä¸ä¸ªäººä¸ä¸ªå£å³ï¼ä½ è¿ä¸ªéæ±å¤ªâæºè½âäºï¼æä¼°è®¡ä¸å¥½å¼ãâ</p>\n<p>å°æçªç¶æ³å°èªå·±æè¿å¨å­¦æ ¡çç®æ³è¯¾ä¸èå¸è®²è¿ä¸äºæ±æä¼è§£é®é¢çæ¹æ³ï¼ç¶åè¯´ï¼âæç¥éï¼æç¥éï¼ææè¿å¨ç®æ³è¯¾ä¸å­¦è¿ä¸äºæä¼è§£é®é¢çè§£å³æ¹æ³ï¼åºè¯¥å¯ä»¥ç¨å¾ä¸ãâ</p>\n<a id=\"more\"></a>\n\n<p>çäºå¥å¹å£æ°éï¼âå¯æ¯è¿äºæ¹æ³ç¨å°ä¼åå¨éé½ä¸ä¸å®å¤ç¨ï¼ä½åµç¨å°ä¸ä¸ªæ´å æºè½çé¡¹ç®ä¸å¢ï¼â</p>\n<p>âå¯ï¼ä¼åå¨éä¹ç¨å°äºæä¼è§£é®é¢çæ¹æ³äºåï¼æä»¬å­¦è¿å¨æè§åãè´ªå¿ç®æ³ãããâå°æå¦æ°å®¶ççè¯´èµ·æ¥ã</p>\n<p>å¤§æè¯´ï¼âç¨å°äºåï¼ è½ç¶ç©çè·¯å¾çä¸å»ä¹ä¸å¤ï¼ä½å®éä¸æä¸¾èµ·æ¥ï¼å®çæç´¢ç©ºé´ä¹ä¸å°ãä¾å¦å¨æ«æè·¯å¾ä¸­ï¼æä»¬å°±å¯ä»¥æé¡ºåºæ«æãç´¢å¼æ«æåä½å¾æ«æï¼åå¦ä¸ä¸ªè¡¨ä¸æå¤ä¸ªç´¢å¼ï¼é£ä¹å°±å¯è½äº§çå¤ä¸ªä¸åçç´¢å¼æ«æï¼é£ä¹åªä¸ªç´¢å¼æ«æè·¯å¾å¥½å¢ï¼èç´¢å¼æ«æåé¡ºåºæ«æãä½å¾æ«æç¸æ¯ï¼åªä¸ªå¥½å¢ï¼â</p>\n<p>å¤§æççå°æè¿·ç¦»çç¼ç¥ï¼åé¡¿äºä¸ä¸ï¼ç»ä»è¶³å¤çæèç©ºé´ä¹åç»§ç»­è¯´éï¼âæ°æ®åºè·¯å¾çæç´¢æ¹æ³éå¸¸æ3ç§ç±»åï¼èªåºåä¸æ¹æ³ãèªé¡¶åä¸æ¹æ³ãéæºæ¹æ³ï¼èPostgreSQLéç¨äºå¶ä¸­çä¸¤ç§æ¹æ³å¢ãâ</p>\n<p>âéç¨äºåªä¸¤ç§æ¹æ³å¢ï¼âçäºå¥æç¥æé®éã</p>\n<p>âéç¨äºèªåºåä¸çæ¹æ³åéæºæ¹æ³ï¼å¶ä¸­èªåºåä¸çæ¹æ³æ¯éç¨çå¨æè§åæ¹æ³ï¼èéæºæ¹æ³éç¨çæ¯éä¼ ç®æ³ãâ</p>\n<p>âé£æè°ä½¿ç¨äºèªé¡¶åä¸çæ¹æ³å¢ï¼âçäºå¥ç»§ç»­âæ§åâéã</p>\n<p>âå¯ãããè¿ä¸ªåï¼Pivotalå¬å¸çå¼æºä¼åå¨ORCAç¨çå°±æ¯èªé¡¶åä¸çæ¹æ³ãå¯ä»¥è®©çäºåç»ä½ è¯´è¯´æä¹æ ·ç¨å¨æè§åæ¹æ³æç´¢æä¼ç©çè·¯å¾ãâ</p>\n<p>çäºå¥æ¿åºçº¸æ¥ï¼å¨çº¸ä¸ç»äºå ä¸ªåï¼ç¶åè¯´ï¼âè¿ä»£è¡¨4ä¸ªè¡¨ï¼èªåºåä¸åï¼æä»¥æ¯ä»åºä¸åä¸å ç§¯ï¼è¿æ¯æåºå±ï¼æä»¬å«å®ç¬¬ä¸å±âã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/1.png\"> </p>\n<p>âå¨æè§åæ¹æ³é¦åèèä¸¤ä¸ªè¡¨çè¿æ¥ï¼å¶ä¸­ä¼åèèæè¿æ¥å³ç³»çè¡¨è¿è¡è¿æ¥ï¼ä¸¤ä¸ªè¡¨çè¿æ¥å¯ä»¥å»ºç«ä¸ä¸ªæ°çè¡¨ï¼æä»¬æè¿äºæ°è¡¨å«åç¬¬äºå±ãâçäºå¥éè¿è¿çº¿ï¼äº§çäºä¸äºæ°çâè¡¨âã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/2.png\"> </p>\n<p>âç¬¬äºå±çè¡¨åç¬¬ä¸å±çè¡¨åè¿æ¥ï¼å¯ä»¥çæåºäº3ä¸ªè¡¨è¿æ¥çæ°çâè¡¨âï¼è¿æ ·å°±åååæ¨è¿äºä¸å±ï¼æä»¬äº§çäºç¬¬ä¸å±â</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/3.png\"> </p>\n<p>âç¶ååç¨ç¬¬ä¸å±çè¡¨åç¬¬ä¸å±çè¡¨è¿è¡è¿æ¥ï¼æç»çææ´ä¸ªé®é¢çæä¼è·¯å¾ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/4.png\"> </p>\n<p>âå¯æ¯ï¼è¿ä¸å°±æ¯ç©·ä¸¾åï¼âå°æé®éã</p>\n<p>çäºå¥è§£éè¯´ï¼âå¨æè§åæä¸¤ä¸ªç¹ç¹ï¼ä¸ä¸ªæ¯è¦éå¤çå©ç¨å­é®é¢çè§£ï¼è¿æ ·è½åå°è®¡ç®éï¼éä½å¤æåº¦ï¼å¦å¤ä¸ç¹å°±æ¯éè¿å­é®é¢çæä¼è§£è½å¤æé åºæç»çæä¼è§£ï¼ä¹å°±æ¯è¯´éè¦å·ææä¼å­ç»æçæ§è´¨ï¼æä»¥å¨æè§åçå¤æåº¦åç©·ä¸¾æ¯ä¸ä¸æ ·çãâ</p>\n<p>å¤§æç»§ç»­è§£éè¯´ï¼âè¿æï¼è½ç¶ä½ çå¾éçè¿çº¿æ¯è¾å¤ï¼ä½å¨å®éæåµéï¼å¹¶ä¸æ¯ææçååä¹é´é½è½äº§çè¿çº¿ï¼è¿æ¥å³ç³»ä¹æä¸ªåæ³æ§çé®é¢åï¼æä»¥å¤æåº¦æ¯å¯ä»¥æ§å¶ä½çãâ</p>\n<p>å°ææè§å¥½åæç½äºä¸ç¹ï¼ç¶åèµ¶ç´§è¿½é®ï¼âé£éä¼ ç®æ³å¢ï¼â</p>\n<p>å¤§æè¯´ï¼âè½ç¶å¨æè§åçå¤æåº¦æ¯å¯ä»¥æ§å¶çï¼ä½æ¯å¦æè¡¨æ¯è¾å¤ï¼å®çæç´¢ç©ºé´è¿æ¯å¾å¤§ï¼æä»¥å¦æå¨è¡¨æ¯è¾å¤çæ¶åï¼å¯ä»¥å°è¯ä½¿éä¼ ç®æ³ï¼è¿ä¸ªç®æ³è·å¾çä¸ä¸å®æ¯å¨å±æä¼è§£ï¼å®è·å¾çå¯è½æ¯å±é¨æä¼è§£ãâ</p>\n<p>âé£éä¼ ç®æ³æ¯æä¹å®ç°ç©çè·¯å¾æç´¢çå¢ï¼âå°æé®ã</p>\n<p>çäºå¥å»å¤§æçä¹¦æéæ¾å°äºä¸æ¬ç®æ³çä¹¦ï¼æ°å¥½éé¢æéä¼ ç®æ³çä»ç»ï¼äºæ¯æè¯»äºèµ·æ¥ï¼âéä¼ ç®æ³çå®ç°æ­¥éª¤å¦ä¸ï¼1ï¼ç§ç¾¤åå§åï¼å¯¹åºå è¿è¡ç¼ç ï¼å¹¶éè¿å¯¹åºå è¿è¡éæºçæåç»åï¼çæå¤ä¸ªæè²ä½ï¼è¿äºæè²ä½ææä¸ä¸ªæ°çç§ç¾¤ï¼å¦å¤ï¼å¨çææè²ä½çè¿ç¨ä¸­åæ¶è®¡ç®æè²ä½çéåºåº¦ï¼2ï¼éæ©æè²ä½ï¼éè¿éæºéæ©ï¼å®éä¸éè¿åºäºæ¦ççéæºæ°çæç®æ³ï¼è¿æ ·è½å¾åäºéæ©åºä¼ç§çæè²ä½ï¼ï¼éæ©åºç¨äºäº¤åååå¼çæè²ä½ï¼3ï¼äº¤åæä½ï¼æè²ä½è¿è¡äº¤åï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼4ï¼åå¼æä½ï¼å¯¹æè²ä½è¿è¡åå¼æä½ï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼5ï¼éåºåº¦è®¡ç®ï¼å¯¹ä¸è¯çæè²ä½è¿è¡æ·æ±°ãâ</p>\n<p>å¤§æç¬çè¯´ï¼âå°½ä¿¡ä¹¦ä¸å¦æ ä¹¦ï¼ææ¥è¯´ä¸ä¸éä¼ ç®æ³æ¯å¦ä½è§£å³è´§éé®é¢çãæä»¬å¯ä»¥å°åå¸ä½ä¸ºåºå ï¼èµ°éåä¸ªåå¸çè·¯å¾ä½ä¸ºæè²ä½ï¼è·¯å¾çæ»é¿åº¦ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°è´è´£ç­éææ¯è¾é¿çè·¯å¾ï¼ä¿çè¾ç­çè·¯å¾ï¼ç®æ³çæ­¥éª¤å¦ä¸ï¼1ï¼å¯¹åä¸ªåå¸è¿è¡ç¼å·ï¼å°åä¸ªåå¸æ ¹æ®ç¼å·è¿è¡æåç»åï¼çæå¤æ¡æ°çè·¯å¾ï¼æè²ä½ï¼ï¼ç¶åæ ¹æ®ååå¸é´çè·ç¦»è®¡ç®æ´ä½è·¯å¾é¿åº¦ï¼éåºåº¦ï¼ï¼å¤æ¡æ°è·¯å¾ææä¸ä¸ªç§ç¾¤ï¼2ï¼éæ©ä¸¤ä¸ªè·¯å¾è¿è¡äº¤åï¼éè¦æ³¨æäº¤åçææ°æè²ä½ä¸­ä¸è½éå¤åºç°åä¸ä¸ªåå¸ï¼ï¼å¯¹äº¤åæä½äº§ççæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼3ï¼éæºéæ©æè²ä½è¿è¡åå¼ï¼éå¸¸æ¹æ³æ¯äº¤æ¢åå¸å¨è·¯å¾ä¸­çä½ç½®ï¼ï¼å¯¹åå¼æä½åçæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼4ï¼å¯¹ç§ç¾¤ä¸­ææè·¯å¾è¿è¡åºäºè·¯å¾é¿åº¦æå°å°å¤§æåºï¼æ·æ±°ææåé åçè·¯å¾ãâå¤§æä¸å£æ°è¯´å®äºæ´ä¸ªæµç¨ï¼é¿åºäºä¸å£æ°ï¼ç¶åç»§ç»­è¯´ï¼âæä¹æ ·ï¼æ¯ä¸æ¯so easy?â</p>\n<p>å°ææ³äºæ³çäºå¥åå¤§æè¯´çæµç¨ï¼ç¶åè¯´ï¼âææ¥çæ³ä¸ä¸PostgreSQLæ¯å¦ä½å®ç°éä¼ ç®æ³çï¼PostgreSQLåºè¯¥æ¯æ¨¡æäºè§£å³è´§éé®é¢çæ¹æ³ï¼å®å°è¡¨ä½ä¸ºåºå ãæç»çæçæ§è¡è®¡åä½ä¸ºæè²ä½ãæ§è¡è®¡åçæ»ä»£ä»·ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°åæ¯åºäºè·¯å¾çä»£ä»·è¿è¡ç­éï¼å¯¹ä¸å¯¹ï¼â</p>\n<p>çäºå¥èµå¹éï¼âè¯´å¾éå¸¸å¥½ï¼ä¸è¿é PostgreSQLæ°æ®åºçåºå ç®æ³å®ç°æ¹å¼åéå¸¸çéä¼ ç®æ³ç¥æä¸åå¨äºå¶æ²¡æåå¼çè¿ç¨ï¼åªéè¿äº¤åäº§çæ°çæè²ä½ï¼ä¸è¿è¿é½ä¸æ¯éç¹äºãâ</p>\n<p>å¤§æè¯´ï¼âåååï¼æä»¬ä¸æ¯å¨æç´¢é¥­åºåï¼æä¹æç´¢èµ·æ¥æä¼è·¯å¾äºï¼ä¸è¦åè¯´ä¼åå¨äºï¼åæç¹é¥­é½æ²¡å¾åäºãâ<br>äºæ¯ä¸ä¸ªäººåç­ç«æå¤©çæèµ·é¥­åºæ¥äºã</p>\n","site":{"data":{}},"excerpt":"<p>å°æãå¤§æåçäºå¥å¨å¤§åç¹è¯éæç´¢éè¿å¥½çé¥­åºï¼ææ¥æå»æ»æ¯æè§ä¸å¤ªé è°±ï¼ä¸æ¯å«çæé®é¢ï¼å°±æ¯å³éä¸å¤æ­£å®ï¼å¤§ææå¹éï¼âçï¼è¿å°±æ¯èæµ·ï¼æä»¬å¯ä»¥åä¸æä¸ä¸ªAIç¹è¯ï¼åªè½æ¨èæä¼çé¥­åºåï¼æåç¡®çæ¾å°äºåè´§ä»¬ççç¹ï¼è¿éé¢éå«çå¾å¤§çåæºåï¼â</p>\n<p>çäºå¥ç¥äºå®ä¸ç¼è¯´ï¼âAIæ¨èå½ç¶å¥½åï¼å¯æ¯è¦æ¨èçåæè¡åï¼å¯æ¯ä¸ä¸ªäººä¸ä¸ªå£å³ï¼ä½ è¿ä¸ªéæ±å¤ªâæºè½âäºï¼æä¼°è®¡ä¸å¥½å¼ãâ</p>\n<p>å°æçªç¶æ³å°èªå·±æè¿å¨å­¦æ ¡çç®æ³è¯¾ä¸èå¸è®²è¿ä¸äºæ±æä¼è§£é®é¢çæ¹æ³ï¼ç¶åè¯´ï¼âæç¥éï¼æç¥éï¼ææè¿å¨ç®æ³è¯¾ä¸å­¦è¿ä¸äºæä¼è§£é®é¢çè§£å³æ¹æ³ï¼åºè¯¥å¯ä»¥ç¨å¾ä¸ãâ</p>","more":"<p>çäºå¥å¹å£æ°éï¼âå¯æ¯è¿äºæ¹æ³ç¨å°ä¼åå¨éé½ä¸ä¸å®å¤ç¨ï¼ä½åµç¨å°ä¸ä¸ªæ´å æºè½çé¡¹ç®ä¸å¢ï¼â</p>\n<p>âå¯ï¼ä¼åå¨éä¹ç¨å°äºæä¼è§£é®é¢çæ¹æ³äºåï¼æä»¬å­¦è¿å¨æè§åãè´ªå¿ç®æ³ãããâå°æå¦æ°å®¶ççè¯´èµ·æ¥ã</p>\n<p>å¤§æè¯´ï¼âç¨å°äºåï¼ è½ç¶ç©çè·¯å¾çä¸å»ä¹ä¸å¤ï¼ä½å®éä¸æä¸¾èµ·æ¥ï¼å®çæç´¢ç©ºé´ä¹ä¸å°ãä¾å¦å¨æ«æè·¯å¾ä¸­ï¼æä»¬å°±å¯ä»¥æé¡ºåºæ«æãç´¢å¼æ«æåä½å¾æ«æï¼åå¦ä¸ä¸ªè¡¨ä¸æå¤ä¸ªç´¢å¼ï¼é£ä¹å°±å¯è½äº§çå¤ä¸ªä¸åçç´¢å¼æ«æï¼é£ä¹åªä¸ªç´¢å¼æ«æè·¯å¾å¥½å¢ï¼èç´¢å¼æ«æåé¡ºåºæ«æãä½å¾æ«æç¸æ¯ï¼åªä¸ªå¥½å¢ï¼â</p>\n<p>å¤§æççå°æè¿·ç¦»çç¼ç¥ï¼åé¡¿äºä¸ä¸ï¼ç»ä»è¶³å¤çæèç©ºé´ä¹åç»§ç»­è¯´éï¼âæ°æ®åºè·¯å¾çæç´¢æ¹æ³éå¸¸æ3ç§ç±»åï¼èªåºåä¸æ¹æ³ãèªé¡¶åä¸æ¹æ³ãéæºæ¹æ³ï¼èPostgreSQLéç¨äºå¶ä¸­çä¸¤ç§æ¹æ³å¢ãâ</p>\n<p>âéç¨äºåªä¸¤ç§æ¹æ³å¢ï¼âçäºå¥æç¥æé®éã</p>\n<p>âéç¨äºèªåºåä¸çæ¹æ³åéæºæ¹æ³ï¼å¶ä¸­èªåºåä¸çæ¹æ³æ¯éç¨çå¨æè§åæ¹æ³ï¼èéæºæ¹æ³éç¨çæ¯éä¼ ç®æ³ãâ</p>\n<p>âé£æè°ä½¿ç¨äºèªé¡¶åä¸çæ¹æ³å¢ï¼âçäºå¥ç»§ç»­âæ§åâéã</p>\n<p>âå¯ãããè¿ä¸ªåï¼Pivotalå¬å¸çå¼æºä¼åå¨ORCAç¨çå°±æ¯èªé¡¶åä¸çæ¹æ³ãå¯ä»¥è®©çäºåç»ä½ è¯´è¯´æä¹æ ·ç¨å¨æè§åæ¹æ³æç´¢æä¼ç©çè·¯å¾ãâ</p>\n<p>çäºå¥æ¿åºçº¸æ¥ï¼å¨çº¸ä¸ç»äºå ä¸ªåï¼ç¶åè¯´ï¼âè¿ä»£è¡¨4ä¸ªè¡¨ï¼èªåºåä¸åï¼æä»¥æ¯ä»åºä¸åä¸å ç§¯ï¼è¿æ¯æåºå±ï¼æä»¬å«å®ç¬¬ä¸å±âã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/1.png\"> </p>\n<p>âå¨æè§åæ¹æ³é¦åèèä¸¤ä¸ªè¡¨çè¿æ¥ï¼å¶ä¸­ä¼åèèæè¿æ¥å³ç³»çè¡¨è¿è¡è¿æ¥ï¼ä¸¤ä¸ªè¡¨çè¿æ¥å¯ä»¥å»ºç«ä¸ä¸ªæ°çè¡¨ï¼æä»¬æè¿äºæ°è¡¨å«åç¬¬äºå±ãâçäºå¥éè¿è¿çº¿ï¼äº§çäºä¸äºæ°çâè¡¨âã</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/2.png\"> </p>\n<p>âç¬¬äºå±çè¡¨åç¬¬ä¸å±çè¡¨åè¿æ¥ï¼å¯ä»¥çæåºäº3ä¸ªè¡¨è¿æ¥çæ°çâè¡¨âï¼è¿æ ·å°±åååæ¨è¿äºä¸å±ï¼æä»¬äº§çäºç¬¬ä¸å±â</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/3.png\"> </p>\n<p>âç¶ååç¨ç¬¬ä¸å±çè¡¨åç¬¬ä¸å±çè¡¨è¿è¡è¿æ¥ï¼æç»çææ´ä¸ªé®é¢çæä¼è·¯å¾ãâ</p>\n<p><img src=\"/2020/10/03/postgresql-optimizer-outline-9/4.png\"> </p>\n<p>âå¯æ¯ï¼è¿ä¸å°±æ¯ç©·ä¸¾åï¼âå°æé®éã</p>\n<p>çäºå¥è§£éè¯´ï¼âå¨æè§åæä¸¤ä¸ªç¹ç¹ï¼ä¸ä¸ªæ¯è¦éå¤çå©ç¨å­é®é¢çè§£ï¼è¿æ ·è½åå°è®¡ç®éï¼éä½å¤æåº¦ï¼å¦å¤ä¸ç¹å°±æ¯éè¿å­é®é¢çæä¼è§£è½å¤æé åºæç»çæä¼è§£ï¼ä¹å°±æ¯è¯´éè¦å·ææä¼å­ç»æçæ§è´¨ï¼æä»¥å¨æè§åçå¤æåº¦åç©·ä¸¾æ¯ä¸ä¸æ ·çãâ</p>\n<p>å¤§æç»§ç»­è§£éè¯´ï¼âè¿æï¼è½ç¶ä½ çå¾éçè¿çº¿æ¯è¾å¤ï¼ä½å¨å®éæåµéï¼å¹¶ä¸æ¯ææçååä¹é´é½è½äº§çè¿çº¿ï¼è¿æ¥å³ç³»ä¹æä¸ªåæ³æ§çé®é¢åï¼æä»¥å¤æåº¦æ¯å¯ä»¥æ§å¶ä½çãâ</p>\n<p>å°ææè§å¥½åæç½äºä¸ç¹ï¼ç¶åèµ¶ç´§è¿½é®ï¼âé£éä¼ ç®æ³å¢ï¼â</p>\n<p>å¤§æè¯´ï¼âè½ç¶å¨æè§åçå¤æåº¦æ¯å¯ä»¥æ§å¶çï¼ä½æ¯å¦æè¡¨æ¯è¾å¤ï¼å®çæç´¢ç©ºé´è¿æ¯å¾å¤§ï¼æä»¥å¦æå¨è¡¨æ¯è¾å¤çæ¶åï¼å¯ä»¥å°è¯ä½¿éä¼ ç®æ³ï¼è¿ä¸ªç®æ³è·å¾çä¸ä¸å®æ¯å¨å±æä¼è§£ï¼å®è·å¾çå¯è½æ¯å±é¨æä¼è§£ãâ</p>\n<p>âé£éä¼ ç®æ³æ¯æä¹å®ç°ç©çè·¯å¾æç´¢çå¢ï¼âå°æé®ã</p>\n<p>çäºå¥å»å¤§æçä¹¦æéæ¾å°äºä¸æ¬ç®æ³çä¹¦ï¼æ°å¥½éé¢æéä¼ ç®æ³çä»ç»ï¼äºæ¯æè¯»äºèµ·æ¥ï¼âéä¼ ç®æ³çå®ç°æ­¥éª¤å¦ä¸ï¼1ï¼ç§ç¾¤åå§åï¼å¯¹åºå è¿è¡ç¼ç ï¼å¹¶éè¿å¯¹åºå è¿è¡éæºçæåç»åï¼çæå¤ä¸ªæè²ä½ï¼è¿äºæè²ä½ææä¸ä¸ªæ°çç§ç¾¤ï¼å¦å¤ï¼å¨çææè²ä½çè¿ç¨ä¸­åæ¶è®¡ç®æè²ä½çéåºåº¦ï¼2ï¼éæ©æè²ä½ï¼éè¿éæºéæ©ï¼å®éä¸éè¿åºäºæ¦ççéæºæ°çæç®æ³ï¼è¿æ ·è½å¾åäºéæ©åºä¼ç§çæè²ä½ï¼ï¼éæ©åºç¨äºäº¤åååå¼çæè²ä½ï¼3ï¼äº¤åæä½ï¼æè²ä½è¿è¡äº¤åï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼4ï¼åå¼æä½ï¼å¯¹æè²ä½è¿è¡åå¼æä½ï¼äº§çæ°çæè²ä½å¹¶å å¥å°ç§ç¾¤ï¼5ï¼éåºåº¦è®¡ç®ï¼å¯¹ä¸è¯çæè²ä½è¿è¡æ·æ±°ãâ</p>\n<p>å¤§æç¬çè¯´ï¼âå°½ä¿¡ä¹¦ä¸å¦æ ä¹¦ï¼ææ¥è¯´ä¸ä¸éä¼ ç®æ³æ¯å¦ä½è§£å³è´§éé®é¢çãæä»¬å¯ä»¥å°åå¸ä½ä¸ºåºå ï¼èµ°éåä¸ªåå¸çè·¯å¾ä½ä¸ºæè²ä½ï¼è·¯å¾çæ»é¿åº¦ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°è´è´£ç­éææ¯è¾é¿çè·¯å¾ï¼ä¿çè¾ç­çè·¯å¾ï¼ç®æ³çæ­¥éª¤å¦ä¸ï¼1ï¼å¯¹åä¸ªåå¸è¿è¡ç¼å·ï¼å°åä¸ªåå¸æ ¹æ®ç¼å·è¿è¡æåç»åï¼çæå¤æ¡æ°çè·¯å¾ï¼æè²ä½ï¼ï¼ç¶åæ ¹æ®ååå¸é´çè·ç¦»è®¡ç®æ´ä½è·¯å¾é¿åº¦ï¼éåºåº¦ï¼ï¼å¤æ¡æ°è·¯å¾ææä¸ä¸ªç§ç¾¤ï¼2ï¼éæ©ä¸¤ä¸ªè·¯å¾è¿è¡äº¤åï¼éè¦æ³¨æäº¤åçææ°æè²ä½ä¸­ä¸è½éå¤åºç°åä¸ä¸ªåå¸ï¼ï¼å¯¹äº¤åæä½äº§ççæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼3ï¼éæºéæ©æè²ä½è¿è¡åå¼ï¼éå¸¸æ¹æ³æ¯äº¤æ¢åå¸å¨è·¯å¾ä¸­çä½ç½®ï¼ï¼å¯¹åå¼æä½åçæ°è·¯å¾è®¡ç®è·¯å¾é¿åº¦ï¼4ï¼å¯¹ç§ç¾¤ä¸­ææè·¯å¾è¿è¡åºäºè·¯å¾é¿åº¦æå°å°å¤§æåºï¼æ·æ±°ææåé åçè·¯å¾ãâå¤§æä¸å£æ°è¯´å®äºæ´ä¸ªæµç¨ï¼é¿åºäºä¸å£æ°ï¼ç¶åç»§ç»­è¯´ï¼âæä¹æ ·ï¼æ¯ä¸æ¯so easy?â</p>\n<p>å°ææ³äºæ³çäºå¥åå¤§æè¯´çæµç¨ï¼ç¶åè¯´ï¼âææ¥çæ³ä¸ä¸PostgreSQLæ¯å¦ä½å®ç°éä¼ ç®æ³çï¼PostgreSQLåºè¯¥æ¯æ¨¡æäºè§£å³è´§éé®é¢çæ¹æ³ï¼å®å°è¡¨ä½ä¸ºåºå ãæç»çæçæ§è¡è®¡åä½ä¸ºæè²ä½ãæ§è¡è®¡åçæ»ä»£ä»·ä½ä¸ºéåºåº¦ï¼éåºåº¦å½æ°åæ¯åºäºè·¯å¾çä»£ä»·è¿è¡ç­éï¼å¯¹ä¸å¯¹ï¼â</p>\n<p>çäºå¥èµå¹éï¼âè¯´å¾éå¸¸å¥½ï¼ä¸è¿é PostgreSQLæ°æ®åºçåºå ç®æ³å®ç°æ¹å¼åéå¸¸çéä¼ ç®æ³ç¥æä¸åå¨äºå¶æ²¡æåå¼çè¿ç¨ï¼åªéè¿äº¤åäº§çæ°çæè²ä½ï¼ä¸è¿è¿é½ä¸æ¯éç¹äºãâ</p>\n<p>å¤§æè¯´ï¼âåååï¼æä»¬ä¸æ¯å¨æç´¢é¥­åºåï¼æä¹æç´¢èµ·æ¥æä¼è·¯å¾äºï¼ä¸è¦åè¯´ä¼åå¨äºï¼åæç¹é¥­é½æ²¡å¾åäºãâ<br>äºæ¯ä¸ä¸ªäººåç­ç«æå¤©çæèµ·é¥­åºæ¥äºã</p>"},{"title":"PostgreSQLä¼åå¨ç½è¯(10) - æåè¡¥åä¸¤å¥","date":"2020-10-03T01:13:44.000Z","_content":"\n\n**å¨æç®å½**\n\n1. {% post_link postgresql-optimizer-outline-1 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å %}\n2. {% post_link postgresql-optimizer-outline-2 ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå² %}\n3. {% post_link postgresql-optimizer-outline-3 ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼ %}\n4. {% post_link postgresql-optimizer-outline-4 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼ %}\n5. {% post_link postgresql-optimizer-outline-5 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·± %}\n6. {% post_link postgresql-optimizer-outline-6 ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´ %}\n7. {% post_link postgresql-optimizer-outline-7 ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é %}\n8. {% post_link postgresql-optimizer-outline-8 ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©· %}\n9. {% post_link postgresql-optimizer-outline-9 ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº %}\n\nãPostgreSQLä¼åå¨ç½è¯ãææ¶å§ç»äºï¼æä»¬åºæ¬ä¸æ¶µçäºå¤§é¨åæ¥è¯¢ä¼åçæ¦å¿µï¼ä½æ¯ç±äºç¯å¹æ¯è¾å°ï¼æ²¡ææç»èè¯´å¾ç¹å«å°ä½ï¼å¶ä¸­æå¤§é¨ååå®¹æ¯ææèªãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦çæ¦å¿µè§£éçé¨åï¼ç¶åä»¥å°æãå¤§æåçäºå¥è¿è¡å¯¹è¯çæ¹å¼å±ç°åºæ¥ï¼å¯¹äºä¹¦ä¸­ä»ç»çä»£ç åæçé¨åä»¥åæ¯è¾æ·±å¥çå®ç°ç»èï¼ç±äºä¸å¤ªå®¹æéè¿å¯¹è¯çæ¹å¼å±ç¤ºï¼æä»¥å¨ãPostgreSQLä¼åå¨ç½è¯ãä¸­æ²¡ææ¶åå°ã\n\næå·²ç»å°½ææè½å°è¿ç§å¯¹è¯çå½¢å¼åçå·ææäºæ§ä¸äºï¼ä½æ¯éäºä½èçè¯­è¨è½åï¼æäºæèçåæ¢ä¸ä¼æ¾å¾æ¯è¾çç¡¬ï¼å¨æèçå¤çä¸ææ¶ä¹ç¸å¯¹æ¯è¾åèäºï¼ä¸è¿è¯·æ¾å¿ï¼æå³ä½¿ååªåä¹åä¸åºæ¥ä¸çåèï¼æä»¥è¯·ä¸è¦éè§æï¼å ä¸ºæçæ°èµ·æ¥è¿æèªå·±é½å®³æã","source":"_posts/postgresql-optimizer-outline-10.md","raw":"---\ntitle: PostgreSQLä¼åå¨ç½è¯(10) - æåè¡¥åä¸¤å¥\ndate: 2020-10-03 09:13:44\ntags:\n---\n\n\n**å¨æç®å½**\n\n1. {% post_link postgresql-optimizer-outline-1 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å %}\n2. {% post_link postgresql-optimizer-outline-2 ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå² %}\n3. {% post_link postgresql-optimizer-outline-3 ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼ %}\n4. {% post_link postgresql-optimizer-outline-4 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼ %}\n5. {% post_link postgresql-optimizer-outline-5 ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·± %}\n6. {% post_link postgresql-optimizer-outline-6 ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´ %}\n7. {% post_link postgresql-optimizer-outline-7 ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é %}\n8. {% post_link postgresql-optimizer-outline-8 ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©· %}\n9. {% post_link postgresql-optimizer-outline-9 ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº %}\n\nãPostgreSQLä¼åå¨ç½è¯ãææ¶å§ç»äºï¼æä»¬åºæ¬ä¸æ¶µçäºå¤§é¨åæ¥è¯¢ä¼åçæ¦å¿µï¼ä½æ¯ç±äºç¯å¹æ¯è¾å°ï¼æ²¡ææç»èè¯´å¾ç¹å«å°ä½ï¼å¶ä¸­æå¤§é¨ååå®¹æ¯ææèªãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦çæ¦å¿µè§£éçé¨åï¼ç¶åä»¥å°æãå¤§æåçäºå¥è¿è¡å¯¹è¯çæ¹å¼å±ç°åºæ¥ï¼å¯¹äºä¹¦ä¸­ä»ç»çä»£ç åæçé¨åä»¥åæ¯è¾æ·±å¥çå®ç°ç»èï¼ç±äºä¸å¤ªå®¹æéè¿å¯¹è¯çæ¹å¼å±ç¤ºï¼æä»¥å¨ãPostgreSQLä¼åå¨ç½è¯ãä¸­æ²¡ææ¶åå°ã\n\næå·²ç»å°½ææè½å°è¿ç§å¯¹è¯çå½¢å¼åçå·ææäºæ§ä¸äºï¼ä½æ¯éäºä½èçè¯­è¨è½åï¼æäºæèçåæ¢ä¸ä¼æ¾å¾æ¯è¾çç¡¬ï¼å¨æèçå¤çä¸ææ¶ä¹ç¸å¯¹æ¯è¾åèäºï¼ä¸è¿è¯·æ¾å¿ï¼æå³ä½¿ååªåä¹åä¸åºæ¥ä¸çåèï¼æä»¥è¯·ä¸è¦éè§æï¼å ä¸ºæçæ°èµ·æ¥è¿æèªå·±é½å®³æã","slug":"postgresql-optimizer-outline-10","published":1,"updated":"2020-10-03T01:29:32.000Z","_id":"ckfszn0xc0000rz9khcerd7qi","comments":1,"layout":"post","photos":[],"link":"","content":"<p><strong>å¨æç®å½</strong></p>\n<ol>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-1/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å</a></li>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-2/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå²\">ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå²</a></li>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-3/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼\">ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼</a></li>\n<li><a href=\"/2020/08/05/postgresql-optimizer-outline-4/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼</a></li>\n<li><a href=\"/2020/08/14/postgresql-optimizer-outline-5/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·±\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·±</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-6/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´\">ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-7/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é\">ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-8/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©·\">ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©·</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-9/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº\">ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº</a>\n\n</li>\n</ol>\n<p>ãPostgreSQLä¼åå¨ç½è¯ãææ¶å§ç»äºï¼æä»¬åºæ¬ä¸æ¶µçäºå¤§é¨åæ¥è¯¢ä¼åçæ¦å¿µï¼ä½æ¯ç±äºç¯å¹æ¯è¾å°ï¼æ²¡ææç»èè¯´å¾ç¹å«å°ä½ï¼å¶ä¸­æå¤§é¨ååå®¹æ¯ææèªãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦çæ¦å¿µè§£éçé¨åï¼ç¶åä»¥å°æãå¤§æåçäºå¥è¿è¡å¯¹è¯çæ¹å¼å±ç°åºæ¥ï¼å¯¹äºä¹¦ä¸­ä»ç»çä»£ç åæçé¨åä»¥åæ¯è¾æ·±å¥çå®ç°ç»èï¼ç±äºä¸å¤ªå®¹æéè¿å¯¹è¯çæ¹å¼å±ç¤ºï¼æä»¥å¨ãPostgreSQLä¼åå¨ç½è¯ãä¸­æ²¡ææ¶åå°ã</p>\n<p>æå·²ç»å°½ææè½å°è¿ç§å¯¹è¯çå½¢å¼åçå·ææäºæ§ä¸äºï¼ä½æ¯éäºä½èçè¯­è¨è½åï¼æäºæèçåæ¢ä¸ä¼æ¾å¾æ¯è¾çç¡¬ï¼å¨æèçå¤çä¸ææ¶ä¹ç¸å¯¹æ¯è¾åèäºï¼ä¸è¿è¯·æ¾å¿ï¼æå³ä½¿ååªåä¹åä¸åºæ¥ä¸çåèï¼æä»¥è¯·ä¸è¦éè§æï¼å ä¸ºæçæ°èµ·æ¥è¿æèªå·±é½å®³æã</p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>å¨æç®å½</strong></p>\n<ol>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-1/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸ºä»ä¹ä¼å</a></li>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-2/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå²\">ãPostgreSQLä¼åå¨ç½è¯ã- SQLè¿åå²</a></li>\n<li><a href=\"/2020/08/02/postgresql-optimizer-outline-3/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼\">ãPostgreSQLä¼åå¨ç½è¯ã- æåï¼æåï¼</a></li>\n<li><a href=\"/2020/08/05/postgresql-optimizer-outline-4/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸æ¨ï¼ä¸æ¨ï¼</a></li>\n<li><a href=\"/2020/08/14/postgresql-optimizer-outline-5/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·±\">ãPostgreSQLä¼åå¨ç½è¯ã- ä¸¥æ ¼è¦æ±èªå·±</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-6/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´\">ãPostgreSQLä¼åå¨ç½è¯ã- ç»è®¡å±æçæ³æ°´</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-7/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é\">ãPostgreSQLä¼åå¨ç½è¯ã- ä½ èµ°ä½ çé³å³é</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-8/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©·\">ãPostgreSQLä¼åå¨ç½è¯ã- ç®è®¡ä¸å°å°±åç©·</a></li>\n<li><a href=\"/2020/10/03/postgresql-optimizer-outline-9/\" title=\"ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº\">ãPostgreSQLä¼åå¨ç½è¯ã- æ¾é¥­åº</a>\n\n</li>\n</ol>\n<p>ãPostgreSQLä¼åå¨ç½è¯ãææ¶å§ç»äºï¼æä»¬åºæ¬ä¸æ¶µçäºå¤§é¨åæ¥è¯¢ä¼åçæ¦å¿µï¼ä½æ¯ç±äºç¯å¹æ¯è¾å°ï¼æ²¡ææç»èè¯´å¾ç¹å«å°ä½ï¼å¶ä¸­æå¤§é¨ååå®¹æ¯ææèªãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦çæ¦å¿µè§£éçé¨åï¼ç¶åä»¥å°æãå¤§æåçäºå¥è¿è¡å¯¹è¯çæ¹å¼å±ç°åºæ¥ï¼å¯¹äºä¹¦ä¸­ä»ç»çä»£ç åæçé¨åä»¥åæ¯è¾æ·±å¥çå®ç°ç»èï¼ç±äºä¸å¤ªå®¹æéè¿å¯¹è¯çæ¹å¼å±ç¤ºï¼æä»¥å¨ãPostgreSQLä¼åå¨ç½è¯ãä¸­æ²¡ææ¶åå°ã</p>\n<p>æå·²ç»å°½ææè½å°è¿ç§å¯¹è¯çå½¢å¼åçå·ææäºæ§ä¸äºï¼ä½æ¯éäºä½èçè¯­è¨è½åï¼æäºæèçåæ¢ä¸ä¼æ¾å¾æ¯è¾çç¡¬ï¼å¨æèçå¤çä¸ææ¶ä¹ç¸å¯¹æ¯è¾åèäºï¼ä¸è¿è¯·æ¾å¿ï¼æå³ä½¿ååªåä¹åä¸åºæ¥ä¸çåèï¼æä»¥è¯·ä¸è¦éè§æï¼å ä¸ºæçæ°èµ·æ¥è¿æèªå·±é½å®³æã</p>\n"},{"title":"PostgreSQLä¸­çé - èªæé","date":"2021-02-06T08:18:10.000Z","_content":"\nç»è¿ä¸æ¬¡ç{% post_link postgresql-optimizer-outline-10 ããPostgreSQLä¼åå¨ç½è¯ã %}ä¸­å¤§æåçäºå¥å¯¹PostgreSQLä¼åå¨çæ¦è¦çè®²è§£ï¼å°ææå°èªå·±å·²ç»æ·±æ·±çç±ä¸äºæ°æ®åºåæ ¸ï¼å°æå¨GitChatç½ç«ä¸è´­ä¹°äºãPostgreSQLä¼åå¨å¥é¨ãçæå­ç½è¯¾ï¼è¿è·å°å®ä½ä¹¦åºä¹°äºæ¬ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãï¼æ¯å¤©å¯¹ç§çç½è¯¾åä¹¦ä¸çåå®¹ä»ç»ç è¯»PostgreSQLçä¼åå¨çå®ç°ï¼åå¤å¨æ¯ä¸ä¹åå»ä»äºæ°æ®åºåæ ¸å¼åçå·¥ä½ã\n\nä¸è¿ï¼æè¿å¨å­¦æ ¡çæ°æ®åºåçè¯¾ç¨å­¦å°äºå¹¶åæ§å¶çé¨åï¼è¿é¨åå¯¹å°ææ¥è¯´æç¹é¾åº¦ï¼å ä¸ºå°ææ²¡æå¯¹æ°æ®åºçåçè¿è¡è¿å®è·µï¼æ æ³çè§£éçéè¦æ§ï¼äºæ¯å°æåæ¥å°èªå·±çå¥å¥å¤§æå®¶éåå¤§æè¯·æPostgreSQLæ¯å¦ä½å®ç°å¹¶åæ§å¶çã\n<!-- more -->\n\nå¤§æè¯´ï¼âå¹¶åæ§å¶çé¨åæ¯è¾ç¹æï¼æä»¬ä»å¤©ä¸»è¦å³æ³¨PostgreSQLéçå®ç°ï¼ä¸è¿æä»¬åä»æåºå±çé¨åå¼å§ï¼åæ¥çä¸çPostgreSQLæ¯å¦ä½å®ç°ä¸ä¸ªèªæéçï¼ä½ ç¥éèªæéåï¼â\n\nå°ææè§è¿ä¸ªæ¦å¿µå¥½åå¨åªéå¬è¿ï¼ä½åæ²¡ä»ä¹å°è±¡ï¼äºæ¯å°å£°çè¯´ï¼âä¸ç¥éãâ\n\nå¤§æååä¸ç¬ï¼å²è®½éï¼âè¿ä¹è½»æå°±è¯´ä¸ç¥éï¼èªä¿¡ä¸ç¹ï¼å¤§èä¸ç¹ï¼åé®ä½ ä¸éï¼ç¥éä¸ç¥éèªæéï¼ï¼â\n\nå°ææè§åå°äºå¾å¤§çé¼èï¼äºæ¯å¤§å£°çè¯´ï¼âèå­ä¸ç¥éï¼â\n\nâå¯ï¼å¾èªä¿¡åãããæ¥ï¼è®©æç»ä½ è®²è®²ãPostgreSQLçéçæ¦å¿µæå¾å¤ç§ï¼æ¯å¦å¸¸è§çè¡¨éãè¡éãé¡µéãè½»ééãèªæéç­ç­ï¼è¿éé¢æåºå±çæ¯å®ç°æ¯èªæéï¼å®åç¡¬ä»¶ç´æ¥æ¥è§¦ï¼å¹¶ä¸å±è½åç§ä¸åç¡¬ä»¶åæä½ç³»ç»çç»èï¼éå¸¸å©ç¨ç¡¬ä»¶æä¾çåå­æä½æä»¤æ¥å®ç°ãâ\n\nâé£ä¸ºä»ä¹è¦ä½¿ç¨è¿ç§éå¢ï¼â\n\nâèªæéæ¯ä¸ç§äºæ¥éï¼å®éå¸¸æ¯ç¨æ¥ä¿æ¤ä¸´çåºï¼è¿ç§ä¿æ¤çæ¹å¼æ¯ä¸ç§âä¸æ¯ä½ æ­»å°±æ¯ææ´»âçæ¹å¼ï¼æ¯å¦è¯´æéè¿éè·åå°è¿ä¸ªä¸´çåºçè®¿é®æéï¼é£ä¹å¶ä»äººå°±å¿é¡»ç­å¾ï¼é£å®æä¹ç­å¾å¢ï¼â\n\nâæç¥éï¼âå°ææ¢ç­éï¼âå¦æå¹²ç­ççè¯ï¼CPUå°±ä¸è½è¢«ååçå©ç¨ï¼æä»¥æç¥éç³»ç»éæä¸ä¸ªsleepå½æ°è½å¾å¥½çè§£å³è¿ä¸ªé®é¢ï¼å¦ææä»¬ä¸è½è·åå°éï¼é£ä¹æä»¬å¯ä»¥ç¡ä¸ä¼ï¼åæ¥è·åéï¼æå¬è¯´sleepå½æ°å¯ä»¥éæ¾CPUèµæºï¼è¿æ ·å¶ä»è¿ç¨æèçº¿ç¨å°±è½ååçå©ç¨CPUäºï¼è¿æ ·CPUå³è¢«ååçå©ç¨ï¼æä¹è½ä¸åçå¯¹éååºè¯·æ±ï¼å²ä¸æ¯ä¸¤å¨å¶ç¾ãâå°æä¼¸äºä¼¸è¡£è¢ï¼å¯¹å¤§æè¯´ï¼âæ¿ç¬æ¥ï¼è®©æå±ç¤ºä¸ä¸codingçè½åãâ\n\nå¤§æç»ä»æ¾äºçº¸åç¬ï¼è°ä¾éâçä¸å»å¾é«è°åãããâ\n\nâæä¹æ³ä½è°ï¼ä½æ¯å®åä¸åè®¸åï¼âå°æä¸è¾¹è¯´ï¼ä¸è¾¹å¨çº¸ä¸ååºäºèªå·±çèå¾ï¼\n\n```\n\twhile(!spinlock_aquire(&lock))\n\t\tsleep(100);\n```\n\nå¤§ææ¥è¿ç¬å¨å°æåçä»£ç ä¸ç»äºä¸ä¸ªå¤§å¤§çå¯¹å¾ï¼å¯¹å°æçè¡ä¸ºè¡¨ç¤ºè¯å®ï¼ç¶ååç»äºä¸ä¸ªXï¼è§£ééï¼âè½ç¶çä¸å»åçï¼ä½æ¯è¿éå­å¨ä¸ä¸ªé®é¢ï¼ææ¶æä»¬è¦ä¿æ¤çä¸´çåºåªæåºåºå ä¸ªæä»¤ï¼éçææèå®éä¸å æéçæ¶é´æ¯æç­çï¼æ¢å¥è¯è¯´éçè¯·æ±èå®éä¸ä¸ç¨ç­å¤ªé¿æ¶é´å°±è½è·å¾éï¼è¿æ¶åå°±éè¦èèè¿ä¸ªç¡ç æ¯ä¸æ¯åéäºãâ\n\nå°æè¯´ï¼âæä»ä¹ä¸åéçï¼ä¸ç¡ç é¾éä¸ç´å çCPUèµæºä¸æ¾ï¼æµªè´¹CPUèµæºï¼è¿ç®ç´æ¯å çèåXXXåãâ\n\nâå¯¹ï¼å°±æ¯å çèåXXXï¼ä½ è¯´çç¡ç æ¨¡å¼å®éä¸è¿è¡äºCPUä¸ä¸æçåæ¢ï¼ä½è¿ç§åæ¢éè¦éå¸¸å¤çæ¶éå¨æï¼å¦ææä»¬è¦ä¿æ¤çä¸´çåºå¾ç­ï¼è¿ç§åæ¢çä»£ä»·å°±æ¾å¾æç¹å¤§äºï¼æä»¥éæ¾CPUèµæºè¿ä¸å¦å çå¥½ãâ\n\nå°ææ³äºæ³ï¼è¯´ï¼âå¦ï¼é£è¿ç§éæç¹åä¸ä¸ªå°æåéå°äºæ³è¦çç©å·ï¼å®¶é¿ä¸ç»ä¹°çæ¶åçè¡ä¸ºãããâ\n\nå¤§æç¬çè¯´ï¼âæ¯çï¼ä½ å°æ¶åå°±æ¯è¿æ ·ï¼èä¸ï¼ä½ å¨å°ä¸ææ»çæ¶åä»æ¥ä¸ä¼æ¯ï¼ä¸ç´å¤äºæ»å¨çç¶æï¼æä»¥ä½ å¾å°çæ¶åå°±çè§£äºèªæéçæ¬è´¨ï¼å°±æ¯å¿ç­ãâ\n \n\n\n\n**èªæéçä¼ªç **\n\nå°æç»§ç»­è¯´ï¼âè¿æ ·çè¯ï¼èªæéçå®ç°å°±æ¯è¾å®¹æäºï¼ä¹å°±æ¯ä¸sleepåï¼ææ¥æå®ååºæ¥ãâè¯´çå¼å§å¨çº¸ä¸å¼å§åèªæéå®ç°çä¼ªç ï¼å ä¸ºå·²ç»äºè§£äºèªæéçåºæ¬åçï¼æä»¥åä»£ç çè¿ç¨æ¯æä¸ºé¡ºå©çï¼å°æä¸è¾¹åä¸è¾¹ææä½©æèªå·±ï¼é½æ¯ä¹å¹´ä¹å¡æè²ï¼æä¹æå°±è¿ä¹ä¼ç§å¢ï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåã\n\n```\n//è®©æä»¬åè®¾lockåæ°æ¯ä¸ä¸ªçº¿ç¨æè¿ç¨å±äº«åé\nint spinlock_acquire(int *lock)\n{\n    while(*lock != 0)\n        continue;\n    *lock = 1;\n    return *lock;\n}\n\nint spinlock_release(int *lock)\n{\n    *lock = 0;\n}\n```\n\nå¤§æççå°ææ´æ´èªå¾çåçè¿æ®µä»£ç ï¼éè§å°ï¼âä½ è§å¾è¿æ ·å°±è½å®ç°ä¸ä¸ªèªæéåï¼è°¬ç£ãâè¯´çæ¿ç¬å¨å°æåçèªæéä¸ç»äºä¸ä¸ªå¤§å¤§çXï¼ç¶åä¸è¾¹æå¼çµèï¼ä¸è¾¹ç»§ç»­è¯´ï¼âè®©æä»¬ççä½ éå¨åªéãâè¯´çåªåªåªçå¨ç¼è¯å¨éæ²åºäºåå°æåæ ·é»è¾çä»£ç ï¼ç¼è¯ä¹åï¼éè¿ä»£ç è°è¯å·¥å·æ¥çäºspinlock_acquireå½æ°çæ±ç¼ä»£ç ï¼\n\n```\nspinlock1`spinlock_acquire:\n    0x100000f10 <+0>:  pushq  %rbp\n    0x100000f11 <+1>:  movq   %rsp, %rbp\n    0x100000f14 <+4>:  movq   %rdi, -0x8(%rbp)\n    0x100000f18 <+8>:  movq   -0x8(%rbp), %rax\n    0x100000f1c <+12>: cmpl   $0x0, (%rax)\n    0x100000f1f <+15>: je     0x100000f2a \n    0x100000f25 <+21>: jmp    0x100000f18\n    0x100000f2a <+26>: movq   -0x8(%rbp), %rax\n    0x100000f2e <+30>: movl   $0x1, (%rax)\n    0x100000f34 <+36>: movq   -0x8(%rbp), %rax\n    0x100000f38 <+40>: movl   (%rax), %eax\n    0x100000f3a <+42>: popq   %rbp\n    0x100000f3b <+43>: retq\n    0x100000f3c <+44>: nopl   (%rax)\n```\n\nå¤§ææçå±å¹ä¸çæ±ç¼ä»£ç è¯´ï¼âè¿æ®µä»£ç æ¯æ æ³ä½ä¸ºéçå®ç°çï¼å ä¸ºä¸é¢çæä½ç¼ºä¹åå­æ§ï¼æ¯å¦å¯¹lockå¯¹åºçå¼æ¯å¦ä¸º0ï¼*lock != 0ï¼çå¤æ­å°±ä¸æ¯ä¸ä¸ªåå­æä½ï¼å®æ¯éè¿movq   -0x8(%rbp), %raxåcmpl   $0x0, (%rax)ä¸¤ä¸ªæä»¤æ¥å®ç°ãåå¦æä¸¤ä¸ªçº¿ç¨æ¥è·ååä¸ä¸ªéï¼é£ä¹ä¼åçä»ä¹æåµå¢ï¼âè¯´çå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼\n \nâä½ çï¼è¿æ¶åé®é¢å°±åºç°äºï¼çº¿ç¨Aåçº¿ç¨Båæ¶è§å¾å½åçlockä¸­çå¼æ¯0ï¼ä¹å°±æ¯è¯´ä»ä»¬ä¸¤ä¸ªé½è½è·å¾éèµæºï¼ä¹å°±åºç°äºä¸¤ä¸ªçº¿ç¨åæ¶è·å¾éçæåµï¼ä½ è§å¾è¿è¿åçåï¼â\n\nå°æç¾æ§çä½ä¸äºå¤´ï¼æªä¸å¾èªå·±äºåå¤å¹´å°å¤´æ¥ï¼è¿å¨äººæµ·éæµ®æ²ï¼åæ¥æ¯å ä¸ºä¸ææ±ç¼è¯­è¨åã\n\nççå°æç¾æ§çè¡¨æï¼å¤§æè§£ééï¼âCè¯­è¨çä¸æ¡è¯­å¥å¯è½å¯¹åºå æ¡æ±ç¼æä»¤ï¼å¨æ§è¡æé´æ æ³ä¿è¯å®çåå­æ§ï¼æä»¥å¨é«çº§è¯­è¨çå±é¢éè¦åå©ä¸äºç®æ³æèåºå±çæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼å¦ææ³éè¿é«çº§è¯­è¨çç®æ³æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼ä¹ä¸æ¯è¡¥å¯ä»¥ï¼ä½æ¯éè¦ä½¿ç¨ä¸äºæ¯è¾ç²¾å¦çç®æ³ï¼æ¯å¦Petersonç®æ³ï¼ï¼è¿äºæ¹æ³é½æå¾å¤§çå±éæ§ï¼ç°å¨å·²ç»å¾å°ä½¿ç¨è¿äºæ¹æ³äºï¼ä»å¤©æä»¬éè¦å³æ³¨çæ¯ç®åçè®¡ç®æºæä¾çä¸äºç¡¬ä»¶æä»¤ï¼éè¿è¿äºæä»¤ï¼æä»¬å¯ä»¥åå©è¿äºæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ãâ\n\n**TAS VS CAS**\n\n\nå°ææ¯æ¯çé®éï¼âæ¯ä¸æ¯æä»¬å­¦æä½ç³»ç»è¯¾ç¨çæ¶åè¯´çé£äºåå­æä»¤ï¼â\n\nâå¯¹çï¼ç°å¨å¤§é¨åç¡¬ä»¶é½æ¯æä¸¤ç§ç±»åçåå­æä½æä»¤ï¼æ¯å¦TASåCASæä»¤ï¼ä¸é¢æä»¬ç»åºä»ä»¬çä¼ªç ãâè¯´çï¼å¤§ææ¿äºä¸å¼ æ°çç½çº¸ï¼è¾¹åè¾¹è¯´éï¼âTEST-AND-SET ç®ç§°ä¸ºTASï¼å®çæµç¨æ¯ååå­åéåå¥1ï¼ç¶åè¿ååå­åéçåå¼ï¼ä¼ªç æ¯è¿æ ·çãâ\n\n```\nint TAS(int *lock)\n{\n    int temp = *lock;\n    *lock = 1;\n    return *lock;\n}\n```\n\nâCOMPARE-AND-SWAPç®ç§°CASï¼å®çæµç¨æ¯æ¯è¾éä¸­çå¼åææå¼ï¼å¦æéä¸­çå¼åææå¼ç¸åï¼åè®¾ç½®ä¸ºæ°å¼ï¼è¿åtrue,å¦åä¸è®¾ç½®æ°å¼ï¼è¿åfalseï¼å®çä¼ªç æ¯è¿æ ·çãâå¤§æç»§ç»­åéã\n\n```\nint CAS(int *lock, int expect, int new)\n{\n    if(*lock == expect)\n    {\n        *lock = new;\n        return true;\n    }\n    return false;\n}\n```\n\nå¤§ææç¤ºéï¼âæ³¨æï¼ä¸é¢çä¼ªç æ¯åç¨é«çº§è¯­è¨çå½¢å¼æ¥æè¿°è¿ä¸¤ç§ç±»åçæä»¤çå«ä¹ï¼å®éä¸å®æ¯ä¸ä¸ªå®æ´çåå­æä½ï¼å¨X86æ¶æçCPUä¸­ï¼åå«æä¾äºXCHGæä»¤åCMPXCHGæä»¤æ¥å®ç°TASåCASæä½ï¼PostgreSQLå¨X86æ¶æä¸éç¨çæ¯åºäºXCHGæä»¤çTASæ¥å®ç°çèªæéãâ\n\nå°æå´å¥çè¯´ï¼âæå·²ç»è¿«ä¸åå¾çæ³ççPostgreSQLæ¯æä¹ä½¿ç¨TASæä»¤æ¥å®ç°èªæéçäºãâ\n\nå¤§æççå°ææèè¶³è¹çç¥æï¼åäºä¸ä¸ªcalm downçæå¿ï¼ç¶åè¯´ï¼âç¨å®å¿èºï¼ä¸è¦æ¥ï¼åè¿ä¸ä¼ç²¾ç¥çé¢çææ¤è½¦å°±å°äºãå¨è¿ä¹åæä»¬åæ¥è°ä¸ä¸TTASãâ\n\nâTTASï¼æè§åæ¯TEST AND TEST-AND-SETï¼â\n\nâæ¯çï¼TASè½ç¶å·²ç»è¶³å¤æä»¬ä½¿ç¨ï¼ä½æ¯ä¹å¸¦æ¥ä¸ä¸ªé®é¢ï¼å¤§é¨åCPUå®ç°TASçæ¹æ³æ¯éä½æ»çº¿ï¼ä¸æ¦éä½æ»çº¿å°±ç­äºä¸ä¸ªCPUå ç¨äºæ´ä¸ªæ»çº¿ï¼èé¢ç¹çéä½æ»çº¿ä¼éä½CPUçä½¿ç¨æçï¼æä»¥å¨è¿å¥TASä¹åï¼æä»¬å¯ä»¥ååä¸ä¸ªç²ç¥çæ£æµï¼è¿ä¸ªæ£æµä¸å¨åå­æä½ä¹ä¸­ï¼ä½æ¯å®å¯ä»¥è®©æä»¬å¿«éçç¥éç®åéçç¶æï¼å¦æç¬¬ä¸ä¸ªTESTæ£æµå°éå·²ç»è¢«å ç¨äºï¼é£ä¹æä»¬å°±åç­ä¸ä¼ï¼å°±ä¸ç¨è¿è¡TASäºï¼è¿æ ·å°±é¿åäºéä½æ»çº¿ï¼å¦æç¬¬ä¸ä¸ªTESTåç°éæ²¡æè¢«å ç¨ï¼é£ä¹å°±å¼å¾å»åTASãâ\n\nå°æè¯´ï¼âä½å¨ç¬¬ä¸ä¸ªTESTåTEST-AND-SETä¹é´ï¼éçç¶æå¯è½ä¼è¢«å¶ä»CPUä¸çè¿ç¨ä¿®æ¹æå§ï¼â\n\nâæ¯çï¼æä»¥è¿ä¸ªTESTåªæ¯æä»¬æé«æ§è½çä¸ä¸ªææ®µãæ¯å¦å¨PostgreSQLæ°æ®åºä¸­ï¼å®å°±æ¯éç¨çTTASçæ¹æ³ãâè¯´çï¼å¤§ææå¼äºPostgreSQLæºä»£ç ï¼æ¾å°äºTASå®ç°çé¨åï¼\n\n```\nstatic __inline__ int\ntas(volatile slock_t *lock)\n{\n   register slock_t _res = 1;\n\n   __asm__ __volatile__(\n      \"  cmpb   $0,%1  \\n\"\n      \"  jne       1f    \\n\"\n      \"  lock         \\n\"\n      \"  xchgb  %0,%1  \\n\"\n      \"1: \\n\"\n:     \"+q\"(_res), \"+m\"(*lock)\n:\n:     \"memory\", \"cc\");\n   return (int) _res;\n}\n```\n\nå¤§æä¸è¾¹ç¨é¼ æ å¨ç¼è¯å¨éåä½äºtaså½æ°ï¼ä¸è¾¹è¯´ï¼âä»è¿æ®µæ±ç¼ä»£ç å¯ä»¥çåºï¼CMPæä»¤åä¸é¢çXCHGä¸è½ç»æä¸ä¸ªåå­æä½ï¼æ¯å¦ä¸ä¸ªçº¿ç¨Bå·²ç»ææäºéï¼çº¿ç¨AåäºCMPæä»¤ä¹åç°äºæå¶ä»çº¿ç¨å·²ç»å æäºéèµæºï¼äºæ¯ä»å°±ä¼JNEè·³è¿XCHGæä»¤ï¼ä½æ¯å¾å¯è½å¨CMPæä»¤ä¹åï¼çº¿ç¨Bå°±ç«å³éæ¾äºéèµæºãâå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼\n\n \nâXCHGæä»¤ä¼å°è¯äº¤æ¢ä¸¤ä¸ªæä½æ°ï¼å¦ææ³è¦è·å¾ä¸ä¸ªéï¼ä¹å°±æ¯è¯´æä»¬æç®å¨âéå¯¹åºçå¼æ¯0çæåµä¸æéçå¼è®¾ç½®ä¸º1âï¼åæ¶æä»¬è¿å¯ä»¥ç¨0å1æ¥ä»£è¡¨TEST-AND-SETæ¯å¦æåï¼é£ä¹å¯¹ä¸é¢çæ±ç¼ä»£ç ç¿»è¯æé«çº§è¯­è¨å°±åæä¸é¢è¿æ ·ãâå¤§æå¼å§å¨çº¸ä¸ååºäºå¯¹åºäºPostgreSQLçtaså½æ°çä¼ªç ï¼\n\n```\nstatic __inline__ int\ntas(volatile slock_t lock)\n{\n   register slock_res = 1;\n\n   if(*lock != 1)  //CMPæä»¤\n   {\n      //ä¸é¢3è¡æ¯åå­æä½ï¼å¯¹åºXCHG\n       int temp = *lock; \nlock = 1;  //å*lock = res;\nres = temp;\n    }\n   return (int) _res;\n}\n```\n\nå°æå¬å¾äºéé¾éçï¼åªå¥½è¯´ï¼âæè§å¬çæç¹ååï¼â\n\nå¤§æç¬çè¯´ï¼æ²¡å³ç³»çï¼âä½ å¯ä»¥æè¿äºæ¦å¿µè®°ä½ï¼ææ¶é´åæ³ä¸ä¸ï¼å¥½å¥½æ¶åæ¶åãâ\n\nå°æçè¦çè¯´ï¼âå¯æ¯ä½ è¯´çè¿äºé½æ¯ä¾¿ç§çç¥è¯ï¼å®¹ææ¶åä¸è¯åãâ\n\nå¤§æè¯´ï¼âä¸è¦æå¿åï¼èªæéçäºæååå¼å§ï¼æäºTASæä»¬æè½ç»§ç»­å®ç°PostgreSQLçèªæéï¼è®©æä»¬æ¥ççèªæéçå®ç°å§ãâ\n\n**PostgreSQLçèªæé**\n\nå¤§æç»§ç»­è¯´éï¼âå¨æäºCPUæ¶æä¸ï¼PostgreSQLæ²¡æç´æ¥ä½¿ç¨TTASï¼èæ¯åå®ç°äºTASï¼ç¶ååç¨TAS_SPINå½æ°(æèè¯´å®)æ¥å®ç°çèªæéãâ\n\n```\n\t#define TAS_SPIN(lock)  (*(lock) ? 1 : TAS(lock))\n```\n\nâæäºTAS_SPINæä»¬æ¯ä¸æ¯å°±å¾å®¹æå®ç°ä¸ä¸ªèªæéäºå¢ï¼âå¤§æé®éã\n\nå°ææ³äºæ³è¯´ï¼âè®©ææ¥åä¸ä¸ï¼ççè¿æ¬¡è½ä¸è½å®ç°ä¸ä¸ªå¯ç¨çèªæéãâè¯´çå°æå¨çº¸ä¸åäºèµ·æ¥ï¼\n\n```\nvoid spinlock_acquire(int *lock)\n{\n\twhile(TAS_SPIN(lock));\n}\n```\n\nåå®ä¹åï¼å°æåæ¨æ¼äºå éï¼æè§æ²¡ä»ä¹éè¯¯äºï¼äºæ¯å¸æ°çæäºæå¤´ï¼è¯´éï¼âæä¹æ ·ï¼æ¯ä¸æ¯å¾ä½©ææè¿æ ·ç¾è²ä¸æºæ§å¹¶éçäººï¼â\n\nâå¯ï¼è¿ä¸ªèªæéæ¯å¯ç¨çï¼ä¸è¿ç¾è²åæºæ§ä½ é½æ²¡åå°ï¼ä½ åå°äºçéï¼ç²¾ç¥çé¢çææ¤è½¦è¿æ²¡å°ï¼æä»¬è¿ææ¶é´ç»§ç»­è¯´èªæéãâå¤§æè°ä¾éï¼âæä»¬è¿è½ç»§ç»­ä¼åå®ãæ¯å¦éå½çå·æï¼è¿ç§èªæç®çæ¯ä¸æ¾å¼CPUï¼ä½ä¹æ²¡å¿è¦ä¸åçæï¼æä»¬å¯ä»¥ç¨ç©ºæä»¤æ¥éå½çè®©CPUæ­ä¸ä¼ï¼èä¸å¿è¿åº¦æè½¬ï¼æè½¬å¤ªé¢ç¹äºæµªè´¹çµï¼æä»¬ä½¿ç¨nopæä»¤æ¥è¿è¡å·æâï¼è¯´çå¤§æå¨PostgreSQLçæºä»£ç ä¸­æåºäºspin_delayå½æ°ã\n\n```\n\nstatic __inline__ void\nspin_delay(void)\n{\n   __asm__ __volatile__(\n      \" rep; nop       \\n\");\n}\n```\n\nå¤§æç»§ç»­è¯´éï¼âå¦å¤ï¼æä»¬ä¹åºè¯¥å¤çä¸äºç¹æ®çæåµï¼æ¯å¦å°è¯äºå¾å¤æ¬¡TASä¹åä»ç¶æ æ³è·å¾éèµæºï¼é£ä¹å°±è¿å¥sleepï¼ä¹å°±æ¯äº¤åºCPUèµæºï¼éè¦æ³¨æçæ¯ç¡ç çæ¶é´æ¯éæºçï¼ä½ä¸è½è¶åºä¸ä¸çãâ\n\n```\n//ç¬¬ä¸æ¬¡sleepçæ¶é´ï¼sleepçæ¶é´éæ­¥éå¢ï¼ç¬¬ä¸æ¬¡æ¯1000å¾®ç§\nif (status->cur_delay == 0) /* first time to delay? */\n   status->cur_delay = MIN_DELAY_USEC;\n\npg_usleep(status->cur_delay);\n```\n\nâå½ç¶ï¼å¦ææè½¬äºå¾é¿æ¶é´ï¼ä»ç¶æ²¡æåæ³è·å¾éèµæºï¼å°±è¿å¥èªææ¨¡å¼ï¼å ä¸ºæä»¬åè®¾èªæéä¿æ¤çä¸´çåºé½å¾ç­ï¼å¦æå¾é¿æ¶é´è¿è·åä¸å°éèµæºï¼é£ä¹å°±å¯è½åºé®é¢äºãâ\n\n```\nif (++(status->delays) > NUM_DELAYS)\n   s_lock_stuck(status->file, status->line, status->func);\n```\n\nâè¿åºæ¬ä¸å°±æ¯PostgreSQLèªæéçå®ç°äºï¼ä¸è¿è¿éè¦æ³¨ææä»¬åªè°äºX86æ¶æä¸çå®ç°æ¹æ³ï¼å¨ä¸åçCPUæ¶æä¸ï¼TASçå®ç°æ¯ä¸åçï¼æ¯å¦å¨MIPSæ¶æä¸æä¾çæ¯llåscæä»¤ï¼æä»¬è¦åå©è¿ä¸¤ä¸ªæä»¤æ¥å®ç°TASãâ\n\nâæç½äºï¼çæ¥æéè¦å­¦çä¸è¥¿è¿æå¾å¤ãâå°ææ²®ä¸§çè¯´ã\n\nâä¸è¦è¿ä¹æ²è§åï¼ä½ ä¸äºè§£è¿äºç¥è¯ä¸»è¦æ¯å ä¸ºä½ è¿æ²¡æåå å·¥ä½ï¼è¿æ¯å­¦çï¼è¿å¨å­¦ä¹ çé¶æ®µï¼ç­ä½ åå å·¥ä½äºï¼æ¶é´é¿äºï¼ä¹å°±ä¹ æ¯äºãâå¤§æç¬çè¯´ï¼âåæ­£åºå¤äºä¸æï¼å¨æä»¬ç»æä¹åï¼åæ¥è¡¥åä¸ä¸èªæééæ¾çç¥è¯ãâ\n\nâéçéæ¾ï¼ç´æ¥æå¼è®¾ç½®æ0å°±å¯ä»¥äºåãâ\n\nâbingoï¼æ¯çï¼æä¹æ¯è¿ä¹è®¤ä¸ºçï¼ä½æ¯è¿æä¸ä¸ªæ³¨æäºé¡¹ãâ\n\nâä»ä¹æ³¨æäºé¡¹ï¼é¾éè¿è¿æä»ä¹å¹ºè¾å­åï¼âå°ææå¥éã\n\nâæä¸ä¸ªå¾å¤§çå¹ºè¾å­ï¼å°±æ¯ç®åå¾å¤CPUä¸ºäºæé«æ§è¡æçï¼å®ç°äºä¹±åºæ§è¡åè½ï¼å³äºä¹±åºæ§è¡çå·ä½åå®¹æä»¬å°±ä¸å±å¼äºï¼ä»¥åä½ ä¸å¥½æ¶åãä¸è¿éè¦è®°ä½çæ¯ï¼å¦ææéæ¾éåæåªæ¯ç®åè®¾ç½®lockçå¼ï¼ç±äºä¹±åºæ§è¡çä½ç¨ï¼æäºä¸´çåºä¸­çæä»¤å¯è½ä¼å¨lockéæ¾åææ§è¡ï¼è¿å°±ç¸å½äºä¸¤ä¸ªè¿ï¼çº¿ï¼ç¨å±åè¿å¥äºä¸´çåºï¼é£è¯å®ä¼åºé®é¢ï¼æä»¥æä»¬å¯ä»¥éç¨åå­å±éçæ¹å¼æ¥ä¿è¯ééæ¾çæåºæ§ï¼ä½ çï¼PostgreSQLçæäºééæ¾æ¶ç¨çæ¯è¿ç§æ¹å¼ãâè¯´çï¼å¤§æå¨æºä»£ç ä¸­æ åºäºä¸è¡ééæ¾çä»£ç ï¼\n\n```\ndo { __memory_barrier(); *(lock) = 0; } while (0)\n```\n   \nâå¥½å§ï¼æè®°ä¸äºï¼å¿µäºè¿ä¹å¤å¹´çä¹¦ï¼æè§å¾è¿æ¯å¹¼å¿å­éåæãâå°æè¦çè¸è¯´ã\nâæ²¡äºï¼ä¸­åæä»¬å»åç¹å¥½çï¼å¼¥è¡¥ä¸ä¸ä½ åä¼¤çå¿çµï¼æåå¤ä¸ä¸ï¼å±ä»¬é©¬ä¸å°±åºåãâ","source":"_posts/postgresql-lock-spinlock-implement.md","raw":"---\ntitle: PostgreSQLä¸­çé - èªæé\ndate: 2021-02-06 16:18:10\ntags: lock spinlock transaction postgresql\n---\n\nç»è¿ä¸æ¬¡ç{% post_link postgresql-optimizer-outline-10 ããPostgreSQLä¼åå¨ç½è¯ã %}ä¸­å¤§æåçäºå¥å¯¹PostgreSQLä¼åå¨çæ¦è¦çè®²è§£ï¼å°ææå°èªå·±å·²ç»æ·±æ·±çç±ä¸äºæ°æ®åºåæ ¸ï¼å°æå¨GitChatç½ç«ä¸è´­ä¹°äºãPostgreSQLä¼åå¨å¥é¨ãçæå­ç½è¯¾ï¼è¿è·å°å®ä½ä¹¦åºä¹°äºæ¬ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãï¼æ¯å¤©å¯¹ç§çç½è¯¾åä¹¦ä¸çåå®¹ä»ç»ç è¯»PostgreSQLçä¼åå¨çå®ç°ï¼åå¤å¨æ¯ä¸ä¹åå»ä»äºæ°æ®åºåæ ¸å¼åçå·¥ä½ã\n\nä¸è¿ï¼æè¿å¨å­¦æ ¡çæ°æ®åºåçè¯¾ç¨å­¦å°äºå¹¶åæ§å¶çé¨åï¼è¿é¨åå¯¹å°ææ¥è¯´æç¹é¾åº¦ï¼å ä¸ºå°ææ²¡æå¯¹æ°æ®åºçåçè¿è¡è¿å®è·µï¼æ æ³çè§£éçéè¦æ§ï¼äºæ¯å°æåæ¥å°èªå·±çå¥å¥å¤§æå®¶éåå¤§æè¯·æPostgreSQLæ¯å¦ä½å®ç°å¹¶åæ§å¶çã\n<!-- more -->\n\nå¤§æè¯´ï¼âå¹¶åæ§å¶çé¨åæ¯è¾ç¹æï¼æä»¬ä»å¤©ä¸»è¦å³æ³¨PostgreSQLéçå®ç°ï¼ä¸è¿æä»¬åä»æåºå±çé¨åå¼å§ï¼åæ¥çä¸çPostgreSQLæ¯å¦ä½å®ç°ä¸ä¸ªèªæéçï¼ä½ ç¥éèªæéåï¼â\n\nå°ææè§è¿ä¸ªæ¦å¿µå¥½åå¨åªéå¬è¿ï¼ä½åæ²¡ä»ä¹å°è±¡ï¼äºæ¯å°å£°çè¯´ï¼âä¸ç¥éãâ\n\nå¤§æååä¸ç¬ï¼å²è®½éï¼âè¿ä¹è½»æå°±è¯´ä¸ç¥éï¼èªä¿¡ä¸ç¹ï¼å¤§èä¸ç¹ï¼åé®ä½ ä¸éï¼ç¥éä¸ç¥éèªæéï¼ï¼â\n\nå°ææè§åå°äºå¾å¤§çé¼èï¼äºæ¯å¤§å£°çè¯´ï¼âèå­ä¸ç¥éï¼â\n\nâå¯ï¼å¾èªä¿¡åãããæ¥ï¼è®©æç»ä½ è®²è®²ãPostgreSQLçéçæ¦å¿µæå¾å¤ç§ï¼æ¯å¦å¸¸è§çè¡¨éãè¡éãé¡µéãè½»ééãèªæéç­ç­ï¼è¿éé¢æåºå±çæ¯å®ç°æ¯èªæéï¼å®åç¡¬ä»¶ç´æ¥æ¥è§¦ï¼å¹¶ä¸å±è½åç§ä¸åç¡¬ä»¶åæä½ç³»ç»çç»èï¼éå¸¸å©ç¨ç¡¬ä»¶æä¾çåå­æä½æä»¤æ¥å®ç°ãâ\n\nâé£ä¸ºä»ä¹è¦ä½¿ç¨è¿ç§éå¢ï¼â\n\nâèªæéæ¯ä¸ç§äºæ¥éï¼å®éå¸¸æ¯ç¨æ¥ä¿æ¤ä¸´çåºï¼è¿ç§ä¿æ¤çæ¹å¼æ¯ä¸ç§âä¸æ¯ä½ æ­»å°±æ¯ææ´»âçæ¹å¼ï¼æ¯å¦è¯´æéè¿éè·åå°è¿ä¸ªä¸´çåºçè®¿é®æéï¼é£ä¹å¶ä»äººå°±å¿é¡»ç­å¾ï¼é£å®æä¹ç­å¾å¢ï¼â\n\nâæç¥éï¼âå°ææ¢ç­éï¼âå¦æå¹²ç­ççè¯ï¼CPUå°±ä¸è½è¢«ååçå©ç¨ï¼æä»¥æç¥éç³»ç»éæä¸ä¸ªsleepå½æ°è½å¾å¥½çè§£å³è¿ä¸ªé®é¢ï¼å¦ææä»¬ä¸è½è·åå°éï¼é£ä¹æä»¬å¯ä»¥ç¡ä¸ä¼ï¼åæ¥è·åéï¼æå¬è¯´sleepå½æ°å¯ä»¥éæ¾CPUèµæºï¼è¿æ ·å¶ä»è¿ç¨æèçº¿ç¨å°±è½ååçå©ç¨CPUäºï¼è¿æ ·CPUå³è¢«ååçå©ç¨ï¼æä¹è½ä¸åçå¯¹éååºè¯·æ±ï¼å²ä¸æ¯ä¸¤å¨å¶ç¾ãâå°æä¼¸äºä¼¸è¡£è¢ï¼å¯¹å¤§æè¯´ï¼âæ¿ç¬æ¥ï¼è®©æå±ç¤ºä¸ä¸codingçè½åãâ\n\nå¤§æç»ä»æ¾äºçº¸åç¬ï¼è°ä¾éâçä¸å»å¾é«è°åãããâ\n\nâæä¹æ³ä½è°ï¼ä½æ¯å®åä¸åè®¸åï¼âå°æä¸è¾¹è¯´ï¼ä¸è¾¹å¨çº¸ä¸ååºäºèªå·±çèå¾ï¼\n\n```\n\twhile(!spinlock_aquire(&lock))\n\t\tsleep(100);\n```\n\nå¤§ææ¥è¿ç¬å¨å°æåçä»£ç ä¸ç»äºä¸ä¸ªå¤§å¤§çå¯¹å¾ï¼å¯¹å°æçè¡ä¸ºè¡¨ç¤ºè¯å®ï¼ç¶ååç»äºä¸ä¸ªXï¼è§£ééï¼âè½ç¶çä¸å»åçï¼ä½æ¯è¿éå­å¨ä¸ä¸ªé®é¢ï¼ææ¶æä»¬è¦ä¿æ¤çä¸´çåºåªæåºåºå ä¸ªæä»¤ï¼éçææèå®éä¸å æéçæ¶é´æ¯æç­çï¼æ¢å¥è¯è¯´éçè¯·æ±èå®éä¸ä¸ç¨ç­å¤ªé¿æ¶é´å°±è½è·å¾éï¼è¿æ¶åå°±éè¦èèè¿ä¸ªç¡ç æ¯ä¸æ¯åéäºãâ\n\nå°æè¯´ï¼âæä»ä¹ä¸åéçï¼ä¸ç¡ç é¾éä¸ç´å çCPUèµæºä¸æ¾ï¼æµªè´¹CPUèµæºï¼è¿ç®ç´æ¯å çèåXXXåãâ\n\nâå¯¹ï¼å°±æ¯å çèåXXXï¼ä½ è¯´çç¡ç æ¨¡å¼å®éä¸è¿è¡äºCPUä¸ä¸æçåæ¢ï¼ä½è¿ç§åæ¢éè¦éå¸¸å¤çæ¶éå¨æï¼å¦ææä»¬è¦ä¿æ¤çä¸´çåºå¾ç­ï¼è¿ç§åæ¢çä»£ä»·å°±æ¾å¾æç¹å¤§äºï¼æä»¥éæ¾CPUèµæºè¿ä¸å¦å çå¥½ãâ\n\nå°ææ³äºæ³ï¼è¯´ï¼âå¦ï¼é£è¿ç§éæç¹åä¸ä¸ªå°æåéå°äºæ³è¦çç©å·ï¼å®¶é¿ä¸ç»ä¹°çæ¶åçè¡ä¸ºãããâ\n\nå¤§æç¬çè¯´ï¼âæ¯çï¼ä½ å°æ¶åå°±æ¯è¿æ ·ï¼èä¸ï¼ä½ å¨å°ä¸ææ»çæ¶åä»æ¥ä¸ä¼æ¯ï¼ä¸ç´å¤äºæ»å¨çç¶æï¼æä»¥ä½ å¾å°çæ¶åå°±çè§£äºèªæéçæ¬è´¨ï¼å°±æ¯å¿ç­ãâ\n \n\n\n\n**èªæéçä¼ªç **\n\nå°æç»§ç»­è¯´ï¼âè¿æ ·çè¯ï¼èªæéçå®ç°å°±æ¯è¾å®¹æäºï¼ä¹å°±æ¯ä¸sleepåï¼ææ¥æå®ååºæ¥ãâè¯´çå¼å§å¨çº¸ä¸å¼å§åèªæéå®ç°çä¼ªç ï¼å ä¸ºå·²ç»äºè§£äºèªæéçåºæ¬åçï¼æä»¥åä»£ç çè¿ç¨æ¯æä¸ºé¡ºå©çï¼å°æä¸è¾¹åä¸è¾¹ææä½©æèªå·±ï¼é½æ¯ä¹å¹´ä¹å¡æè²ï¼æä¹æå°±è¿ä¹ä¼ç§å¢ï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåã\n\n```\n//è®©æä»¬åè®¾lockåæ°æ¯ä¸ä¸ªçº¿ç¨æè¿ç¨å±äº«åé\nint spinlock_acquire(int *lock)\n{\n    while(*lock != 0)\n        continue;\n    *lock = 1;\n    return *lock;\n}\n\nint spinlock_release(int *lock)\n{\n    *lock = 0;\n}\n```\n\nå¤§æççå°ææ´æ´èªå¾çåçè¿æ®µä»£ç ï¼éè§å°ï¼âä½ è§å¾è¿æ ·å°±è½å®ç°ä¸ä¸ªèªæéåï¼è°¬ç£ãâè¯´çæ¿ç¬å¨å°æåçèªæéä¸ç»äºä¸ä¸ªå¤§å¤§çXï¼ç¶åä¸è¾¹æå¼çµèï¼ä¸è¾¹ç»§ç»­è¯´ï¼âè®©æä»¬ççä½ éå¨åªéãâè¯´çåªåªåªçå¨ç¼è¯å¨éæ²åºäºåå°æåæ ·é»è¾çä»£ç ï¼ç¼è¯ä¹åï¼éè¿ä»£ç è°è¯å·¥å·æ¥çäºspinlock_acquireå½æ°çæ±ç¼ä»£ç ï¼\n\n```\nspinlock1`spinlock_acquire:\n    0x100000f10 <+0>:  pushq  %rbp\n    0x100000f11 <+1>:  movq   %rsp, %rbp\n    0x100000f14 <+4>:  movq   %rdi, -0x8(%rbp)\n    0x100000f18 <+8>:  movq   -0x8(%rbp), %rax\n    0x100000f1c <+12>: cmpl   $0x0, (%rax)\n    0x100000f1f <+15>: je     0x100000f2a \n    0x100000f25 <+21>: jmp    0x100000f18\n    0x100000f2a <+26>: movq   -0x8(%rbp), %rax\n    0x100000f2e <+30>: movl   $0x1, (%rax)\n    0x100000f34 <+36>: movq   -0x8(%rbp), %rax\n    0x100000f38 <+40>: movl   (%rax), %eax\n    0x100000f3a <+42>: popq   %rbp\n    0x100000f3b <+43>: retq\n    0x100000f3c <+44>: nopl   (%rax)\n```\n\nå¤§ææçå±å¹ä¸çæ±ç¼ä»£ç è¯´ï¼âè¿æ®µä»£ç æ¯æ æ³ä½ä¸ºéçå®ç°çï¼å ä¸ºä¸é¢çæä½ç¼ºä¹åå­æ§ï¼æ¯å¦å¯¹lockå¯¹åºçå¼æ¯å¦ä¸º0ï¼*lock != 0ï¼çå¤æ­å°±ä¸æ¯ä¸ä¸ªåå­æä½ï¼å®æ¯éè¿movq   -0x8(%rbp), %raxåcmpl   $0x0, (%rax)ä¸¤ä¸ªæä»¤æ¥å®ç°ãåå¦æä¸¤ä¸ªçº¿ç¨æ¥è·ååä¸ä¸ªéï¼é£ä¹ä¼åçä»ä¹æåµå¢ï¼âè¯´çå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼\n \nâä½ çï¼è¿æ¶åé®é¢å°±åºç°äºï¼çº¿ç¨Aåçº¿ç¨Båæ¶è§å¾å½åçlockä¸­çå¼æ¯0ï¼ä¹å°±æ¯è¯´ä»ä»¬ä¸¤ä¸ªé½è½è·å¾éèµæºï¼ä¹å°±åºç°äºä¸¤ä¸ªçº¿ç¨åæ¶è·å¾éçæåµï¼ä½ è§å¾è¿è¿åçåï¼â\n\nå°æç¾æ§çä½ä¸äºå¤´ï¼æªä¸å¾èªå·±äºåå¤å¹´å°å¤´æ¥ï¼è¿å¨äººæµ·éæµ®æ²ï¼åæ¥æ¯å ä¸ºä¸ææ±ç¼è¯­è¨åã\n\nççå°æç¾æ§çè¡¨æï¼å¤§æè§£ééï¼âCè¯­è¨çä¸æ¡è¯­å¥å¯è½å¯¹åºå æ¡æ±ç¼æä»¤ï¼å¨æ§è¡æé´æ æ³ä¿è¯å®çåå­æ§ï¼æä»¥å¨é«çº§è¯­è¨çå±é¢éè¦åå©ä¸äºç®æ³æèåºå±çæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼å¦ææ³éè¿é«çº§è¯­è¨çç®æ³æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼ä¹ä¸æ¯è¡¥å¯ä»¥ï¼ä½æ¯éè¦ä½¿ç¨ä¸äºæ¯è¾ç²¾å¦çç®æ³ï¼æ¯å¦Petersonç®æ³ï¼ï¼è¿äºæ¹æ³é½æå¾å¤§çå±éæ§ï¼ç°å¨å·²ç»å¾å°ä½¿ç¨è¿äºæ¹æ³äºï¼ä»å¤©æä»¬éè¦å³æ³¨çæ¯ç®åçè®¡ç®æºæä¾çä¸äºç¡¬ä»¶æä»¤ï¼éè¿è¿äºæä»¤ï¼æä»¬å¯ä»¥åå©è¿äºæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ãâ\n\n**TAS VS CAS**\n\n\nå°ææ¯æ¯çé®éï¼âæ¯ä¸æ¯æä»¬å­¦æä½ç³»ç»è¯¾ç¨çæ¶åè¯´çé£äºåå­æä»¤ï¼â\n\nâå¯¹çï¼ç°å¨å¤§é¨åç¡¬ä»¶é½æ¯æä¸¤ç§ç±»åçåå­æä½æä»¤ï¼æ¯å¦TASåCASæä»¤ï¼ä¸é¢æä»¬ç»åºä»ä»¬çä¼ªç ãâè¯´çï¼å¤§ææ¿äºä¸å¼ æ°çç½çº¸ï¼è¾¹åè¾¹è¯´éï¼âTEST-AND-SET ç®ç§°ä¸ºTASï¼å®çæµç¨æ¯ååå­åéåå¥1ï¼ç¶åè¿ååå­åéçåå¼ï¼ä¼ªç æ¯è¿æ ·çãâ\n\n```\nint TAS(int *lock)\n{\n    int temp = *lock;\n    *lock = 1;\n    return *lock;\n}\n```\n\nâCOMPARE-AND-SWAPç®ç§°CASï¼å®çæµç¨æ¯æ¯è¾éä¸­çå¼åææå¼ï¼å¦æéä¸­çå¼åææå¼ç¸åï¼åè®¾ç½®ä¸ºæ°å¼ï¼è¿åtrue,å¦åä¸è®¾ç½®æ°å¼ï¼è¿åfalseï¼å®çä¼ªç æ¯è¿æ ·çãâå¤§æç»§ç»­åéã\n\n```\nint CAS(int *lock, int expect, int new)\n{\n    if(*lock == expect)\n    {\n        *lock = new;\n        return true;\n    }\n    return false;\n}\n```\n\nå¤§ææç¤ºéï¼âæ³¨æï¼ä¸é¢çä¼ªç æ¯åç¨é«çº§è¯­è¨çå½¢å¼æ¥æè¿°è¿ä¸¤ç§ç±»åçæä»¤çå«ä¹ï¼å®éä¸å®æ¯ä¸ä¸ªå®æ´çåå­æä½ï¼å¨X86æ¶æçCPUä¸­ï¼åå«æä¾äºXCHGæä»¤åCMPXCHGæä»¤æ¥å®ç°TASåCASæä½ï¼PostgreSQLå¨X86æ¶æä¸éç¨çæ¯åºäºXCHGæä»¤çTASæ¥å®ç°çèªæéãâ\n\nå°æå´å¥çè¯´ï¼âæå·²ç»è¿«ä¸åå¾çæ³ççPostgreSQLæ¯æä¹ä½¿ç¨TASæä»¤æ¥å®ç°èªæéçäºãâ\n\nå¤§æççå°ææèè¶³è¹çç¥æï¼åäºä¸ä¸ªcalm downçæå¿ï¼ç¶åè¯´ï¼âç¨å®å¿èºï¼ä¸è¦æ¥ï¼åè¿ä¸ä¼ç²¾ç¥çé¢çææ¤è½¦å°±å°äºãå¨è¿ä¹åæä»¬åæ¥è°ä¸ä¸TTASãâ\n\nâTTASï¼æè§åæ¯TEST AND TEST-AND-SETï¼â\n\nâæ¯çï¼TASè½ç¶å·²ç»è¶³å¤æä»¬ä½¿ç¨ï¼ä½æ¯ä¹å¸¦æ¥ä¸ä¸ªé®é¢ï¼å¤§é¨åCPUå®ç°TASçæ¹æ³æ¯éä½æ»çº¿ï¼ä¸æ¦éä½æ»çº¿å°±ç­äºä¸ä¸ªCPUå ç¨äºæ´ä¸ªæ»çº¿ï¼èé¢ç¹çéä½æ»çº¿ä¼éä½CPUçä½¿ç¨æçï¼æä»¥å¨è¿å¥TASä¹åï¼æä»¬å¯ä»¥ååä¸ä¸ªç²ç¥çæ£æµï¼è¿ä¸ªæ£æµä¸å¨åå­æä½ä¹ä¸­ï¼ä½æ¯å®å¯ä»¥è®©æä»¬å¿«éçç¥éç®åéçç¶æï¼å¦æç¬¬ä¸ä¸ªTESTæ£æµå°éå·²ç»è¢«å ç¨äºï¼é£ä¹æä»¬å°±åç­ä¸ä¼ï¼å°±ä¸ç¨è¿è¡TASäºï¼è¿æ ·å°±é¿åäºéä½æ»çº¿ï¼å¦æç¬¬ä¸ä¸ªTESTåç°éæ²¡æè¢«å ç¨ï¼é£ä¹å°±å¼å¾å»åTASãâ\n\nå°æè¯´ï¼âä½å¨ç¬¬ä¸ä¸ªTESTåTEST-AND-SETä¹é´ï¼éçç¶æå¯è½ä¼è¢«å¶ä»CPUä¸çè¿ç¨ä¿®æ¹æå§ï¼â\n\nâæ¯çï¼æä»¥è¿ä¸ªTESTåªæ¯æä»¬æé«æ§è½çä¸ä¸ªææ®µãæ¯å¦å¨PostgreSQLæ°æ®åºä¸­ï¼å®å°±æ¯éç¨çTTASçæ¹æ³ãâè¯´çï¼å¤§ææå¼äºPostgreSQLæºä»£ç ï¼æ¾å°äºTASå®ç°çé¨åï¼\n\n```\nstatic __inline__ int\ntas(volatile slock_t *lock)\n{\n   register slock_t _res = 1;\n\n   __asm__ __volatile__(\n      \"  cmpb   $0,%1  \\n\"\n      \"  jne       1f    \\n\"\n      \"  lock         \\n\"\n      \"  xchgb  %0,%1  \\n\"\n      \"1: \\n\"\n:     \"+q\"(_res), \"+m\"(*lock)\n:\n:     \"memory\", \"cc\");\n   return (int) _res;\n}\n```\n\nå¤§æä¸è¾¹ç¨é¼ æ å¨ç¼è¯å¨éåä½äºtaså½æ°ï¼ä¸è¾¹è¯´ï¼âä»è¿æ®µæ±ç¼ä»£ç å¯ä»¥çåºï¼CMPæä»¤åä¸é¢çXCHGä¸è½ç»æä¸ä¸ªåå­æä½ï¼æ¯å¦ä¸ä¸ªçº¿ç¨Bå·²ç»ææäºéï¼çº¿ç¨AåäºCMPæä»¤ä¹åç°äºæå¶ä»çº¿ç¨å·²ç»å æäºéèµæºï¼äºæ¯ä»å°±ä¼JNEè·³è¿XCHGæä»¤ï¼ä½æ¯å¾å¯è½å¨CMPæä»¤ä¹åï¼çº¿ç¨Bå°±ç«å³éæ¾äºéèµæºãâå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼\n\n \nâXCHGæä»¤ä¼å°è¯äº¤æ¢ä¸¤ä¸ªæä½æ°ï¼å¦ææ³è¦è·å¾ä¸ä¸ªéï¼ä¹å°±æ¯è¯´æä»¬æç®å¨âéå¯¹åºçå¼æ¯0çæåµä¸æéçå¼è®¾ç½®ä¸º1âï¼åæ¶æä»¬è¿å¯ä»¥ç¨0å1æ¥ä»£è¡¨TEST-AND-SETæ¯å¦æåï¼é£ä¹å¯¹ä¸é¢çæ±ç¼ä»£ç ç¿»è¯æé«çº§è¯­è¨å°±åæä¸é¢è¿æ ·ãâå¤§æå¼å§å¨çº¸ä¸ååºäºå¯¹åºäºPostgreSQLçtaså½æ°çä¼ªç ï¼\n\n```\nstatic __inline__ int\ntas(volatile slock_t lock)\n{\n   register slock_res = 1;\n\n   if(*lock != 1)  //CMPæä»¤\n   {\n      //ä¸é¢3è¡æ¯åå­æä½ï¼å¯¹åºXCHG\n       int temp = *lock; \nlock = 1;  //å*lock = res;\nres = temp;\n    }\n   return (int) _res;\n}\n```\n\nå°æå¬å¾äºéé¾éçï¼åªå¥½è¯´ï¼âæè§å¬çæç¹ååï¼â\n\nå¤§æç¬çè¯´ï¼æ²¡å³ç³»çï¼âä½ å¯ä»¥æè¿äºæ¦å¿µè®°ä½ï¼ææ¶é´åæ³ä¸ä¸ï¼å¥½å¥½æ¶åæ¶åãâ\n\nå°æçè¦çè¯´ï¼âå¯æ¯ä½ è¯´çè¿äºé½æ¯ä¾¿ç§çç¥è¯ï¼å®¹ææ¶åä¸è¯åãâ\n\nå¤§æè¯´ï¼âä¸è¦æå¿åï¼èªæéçäºæååå¼å§ï¼æäºTASæä»¬æè½ç»§ç»­å®ç°PostgreSQLçèªæéï¼è®©æä»¬æ¥ççèªæéçå®ç°å§ãâ\n\n**PostgreSQLçèªæé**\n\nå¤§æç»§ç»­è¯´éï¼âå¨æäºCPUæ¶æä¸ï¼PostgreSQLæ²¡æç´æ¥ä½¿ç¨TTASï¼èæ¯åå®ç°äºTASï¼ç¶ååç¨TAS_SPINå½æ°(æèè¯´å®)æ¥å®ç°çèªæéãâ\n\n```\n\t#define TAS_SPIN(lock)  (*(lock) ? 1 : TAS(lock))\n```\n\nâæäºTAS_SPINæä»¬æ¯ä¸æ¯å°±å¾å®¹æå®ç°ä¸ä¸ªèªæéäºå¢ï¼âå¤§æé®éã\n\nå°ææ³äºæ³è¯´ï¼âè®©ææ¥åä¸ä¸ï¼ççè¿æ¬¡è½ä¸è½å®ç°ä¸ä¸ªå¯ç¨çèªæéãâè¯´çå°æå¨çº¸ä¸åäºèµ·æ¥ï¼\n\n```\nvoid spinlock_acquire(int *lock)\n{\n\twhile(TAS_SPIN(lock));\n}\n```\n\nåå®ä¹åï¼å°æåæ¨æ¼äºå éï¼æè§æ²¡ä»ä¹éè¯¯äºï¼äºæ¯å¸æ°çæäºæå¤´ï¼è¯´éï¼âæä¹æ ·ï¼æ¯ä¸æ¯å¾ä½©ææè¿æ ·ç¾è²ä¸æºæ§å¹¶éçäººï¼â\n\nâå¯ï¼è¿ä¸ªèªæéæ¯å¯ç¨çï¼ä¸è¿ç¾è²åæºæ§ä½ é½æ²¡åå°ï¼ä½ åå°äºçéï¼ç²¾ç¥çé¢çææ¤è½¦è¿æ²¡å°ï¼æä»¬è¿ææ¶é´ç»§ç»­è¯´èªæéãâå¤§æè°ä¾éï¼âæä»¬è¿è½ç»§ç»­ä¼åå®ãæ¯å¦éå½çå·æï¼è¿ç§èªæç®çæ¯ä¸æ¾å¼CPUï¼ä½ä¹æ²¡å¿è¦ä¸åçæï¼æä»¬å¯ä»¥ç¨ç©ºæä»¤æ¥éå½çè®©CPUæ­ä¸ä¼ï¼èä¸å¿è¿åº¦æè½¬ï¼æè½¬å¤ªé¢ç¹äºæµªè´¹çµï¼æä»¬ä½¿ç¨nopæä»¤æ¥è¿è¡å·æâï¼è¯´çå¤§æå¨PostgreSQLçæºä»£ç ä¸­æåºäºspin_delayå½æ°ã\n\n```\n\nstatic __inline__ void\nspin_delay(void)\n{\n   __asm__ __volatile__(\n      \" rep; nop       \\n\");\n}\n```\n\nå¤§æç»§ç»­è¯´éï¼âå¦å¤ï¼æä»¬ä¹åºè¯¥å¤çä¸äºç¹æ®çæåµï¼æ¯å¦å°è¯äºå¾å¤æ¬¡TASä¹åä»ç¶æ æ³è·å¾éèµæºï¼é£ä¹å°±è¿å¥sleepï¼ä¹å°±æ¯äº¤åºCPUèµæºï¼éè¦æ³¨æçæ¯ç¡ç çæ¶é´æ¯éæºçï¼ä½ä¸è½è¶åºä¸ä¸çãâ\n\n```\n//ç¬¬ä¸æ¬¡sleepçæ¶é´ï¼sleepçæ¶é´éæ­¥éå¢ï¼ç¬¬ä¸æ¬¡æ¯1000å¾®ç§\nif (status->cur_delay == 0) /* first time to delay? */\n   status->cur_delay = MIN_DELAY_USEC;\n\npg_usleep(status->cur_delay);\n```\n\nâå½ç¶ï¼å¦ææè½¬äºå¾é¿æ¶é´ï¼ä»ç¶æ²¡æåæ³è·å¾éèµæºï¼å°±è¿å¥èªææ¨¡å¼ï¼å ä¸ºæä»¬åè®¾èªæéä¿æ¤çä¸´çåºé½å¾ç­ï¼å¦æå¾é¿æ¶é´è¿è·åä¸å°éèµæºï¼é£ä¹å°±å¯è½åºé®é¢äºãâ\n\n```\nif (++(status->delays) > NUM_DELAYS)\n   s_lock_stuck(status->file, status->line, status->func);\n```\n\nâè¿åºæ¬ä¸å°±æ¯PostgreSQLèªæéçå®ç°äºï¼ä¸è¿è¿éè¦æ³¨ææä»¬åªè°äºX86æ¶æä¸çå®ç°æ¹æ³ï¼å¨ä¸åçCPUæ¶æä¸ï¼TASçå®ç°æ¯ä¸åçï¼æ¯å¦å¨MIPSæ¶æä¸æä¾çæ¯llåscæä»¤ï¼æä»¬è¦åå©è¿ä¸¤ä¸ªæä»¤æ¥å®ç°TASãâ\n\nâæç½äºï¼çæ¥æéè¦å­¦çä¸è¥¿è¿æå¾å¤ãâå°ææ²®ä¸§çè¯´ã\n\nâä¸è¦è¿ä¹æ²è§åï¼ä½ ä¸äºè§£è¿äºç¥è¯ä¸»è¦æ¯å ä¸ºä½ è¿æ²¡æåå å·¥ä½ï¼è¿æ¯å­¦çï¼è¿å¨å­¦ä¹ çé¶æ®µï¼ç­ä½ åå å·¥ä½äºï¼æ¶é´é¿äºï¼ä¹å°±ä¹ æ¯äºãâå¤§æç¬çè¯´ï¼âåæ­£åºå¤äºä¸æï¼å¨æä»¬ç»æä¹åï¼åæ¥è¡¥åä¸ä¸èªæééæ¾çç¥è¯ãâ\n\nâéçéæ¾ï¼ç´æ¥æå¼è®¾ç½®æ0å°±å¯ä»¥äºåãâ\n\nâbingoï¼æ¯çï¼æä¹æ¯è¿ä¹è®¤ä¸ºçï¼ä½æ¯è¿æä¸ä¸ªæ³¨æäºé¡¹ãâ\n\nâä»ä¹æ³¨æäºé¡¹ï¼é¾éè¿è¿æä»ä¹å¹ºè¾å­åï¼âå°ææå¥éã\n\nâæä¸ä¸ªå¾å¤§çå¹ºè¾å­ï¼å°±æ¯ç®åå¾å¤CPUä¸ºäºæé«æ§è¡æçï¼å®ç°äºä¹±åºæ§è¡åè½ï¼å³äºä¹±åºæ§è¡çå·ä½åå®¹æä»¬å°±ä¸å±å¼äºï¼ä»¥åä½ ä¸å¥½æ¶åãä¸è¿éè¦è®°ä½çæ¯ï¼å¦ææéæ¾éåæåªæ¯ç®åè®¾ç½®lockçå¼ï¼ç±äºä¹±åºæ§è¡çä½ç¨ï¼æäºä¸´çåºä¸­çæä»¤å¯è½ä¼å¨lockéæ¾åææ§è¡ï¼è¿å°±ç¸å½äºä¸¤ä¸ªè¿ï¼çº¿ï¼ç¨å±åè¿å¥äºä¸´çåºï¼é£è¯å®ä¼åºé®é¢ï¼æä»¥æä»¬å¯ä»¥éç¨åå­å±éçæ¹å¼æ¥ä¿è¯ééæ¾çæåºæ§ï¼ä½ çï¼PostgreSQLçæäºééæ¾æ¶ç¨çæ¯è¿ç§æ¹å¼ãâè¯´çï¼å¤§æå¨æºä»£ç ä¸­æ åºäºä¸è¡ééæ¾çä»£ç ï¼\n\n```\ndo { __memory_barrier(); *(lock) = 0; } while (0)\n```\n   \nâå¥½å§ï¼æè®°ä¸äºï¼å¿µäºè¿ä¹å¤å¹´çä¹¦ï¼æè§å¾è¿æ¯å¹¼å¿å­éåæãâå°æè¦çè¸è¯´ã\nâæ²¡äºï¼ä¸­åæä»¬å»åç¹å¥½çï¼å¼¥è¡¥ä¸ä¸ä½ åä¼¤çå¿çµï¼æåå¤ä¸ä¸ï¼å±ä»¬é©¬ä¸å°±åºåãâ","slug":"postgresql-lock-spinlock-implement","published":1,"updated":"2021-02-06T08:25:47.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckktgdw790000nj9k0mucc72m","content":"<p>ç»è¿ä¸æ¬¡ç<a href=\"/2020/10/03/postgresql-optimizer-outline-10/\" title=\"ããPostgreSQLä¼åå¨ç½è¯ã\">ããPostgreSQLä¼åå¨ç½è¯ã</a>ä¸­å¤§æåçäºå¥å¯¹PostgreSQLä¼åå¨çæ¦è¦çè®²è§£ï¼å°ææå°èªå·±å·²ç»æ·±æ·±çç±ä¸äºæ°æ®åºåæ ¸ï¼å°æå¨GitChatç½ç«ä¸è´­ä¹°äºãPostgreSQLä¼åå¨å¥é¨ãçæå­ç½è¯¾ï¼è¿è·å°å®ä½ä¹¦åºä¹°äºæ¬ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãï¼æ¯å¤©å¯¹ç§çç½è¯¾åä¹¦ä¸çåå®¹ä»ç»ç è¯»PostgreSQLçä¼åå¨çå®ç°ï¼åå¤å¨æ¯ä¸ä¹åå»ä»äºæ°æ®åºåæ ¸å¼åçå·¥ä½ã</p>\n<p>ä¸è¿ï¼æè¿å¨å­¦æ ¡çæ°æ®åºåçè¯¾ç¨å­¦å°äºå¹¶åæ§å¶çé¨åï¼è¿é¨åå¯¹å°ææ¥è¯´æç¹é¾åº¦ï¼å ä¸ºå°ææ²¡æå¯¹æ°æ®åºçåçè¿è¡è¿å®è·µï¼æ æ³çè§£éçéè¦æ§ï¼äºæ¯å°æåæ¥å°èªå·±çå¥å¥å¤§æå®¶éåå¤§æè¯·æPostgreSQLæ¯å¦ä½å®ç°å¹¶åæ§å¶çã</p>\n<a id=\"more\"></a>\n\n<p>å¤§æè¯´ï¼âå¹¶åæ§å¶çé¨åæ¯è¾ç¹æï¼æä»¬ä»å¤©ä¸»è¦å³æ³¨PostgreSQLéçå®ç°ï¼ä¸è¿æä»¬åä»æåºå±çé¨åå¼å§ï¼åæ¥çä¸çPostgreSQLæ¯å¦ä½å®ç°ä¸ä¸ªèªæéçï¼ä½ ç¥éèªæéåï¼â</p>\n<p>å°ææè§è¿ä¸ªæ¦å¿µå¥½åå¨åªéå¬è¿ï¼ä½åæ²¡ä»ä¹å°è±¡ï¼äºæ¯å°å£°çè¯´ï¼âä¸ç¥éãâ</p>\n<p>å¤§æååä¸ç¬ï¼å²è®½éï¼âè¿ä¹è½»æå°±è¯´ä¸ç¥éï¼èªä¿¡ä¸ç¹ï¼å¤§èä¸ç¹ï¼åé®ä½ ä¸éï¼ç¥éä¸ç¥éèªæéï¼ï¼â</p>\n<p>å°ææè§åå°äºå¾å¤§çé¼èï¼äºæ¯å¤§å£°çè¯´ï¼âèå­ä¸ç¥éï¼â</p>\n<p>âå¯ï¼å¾èªä¿¡åãããæ¥ï¼è®©æç»ä½ è®²è®²ãPostgreSQLçéçæ¦å¿µæå¾å¤ç§ï¼æ¯å¦å¸¸è§çè¡¨éãè¡éãé¡µéãè½»ééãèªæéç­ç­ï¼è¿éé¢æåºå±çæ¯å®ç°æ¯èªæéï¼å®åç¡¬ä»¶ç´æ¥æ¥è§¦ï¼å¹¶ä¸å±è½åç§ä¸åç¡¬ä»¶åæä½ç³»ç»çç»èï¼éå¸¸å©ç¨ç¡¬ä»¶æä¾çåå­æä½æä»¤æ¥å®ç°ãâ</p>\n<p>âé£ä¸ºä»ä¹è¦ä½¿ç¨è¿ç§éå¢ï¼â</p>\n<p>âèªæéæ¯ä¸ç§äºæ¥éï¼å®éå¸¸æ¯ç¨æ¥ä¿æ¤ä¸´çåºï¼è¿ç§ä¿æ¤çæ¹å¼æ¯ä¸ç§âä¸æ¯ä½ æ­»å°±æ¯ææ´»âçæ¹å¼ï¼æ¯å¦è¯´æéè¿éè·åå°è¿ä¸ªä¸´çåºçè®¿é®æéï¼é£ä¹å¶ä»äººå°±å¿é¡»ç­å¾ï¼é£å®æä¹ç­å¾å¢ï¼â</p>\n<p>âæç¥éï¼âå°ææ¢ç­éï¼âå¦æå¹²ç­ççè¯ï¼CPUå°±ä¸è½è¢«ååçå©ç¨ï¼æä»¥æç¥éç³»ç»éæä¸ä¸ªsleepå½æ°è½å¾å¥½çè§£å³è¿ä¸ªé®é¢ï¼å¦ææä»¬ä¸è½è·åå°éï¼é£ä¹æä»¬å¯ä»¥ç¡ä¸ä¼ï¼åæ¥è·åéï¼æå¬è¯´sleepå½æ°å¯ä»¥éæ¾CPUèµæºï¼è¿æ ·å¶ä»è¿ç¨æèçº¿ç¨å°±è½ååçå©ç¨CPUäºï¼è¿æ ·CPUå³è¢«ååçå©ç¨ï¼æä¹è½ä¸åçå¯¹éååºè¯·æ±ï¼å²ä¸æ¯ä¸¤å¨å¶ç¾ãâå°æä¼¸äºä¼¸è¡£è¢ï¼å¯¹å¤§æè¯´ï¼âæ¿ç¬æ¥ï¼è®©æå±ç¤ºä¸ä¸codingçè½åãâ</p>\n<p>å¤§æç»ä»æ¾äºçº¸åç¬ï¼è°ä¾éâçä¸å»å¾é«è°åãããâ</p>\n<p>âæä¹æ³ä½è°ï¼ä½æ¯å®åä¸åè®¸åï¼âå°æä¸è¾¹è¯´ï¼ä¸è¾¹å¨çº¸ä¸ååºäºèªå·±çèå¾ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while(!spinlock_aquire(&amp;lock))</span><br><span class=\"line\">    sleep(100);</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææ¥è¿ç¬å¨å°æåçä»£ç ä¸ç»äºä¸ä¸ªå¤§å¤§çå¯¹å¾ï¼å¯¹å°æçè¡ä¸ºè¡¨ç¤ºè¯å®ï¼ç¶ååç»äºä¸ä¸ªXï¼è§£ééï¼âè½ç¶çä¸å»åçï¼ä½æ¯è¿éå­å¨ä¸ä¸ªé®é¢ï¼ææ¶æä»¬è¦ä¿æ¤çä¸´çåºåªæåºåºå ä¸ªæä»¤ï¼éçææèå®éä¸å æéçæ¶é´æ¯æç­çï¼æ¢å¥è¯è¯´éçè¯·æ±èå®éä¸ä¸ç¨ç­å¤ªé¿æ¶é´å°±è½è·å¾éï¼è¿æ¶åå°±éè¦èèè¿ä¸ªç¡ç æ¯ä¸æ¯åéäºãâ</p>\n<p>å°æè¯´ï¼âæä»ä¹ä¸åéçï¼ä¸ç¡ç é¾éä¸ç´å çCPUèµæºä¸æ¾ï¼æµªè´¹CPUèµæºï¼è¿ç®ç´æ¯å çèåXXXåãâ</p>\n<p>âå¯¹ï¼å°±æ¯å çèåXXXï¼ä½ è¯´çç¡ç æ¨¡å¼å®éä¸è¿è¡äºCPUä¸ä¸æçåæ¢ï¼ä½è¿ç§åæ¢éè¦éå¸¸å¤çæ¶éå¨æï¼å¦ææä»¬è¦ä¿æ¤çä¸´çåºå¾ç­ï¼è¿ç§åæ¢çä»£ä»·å°±æ¾å¾æç¹å¤§äºï¼æä»¥éæ¾CPUèµæºè¿ä¸å¦å çå¥½ãâ</p>\n<p>å°ææ³äºæ³ï¼è¯´ï¼âå¦ï¼é£è¿ç§éæç¹åä¸ä¸ªå°æåéå°äºæ³è¦çç©å·ï¼å®¶é¿ä¸ç»ä¹°çæ¶åçè¡ä¸ºãããâ</p>\n<p>å¤§æç¬çè¯´ï¼âæ¯çï¼ä½ å°æ¶åå°±æ¯è¿æ ·ï¼èä¸ï¼ä½ å¨å°ä¸ææ»çæ¶åä»æ¥ä¸ä¼æ¯ï¼ä¸ç´å¤äºæ»å¨çç¶æï¼æä»¥ä½ å¾å°çæ¶åå°±çè§£äºèªæéçæ¬è´¨ï¼å°±æ¯å¿ç­ãâ</p>\n<p><strong>èªæéçä¼ªç </strong></p>\n<p>å°æç»§ç»­è¯´ï¼âè¿æ ·çè¯ï¼èªæéçå®ç°å°±æ¯è¾å®¹æäºï¼ä¹å°±æ¯ä¸sleepåï¼ææ¥æå®ååºæ¥ãâè¯´çå¼å§å¨çº¸ä¸å¼å§åèªæéå®ç°çä¼ªç ï¼å ä¸ºå·²ç»äºè§£äºèªæéçåºæ¬åçï¼æä»¥åä»£ç çè¿ç¨æ¯æä¸ºé¡ºå©çï¼å°æä¸è¾¹åä¸è¾¹ææä½©æèªå·±ï¼é½æ¯ä¹å¹´ä¹å¡æè²ï¼æä¹æå°±è¿ä¹ä¼ç§å¢ï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;è®©æä»¬åè®¾lockåæ°æ¯ä¸ä¸ªçº¿ç¨æè¿ç¨å±äº«åé</span><br><span class=\"line\">int spinlock_acquire(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    while(*lock !&#x3D; 0)</span><br><span class=\"line\">        continue;</span><br><span class=\"line\">    *lock &#x3D; 1;</span><br><span class=\"line\">    return *lock;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int spinlock_release(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    *lock &#x3D; 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æççå°ææ´æ´èªå¾çåçè¿æ®µä»£ç ï¼éè§å°ï¼âä½ è§å¾è¿æ ·å°±è½å®ç°ä¸ä¸ªèªæéåï¼è°¬ç£ãâè¯´çæ¿ç¬å¨å°æåçèªæéä¸ç»äºä¸ä¸ªå¤§å¤§çXï¼ç¶åä¸è¾¹æå¼çµèï¼ä¸è¾¹ç»§ç»­è¯´ï¼âè®©æä»¬ççä½ éå¨åªéãâè¯´çåªåªåªçå¨ç¼è¯å¨éæ²åºäºåå°æåæ ·é»è¾çä»£ç ï¼ç¼è¯ä¹åï¼éè¿ä»£ç è°è¯å·¥å·æ¥çäºspinlock_acquireå½æ°çæ±ç¼ä»£ç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spinlock1&#96;spinlock_acquire:</span><br><span class=\"line\">    0x100000f10 &lt;+0&gt;:  pushq  %rbp</span><br><span class=\"line\">    0x100000f11 &lt;+1&gt;:  movq   %rsp, %rbp</span><br><span class=\"line\">    0x100000f14 &lt;+4&gt;:  movq   %rdi, -0x8(%rbp)</span><br><span class=\"line\">    0x100000f18 &lt;+8&gt;:  movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f1c &lt;+12&gt;: cmpl   $0x0, (%rax)</span><br><span class=\"line\">    0x100000f1f &lt;+15&gt;: je     0x100000f2a </span><br><span class=\"line\">    0x100000f25 &lt;+21&gt;: jmp    0x100000f18</span><br><span class=\"line\">    0x100000f2a &lt;+26&gt;: movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f2e &lt;+30&gt;: movl   $0x1, (%rax)</span><br><span class=\"line\">    0x100000f34 &lt;+36&gt;: movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f38 &lt;+40&gt;: movl   (%rax), %eax</span><br><span class=\"line\">    0x100000f3a &lt;+42&gt;: popq   %rbp</span><br><span class=\"line\">    0x100000f3b &lt;+43&gt;: retq</span><br><span class=\"line\">    0x100000f3c &lt;+44&gt;: nopl   (%rax)</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææçå±å¹ä¸çæ±ç¼ä»£ç è¯´ï¼âè¿æ®µä»£ç æ¯æ æ³ä½ä¸ºéçå®ç°çï¼å ä¸ºä¸é¢çæä½ç¼ºä¹åå­æ§ï¼æ¯å¦å¯¹lockå¯¹åºçå¼æ¯å¦ä¸º0ï¼*lock != 0ï¼çå¤æ­å°±ä¸æ¯ä¸ä¸ªåå­æä½ï¼å®æ¯éè¿movq   -0x8(%rbp), %raxåcmpl   $0x0, (%rax)ä¸¤ä¸ªæä»¤æ¥å®ç°ãåå¦æä¸¤ä¸ªçº¿ç¨æ¥è·ååä¸ä¸ªéï¼é£ä¹ä¼åçä»ä¹æåµå¢ï¼âè¯´çå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼</p>\n<p>âä½ çï¼è¿æ¶åé®é¢å°±åºç°äºï¼çº¿ç¨Aåçº¿ç¨Båæ¶è§å¾å½åçlockä¸­çå¼æ¯0ï¼ä¹å°±æ¯è¯´ä»ä»¬ä¸¤ä¸ªé½è½è·å¾éèµæºï¼ä¹å°±åºç°äºä¸¤ä¸ªçº¿ç¨åæ¶è·å¾éçæåµï¼ä½ è§å¾è¿è¿åçåï¼â</p>\n<p>å°æç¾æ§çä½ä¸äºå¤´ï¼æªä¸å¾èªå·±äºåå¤å¹´å°å¤´æ¥ï¼è¿å¨äººæµ·éæµ®æ²ï¼åæ¥æ¯å ä¸ºä¸ææ±ç¼è¯­è¨åã</p>\n<p>ççå°æç¾æ§çè¡¨æï¼å¤§æè§£ééï¼âCè¯­è¨çä¸æ¡è¯­å¥å¯è½å¯¹åºå æ¡æ±ç¼æä»¤ï¼å¨æ§è¡æé´æ æ³ä¿è¯å®çåå­æ§ï¼æä»¥å¨é«çº§è¯­è¨çå±é¢éè¦åå©ä¸äºç®æ³æèåºå±çæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼å¦ææ³éè¿é«çº§è¯­è¨çç®æ³æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼ä¹ä¸æ¯è¡¥å¯ä»¥ï¼ä½æ¯éè¦ä½¿ç¨ä¸äºæ¯è¾ç²¾å¦çç®æ³ï¼æ¯å¦Petersonç®æ³ï¼ï¼è¿äºæ¹æ³é½æå¾å¤§çå±éæ§ï¼ç°å¨å·²ç»å¾å°ä½¿ç¨è¿äºæ¹æ³äºï¼ä»å¤©æä»¬éè¦å³æ³¨çæ¯ç®åçè®¡ç®æºæä¾çä¸äºç¡¬ä»¶æä»¤ï¼éè¿è¿äºæä»¤ï¼æä»¬å¯ä»¥åå©è¿äºæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ãâ</p>\n<p><strong>TAS VS CAS</strong></p>\n<p>å°ææ¯æ¯çé®éï¼âæ¯ä¸æ¯æä»¬å­¦æä½ç³»ç»è¯¾ç¨çæ¶åè¯´çé£äºåå­æä»¤ï¼â</p>\n<p>âå¯¹çï¼ç°å¨å¤§é¨åç¡¬ä»¶é½æ¯æä¸¤ç§ç±»åçåå­æä½æä»¤ï¼æ¯å¦TASåCASæä»¤ï¼ä¸é¢æä»¬ç»åºä»ä»¬çä¼ªç ãâè¯´çï¼å¤§ææ¿äºä¸å¼ æ°çç½çº¸ï¼è¾¹åè¾¹è¯´éï¼âTEST-AND-SET ç®ç§°ä¸ºTASï¼å®çæµç¨æ¯ååå­åéåå¥1ï¼ç¶åè¿ååå­åéçåå¼ï¼ä¼ªç æ¯è¿æ ·çãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int TAS(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    int temp &#x3D; *lock;</span><br><span class=\"line\">    *lock &#x3D; 1;</span><br><span class=\"line\">    return *lock;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>âCOMPARE-AND-SWAPç®ç§°CASï¼å®çæµç¨æ¯æ¯è¾éä¸­çå¼åææå¼ï¼å¦æéä¸­çå¼åææå¼ç¸åï¼åè®¾ç½®ä¸ºæ°å¼ï¼è¿åtrue,å¦åä¸è®¾ç½®æ°å¼ï¼è¿åfalseï¼å®çä¼ªç æ¯è¿æ ·çãâå¤§æç»§ç»­åéã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int CAS(int *lock, int expect, int new)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    if(*lock &#x3D;&#x3D; expect)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        *lock &#x3D; new;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return false;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææç¤ºéï¼âæ³¨æï¼ä¸é¢çä¼ªç æ¯åç¨é«çº§è¯­è¨çå½¢å¼æ¥æè¿°è¿ä¸¤ç§ç±»åçæä»¤çå«ä¹ï¼å®éä¸å®æ¯ä¸ä¸ªå®æ´çåå­æä½ï¼å¨X86æ¶æçCPUä¸­ï¼åå«æä¾äºXCHGæä»¤åCMPXCHGæä»¤æ¥å®ç°TASåCASæä½ï¼PostgreSQLå¨X86æ¶æä¸éç¨çæ¯åºäºXCHGæä»¤çTASæ¥å®ç°çèªæéãâ</p>\n<p>å°æå´å¥çè¯´ï¼âæå·²ç»è¿«ä¸åå¾çæ³ççPostgreSQLæ¯æä¹ä½¿ç¨TASæä»¤æ¥å®ç°èªæéçäºãâ</p>\n<p>å¤§æççå°ææèè¶³è¹çç¥æï¼åäºä¸ä¸ªcalm downçæå¿ï¼ç¶åè¯´ï¼âç¨å®å¿èºï¼ä¸è¦æ¥ï¼åè¿ä¸ä¼ç²¾ç¥çé¢çææ¤è½¦å°±å°äºãå¨è¿ä¹åæä»¬åæ¥è°ä¸ä¸TTASãâ</p>\n<p>âTTASï¼æè§åæ¯TEST AND TEST-AND-SETï¼â</p>\n<p>âæ¯çï¼TASè½ç¶å·²ç»è¶³å¤æä»¬ä½¿ç¨ï¼ä½æ¯ä¹å¸¦æ¥ä¸ä¸ªé®é¢ï¼å¤§é¨åCPUå®ç°TASçæ¹æ³æ¯éä½æ»çº¿ï¼ä¸æ¦éä½æ»çº¿å°±ç­äºä¸ä¸ªCPUå ç¨äºæ´ä¸ªæ»çº¿ï¼èé¢ç¹çéä½æ»çº¿ä¼éä½CPUçä½¿ç¨æçï¼æä»¥å¨è¿å¥TASä¹åï¼æä»¬å¯ä»¥ååä¸ä¸ªç²ç¥çæ£æµï¼è¿ä¸ªæ£æµä¸å¨åå­æä½ä¹ä¸­ï¼ä½æ¯å®å¯ä»¥è®©æä»¬å¿«éçç¥éç®åéçç¶æï¼å¦æç¬¬ä¸ä¸ªTESTæ£æµå°éå·²ç»è¢«å ç¨äºï¼é£ä¹æä»¬å°±åç­ä¸ä¼ï¼å°±ä¸ç¨è¿è¡TASäºï¼è¿æ ·å°±é¿åäºéä½æ»çº¿ï¼å¦æç¬¬ä¸ä¸ªTESTåç°éæ²¡æè¢«å ç¨ï¼é£ä¹å°±å¼å¾å»åTASãâ</p>\n<p>å°æè¯´ï¼âä½å¨ç¬¬ä¸ä¸ªTESTåTEST-AND-SETä¹é´ï¼éçç¶æå¯è½ä¼è¢«å¶ä»CPUä¸çè¿ç¨ä¿®æ¹æå§ï¼â</p>\n<p>âæ¯çï¼æä»¥è¿ä¸ªTESTåªæ¯æä»¬æé«æ§è½çä¸ä¸ªææ®µãæ¯å¦å¨PostgreSQLæ°æ®åºä¸­ï¼å®å°±æ¯éç¨çTTASçæ¹æ³ãâè¯´çï¼å¤§ææå¼äºPostgreSQLæºä»£ç ï¼æ¾å°äºTASå®ç°çé¨åï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static __inline__ int</span><br><span class=\"line\">tas(volatile slock_t *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   register slock_t _res &#x3D; 1;</span><br><span class=\"line\"></span><br><span class=\"line\">   __asm__ __volatile__(</span><br><span class=\"line\">      &quot;  cmpb   $0,%1  \\n&quot;</span><br><span class=\"line\">      &quot;  jne       1f    \\n&quot;</span><br><span class=\"line\">      &quot;  lock         \\n&quot;</span><br><span class=\"line\">      &quot;  xchgb  %0,%1  \\n&quot;</span><br><span class=\"line\">      &quot;1: \\n&quot;</span><br><span class=\"line\">:     &quot;+q&quot;(_res), &quot;+m&quot;(*lock)</span><br><span class=\"line\">:</span><br><span class=\"line\">:     &quot;memory&quot;, &quot;cc&quot;);</span><br><span class=\"line\">   return (int) _res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æä¸è¾¹ç¨é¼ æ å¨ç¼è¯å¨éåä½äºtaså½æ°ï¼ä¸è¾¹è¯´ï¼âä»è¿æ®µæ±ç¼ä»£ç å¯ä»¥çåºï¼CMPæä»¤åä¸é¢çXCHGä¸è½ç»æä¸ä¸ªåå­æä½ï¼æ¯å¦ä¸ä¸ªçº¿ç¨Bå·²ç»ææäºéï¼çº¿ç¨AåäºCMPæä»¤ä¹åç°äºæå¶ä»çº¿ç¨å·²ç»å æäºéèµæºï¼äºæ¯ä»å°±ä¼JNEè·³è¿XCHGæä»¤ï¼ä½æ¯å¾å¯è½å¨CMPæä»¤ä¹åï¼çº¿ç¨Bå°±ç«å³éæ¾äºéèµæºãâå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼</p>\n<p>âXCHGæä»¤ä¼å°è¯äº¤æ¢ä¸¤ä¸ªæä½æ°ï¼å¦ææ³è¦è·å¾ä¸ä¸ªéï¼ä¹å°±æ¯è¯´æä»¬æç®å¨âéå¯¹åºçå¼æ¯0çæåµä¸æéçå¼è®¾ç½®ä¸º1âï¼åæ¶æä»¬è¿å¯ä»¥ç¨0å1æ¥ä»£è¡¨TEST-AND-SETæ¯å¦æåï¼é£ä¹å¯¹ä¸é¢çæ±ç¼ä»£ç ç¿»è¯æé«çº§è¯­è¨å°±åæä¸é¢è¿æ ·ãâå¤§æå¼å§å¨çº¸ä¸ååºäºå¯¹åºäºPostgreSQLçtaså½æ°çä¼ªç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static __inline__ int</span><br><span class=\"line\">tas(volatile slock_t lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   register slock_res &#x3D; 1;</span><br><span class=\"line\"></span><br><span class=\"line\">   if(*lock !&#x3D; 1)  &#x2F;&#x2F;CMPæä»¤</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">      &#x2F;&#x2F;ä¸é¢3è¡æ¯åå­æä½ï¼å¯¹åºXCHG</span><br><span class=\"line\">       int temp &#x3D; *lock; </span><br><span class=\"line\">lock &#x3D; 1;  &#x2F;&#x2F;å*lock &#x3D; res;</span><br><span class=\"line\">res &#x3D; temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">   return (int) _res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å°æå¬å¾äºéé¾éçï¼åªå¥½è¯´ï¼âæè§å¬çæç¹ååï¼â</p>\n<p>å¤§æç¬çè¯´ï¼æ²¡å³ç³»çï¼âä½ å¯ä»¥æè¿äºæ¦å¿µè®°ä½ï¼ææ¶é´åæ³ä¸ä¸ï¼å¥½å¥½æ¶åæ¶åãâ</p>\n<p>å°æçè¦çè¯´ï¼âå¯æ¯ä½ è¯´çè¿äºé½æ¯ä¾¿ç§çç¥è¯ï¼å®¹ææ¶åä¸è¯åãâ</p>\n<p>å¤§æè¯´ï¼âä¸è¦æå¿åï¼èªæéçäºæååå¼å§ï¼æäºTASæä»¬æè½ç»§ç»­å®ç°PostgreSQLçèªæéï¼è®©æä»¬æ¥ççèªæéçå®ç°å§ãâ</p>\n<p><strong>PostgreSQLçèªæé</strong></p>\n<p>å¤§æç»§ç»­è¯´éï¼âå¨æäºCPUæ¶æä¸ï¼PostgreSQLæ²¡æç´æ¥ä½¿ç¨TTASï¼èæ¯åå®ç°äºTASï¼ç¶ååç¨TAS_SPINå½æ°(æèè¯´å®)æ¥å®ç°çèªæéãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#define TAS_SPIN(lock)  (*(lock) ? 1 : TAS(lock))</span><br></pre></td></tr></table></figure>\n\n<p>âæäºTAS_SPINæä»¬æ¯ä¸æ¯å°±å¾å®¹æå®ç°ä¸ä¸ªèªæéäºå¢ï¼âå¤§æé®éã</p>\n<p>å°ææ³äºæ³è¯´ï¼âè®©ææ¥åä¸ä¸ï¼ççè¿æ¬¡è½ä¸è½å®ç°ä¸ä¸ªå¯ç¨çèªæéãâè¯´çå°æå¨çº¸ä¸åäºèµ·æ¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void spinlock_acquire(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    while(TAS_SPIN(lock));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åå®ä¹åï¼å°æåæ¨æ¼äºå éï¼æè§æ²¡ä»ä¹éè¯¯äºï¼äºæ¯å¸æ°çæäºæå¤´ï¼è¯´éï¼âæä¹æ ·ï¼æ¯ä¸æ¯å¾ä½©ææè¿æ ·ç¾è²ä¸æºæ§å¹¶éçäººï¼â</p>\n<p>âå¯ï¼è¿ä¸ªèªæéæ¯å¯ç¨çï¼ä¸è¿ç¾è²åæºæ§ä½ é½æ²¡åå°ï¼ä½ åå°äºçéï¼ç²¾ç¥çé¢çææ¤è½¦è¿æ²¡å°ï¼æä»¬è¿ææ¶é´ç»§ç»­è¯´èªæéãâå¤§æè°ä¾éï¼âæä»¬è¿è½ç»§ç»­ä¼åå®ãæ¯å¦éå½çå·æï¼è¿ç§èªæç®çæ¯ä¸æ¾å¼CPUï¼ä½ä¹æ²¡å¿è¦ä¸åçæï¼æä»¬å¯ä»¥ç¨ç©ºæä»¤æ¥éå½çè®©CPUæ­ä¸ä¼ï¼èä¸å¿è¿åº¦æè½¬ï¼æè½¬å¤ªé¢ç¹äºæµªè´¹çµï¼æä»¬ä½¿ç¨nopæä»¤æ¥è¿è¡å·æâï¼è¯´çå¤§æå¨PostgreSQLçæºä»£ç ä¸­æåºäºspin_delayå½æ°ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">static __inline__ void</span><br><span class=\"line\">spin_delay(void)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   __asm__ __volatile__(</span><br><span class=\"line\">      &quot; rep; nop       \\n&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æç»§ç»­è¯´éï¼âå¦å¤ï¼æä»¬ä¹åºè¯¥å¤çä¸äºç¹æ®çæåµï¼æ¯å¦å°è¯äºå¾å¤æ¬¡TASä¹åä»ç¶æ æ³è·å¾éèµæºï¼é£ä¹å°±è¿å¥sleepï¼ä¹å°±æ¯äº¤åºCPUèµæºï¼éè¦æ³¨æçæ¯ç¡ç çæ¶é´æ¯éæºçï¼ä½ä¸è½è¶åºä¸ä¸çãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;ç¬¬ä¸æ¬¡sleepçæ¶é´ï¼sleepçæ¶é´éæ­¥éå¢ï¼ç¬¬ä¸æ¬¡æ¯1000å¾®ç§</span><br><span class=\"line\">if (status-&gt;cur_delay &#x3D;&#x3D; 0) &#x2F;* first time to delay? *&#x2F;</span><br><span class=\"line\">   status-&gt;cur_delay &#x3D; MIN_DELAY_USEC;</span><br><span class=\"line\"></span><br><span class=\"line\">pg_usleep(status-&gt;cur_delay);</span><br></pre></td></tr></table></figure>\n\n<p>âå½ç¶ï¼å¦ææè½¬äºå¾é¿æ¶é´ï¼ä»ç¶æ²¡æåæ³è·å¾éèµæºï¼å°±è¿å¥èªææ¨¡å¼ï¼å ä¸ºæä»¬åè®¾èªæéä¿æ¤çä¸´çåºé½å¾ç­ï¼å¦æå¾é¿æ¶é´è¿è·åä¸å°éèµæºï¼é£ä¹å°±å¯è½åºé®é¢äºãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (++(status-&gt;delays) &gt; NUM_DELAYS)</span><br><span class=\"line\">   s_lock_stuck(status-&gt;file, status-&gt;line, status-&gt;func);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿åºæ¬ä¸å°±æ¯PostgreSQLèªæéçå®ç°äºï¼ä¸è¿è¿éè¦æ³¨ææä»¬åªè°äºX86æ¶æä¸çå®ç°æ¹æ³ï¼å¨ä¸åçCPUæ¶æä¸ï¼TASçå®ç°æ¯ä¸åçï¼æ¯å¦å¨MIPSæ¶æä¸æä¾çæ¯llåscæä»¤ï¼æä»¬è¦åå©è¿ä¸¤ä¸ªæä»¤æ¥å®ç°TASãâ</p>\n<p>âæç½äºï¼çæ¥æéè¦å­¦çä¸è¥¿è¿æå¾å¤ãâå°ææ²®ä¸§çè¯´ã</p>\n<p>âä¸è¦è¿ä¹æ²è§åï¼ä½ ä¸äºè§£è¿äºç¥è¯ä¸»è¦æ¯å ä¸ºä½ è¿æ²¡æåå å·¥ä½ï¼è¿æ¯å­¦çï¼è¿å¨å­¦ä¹ çé¶æ®µï¼ç­ä½ åå å·¥ä½äºï¼æ¶é´é¿äºï¼ä¹å°±ä¹ æ¯äºãâå¤§æç¬çè¯´ï¼âåæ­£åºå¤äºä¸æï¼å¨æä»¬ç»æä¹åï¼åæ¥è¡¥åä¸ä¸èªæééæ¾çç¥è¯ãâ</p>\n<p>âéçéæ¾ï¼ç´æ¥æå¼è®¾ç½®æ0å°±å¯ä»¥äºåãâ</p>\n<p>âbingoï¼æ¯çï¼æä¹æ¯è¿ä¹è®¤ä¸ºçï¼ä½æ¯è¿æä¸ä¸ªæ³¨æäºé¡¹ãâ</p>\n<p>âä»ä¹æ³¨æäºé¡¹ï¼é¾éè¿è¿æä»ä¹å¹ºè¾å­åï¼âå°ææå¥éã</p>\n<p>âæä¸ä¸ªå¾å¤§çå¹ºè¾å­ï¼å°±æ¯ç®åå¾å¤CPUä¸ºäºæé«æ§è¡æçï¼å®ç°äºä¹±åºæ§è¡åè½ï¼å³äºä¹±åºæ§è¡çå·ä½åå®¹æä»¬å°±ä¸å±å¼äºï¼ä»¥åä½ ä¸å¥½æ¶åãä¸è¿éè¦è®°ä½çæ¯ï¼å¦ææéæ¾éåæåªæ¯ç®åè®¾ç½®lockçå¼ï¼ç±äºä¹±åºæ§è¡çä½ç¨ï¼æäºä¸´çåºä¸­çæä»¤å¯è½ä¼å¨lockéæ¾åææ§è¡ï¼è¿å°±ç¸å½äºä¸¤ä¸ªè¿ï¼çº¿ï¼ç¨å±åè¿å¥äºä¸´çåºï¼é£è¯å®ä¼åºé®é¢ï¼æä»¥æä»¬å¯ä»¥éç¨åå­å±éçæ¹å¼æ¥ä¿è¯ééæ¾çæåºæ§ï¼ä½ çï¼PostgreSQLçæäºééæ¾æ¶ç¨çæ¯è¿ç§æ¹å¼ãâè¯´çï¼å¤§æå¨æºä»£ç ä¸­æ åºäºä¸è¡ééæ¾çä»£ç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">do &#123; __memory_barrier(); *(lock) &#x3D; 0; &#125; while (0)</span><br></pre></td></tr></table></figure>\n\n<p>âå¥½å§ï¼æè®°ä¸äºï¼å¿µäºè¿ä¹å¤å¹´çä¹¦ï¼æè§å¾è¿æ¯å¹¼å¿å­éåæãâå°æè¦çè¸è¯´ã<br>âæ²¡äºï¼ä¸­åæä»¬å»åç¹å¥½çï¼å¼¥è¡¥ä¸ä¸ä½ åä¼¤çå¿çµï¼æåå¤ä¸ä¸ï¼å±ä»¬é©¬ä¸å°±åºåãâ</p>\n","site":{"data":{}},"excerpt":"<p>ç»è¿ä¸æ¬¡ç<a href=\"/2020/10/03/postgresql-optimizer-outline-10/\" title=\"ããPostgreSQLä¼åå¨ç½è¯ã\">ããPostgreSQLä¼åå¨ç½è¯ã</a>ä¸­å¤§æåçäºå¥å¯¹PostgreSQLä¼åå¨çæ¦è¦çè®²è§£ï¼å°ææå°èªå·±å·²ç»æ·±æ·±çç±ä¸äºæ°æ®åºåæ ¸ï¼å°æå¨GitChatç½ç«ä¸è´­ä¹°äºãPostgreSQLä¼åå¨å¥é¨ãçæå­ç½è¯¾ï¼è¿è·å°å®ä½ä¹¦åºä¹°äºæ¬ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãï¼æ¯å¤©å¯¹ç§çç½è¯¾åä¹¦ä¸çåå®¹ä»ç»ç è¯»PostgreSQLçä¼åå¨çå®ç°ï¼åå¤å¨æ¯ä¸ä¹åå»ä»äºæ°æ®åºåæ ¸å¼åçå·¥ä½ã</p>\n<p>ä¸è¿ï¼æè¿å¨å­¦æ ¡çæ°æ®åºåçè¯¾ç¨å­¦å°äºå¹¶åæ§å¶çé¨åï¼è¿é¨åå¯¹å°ææ¥è¯´æç¹é¾åº¦ï¼å ä¸ºå°ææ²¡æå¯¹æ°æ®åºçåçè¿è¡è¿å®è·µï¼æ æ³çè§£éçéè¦æ§ï¼äºæ¯å°æåæ¥å°èªå·±çå¥å¥å¤§æå®¶éåå¤§æè¯·æPostgreSQLæ¯å¦ä½å®ç°å¹¶åæ§å¶çã</p>","more":"<p>å¤§æè¯´ï¼âå¹¶åæ§å¶çé¨åæ¯è¾ç¹æï¼æä»¬ä»å¤©ä¸»è¦å³æ³¨PostgreSQLéçå®ç°ï¼ä¸è¿æä»¬åä»æåºå±çé¨åå¼å§ï¼åæ¥çä¸çPostgreSQLæ¯å¦ä½å®ç°ä¸ä¸ªèªæéçï¼ä½ ç¥éèªæéåï¼â</p>\n<p>å°ææè§è¿ä¸ªæ¦å¿µå¥½åå¨åªéå¬è¿ï¼ä½åæ²¡ä»ä¹å°è±¡ï¼äºæ¯å°å£°çè¯´ï¼âä¸ç¥éãâ</p>\n<p>å¤§æååä¸ç¬ï¼å²è®½éï¼âè¿ä¹è½»æå°±è¯´ä¸ç¥éï¼èªä¿¡ä¸ç¹ï¼å¤§èä¸ç¹ï¼åé®ä½ ä¸éï¼ç¥éä¸ç¥éèªæéï¼ï¼â</p>\n<p>å°ææè§åå°äºå¾å¤§çé¼èï¼äºæ¯å¤§å£°çè¯´ï¼âèå­ä¸ç¥éï¼â</p>\n<p>âå¯ï¼å¾èªä¿¡åãããæ¥ï¼è®©æç»ä½ è®²è®²ãPostgreSQLçéçæ¦å¿µæå¾å¤ç§ï¼æ¯å¦å¸¸è§çè¡¨éãè¡éãé¡µéãè½»ééãèªæéç­ç­ï¼è¿éé¢æåºå±çæ¯å®ç°æ¯èªæéï¼å®åç¡¬ä»¶ç´æ¥æ¥è§¦ï¼å¹¶ä¸å±è½åç§ä¸åç¡¬ä»¶åæä½ç³»ç»çç»èï¼éå¸¸å©ç¨ç¡¬ä»¶æä¾çåå­æä½æä»¤æ¥å®ç°ãâ</p>\n<p>âé£ä¸ºä»ä¹è¦ä½¿ç¨è¿ç§éå¢ï¼â</p>\n<p>âèªæéæ¯ä¸ç§äºæ¥éï¼å®éå¸¸æ¯ç¨æ¥ä¿æ¤ä¸´çåºï¼è¿ç§ä¿æ¤çæ¹å¼æ¯ä¸ç§âä¸æ¯ä½ æ­»å°±æ¯ææ´»âçæ¹å¼ï¼æ¯å¦è¯´æéè¿éè·åå°è¿ä¸ªä¸´çåºçè®¿é®æéï¼é£ä¹å¶ä»äººå°±å¿é¡»ç­å¾ï¼é£å®æä¹ç­å¾å¢ï¼â</p>\n<p>âæç¥éï¼âå°ææ¢ç­éï¼âå¦æå¹²ç­ççè¯ï¼CPUå°±ä¸è½è¢«ååçå©ç¨ï¼æä»¥æç¥éç³»ç»éæä¸ä¸ªsleepå½æ°è½å¾å¥½çè§£å³è¿ä¸ªé®é¢ï¼å¦ææä»¬ä¸è½è·åå°éï¼é£ä¹æä»¬å¯ä»¥ç¡ä¸ä¼ï¼åæ¥è·åéï¼æå¬è¯´sleepå½æ°å¯ä»¥éæ¾CPUèµæºï¼è¿æ ·å¶ä»è¿ç¨æèçº¿ç¨å°±è½ååçå©ç¨CPUäºï¼è¿æ ·CPUå³è¢«ååçå©ç¨ï¼æä¹è½ä¸åçå¯¹éååºè¯·æ±ï¼å²ä¸æ¯ä¸¤å¨å¶ç¾ãâå°æä¼¸äºä¼¸è¡£è¢ï¼å¯¹å¤§æè¯´ï¼âæ¿ç¬æ¥ï¼è®©æå±ç¤ºä¸ä¸codingçè½åãâ</p>\n<p>å¤§æç»ä»æ¾äºçº¸åç¬ï¼è°ä¾éâçä¸å»å¾é«è°åãããâ</p>\n<p>âæä¹æ³ä½è°ï¼ä½æ¯å®åä¸åè®¸åï¼âå°æä¸è¾¹è¯´ï¼ä¸è¾¹å¨çº¸ä¸ååºäºèªå·±çèå¾ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while(!spinlock_aquire(&amp;lock))</span><br><span class=\"line\">    sleep(100);</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææ¥è¿ç¬å¨å°æåçä»£ç ä¸ç»äºä¸ä¸ªå¤§å¤§çå¯¹å¾ï¼å¯¹å°æçè¡ä¸ºè¡¨ç¤ºè¯å®ï¼ç¶ååç»äºä¸ä¸ªXï¼è§£ééï¼âè½ç¶çä¸å»åçï¼ä½æ¯è¿éå­å¨ä¸ä¸ªé®é¢ï¼ææ¶æä»¬è¦ä¿æ¤çä¸´çåºåªæåºåºå ä¸ªæä»¤ï¼éçææèå®éä¸å æéçæ¶é´æ¯æç­çï¼æ¢å¥è¯è¯´éçè¯·æ±èå®éä¸ä¸ç¨ç­å¤ªé¿æ¶é´å°±è½è·å¾éï¼è¿æ¶åå°±éè¦èèè¿ä¸ªç¡ç æ¯ä¸æ¯åéäºãâ</p>\n<p>å°æè¯´ï¼âæä»ä¹ä¸åéçï¼ä¸ç¡ç é¾éä¸ç´å çCPUèµæºä¸æ¾ï¼æµªè´¹CPUèµæºï¼è¿ç®ç´æ¯å çèåXXXåãâ</p>\n<p>âå¯¹ï¼å°±æ¯å çèåXXXï¼ä½ è¯´çç¡ç æ¨¡å¼å®éä¸è¿è¡äºCPUä¸ä¸æçåæ¢ï¼ä½è¿ç§åæ¢éè¦éå¸¸å¤çæ¶éå¨æï¼å¦ææä»¬è¦ä¿æ¤çä¸´çåºå¾ç­ï¼è¿ç§åæ¢çä»£ä»·å°±æ¾å¾æç¹å¤§äºï¼æä»¥éæ¾CPUèµæºè¿ä¸å¦å çå¥½ãâ</p>\n<p>å°ææ³äºæ³ï¼è¯´ï¼âå¦ï¼é£è¿ç§éæç¹åä¸ä¸ªå°æåéå°äºæ³è¦çç©å·ï¼å®¶é¿ä¸ç»ä¹°çæ¶åçè¡ä¸ºãããâ</p>\n<p>å¤§æç¬çè¯´ï¼âæ¯çï¼ä½ å°æ¶åå°±æ¯è¿æ ·ï¼èä¸ï¼ä½ å¨å°ä¸ææ»çæ¶åä»æ¥ä¸ä¼æ¯ï¼ä¸ç´å¤äºæ»å¨çç¶æï¼æä»¥ä½ å¾å°çæ¶åå°±çè§£äºèªæéçæ¬è´¨ï¼å°±æ¯å¿ç­ãâ</p>\n<p><strong>èªæéçä¼ªç </strong></p>\n<p>å°æç»§ç»­è¯´ï¼âè¿æ ·çè¯ï¼èªæéçå®ç°å°±æ¯è¾å®¹æäºï¼ä¹å°±æ¯ä¸sleepåï¼ææ¥æå®ååºæ¥ãâè¯´çå¼å§å¨çº¸ä¸å¼å§åèªæéå®ç°çä¼ªç ï¼å ä¸ºå·²ç»äºè§£äºèªæéçåºæ¬åçï¼æä»¥åä»£ç çè¿ç¨æ¯æä¸ºé¡ºå©çï¼å°æä¸è¾¹åä¸è¾¹ææä½©æèªå·±ï¼é½æ¯ä¹å¹´ä¹å¡æè²ï¼æä¹æå°±è¿ä¹ä¼ç§å¢ï¼åæè¿æ ·ä¼ç§çäººï¼æ¬è¯¥ç¿çè¿ä¸çåã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;è®©æä»¬åè®¾lockåæ°æ¯ä¸ä¸ªçº¿ç¨æè¿ç¨å±äº«åé</span><br><span class=\"line\">int spinlock_acquire(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    while(*lock !&#x3D; 0)</span><br><span class=\"line\">        continue;</span><br><span class=\"line\">    *lock &#x3D; 1;</span><br><span class=\"line\">    return *lock;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">int spinlock_release(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    *lock &#x3D; 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æççå°ææ´æ´èªå¾çåçè¿æ®µä»£ç ï¼éè§å°ï¼âä½ è§å¾è¿æ ·å°±è½å®ç°ä¸ä¸ªèªæéåï¼è°¬ç£ãâè¯´çæ¿ç¬å¨å°æåçèªæéä¸ç»äºä¸ä¸ªå¤§å¤§çXï¼ç¶åä¸è¾¹æå¼çµèï¼ä¸è¾¹ç»§ç»­è¯´ï¼âè®©æä»¬ççä½ éå¨åªéãâè¯´çåªåªåªçå¨ç¼è¯å¨éæ²åºäºåå°æåæ ·é»è¾çä»£ç ï¼ç¼è¯ä¹åï¼éè¿ä»£ç è°è¯å·¥å·æ¥çäºspinlock_acquireå½æ°çæ±ç¼ä»£ç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spinlock1&#96;spinlock_acquire:</span><br><span class=\"line\">    0x100000f10 &lt;+0&gt;:  pushq  %rbp</span><br><span class=\"line\">    0x100000f11 &lt;+1&gt;:  movq   %rsp, %rbp</span><br><span class=\"line\">    0x100000f14 &lt;+4&gt;:  movq   %rdi, -0x8(%rbp)</span><br><span class=\"line\">    0x100000f18 &lt;+8&gt;:  movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f1c &lt;+12&gt;: cmpl   $0x0, (%rax)</span><br><span class=\"line\">    0x100000f1f &lt;+15&gt;: je     0x100000f2a </span><br><span class=\"line\">    0x100000f25 &lt;+21&gt;: jmp    0x100000f18</span><br><span class=\"line\">    0x100000f2a &lt;+26&gt;: movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f2e &lt;+30&gt;: movl   $0x1, (%rax)</span><br><span class=\"line\">    0x100000f34 &lt;+36&gt;: movq   -0x8(%rbp), %rax</span><br><span class=\"line\">    0x100000f38 &lt;+40&gt;: movl   (%rax), %eax</span><br><span class=\"line\">    0x100000f3a &lt;+42&gt;: popq   %rbp</span><br><span class=\"line\">    0x100000f3b &lt;+43&gt;: retq</span><br><span class=\"line\">    0x100000f3c &lt;+44&gt;: nopl   (%rax)</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææçå±å¹ä¸çæ±ç¼ä»£ç è¯´ï¼âè¿æ®µä»£ç æ¯æ æ³ä½ä¸ºéçå®ç°çï¼å ä¸ºä¸é¢çæä½ç¼ºä¹åå­æ§ï¼æ¯å¦å¯¹lockå¯¹åºçå¼æ¯å¦ä¸º0ï¼*lock != 0ï¼çå¤æ­å°±ä¸æ¯ä¸ä¸ªåå­æä½ï¼å®æ¯éè¿movq   -0x8(%rbp), %raxåcmpl   $0x0, (%rax)ä¸¤ä¸ªæä»¤æ¥å®ç°ãåå¦æä¸¤ä¸ªçº¿ç¨æ¥è·ååä¸ä¸ªéï¼é£ä¹ä¼åçä»ä¹æåµå¢ï¼âè¯´çå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼</p>\n<p>âä½ çï¼è¿æ¶åé®é¢å°±åºç°äºï¼çº¿ç¨Aåçº¿ç¨Båæ¶è§å¾å½åçlockä¸­çå¼æ¯0ï¼ä¹å°±æ¯è¯´ä»ä»¬ä¸¤ä¸ªé½è½è·å¾éèµæºï¼ä¹å°±åºç°äºä¸¤ä¸ªçº¿ç¨åæ¶è·å¾éçæåµï¼ä½ è§å¾è¿è¿åçåï¼â</p>\n<p>å°æç¾æ§çä½ä¸äºå¤´ï¼æªä¸å¾èªå·±äºåå¤å¹´å°å¤´æ¥ï¼è¿å¨äººæµ·éæµ®æ²ï¼åæ¥æ¯å ä¸ºä¸ææ±ç¼è¯­è¨åã</p>\n<p>ççå°æç¾æ§çè¡¨æï¼å¤§æè§£ééï¼âCè¯­è¨çä¸æ¡è¯­å¥å¯è½å¯¹åºå æ¡æ±ç¼æä»¤ï¼å¨æ§è¡æé´æ æ³ä¿è¯å®çåå­æ§ï¼æä»¥å¨é«çº§è¯­è¨çå±é¢éè¦åå©ä¸äºç®æ³æèåºå±çæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼å¦ææ³éè¿é«çº§è¯­è¨çç®æ³æ¥å®ç°ä¸´çåºçåæ­¥åè½ï¼ä¹ä¸æ¯è¡¥å¯ä»¥ï¼ä½æ¯éè¦ä½¿ç¨ä¸äºæ¯è¾ç²¾å¦çç®æ³ï¼æ¯å¦Petersonç®æ³ï¼ï¼è¿äºæ¹æ³é½æå¾å¤§çå±éæ§ï¼ç°å¨å·²ç»å¾å°ä½¿ç¨è¿äºæ¹æ³äºï¼ä»å¤©æä»¬éè¦å³æ³¨çæ¯ç®åçè®¡ç®æºæä¾çä¸äºç¡¬ä»¶æä»¤ï¼éè¿è¿äºæä»¤ï¼æä»¬å¯ä»¥åå©è¿äºæä»¤æ¥å®ç°ä¸´çåºçåæ­¥åè½ãâ</p>\n<p><strong>TAS VS CAS</strong></p>\n<p>å°ææ¯æ¯çé®éï¼âæ¯ä¸æ¯æä»¬å­¦æä½ç³»ç»è¯¾ç¨çæ¶åè¯´çé£äºåå­æä»¤ï¼â</p>\n<p>âå¯¹çï¼ç°å¨å¤§é¨åç¡¬ä»¶é½æ¯æä¸¤ç§ç±»åçåå­æä½æä»¤ï¼æ¯å¦TASåCASæä»¤ï¼ä¸é¢æä»¬ç»åºä»ä»¬çä¼ªç ãâè¯´çï¼å¤§ææ¿äºä¸å¼ æ°çç½çº¸ï¼è¾¹åè¾¹è¯´éï¼âTEST-AND-SET ç®ç§°ä¸ºTASï¼å®çæµç¨æ¯ååå­åéåå¥1ï¼ç¶åè¿ååå­åéçåå¼ï¼ä¼ªç æ¯è¿æ ·çãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int TAS(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    int temp &#x3D; *lock;</span><br><span class=\"line\">    *lock &#x3D; 1;</span><br><span class=\"line\">    return *lock;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>âCOMPARE-AND-SWAPç®ç§°CASï¼å®çæµç¨æ¯æ¯è¾éä¸­çå¼åææå¼ï¼å¦æéä¸­çå¼åææå¼ç¸åï¼åè®¾ç½®ä¸ºæ°å¼ï¼è¿åtrue,å¦åä¸è®¾ç½®æ°å¼ï¼è¿åfalseï¼å®çä¼ªç æ¯è¿æ ·çãâå¤§æç»§ç»­åéã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int CAS(int *lock, int expect, int new)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    if(*lock &#x3D;&#x3D; expect)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        *lock &#x3D; new;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return false;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§ææç¤ºéï¼âæ³¨æï¼ä¸é¢çä¼ªç æ¯åç¨é«çº§è¯­è¨çå½¢å¼æ¥æè¿°è¿ä¸¤ç§ç±»åçæä»¤çå«ä¹ï¼å®éä¸å®æ¯ä¸ä¸ªå®æ´çåå­æä½ï¼å¨X86æ¶æçCPUä¸­ï¼åå«æä¾äºXCHGæä»¤åCMPXCHGæä»¤æ¥å®ç°TASåCASæä½ï¼PostgreSQLå¨X86æ¶æä¸éç¨çæ¯åºäºXCHGæä»¤çTASæ¥å®ç°çèªæéãâ</p>\n<p>å°æå´å¥çè¯´ï¼âæå·²ç»è¿«ä¸åå¾çæ³ççPostgreSQLæ¯æä¹ä½¿ç¨TASæä»¤æ¥å®ç°èªæéçäºãâ</p>\n<p>å¤§æççå°ææèè¶³è¹çç¥æï¼åäºä¸ä¸ªcalm downçæå¿ï¼ç¶åè¯´ï¼âç¨å®å¿èºï¼ä¸è¦æ¥ï¼åè¿ä¸ä¼ç²¾ç¥çé¢çææ¤è½¦å°±å°äºãå¨è¿ä¹åæä»¬åæ¥è°ä¸ä¸TTASãâ</p>\n<p>âTTASï¼æè§åæ¯TEST AND TEST-AND-SETï¼â</p>\n<p>âæ¯çï¼TASè½ç¶å·²ç»è¶³å¤æä»¬ä½¿ç¨ï¼ä½æ¯ä¹å¸¦æ¥ä¸ä¸ªé®é¢ï¼å¤§é¨åCPUå®ç°TASçæ¹æ³æ¯éä½æ»çº¿ï¼ä¸æ¦éä½æ»çº¿å°±ç­äºä¸ä¸ªCPUå ç¨äºæ´ä¸ªæ»çº¿ï¼èé¢ç¹çéä½æ»çº¿ä¼éä½CPUçä½¿ç¨æçï¼æä»¥å¨è¿å¥TASä¹åï¼æä»¬å¯ä»¥ååä¸ä¸ªç²ç¥çæ£æµï¼è¿ä¸ªæ£æµä¸å¨åå­æä½ä¹ä¸­ï¼ä½æ¯å®å¯ä»¥è®©æä»¬å¿«éçç¥éç®åéçç¶æï¼å¦æç¬¬ä¸ä¸ªTESTæ£æµå°éå·²ç»è¢«å ç¨äºï¼é£ä¹æä»¬å°±åç­ä¸ä¼ï¼å°±ä¸ç¨è¿è¡TASäºï¼è¿æ ·å°±é¿åäºéä½æ»çº¿ï¼å¦æç¬¬ä¸ä¸ªTESTåç°éæ²¡æè¢«å ç¨ï¼é£ä¹å°±å¼å¾å»åTASãâ</p>\n<p>å°æè¯´ï¼âä½å¨ç¬¬ä¸ä¸ªTESTåTEST-AND-SETä¹é´ï¼éçç¶æå¯è½ä¼è¢«å¶ä»CPUä¸çè¿ç¨ä¿®æ¹æå§ï¼â</p>\n<p>âæ¯çï¼æä»¥è¿ä¸ªTESTåªæ¯æä»¬æé«æ§è½çä¸ä¸ªææ®µãæ¯å¦å¨PostgreSQLæ°æ®åºä¸­ï¼å®å°±æ¯éç¨çTTASçæ¹æ³ãâè¯´çï¼å¤§ææå¼äºPostgreSQLæºä»£ç ï¼æ¾å°äºTASå®ç°çé¨åï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static __inline__ int</span><br><span class=\"line\">tas(volatile slock_t *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   register slock_t _res &#x3D; 1;</span><br><span class=\"line\"></span><br><span class=\"line\">   __asm__ __volatile__(</span><br><span class=\"line\">      &quot;  cmpb   $0,%1  \\n&quot;</span><br><span class=\"line\">      &quot;  jne       1f    \\n&quot;</span><br><span class=\"line\">      &quot;  lock         \\n&quot;</span><br><span class=\"line\">      &quot;  xchgb  %0,%1  \\n&quot;</span><br><span class=\"line\">      &quot;1: \\n&quot;</span><br><span class=\"line\">:     &quot;+q&quot;(_res), &quot;+m&quot;(*lock)</span><br><span class=\"line\">:</span><br><span class=\"line\">:     &quot;memory&quot;, &quot;cc&quot;);</span><br><span class=\"line\">   return (int) _res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æä¸è¾¹ç¨é¼ æ å¨ç¼è¯å¨éåä½äºtaså½æ°ï¼ä¸è¾¹è¯´ï¼âä»è¿æ®µæ±ç¼ä»£ç å¯ä»¥çåºï¼CMPæä»¤åä¸é¢çXCHGä¸è½ç»æä¸ä¸ªåå­æä½ï¼æ¯å¦ä¸ä¸ªçº¿ç¨Bå·²ç»ææäºéï¼çº¿ç¨AåäºCMPæä»¤ä¹åç°äºæå¶ä»çº¿ç¨å·²ç»å æäºéèµæºï¼äºæ¯ä»å°±ä¼JNEè·³è¿XCHGæä»¤ï¼ä½æ¯å¾å¯è½å¨CMPæä»¤ä¹åï¼çº¿ç¨Bå°±ç«å³éæ¾äºéèµæºãâå¤§æå¨çº¸ä¸ç»äºä¸ä¸ªç¤ºæå¾ï¼</p>\n<p>âXCHGæä»¤ä¼å°è¯äº¤æ¢ä¸¤ä¸ªæä½æ°ï¼å¦ææ³è¦è·å¾ä¸ä¸ªéï¼ä¹å°±æ¯è¯´æä»¬æç®å¨âéå¯¹åºçå¼æ¯0çæåµä¸æéçå¼è®¾ç½®ä¸º1âï¼åæ¶æä»¬è¿å¯ä»¥ç¨0å1æ¥ä»£è¡¨TEST-AND-SETæ¯å¦æåï¼é£ä¹å¯¹ä¸é¢çæ±ç¼ä»£ç ç¿»è¯æé«çº§è¯­è¨å°±åæä¸é¢è¿æ ·ãâå¤§æå¼å§å¨çº¸ä¸ååºäºå¯¹åºäºPostgreSQLçtaså½æ°çä¼ªç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">static __inline__ int</span><br><span class=\"line\">tas(volatile slock_t lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   register slock_res &#x3D; 1;</span><br><span class=\"line\"></span><br><span class=\"line\">   if(*lock !&#x3D; 1)  &#x2F;&#x2F;CMPæä»¤</span><br><span class=\"line\">   &#123;</span><br><span class=\"line\">      &#x2F;&#x2F;ä¸é¢3è¡æ¯åå­æä½ï¼å¯¹åºXCHG</span><br><span class=\"line\">       int temp &#x3D; *lock; </span><br><span class=\"line\">lock &#x3D; 1;  &#x2F;&#x2F;å*lock &#x3D; res;</span><br><span class=\"line\">res &#x3D; temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">   return (int) _res;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å°æå¬å¾äºéé¾éçï¼åªå¥½è¯´ï¼âæè§å¬çæç¹ååï¼â</p>\n<p>å¤§æç¬çè¯´ï¼æ²¡å³ç³»çï¼âä½ å¯ä»¥æè¿äºæ¦å¿µè®°ä½ï¼ææ¶é´åæ³ä¸ä¸ï¼å¥½å¥½æ¶åæ¶åãâ</p>\n<p>å°æçè¦çè¯´ï¼âå¯æ¯ä½ è¯´çè¿äºé½æ¯ä¾¿ç§çç¥è¯ï¼å®¹ææ¶åä¸è¯åãâ</p>\n<p>å¤§æè¯´ï¼âä¸è¦æå¿åï¼èªæéçäºæååå¼å§ï¼æäºTASæä»¬æè½ç»§ç»­å®ç°PostgreSQLçèªæéï¼è®©æä»¬æ¥ççèªæéçå®ç°å§ãâ</p>\n<p><strong>PostgreSQLçèªæé</strong></p>\n<p>å¤§æç»§ç»­è¯´éï¼âå¨æäºCPUæ¶æä¸ï¼PostgreSQLæ²¡æç´æ¥ä½¿ç¨TTASï¼èæ¯åå®ç°äºTASï¼ç¶ååç¨TAS_SPINå½æ°(æèè¯´å®)æ¥å®ç°çèªæéãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#define TAS_SPIN(lock)  (*(lock) ? 1 : TAS(lock))</span><br></pre></td></tr></table></figure>\n\n<p>âæäºTAS_SPINæä»¬æ¯ä¸æ¯å°±å¾å®¹æå®ç°ä¸ä¸ªèªæéäºå¢ï¼âå¤§æé®éã</p>\n<p>å°ææ³äºæ³è¯´ï¼âè®©ææ¥åä¸ä¸ï¼ççè¿æ¬¡è½ä¸è½å®ç°ä¸ä¸ªå¯ç¨çèªæéãâè¯´çå°æå¨çº¸ä¸åäºèµ·æ¥ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void spinlock_acquire(int *lock)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    while(TAS_SPIN(lock));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åå®ä¹åï¼å°æåæ¨æ¼äºå éï¼æè§æ²¡ä»ä¹éè¯¯äºï¼äºæ¯å¸æ°çæäºæå¤´ï¼è¯´éï¼âæä¹æ ·ï¼æ¯ä¸æ¯å¾ä½©ææè¿æ ·ç¾è²ä¸æºæ§å¹¶éçäººï¼â</p>\n<p>âå¯ï¼è¿ä¸ªèªæéæ¯å¯ç¨çï¼ä¸è¿ç¾è²åæºæ§ä½ é½æ²¡åå°ï¼ä½ åå°äºçéï¼ç²¾ç¥çé¢çææ¤è½¦è¿æ²¡å°ï¼æä»¬è¿ææ¶é´ç»§ç»­è¯´èªæéãâå¤§æè°ä¾éï¼âæä»¬è¿è½ç»§ç»­ä¼åå®ãæ¯å¦éå½çå·æï¼è¿ç§èªæç®çæ¯ä¸æ¾å¼CPUï¼ä½ä¹æ²¡å¿è¦ä¸åçæï¼æä»¬å¯ä»¥ç¨ç©ºæä»¤æ¥éå½çè®©CPUæ­ä¸ä¼ï¼èä¸å¿è¿åº¦æè½¬ï¼æè½¬å¤ªé¢ç¹äºæµªè´¹çµï¼æä»¬ä½¿ç¨nopæä»¤æ¥è¿è¡å·æâï¼è¯´çå¤§æå¨PostgreSQLçæºä»£ç ä¸­æåºäºspin_delayå½æ°ã</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">static __inline__ void</span><br><span class=\"line\">spin_delay(void)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   __asm__ __volatile__(</span><br><span class=\"line\">      &quot; rep; nop       \\n&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¤§æç»§ç»­è¯´éï¼âå¦å¤ï¼æä»¬ä¹åºè¯¥å¤çä¸äºç¹æ®çæåµï¼æ¯å¦å°è¯äºå¾å¤æ¬¡TASä¹åä»ç¶æ æ³è·å¾éèµæºï¼é£ä¹å°±è¿å¥sleepï¼ä¹å°±æ¯äº¤åºCPUèµæºï¼éè¦æ³¨æçæ¯ç¡ç çæ¶é´æ¯éæºçï¼ä½ä¸è½è¶åºä¸ä¸çãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;&#x2F;ç¬¬ä¸æ¬¡sleepçæ¶é´ï¼sleepçæ¶é´éæ­¥éå¢ï¼ç¬¬ä¸æ¬¡æ¯1000å¾®ç§</span><br><span class=\"line\">if (status-&gt;cur_delay &#x3D;&#x3D; 0) &#x2F;* first time to delay? *&#x2F;</span><br><span class=\"line\">   status-&gt;cur_delay &#x3D; MIN_DELAY_USEC;</span><br><span class=\"line\"></span><br><span class=\"line\">pg_usleep(status-&gt;cur_delay);</span><br></pre></td></tr></table></figure>\n\n<p>âå½ç¶ï¼å¦ææè½¬äºå¾é¿æ¶é´ï¼ä»ç¶æ²¡æåæ³è·å¾éèµæºï¼å°±è¿å¥èªææ¨¡å¼ï¼å ä¸ºæä»¬åè®¾èªæéä¿æ¤çä¸´çåºé½å¾ç­ï¼å¦æå¾é¿æ¶é´è¿è·åä¸å°éèµæºï¼é£ä¹å°±å¯è½åºé®é¢äºãâ</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if (++(status-&gt;delays) &gt; NUM_DELAYS)</span><br><span class=\"line\">   s_lock_stuck(status-&gt;file, status-&gt;line, status-&gt;func);</span><br></pre></td></tr></table></figure>\n\n<p>âè¿åºæ¬ä¸å°±æ¯PostgreSQLèªæéçå®ç°äºï¼ä¸è¿è¿éè¦æ³¨ææä»¬åªè°äºX86æ¶æä¸çå®ç°æ¹æ³ï¼å¨ä¸åçCPUæ¶æä¸ï¼TASçå®ç°æ¯ä¸åçï¼æ¯å¦å¨MIPSæ¶æä¸æä¾çæ¯llåscæä»¤ï¼æä»¬è¦åå©è¿ä¸¤ä¸ªæä»¤æ¥å®ç°TASãâ</p>\n<p>âæç½äºï¼çæ¥æéè¦å­¦çä¸è¥¿è¿æå¾å¤ãâå°ææ²®ä¸§çè¯´ã</p>\n<p>âä¸è¦è¿ä¹æ²è§åï¼ä½ ä¸äºè§£è¿äºç¥è¯ä¸»è¦æ¯å ä¸ºä½ è¿æ²¡æåå å·¥ä½ï¼è¿æ¯å­¦çï¼è¿å¨å­¦ä¹ çé¶æ®µï¼ç­ä½ åå å·¥ä½äºï¼æ¶é´é¿äºï¼ä¹å°±ä¹ æ¯äºãâå¤§æç¬çè¯´ï¼âåæ­£åºå¤äºä¸æï¼å¨æä»¬ç»æä¹åï¼åæ¥è¡¥åä¸ä¸èªæééæ¾çç¥è¯ãâ</p>\n<p>âéçéæ¾ï¼ç´æ¥æå¼è®¾ç½®æ0å°±å¯ä»¥äºåãâ</p>\n<p>âbingoï¼æ¯çï¼æä¹æ¯è¿ä¹è®¤ä¸ºçï¼ä½æ¯è¿æä¸ä¸ªæ³¨æäºé¡¹ãâ</p>\n<p>âä»ä¹æ³¨æäºé¡¹ï¼é¾éè¿è¿æä»ä¹å¹ºè¾å­åï¼âå°ææå¥éã</p>\n<p>âæä¸ä¸ªå¾å¤§çå¹ºè¾å­ï¼å°±æ¯ç®åå¾å¤CPUä¸ºäºæé«æ§è¡æçï¼å®ç°äºä¹±åºæ§è¡åè½ï¼å³äºä¹±åºæ§è¡çå·ä½åå®¹æä»¬å°±ä¸å±å¼äºï¼ä»¥åä½ ä¸å¥½æ¶åãä¸è¿éè¦è®°ä½çæ¯ï¼å¦ææéæ¾éåæåªæ¯ç®åè®¾ç½®lockçå¼ï¼ç±äºä¹±åºæ§è¡çä½ç¨ï¼æäºä¸´çåºä¸­çæä»¤å¯è½ä¼å¨lockéæ¾åææ§è¡ï¼è¿å°±ç¸å½äºä¸¤ä¸ªè¿ï¼çº¿ï¼ç¨å±åè¿å¥äºä¸´çåºï¼é£è¯å®ä¼åºé®é¢ï¼æä»¥æä»¬å¯ä»¥éç¨åå­å±éçæ¹å¼æ¥ä¿è¯ééæ¾çæåºæ§ï¼ä½ çï¼PostgreSQLçæäºééæ¾æ¶ç¨çæ¯è¿ç§æ¹å¼ãâè¯´çï¼å¤§æå¨æºä»£ç ä¸­æ åºäºä¸è¡ééæ¾çä»£ç ï¼</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">do &#123; __memory_barrier(); *(lock) &#x3D; 0; &#125; while (0)</span><br></pre></td></tr></table></figure>\n\n<p>âå¥½å§ï¼æè®°ä¸äºï¼å¿µäºè¿ä¹å¤å¹´çä¹¦ï¼æè§å¾è¿æ¯å¹¼å¿å­éåæãâå°æè¦çè¸è¯´ã<br>âæ²¡äºï¼ä¸­åæä»¬å»åç¹å¥½çï¼å¼¥è¡¥ä¸ä¸ä½ åä¼¤çå¿çµï¼æåå¤ä¸ä¸ï¼å±ä»¬é©¬ä¸å°±åºåãâ</p>"},{"title":"PostgreSQLä¸­çé - è½»éé","date":"2021-07-20T00:18:10.000Z","_content":"\n\nå¤§æä¸å°æèå®äºèªæéï¼å·²æ¯ä¸­åæ¶åï¼å¤§æçªç¶æ³å°æè¿æä¸æ¬è®²è§£äºå¡å¤ççæ°ä¹¦è¦ä¸å¸ï¼æ­£å¥½åå«è¦è®²ç»å°æçèªæéãè½»ééãå¸¸è§éç­åå®¹ï¼äºæ¯å¯¹å°æè¯´ï¼âæè¿ä¸å¸äºä¸æ¬æ°ä¹¦ï¼å«**ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã**ï¼æ¯**ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã**çå§å¦¹ç¯ï¼æ°å¥½æä½ æ³è¦å­¦ä¹ çåå®¹ï¼æä»¬ä¸å¦¨å»éè¿çä¹¦åºççãâ\n\nç»è¿ä¸ä¸åçè®²è§£ï¼å°æå·²ç»ç²¾ç²åå°½ï¼è¹ä¸­ééä½åï¼å¤§æä¸ç±ç¬éï¼âå±ä»¬è¿æ¯åé¥±é¤æé¥­ï¼ç¶ååå»ä¹¦åºå§ãâ\n\nå°æææèå­ï¼ç¡®å®å·²ç»æ¯é¥¥è è¾è¾ï¼ä¾¿ç¬éï¼âåä¸äºåè®©ä½ ç ´è´¹ãâ\n\n<!--more-->\n\nå¤§æä»æ²åä¸å¼¹èµ·èº«å­ï¼è¾¹ç©¿å¤è¡£è¾¹éï¼âéè¿ç¾é£é¢å¤ï¼æ²å¿æçãæé½ä¸æéåºé½ä¸éï¼æä»¬è¿æ¯è¾¹èµ°è¾¹çå§ãâ\n\nå¤§æå®¶éè¿ä¸è¿æ°æä¸æ¡åä¸è¡ï¼å¨æ«æ¶é´çä¸­åï¼åä¸è¡ä¸ççææï¼äººæµç©¿æ¢­ï¼éè¿çéåºç«ç¶çº·çº·æèµ·éæ¥ï¼è¿æä¸äºéåºå·²ç»è¢«å©ç¤¼ååºï¼å é¿çå©è½¦è·¯è¿åä¸è¡ï¼èªæ¯ç­é¹éå¸¸ãå¤§æåå°æåæ¯æ¥å°æ²å¿æçï¼åç°å·²è¢«å©ç¤¼ååºï¼ç¶ååå°äºæé½ä¸æéåºï¼ç»æåºå¤æéç­åçå®¾å®¢èªè§å°æèµ·äºä¸æ¡é¿é¾ï¼ä¸åæäºæ«å´ã\n\nå¤§ææè®®éï¼âæç¥éæ­¤å¤è§è½æä¸å®¶å°åï¼åºå®¶è½å°ï¼ä½å³éä¸éï¼ä¸å¦åå»ä¸è¯ãâäºæ¯äºäººç©¿æ¢­è¿åä¸è¡è§è½çä¸ä¸ªå°å··ï¼ä¸æå«æï¼ç»äºæ¥å°ä¸å®¶å°åºé¨åï¼åºé¢è½å°ï¼ä½çä¸å»æ´æ´å¹²åï¼è£ä¿®å¤æ´ï¼å¤§å¤§çæçä¸åçééççåºåï¼èçº¦ç¿°ç¸é±é¢é¦ãä¸è¿åºé¢å¨åä¸è¡å¤çè§è½ä¸­ï¼åºä¸­çå®¢äººä¸å¤ï¼ä»æä½ä½ï¼äºäººä¾¿æ¾äºä¸ä¸ªä¸éçä½ç½®åä¸äºã\n\nå°ææ¿èµ·èåç¬éï¼âæ²¡æ³å°è¿å°å°çè§è½ä¸­ç«å§èèé¾ï¼ä¸å¦å°±åä»ä»¬è¿éçæçå¥é¤ï¼ç¸é±æå¤§å©é¢å§ï¼æè¦ä¸ä¸ªå¤§ç¢çãâå¤§æäºæ¯å¯¹æå¡åè¯´ï¼âè¦ä¸¤ä¸ªå¤§ç¢çç¸é±æå¤§å©é¢ï¼ç»ææ¿ä¸¤å¤´èãâ\n\nç¶åå¤§æè½¬å¤´å¯¹å°æè¯´éï¼âä»å¤©çæ¯è§¦éå¤´ï¼å¥½ç¹çé¥­åºç«ç¶é½è¢«å©ç¤¼ç»ç¬å äºãâå°æä¾¿è¯´ï¼âæ²¡å³ç³»ï¼èªæéåï¼é½æ¯äºæ¥çï¼ä»ä»¬å äºï¼æä»¬å°±è¿ä¸å»ï¼ä¸è¿æä»¬å°±ä¸ç­äºï¼ç´æ¥æ¢ä¸å®¶åï¼æçç¸é±æå¤§å©é¢ä¹ä¸éãâ\n\nå¤§æè¯´éï¼âè¯´å°è¿éï¼æä»¬ä¸å¦¨åä»ç»ä¸ä¸PostgreSQLä¸­çè½»ééï¼è¿æ¯ä¸ç§æå±äº«ç²¾ç¥çéãâ\n\nâè½»ééï¼è®©ææ³æ³ï¼æå¥½æ³å¬è¯´è¿è¿ç§ç±»åçéï¼å®åèªæéä¸åï¼å®ä¸è¬ç¨äºä¿æ¤PostgreSQLä¸­å¯¹å±äº«åå­çæä½å§ï¼å®æ¯ä¸ç§è¯»åéå§ï¼â\n\n**è¯»åé**\n\nâæ¯çãâå¤§æè¾¹ç¹å¤´ä¾¿è¯´ï¼âè½»ééæéåæäºè¯»éååéï¼è¯»éåªè¯»åè®¿é®èµæºï¼å æ­¤æ¯å¯ä»¥å±äº«çï¼ä¹å°±æ¯è¯´å¯ä»¥æå¤ä¸ªè¿ç¨åæ¶è¯»å±äº«èµæºï¼èåéåæ¯æå®çï¼å ä¸ºåéçææèè¦ä¿®æ¹å±äº«èµæºä¸­çåå®¹ï¼å®çéç¸å®¹ç©éµæ¯è¿æ ·çãâè¯´çï¼å¤§æè¸äºç¹è¶æ°´ï¼å¨æ¡é¢ä¸ç»åºäºè½»ééçç¸å®¹ç©éµã\n\n| éç±»å   | è¯»é     |  åé    |\n| ------- | -----:  | :----: |\n| è¯»é     | O      |   X    |\n| åé     | X      |   X    |\n\n\"ä½ çï¼è¿å¶ä¸­Oå°±ä»£è¡¨ç¸å®¹ï¼Xå°±ä»£è¡¨äºæ¥ã\"å¤§æè¾¹ç»è¾¹è¯´ã\nå°æççæ¡é¢ä¸æ¸æ¸æ·¡å»çæ°´çï¼è¥æææçè¯´éï¼âè¿ç§éçåºç°å°±æ¯ä¸ºäºæé«å¹¶ååº¦ï¼å ä¸ºè¯»åè¯»æ¯ç¸å®¹çãå®åèªæéæ¯çä¸åå¨äºï¼èªæéæ¯äºæ¥éï¼ä¸æ¦éå®äºä¸´çåºï¼å¶ä»è®¿é®èå°±åªè½ç­äºãå®æ¯æ²¡æç­çº§æ¦å¿µçï¼å°±åªæäºæ¥ä¸ç§æåµï¼èè½»ééæå¯¹å±äº«èµæºçè®¿é®ååæäº2ä¸ªç­çº§ï¼ä¸ä¸ªç­çº§æ¯è¯»ï¼ä¸ä¸ªç­çº§æ¯åï¼è¿æ ·éçç²åº¦å°±æ´ç»äºãâ\n\nå¤§æç¹äºç¹å¤´è¯´éï¼âè¯´å¾å¥½ï¼ä½æä»¬è¿æ¯å°½éä¸è¦æè½»ééåèªæéæ··ä¸ºä¸è°ï¼å®ä»¬çç®çä¸åï¼å®éä¸å¨æ©æçPostgreSQLä¸­ï¼è½»ééæ¯åå©èªæéå®ç°çãâ\n\nå°ææå¥éï¼âåå©èªæéå®ç°ç?â\n\nâå¯ï¼æä»¬å¨å®ç°èªæéçæ¶åï¼åå©CPUæä¾çåè¯­å®ç°äºå¯¹ä¸ä¸ªå±äº«åéçåå­æä½ï¼æä»¥æä»¬å°±å¯ä»¥æ ¹æ®è¿ä¸ªå±äº«åéçç¶ææ¥å³å®æä»¬æ¯ä¸æ¯å¯ä»¥è¿å¥ä¸´çåºãâå¤§æåé¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´ï¼âè½»ééçå®ç°ä¹æ å¤ä¹å¦æ­¤ï¼åªä¸è¿å®çç¶æå¤äºï¼ç¨ä¸ä¸ªåéä¸å¥½ä¿å­ï¼äºæ¯å°±ç¨èªæéæ¥å®ç°å¯¹è¿äºåéçä¿æ¤ãâ\n\nå°æç¹ç¹å¤´è¯´éï¼âå¯ï¼å¨è®²è§£èªæéçæ¶åä½ æ¾ç»è¯´è¿ï¼èªæéä¸è¬åªä¿æ¤å¾å°çä¸´çåºï¼æä»¥å¯ä»¥å¿ç­ï¼ä¹å°±æ¯è¯´ç¨èªæéæ¥å®ç°è½»ééçæ¶åï¼ä¿æ¤å±äº«ç¶æçä¸´çåºä¹ä¸å®éå¸¸å°ï¼ä¸ç¶å°±æ²¡æåæ³ç¨èªæéæ¥å®ç°è½»ééäºå§ãâ\n\n\n**äºæåçäºåå**\n\nå¤§æç±äºç±çè¯´éï¼âæ¯çï¼ä¹æ­£å ä¸ºå¦æ­¤ï¼äºæå·²ç»åçååï¼æä»¬ä»¥åå¯ä»¥è¯´PostgreSQLç¨èªæéæ¥å®ç°äºè½»ééï¼ä½æ¯ç°å¨ä¸è½è¿ä¹è¯´äºãâ\n\nâä¸ºä»ä¹ï¼â\n\nâå¨ä¹åçPostgreSQLçæ¬ä¸­ï¼è½»ééçéç»æä¸­æå ä¸ªåéç¨æ¥è®°å½å½åéçç¶æï¼æ¯å¦ï¼å±äº«éå¯ä»¥ç±å¤ä¸ªè®¿é®èå±äº«ï¼æä»¬å°±å¯ä»¥ç¨ä¸ä¸ªåéæ¥è®°å½ç®åæå¤å°ä¸ªè®¿é®èå±äº«è¿ä¸ªéï¼æ¯å¦æå®éå·æäºæ¥æ§ï¼æä»¬å°±éç¨ä¸ä¸ªåéæ¥æ è¯å½åè°è·å¾äºæå®éãæç»æ ¹æ®è¿äºç¶æå°±å¯ä»¥å¤æ­æ°çè®¿é®èæ¯å¦å¯ä»¥è·å¾éï¼ä½è¿éæä¸¤ä¸ªé®é¢ãâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âä¸ä¸ªé®é¢æ¯è½»ééçè·ååéæ¾ç¹å«é¢ç¹ï¼å¦ä¸ä¸ªé®é¢æ¯è¿æ¬¡èªæéä¿æ¤çä¸´çåºæç¹å¤§äºï¼æè¿ä¸¤ä¸ªé®é¢ç»¼åå°ä¸èµ·å°±æ¯ï¼è¿éç¨èªæéä¿æ¤ä¸´çåºï¼éä½äºPostgreSQLçæ§è½ãâ\n\nâæå¬ä½ åæè¯´çï¼å¥½åæ¯æç¹æµªè´¹ï¼æ¯å¦æå®éçç¶æå§ï¼æä»¬åªéè¦ä¸ä¸ª0å1çç¶æå°±å¯ä»¥äºï¼ç¨ä¸ä¸ªå­èæ¥æ è¯é½å«å¤ï¼èå±äº«éçè®¡æ°ææ³ä¹ä¸ä¼è¾¾å°2^32æ¬¡æ¹ï¼æä»¥ç¨ä¸ä¸ª4å­èçintæ¥è¡¨ç¤ºï¼ä¹å®å¨æ¯ä¸ç§æµªè´¹ï¼æçå¯ä»¥æè¿äºç¶æç¨bitä½æ¥æ è¯ï¼å®å¨å°±å¯ä»¥äºãâå°æç¥æææçè¯´éã\n\nå¤§æèµèµçè¯´ï¼âå®å¨æ­£ç¡®ãâ\n\nè¿æ¶åæå¡åæç¸é±æå¤§å©é¢å·²ç»ç«¯ä¸æ¥äºï¼ä¸¤ä¸ªäººé¡¾ä¸ä¸åæ¥çè¯´è½»ééï¼å¼å§åèµ·æ¥ï¼å°æä¸è¾¹åä¸è¾¹æ³æä¹åççåéè½»ééç¶æçbitä½ï¼å¯¹äºæå®éèè¨ï¼åªéè¦ä¸ä¸ªbitå°±å¤äºï¼èå±äº«éçè®¡æ°å¢ï¼éè¦åéå¤å°ä¸ªå¢ï¼\n\nå¤§æå¿«éçåäºå å£é¢ï¼ç¶åç¨è¸çæ°´å¨æ¡å­ä¸ç»äºèµ·æ¥ï¼âç®åè½»ééç¶æçå¸å±æ¯è¿æ ·çãâ\n\n![](./postgresql-lock-lwlock-implement/lockstate.jpg) \n\nå°æèµè®¸çè¯´ï¼âå¯ï¼ç¨24ä¸ªbitä½åè®¡æ°ï¼åºè¯¥æ¯å¤å¤äºãç°å¨é½åæ¬¢ç¨æ éç¼ç¨ï¼é£ä¹è¿ä¹ä¸ä¸ªåéçä¿æ¤ä¹å°±æ²¡æå¿è¦åä½¿ç¨èªæéæ¥ä¿æ¤äºï¼åªè¦èªå·±å®ç°ä¸ä¸ªCASçåè¯­å°±å¤äºãâ\n\nâå¯¹ï¼æ­£æ¯è¿æ ·å®ç°çï¼è¿æ ·å°±è§£å³äºå¹¶åçé®é¢ãâ\n\n**ä¿æ¤çä¹ä¸å¤§**\n\nå°ææ³äºæ³ï¼ç»§ç»­è¯´éï¼âé£æ¢ç¶å·²ç»ä¸ç¨èªæéå®ç°è½»ééäºï¼é£èªæéæ¯ä¸æ¯å°±å¿«è¦éä¼äºå¢ï¼â\n\nå¤§æåäºä¸å£å¤§èç¶åè¯´éï¼âæè®¸å§ï¼ä½ç®åèªæéè¿æ¯æäºç¨å¤çï¼ç°å¨è¯´è¦éä¼è¿ä¸ºæ¶å°æ©ãèè½»ééå¢ï¼ä¹æå®èªå·±çé®é¢ï¼å®ä¹æä»¥å«è½»ééï¼åå å°±æ¯å®ä¹ææèªå·±ä¿æ¤çä¸´çåºä¸å¤ªâå¤§âï¼è½ç¶æªå¿å¦èªæéé£æ ·ï¼åªéè¦å¾å°çCPUæ¶éå¨æï¼ä½å¦æè½»ééä¿æ¤çä¸´çåºå¤ªå¤æï¼ä»ç¶å¯è½å¸¦æ¥æ§è½é®é¢ãæå°±æ¾ç»ç¯è¿ä¸ä¸ªéè¯¯ï¼å¨è½»ééä¿æ¤çä¸´çåºä¸­å å¥äºå¤ªå¤çæ°ä»£ç ï¼æç»å¯¼è´æ°æ®åºè¿æ¥ä¸ä¸ãããâ\n\nâå¯æ¯ï¼è½»ééä¸­ä¸æ¯æè¯»éåï¼é£è¿ä¸å¤åï¼â\n\nâPostgreSQLä¸­åå±äº«åå­ç¶æçæåµä¹ä¸å°ï¼å æ­¤å¹¶ä¸æ¯æéçç¶æåç¦»æä¸¤ä¸ªç­çº§ä¹åå°±è½è§£å³ä¸åé®é¢ï¼å-åä¹é´ãå-è¯»ä¹é´ä»ç¶æ¯äºæ¥çï¼æä»¥ä½¿ç¨è½»ééçæ¶åä»ç¶è¦è°¨è®°ï¼è½»ééä¿æ¤çåºé´ä¸è½å¤ªå¤§ãè¿å°±å¥½åææ¸¸åºçå¬åä¸æ ·ï¼è½ç¶ä½ ç¬å äºé©¬æ¡¶ï¼ä½æ¯è¯·å¿«éè§£å³é®é¢ï¼ä¸ç¶å¤è¾¹çç­å¾éåå¤ªé¿ï¼ä¹ä¼é ææ¥å µãâ\n\nå¬å¤§æè¯´èµ·äºææ¸¸åºçé©¬æ¡¶ï¼å°æé¡¿æ¶è§å¾å£ä¸­çé¢é¾ä»¥ä¸å½ï¼äºæ¯é®éï¼\"å¯ï¼è½»ééè¿ä¼æéï¼çæ¥è¿åèªæéä¸ä¸æ ·ï¼èªæéå¥½åæ²¡æç­å¾éåå³ï¼\"\n\n**ç­å¾éå**\n\nå¤§æåäºä¸å£é¢ç»§ç»­è¯´éï¼âå¯ï¼ç¡®å®æ¯è¿æ ·ï¼èªæéæ¯æ²¡æéåçï¼ä½æ¯è½»ééæç­å¾éåãæ¯å¦ï¼ç°å¨æè¿ç¨å·²ç»ä»¥å±äº«ç¶æææäºä¸ä¸ªè½»ééï¼é£ä¹æ³è¦ææäºæ¥éçè¿ç¨è¯å®æ¯åªè½è¿ç­å¾éåäºãâ\n\nâå¦æè¿æ¶ååæ¥ä¸ä¸ªè¿ç¨æ³è¦ææå±äº«éå¢ï¼æ¯è®²ç©¶åæ¥åå°çè¿å¥ç­å¾éåï¼è¿æ¯ç´æ¥è·å¾å±äº«éï¼â\n\nâå¯ï¼å¥½é®é¢ï¼è¿å°±æ¯è½»ééåå¸¸è§éçä¸åãâ\n\nâå¸¸è§éï¼â\n\nâå°±æ¯è¡¨çº§éåï¼è½»ééå¨è¿ç§æåµä¸ï¼å±äº«éå°±å¯ä»¥ç´æ¥è·åäºï¼ä½æ¯å¸¸è§éå¯è½å°±éè¦è¿ç­å¾éåå½ï¼â\n\n![](./postgresql-lock-lwlock-implement/sxlock.jpg) \n\n\n**å¤é**\n\nè¿æ¶åºå¤è¿æ¥ä¸ä¸ªé«å¤§çèº«å½±ï¼è¡è¬ååï¼æ ¼å­è¡¬è¡£ï¼å°æè¿è¿çå»ä¼¼æ¾ç¸è¯ï¼äºæ¯åå¤§æé®éï¼âé£åè¿æ¥çäººå¯æ¯çäºå¥ï¼âå¤§æè½¬å¤´ä¸çï¼æç¶æ¯çäºå¥ï¼äºæ¯èµ·èº«æå¼éï¼âèçï¼ä½ æä¹ä¹å°è¿éæåé¢äºï¼è¿æ¥æä»¬ååä¸æ¡å§ãâçäºå¥çæ¯å¤§æåå°æï¼éå¸¸é«å´ï¼äºæ¯åå°æé®éï¼âå°åå¼ï¼ä¸æ¬¡æåå¤§æç»ä½ è®²çæ¥è¯¢ä¼åä½ è¿è®°å¾å§ï¼â\n\nå°æå¿è¯´ï¼âè®°å¾è®°å¾ï¼æç°å¨å·²ç»è·å¾äºæä»¬å®¿èçâä¼åå¨å°è½æâç§°å·ï¼ææå¤©å°±å»ä¹°ä¸ªå¥ç¶æèµ·æ¥ãä¸è¿ä»å¤©å¤§æå¥æ­£ç»æè®²è½»ééå¢ï¼çäºå¥æ¥å§ï¼å±ä»¬3ä¸ªé½æ¯ç³è¯·è¯»éçï¼å¯ä»¥ååä¸æ¡ãâ\n\nçäºå¥ç¬çåå¨å°ææè¾¹ï¼å¯¹æå¡åè¯´ï¼âç»æä¸ç¢ååæå¤§å©é¢ãâç¶åè½¬è¿å¤´è¯´ï¼âæåæå¨åä¸è¡è½¬äºå ä¸ªåï¼ä¸ä¸ªç©ºä½é½æ²¡æ¾å°ï¼å°±æ³èµ·æ¥è¿éæä¸ªé¢é¦ï¼äºæ¯å°±è¿æ¥äºãâ\n\nå°æè¯´ï¼âå¯ï¼çæ¥è¿æ¯è½»ééå¥½ï¼è¯»éå¯ä»¥ç¸å®¹ï¼ä¸åèªæéï¼èªå·±å çCPUåå°æè½¬ãâå°æä¸è¾¹è¯´ä¸è¾¹ç¨æå¨æ¡ä¸ç»äºå ä¸ªåã\n\nçäºå¥è¯´ï¼âå¯ï¼ä¸è¿æä»¬è¿äºè¯»éå·²ç»å é¢äºè¿ä¸ªæ¡å­ï¼å¦ææåéæ³æ¥ç¬å ï¼ä¹éè¦ç­æä»¬èµ°äºæè¡ï¼æä»¬åä»ä»¬ä¸ç¸å®¹åãâ\nå°ææ³äºæ³é¡¿æ¶é¢æï¼å¦ææ­¤æ¶æäººä»¥è¯»éç³è¯·è½»ééï¼èæä»¬ç³è¯·çä¹æ¯è¯»éï¼èªç¶æ¯å¯ä»¥ç´æ¥è·å¾éçï¼èå¦ææä»¬ç³è¯·çæ¯åéï¼é£ä¹å°±è¯å®åªè½ç­å¾äºãä½æ¯å¦æç°å¨æäººä»¥åéææè½»ééï¼é£ä¹æ è®ºæ¯æ°æ¥çè¯»éè¿æ¯åéï¼é½éè¦è¿å¥ç­å¾éåï¼æ³å°æ­¤å¤å°æä¸ç¦åé®éï¼âé£å¦æææéçäººéæ¾äºéï¼æä»¬åºè¯¥ä»¥ä»ä¹é¡ºåºå¤éç­å¾éåéçéå¢ï¼â\n\nçäºå¥æ³äºæ³ï¼è¯´ï¼âå¯ï¼é£è¦çæå¨ç¬¬ä¸ä¸ªçæ¯ä»ä¹éï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯åéï¼é£ä¹å°±ç´æ¥å¤éè¿ä¸ªåéï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯è¯»éï¼é£ä¹å°±å¤éç­å¾éåä¸­ææçè¯»éï¼èå¿½ç¥ç­å¾éåä¸­çåéï¼å°±åè¿æ ·ãããâè¯´çï¼çäºå¥å¨æ¡ä¸ç»äºèµ·æ¥ã\n\n![](./postgresql-lock-lwlock-implement/waitqueue.jpg) \n\n\n**å°ç»**\n\nçççäºå¥å¨æ¡ä¸çç­å¾éåå¤éå¾ï¼å°æè§å¾åºè¯¥å¯¹è½»ééæäºä¸ä¸ªåºæ¬çäºè§£ï¼ä½æ¯çªç¶èåäºä¸ä¸ªæ³æ³ï¼åæå¤§æè¯´è¿å¸¸è§éï¼é£åæ¯ææ ·å®ç°çå¢ï¼äºæ¯ä¾¿é®çäºå¥ï¼âé£å¸¸è§éææ²¡æç­å¾éåï¼âçäºå¥æ£äºä¸ä¸ï¼çªç¶å¤§ç¬éï¼âä¸æ¥ä¸æ¥ï¼æè¿ææ¬æ°ä¹¦ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãå·²ç»ä¸å¸äºï¼éé¢å¥é½æï¼æä»¬åå®å»ä¹¦åºççå§ãâ\nå¤§æåå°æç¹å¤´éï¼âæ­£ææ­¤æï¼åå»åå»ãâ\n\nè¿æ¶æå¡åæçäºå¥çé¢å·²ç»ç«¯ä¸æ¥äºï¼äºæ¯ä¸ä¸ªäººåå¼å§è¾¹åè¾¹èä¸äºä¸åçå«å¦ï¼èçº¦ç¿°ç¸é±é¢é¦ä¸­åæ¢å¤äºæ´»æ³¼çæ°æ°ã\n","source":"_posts/postgresql-lock-lwlock-implement.md","raw":"---\ntitle: PostgreSQLä¸­çé - è½»éé\ndate: 2021-07-20 08:18:10\ntags: lock lwlock transaction postgresql\n---\n\n\nå¤§æä¸å°æèå®äºèªæéï¼å·²æ¯ä¸­åæ¶åï¼å¤§æçªç¶æ³å°æè¿æä¸æ¬è®²è§£äºå¡å¤ççæ°ä¹¦è¦ä¸å¸ï¼æ­£å¥½åå«è¦è®²ç»å°æçèªæéãè½»ééãå¸¸è§éç­åå®¹ï¼äºæ¯å¯¹å°æè¯´ï¼âæè¿ä¸å¸äºä¸æ¬æ°ä¹¦ï¼å«**ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã**ï¼æ¯**ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã**çå§å¦¹ç¯ï¼æ°å¥½æä½ æ³è¦å­¦ä¹ çåå®¹ï¼æä»¬ä¸å¦¨å»éè¿çä¹¦åºççãâ\n\nç»è¿ä¸ä¸åçè®²è§£ï¼å°æå·²ç»ç²¾ç²åå°½ï¼è¹ä¸­ééä½åï¼å¤§æä¸ç±ç¬éï¼âå±ä»¬è¿æ¯åé¥±é¤æé¥­ï¼ç¶ååå»ä¹¦åºå§ãâ\n\nå°æææèå­ï¼ç¡®å®å·²ç»æ¯é¥¥è è¾è¾ï¼ä¾¿ç¬éï¼âåä¸äºåè®©ä½ ç ´è´¹ãâ\n\n<!--more-->\n\nå¤§æä»æ²åä¸å¼¹èµ·èº«å­ï¼è¾¹ç©¿å¤è¡£è¾¹éï¼âéè¿ç¾é£é¢å¤ï¼æ²å¿æçãæé½ä¸æéåºé½ä¸éï¼æä»¬è¿æ¯è¾¹èµ°è¾¹çå§ãâ\n\nå¤§æå®¶éè¿ä¸è¿æ°æä¸æ¡åä¸è¡ï¼å¨æ«æ¶é´çä¸­åï¼åä¸è¡ä¸ççææï¼äººæµç©¿æ¢­ï¼éè¿çéåºç«ç¶çº·çº·æèµ·éæ¥ï¼è¿æä¸äºéåºå·²ç»è¢«å©ç¤¼ååºï¼å é¿çå©è½¦è·¯è¿åä¸è¡ï¼èªæ¯ç­é¹éå¸¸ãå¤§æåå°æåæ¯æ¥å°æ²å¿æçï¼åç°å·²è¢«å©ç¤¼ååºï¼ç¶ååå°äºæé½ä¸æéåºï¼ç»æåºå¤æéç­åçå®¾å®¢èªè§å°æèµ·äºä¸æ¡é¿é¾ï¼ä¸åæäºæ«å´ã\n\nå¤§ææè®®éï¼âæç¥éæ­¤å¤è§è½æä¸å®¶å°åï¼åºå®¶è½å°ï¼ä½å³éä¸éï¼ä¸å¦åå»ä¸è¯ãâäºæ¯äºäººç©¿æ¢­è¿åä¸è¡è§è½çä¸ä¸ªå°å··ï¼ä¸æå«æï¼ç»äºæ¥å°ä¸å®¶å°åºé¨åï¼åºé¢è½å°ï¼ä½çä¸å»æ´æ´å¹²åï¼è£ä¿®å¤æ´ï¼å¤§å¤§çæçä¸åçééççåºåï¼èçº¦ç¿°ç¸é±é¢é¦ãä¸è¿åºé¢å¨åä¸è¡å¤çè§è½ä¸­ï¼åºä¸­çå®¢äººä¸å¤ï¼ä»æä½ä½ï¼äºäººä¾¿æ¾äºä¸ä¸ªä¸éçä½ç½®åä¸äºã\n\nå°ææ¿èµ·èåç¬éï¼âæ²¡æ³å°è¿å°å°çè§è½ä¸­ç«å§èèé¾ï¼ä¸å¦å°±åä»ä»¬è¿éçæçå¥é¤ï¼ç¸é±æå¤§å©é¢å§ï¼æè¦ä¸ä¸ªå¤§ç¢çãâå¤§æäºæ¯å¯¹æå¡åè¯´ï¼âè¦ä¸¤ä¸ªå¤§ç¢çç¸é±æå¤§å©é¢ï¼ç»ææ¿ä¸¤å¤´èãâ\n\nç¶åå¤§æè½¬å¤´å¯¹å°æè¯´éï¼âä»å¤©çæ¯è§¦éå¤´ï¼å¥½ç¹çé¥­åºç«ç¶é½è¢«å©ç¤¼ç»ç¬å äºãâå°æä¾¿è¯´ï¼âæ²¡å³ç³»ï¼èªæéåï¼é½æ¯äºæ¥çï¼ä»ä»¬å äºï¼æä»¬å°±è¿ä¸å»ï¼ä¸è¿æä»¬å°±ä¸ç­äºï¼ç´æ¥æ¢ä¸å®¶åï¼æçç¸é±æå¤§å©é¢ä¹ä¸éãâ\n\nå¤§æè¯´éï¼âè¯´å°è¿éï¼æä»¬ä¸å¦¨åä»ç»ä¸ä¸PostgreSQLä¸­çè½»ééï¼è¿æ¯ä¸ç§æå±äº«ç²¾ç¥çéãâ\n\nâè½»ééï¼è®©ææ³æ³ï¼æå¥½æ³å¬è¯´è¿è¿ç§ç±»åçéï¼å®åèªæéä¸åï¼å®ä¸è¬ç¨äºä¿æ¤PostgreSQLä¸­å¯¹å±äº«åå­çæä½å§ï¼å®æ¯ä¸ç§è¯»åéå§ï¼â\n\n**è¯»åé**\n\nâæ¯çãâå¤§æè¾¹ç¹å¤´ä¾¿è¯´ï¼âè½»ééæéåæäºè¯»éååéï¼è¯»éåªè¯»åè®¿é®èµæºï¼å æ­¤æ¯å¯ä»¥å±äº«çï¼ä¹å°±æ¯è¯´å¯ä»¥æå¤ä¸ªè¿ç¨åæ¶è¯»å±äº«èµæºï¼èåéåæ¯æå®çï¼å ä¸ºåéçææèè¦ä¿®æ¹å±äº«èµæºä¸­çåå®¹ï¼å®çéç¸å®¹ç©éµæ¯è¿æ ·çãâè¯´çï¼å¤§æè¸äºç¹è¶æ°´ï¼å¨æ¡é¢ä¸ç»åºäºè½»ééçç¸å®¹ç©éµã\n\n| éç±»å   | è¯»é     |  åé    |\n| ------- | -----:  | :----: |\n| è¯»é     | O      |   X    |\n| åé     | X      |   X    |\n\n\"ä½ çï¼è¿å¶ä¸­Oå°±ä»£è¡¨ç¸å®¹ï¼Xå°±ä»£è¡¨äºæ¥ã\"å¤§æè¾¹ç»è¾¹è¯´ã\nå°æççæ¡é¢ä¸æ¸æ¸æ·¡å»çæ°´çï¼è¥æææçè¯´éï¼âè¿ç§éçåºç°å°±æ¯ä¸ºäºæé«å¹¶ååº¦ï¼å ä¸ºè¯»åè¯»æ¯ç¸å®¹çãå®åèªæéæ¯çä¸åå¨äºï¼èªæéæ¯äºæ¥éï¼ä¸æ¦éå®äºä¸´çåºï¼å¶ä»è®¿é®èå°±åªè½ç­äºãå®æ¯æ²¡æç­çº§æ¦å¿µçï¼å°±åªæäºæ¥ä¸ç§æåµï¼èè½»ééæå¯¹å±äº«èµæºçè®¿é®ååæäº2ä¸ªç­çº§ï¼ä¸ä¸ªç­çº§æ¯è¯»ï¼ä¸ä¸ªç­çº§æ¯åï¼è¿æ ·éçç²åº¦å°±æ´ç»äºãâ\n\nå¤§æç¹äºç¹å¤´è¯´éï¼âè¯´å¾å¥½ï¼ä½æä»¬è¿æ¯å°½éä¸è¦æè½»ééåèªæéæ··ä¸ºä¸è°ï¼å®ä»¬çç®çä¸åï¼å®éä¸å¨æ©æçPostgreSQLä¸­ï¼è½»ééæ¯åå©èªæéå®ç°çãâ\n\nå°ææå¥éï¼âåå©èªæéå®ç°ç?â\n\nâå¯ï¼æä»¬å¨å®ç°èªæéçæ¶åï¼åå©CPUæä¾çåè¯­å®ç°äºå¯¹ä¸ä¸ªå±äº«åéçåå­æä½ï¼æä»¥æä»¬å°±å¯ä»¥æ ¹æ®è¿ä¸ªå±äº«åéçç¶ææ¥å³å®æä»¬æ¯ä¸æ¯å¯ä»¥è¿å¥ä¸´çåºãâå¤§æåé¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´ï¼âè½»ééçå®ç°ä¹æ å¤ä¹å¦æ­¤ï¼åªä¸è¿å®çç¶æå¤äºï¼ç¨ä¸ä¸ªåéä¸å¥½ä¿å­ï¼äºæ¯å°±ç¨èªæéæ¥å®ç°å¯¹è¿äºåéçä¿æ¤ãâ\n\nå°æç¹ç¹å¤´è¯´éï¼âå¯ï¼å¨è®²è§£èªæéçæ¶åä½ æ¾ç»è¯´è¿ï¼èªæéä¸è¬åªä¿æ¤å¾å°çä¸´çåºï¼æä»¥å¯ä»¥å¿ç­ï¼ä¹å°±æ¯è¯´ç¨èªæéæ¥å®ç°è½»ééçæ¶åï¼ä¿æ¤å±äº«ç¶æçä¸´çåºä¹ä¸å®éå¸¸å°ï¼ä¸ç¶å°±æ²¡æåæ³ç¨èªæéæ¥å®ç°è½»ééäºå§ãâ\n\n\n**äºæåçäºåå**\n\nå¤§æç±äºç±çè¯´éï¼âæ¯çï¼ä¹æ­£å ä¸ºå¦æ­¤ï¼äºæå·²ç»åçååï¼æä»¬ä»¥åå¯ä»¥è¯´PostgreSQLç¨èªæéæ¥å®ç°äºè½»ééï¼ä½æ¯ç°å¨ä¸è½è¿ä¹è¯´äºãâ\n\nâä¸ºä»ä¹ï¼â\n\nâå¨ä¹åçPostgreSQLçæ¬ä¸­ï¼è½»ééçéç»æä¸­æå ä¸ªåéç¨æ¥è®°å½å½åéçç¶æï¼æ¯å¦ï¼å±äº«éå¯ä»¥ç±å¤ä¸ªè®¿é®èå±äº«ï¼æä»¬å°±å¯ä»¥ç¨ä¸ä¸ªåéæ¥è®°å½ç®åæå¤å°ä¸ªè®¿é®èå±äº«è¿ä¸ªéï¼æ¯å¦æå®éå·æäºæ¥æ§ï¼æä»¬å°±éç¨ä¸ä¸ªåéæ¥æ è¯å½åè°è·å¾äºæå®éãæç»æ ¹æ®è¿äºç¶æå°±å¯ä»¥å¤æ­æ°çè®¿é®èæ¯å¦å¯ä»¥è·å¾éï¼ä½è¿éæä¸¤ä¸ªé®é¢ãâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âä¸ä¸ªé®é¢æ¯è½»ééçè·ååéæ¾ç¹å«é¢ç¹ï¼å¦ä¸ä¸ªé®é¢æ¯è¿æ¬¡èªæéä¿æ¤çä¸´çåºæç¹å¤§äºï¼æè¿ä¸¤ä¸ªé®é¢ç»¼åå°ä¸èµ·å°±æ¯ï¼è¿éç¨èªæéä¿æ¤ä¸´çåºï¼éä½äºPostgreSQLçæ§è½ãâ\n\nâæå¬ä½ åæè¯´çï¼å¥½åæ¯æç¹æµªè´¹ï¼æ¯å¦æå®éçç¶æå§ï¼æä»¬åªéè¦ä¸ä¸ª0å1çç¶æå°±å¯ä»¥äºï¼ç¨ä¸ä¸ªå­èæ¥æ è¯é½å«å¤ï¼èå±äº«éçè®¡æ°ææ³ä¹ä¸ä¼è¾¾å°2^32æ¬¡æ¹ï¼æä»¥ç¨ä¸ä¸ª4å­èçintæ¥è¡¨ç¤ºï¼ä¹å®å¨æ¯ä¸ç§æµªè´¹ï¼æçå¯ä»¥æè¿äºç¶æç¨bitä½æ¥æ è¯ï¼å®å¨å°±å¯ä»¥äºãâå°æç¥æææçè¯´éã\n\nå¤§æèµèµçè¯´ï¼âå®å¨æ­£ç¡®ãâ\n\nè¿æ¶åæå¡åæç¸é±æå¤§å©é¢å·²ç»ç«¯ä¸æ¥äºï¼ä¸¤ä¸ªäººé¡¾ä¸ä¸åæ¥çè¯´è½»ééï¼å¼å§åèµ·æ¥ï¼å°æä¸è¾¹åä¸è¾¹æ³æä¹åççåéè½»ééç¶æçbitä½ï¼å¯¹äºæå®éèè¨ï¼åªéè¦ä¸ä¸ªbitå°±å¤äºï¼èå±äº«éçè®¡æ°å¢ï¼éè¦åéå¤å°ä¸ªå¢ï¼\n\nå¤§æå¿«éçåäºå å£é¢ï¼ç¶åç¨è¸çæ°´å¨æ¡å­ä¸ç»äºèµ·æ¥ï¼âç®åè½»ééç¶æçå¸å±æ¯è¿æ ·çãâ\n\n![](./postgresql-lock-lwlock-implement/lockstate.jpg) \n\nå°æèµè®¸çè¯´ï¼âå¯ï¼ç¨24ä¸ªbitä½åè®¡æ°ï¼åºè¯¥æ¯å¤å¤äºãç°å¨é½åæ¬¢ç¨æ éç¼ç¨ï¼é£ä¹è¿ä¹ä¸ä¸ªåéçä¿æ¤ä¹å°±æ²¡æå¿è¦åä½¿ç¨èªæéæ¥ä¿æ¤äºï¼åªè¦èªå·±å®ç°ä¸ä¸ªCASçåè¯­å°±å¤äºãâ\n\nâå¯¹ï¼æ­£æ¯è¿æ ·å®ç°çï¼è¿æ ·å°±è§£å³äºå¹¶åçé®é¢ãâ\n\n**ä¿æ¤çä¹ä¸å¤§**\n\nå°ææ³äºæ³ï¼ç»§ç»­è¯´éï¼âé£æ¢ç¶å·²ç»ä¸ç¨èªæéå®ç°è½»ééäºï¼é£èªæéæ¯ä¸æ¯å°±å¿«è¦éä¼äºå¢ï¼â\n\nå¤§æåäºä¸å£å¤§èç¶åè¯´éï¼âæè®¸å§ï¼ä½ç®åèªæéè¿æ¯æäºç¨å¤çï¼ç°å¨è¯´è¦éä¼è¿ä¸ºæ¶å°æ©ãèè½»ééå¢ï¼ä¹æå®èªå·±çé®é¢ï¼å®ä¹æä»¥å«è½»ééï¼åå å°±æ¯å®ä¹ææèªå·±ä¿æ¤çä¸´çåºä¸å¤ªâå¤§âï¼è½ç¶æªå¿å¦èªæéé£æ ·ï¼åªéè¦å¾å°çCPUæ¶éå¨æï¼ä½å¦æè½»ééä¿æ¤çä¸´çåºå¤ªå¤æï¼ä»ç¶å¯è½å¸¦æ¥æ§è½é®é¢ãæå°±æ¾ç»ç¯è¿ä¸ä¸ªéè¯¯ï¼å¨è½»ééä¿æ¤çä¸´çåºä¸­å å¥äºå¤ªå¤çæ°ä»£ç ï¼æç»å¯¼è´æ°æ®åºè¿æ¥ä¸ä¸ãããâ\n\nâå¯æ¯ï¼è½»ééä¸­ä¸æ¯æè¯»éåï¼é£è¿ä¸å¤åï¼â\n\nâPostgreSQLä¸­åå±äº«åå­ç¶æçæåµä¹ä¸å°ï¼å æ­¤å¹¶ä¸æ¯æéçç¶æåç¦»æä¸¤ä¸ªç­çº§ä¹åå°±è½è§£å³ä¸åé®é¢ï¼å-åä¹é´ãå-è¯»ä¹é´ä»ç¶æ¯äºæ¥çï¼æä»¥ä½¿ç¨è½»ééçæ¶åä»ç¶è¦è°¨è®°ï¼è½»ééä¿æ¤çåºé´ä¸è½å¤ªå¤§ãè¿å°±å¥½åææ¸¸åºçå¬åä¸æ ·ï¼è½ç¶ä½ ç¬å äºé©¬æ¡¶ï¼ä½æ¯è¯·å¿«éè§£å³é®é¢ï¼ä¸ç¶å¤è¾¹çç­å¾éåå¤ªé¿ï¼ä¹ä¼é ææ¥å µãâ\n\nå¬å¤§æè¯´èµ·äºææ¸¸åºçé©¬æ¡¶ï¼å°æé¡¿æ¶è§å¾å£ä¸­çé¢é¾ä»¥ä¸å½ï¼äºæ¯é®éï¼\"å¯ï¼è½»ééè¿ä¼æéï¼çæ¥è¿åèªæéä¸ä¸æ ·ï¼èªæéå¥½åæ²¡æç­å¾éåå³ï¼\"\n\n**ç­å¾éå**\n\nå¤§æåäºä¸å£é¢ç»§ç»­è¯´éï¼âå¯ï¼ç¡®å®æ¯è¿æ ·ï¼èªæéæ¯æ²¡æéåçï¼ä½æ¯è½»ééæç­å¾éåãæ¯å¦ï¼ç°å¨æè¿ç¨å·²ç»ä»¥å±äº«ç¶æææäºä¸ä¸ªè½»ééï¼é£ä¹æ³è¦ææäºæ¥éçè¿ç¨è¯å®æ¯åªè½è¿ç­å¾éåäºãâ\n\nâå¦æè¿æ¶ååæ¥ä¸ä¸ªè¿ç¨æ³è¦ææå±äº«éå¢ï¼æ¯è®²ç©¶åæ¥åå°çè¿å¥ç­å¾éåï¼è¿æ¯ç´æ¥è·å¾å±äº«éï¼â\n\nâå¯ï¼å¥½é®é¢ï¼è¿å°±æ¯è½»ééåå¸¸è§éçä¸åãâ\n\nâå¸¸è§éï¼â\n\nâå°±æ¯è¡¨çº§éåï¼è½»ééå¨è¿ç§æåµä¸ï¼å±äº«éå°±å¯ä»¥ç´æ¥è·åäºï¼ä½æ¯å¸¸è§éå¯è½å°±éè¦è¿ç­å¾éåå½ï¼â\n\n![](./postgresql-lock-lwlock-implement/sxlock.jpg) \n\n\n**å¤é**\n\nè¿æ¶åºå¤è¿æ¥ä¸ä¸ªé«å¤§çèº«å½±ï¼è¡è¬ååï¼æ ¼å­è¡¬è¡£ï¼å°æè¿è¿çå»ä¼¼æ¾ç¸è¯ï¼äºæ¯åå¤§æé®éï¼âé£åè¿æ¥çäººå¯æ¯çäºå¥ï¼âå¤§æè½¬å¤´ä¸çï¼æç¶æ¯çäºå¥ï¼äºæ¯èµ·èº«æå¼éï¼âèçï¼ä½ æä¹ä¹å°è¿éæåé¢äºï¼è¿æ¥æä»¬ååä¸æ¡å§ãâçäºå¥çæ¯å¤§æåå°æï¼éå¸¸é«å´ï¼äºæ¯åå°æé®éï¼âå°åå¼ï¼ä¸æ¬¡æåå¤§æç»ä½ è®²çæ¥è¯¢ä¼åä½ è¿è®°å¾å§ï¼â\n\nå°æå¿è¯´ï¼âè®°å¾è®°å¾ï¼æç°å¨å·²ç»è·å¾äºæä»¬å®¿èçâä¼åå¨å°è½æâç§°å·ï¼ææå¤©å°±å»ä¹°ä¸ªå¥ç¶æèµ·æ¥ãä¸è¿ä»å¤©å¤§æå¥æ­£ç»æè®²è½»ééå¢ï¼çäºå¥æ¥å§ï¼å±ä»¬3ä¸ªé½æ¯ç³è¯·è¯»éçï¼å¯ä»¥ååä¸æ¡ãâ\n\nçäºå¥ç¬çåå¨å°ææè¾¹ï¼å¯¹æå¡åè¯´ï¼âç»æä¸ç¢ååæå¤§å©é¢ãâç¶åè½¬è¿å¤´è¯´ï¼âæåæå¨åä¸è¡è½¬äºå ä¸ªåï¼ä¸ä¸ªç©ºä½é½æ²¡æ¾å°ï¼å°±æ³èµ·æ¥è¿éæä¸ªé¢é¦ï¼äºæ¯å°±è¿æ¥äºãâ\n\nå°æè¯´ï¼âå¯ï¼çæ¥è¿æ¯è½»ééå¥½ï¼è¯»éå¯ä»¥ç¸å®¹ï¼ä¸åèªæéï¼èªå·±å çCPUåå°æè½¬ãâå°æä¸è¾¹è¯´ä¸è¾¹ç¨æå¨æ¡ä¸ç»äºå ä¸ªåã\n\nçäºå¥è¯´ï¼âå¯ï¼ä¸è¿æä»¬è¿äºè¯»éå·²ç»å é¢äºè¿ä¸ªæ¡å­ï¼å¦ææåéæ³æ¥ç¬å ï¼ä¹éè¦ç­æä»¬èµ°äºæè¡ï¼æä»¬åä»ä»¬ä¸ç¸å®¹åãâ\nå°ææ³äºæ³é¡¿æ¶é¢æï¼å¦ææ­¤æ¶æäººä»¥è¯»éç³è¯·è½»ééï¼èæä»¬ç³è¯·çä¹æ¯è¯»éï¼èªç¶æ¯å¯ä»¥ç´æ¥è·å¾éçï¼èå¦ææä»¬ç³è¯·çæ¯åéï¼é£ä¹å°±è¯å®åªè½ç­å¾äºãä½æ¯å¦æç°å¨æäººä»¥åéææè½»ééï¼é£ä¹æ è®ºæ¯æ°æ¥çè¯»éè¿æ¯åéï¼é½éè¦è¿å¥ç­å¾éåï¼æ³å°æ­¤å¤å°æä¸ç¦åé®éï¼âé£å¦æææéçäººéæ¾äºéï¼æä»¬åºè¯¥ä»¥ä»ä¹é¡ºåºå¤éç­å¾éåéçéå¢ï¼â\n\nçäºå¥æ³äºæ³ï¼è¯´ï¼âå¯ï¼é£è¦çæå¨ç¬¬ä¸ä¸ªçæ¯ä»ä¹éï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯åéï¼é£ä¹å°±ç´æ¥å¤éè¿ä¸ªåéï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯è¯»éï¼é£ä¹å°±å¤éç­å¾éåä¸­ææçè¯»éï¼èå¿½ç¥ç­å¾éåä¸­çåéï¼å°±åè¿æ ·ãããâè¯´çï¼çäºå¥å¨æ¡ä¸ç»äºèµ·æ¥ã\n\n![](./postgresql-lock-lwlock-implement/waitqueue.jpg) \n\n\n**å°ç»**\n\nçççäºå¥å¨æ¡ä¸çç­å¾éåå¤éå¾ï¼å°æè§å¾åºè¯¥å¯¹è½»ééæäºä¸ä¸ªåºæ¬çäºè§£ï¼ä½æ¯çªç¶èåäºä¸ä¸ªæ³æ³ï¼åæå¤§æè¯´è¿å¸¸è§éï¼é£åæ¯ææ ·å®ç°çå¢ï¼äºæ¯ä¾¿é®çäºå¥ï¼âé£å¸¸è§éææ²¡æç­å¾éåï¼âçäºå¥æ£äºä¸ä¸ï¼çªç¶å¤§ç¬éï¼âä¸æ¥ä¸æ¥ï¼æè¿ææ¬æ°ä¹¦ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãå·²ç»ä¸å¸äºï¼éé¢å¥é½æï¼æä»¬åå®å»ä¹¦åºççå§ãâ\nå¤§æåå°æç¹å¤´éï¼âæ­£ææ­¤æï¼åå»åå»ãâ\n\nè¿æ¶æå¡åæçäºå¥çé¢å·²ç»ç«¯ä¸æ¥äºï¼äºæ¯ä¸ä¸ªäººåå¼å§è¾¹åè¾¹èä¸äºä¸åçå«å¦ï¼èçº¦ç¿°ç¸é±é¢é¦ä¸­åæ¢å¤äºæ´»æ³¼çæ°æ°ã\n","slug":"postgresql-lock-lwlock-implement","published":1,"updated":"2021-07-19T23:44:11.000Z","_id":"ckrb9w1k70000g29khng9fbev","comments":1,"layout":"post","photos":[],"link":"","content":"<p>å¤§æä¸å°æèå®äºèªæéï¼å·²æ¯ä¸­åæ¶åï¼å¤§æçªç¶æ³å°æè¿æä¸æ¬è®²è§£äºå¡å¤ççæ°ä¹¦è¦ä¸å¸ï¼æ­£å¥½åå«è¦è®²ç»å°æçèªæéãè½»ééãå¸¸è§éç­åå®¹ï¼äºæ¯å¯¹å°æè¯´ï¼âæè¿ä¸å¸äºä¸æ¬æ°ä¹¦ï¼å«<strong>ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã</strong>ï¼æ¯<strong>ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã</strong>çå§å¦¹ç¯ï¼æ°å¥½æä½ æ³è¦å­¦ä¹ çåå®¹ï¼æä»¬ä¸å¦¨å»éè¿çä¹¦åºççãâ</p>\n<p>ç»è¿ä¸ä¸åçè®²è§£ï¼å°æå·²ç»ç²¾ç²åå°½ï¼è¹ä¸­ééä½åï¼å¤§æä¸ç±ç¬éï¼âå±ä»¬è¿æ¯åé¥±é¤æé¥­ï¼ç¶ååå»ä¹¦åºå§ãâ</p>\n<p>å°æææèå­ï¼ç¡®å®å·²ç»æ¯é¥¥è è¾è¾ï¼ä¾¿ç¬éï¼âåä¸äºåè®©ä½ ç ´è´¹ãâ</p>\n<a id=\"more\"></a>\n\n<p>å¤§æä»æ²åä¸å¼¹èµ·èº«å­ï¼è¾¹ç©¿å¤è¡£è¾¹éï¼âéè¿ç¾é£é¢å¤ï¼æ²å¿æçãæé½ä¸æéåºé½ä¸éï¼æä»¬è¿æ¯è¾¹èµ°è¾¹çå§ãâ</p>\n<p>å¤§æå®¶éè¿ä¸è¿æ°æä¸æ¡åä¸è¡ï¼å¨æ«æ¶é´çä¸­åï¼åä¸è¡ä¸ççææï¼äººæµç©¿æ¢­ï¼éè¿çéåºç«ç¶çº·çº·æèµ·éæ¥ï¼è¿æä¸äºéåºå·²ç»è¢«å©ç¤¼ååºï¼å é¿çå©è½¦è·¯è¿åä¸è¡ï¼èªæ¯ç­é¹éå¸¸ãå¤§æåå°æåæ¯æ¥å°æ²å¿æçï¼åç°å·²è¢«å©ç¤¼ååºï¼ç¶ååå°äºæé½ä¸æéåºï¼ç»æåºå¤æéç­åçå®¾å®¢èªè§å°æèµ·äºä¸æ¡é¿é¾ï¼ä¸åæäºæ«å´ã</p>\n<p>å¤§ææè®®éï¼âæç¥éæ­¤å¤è§è½æä¸å®¶å°åï¼åºå®¶è½å°ï¼ä½å³éä¸éï¼ä¸å¦åå»ä¸è¯ãâäºæ¯äºäººç©¿æ¢­è¿åä¸è¡è§è½çä¸ä¸ªå°å··ï¼ä¸æå«æï¼ç»äºæ¥å°ä¸å®¶å°åºé¨åï¼åºé¢è½å°ï¼ä½çä¸å»æ´æ´å¹²åï¼è£ä¿®å¤æ´ï¼å¤§å¤§çæçä¸åçééççåºåï¼èçº¦ç¿°ç¸é±é¢é¦ãä¸è¿åºé¢å¨åä¸è¡å¤çè§è½ä¸­ï¼åºä¸­çå®¢äººä¸å¤ï¼ä»æä½ä½ï¼äºäººä¾¿æ¾äºä¸ä¸ªä¸éçä½ç½®åä¸äºã</p>\n<p>å°ææ¿èµ·èåç¬éï¼âæ²¡æ³å°è¿å°å°çè§è½ä¸­ç«å§èèé¾ï¼ä¸å¦å°±åä»ä»¬è¿éçæçå¥é¤ï¼ç¸é±æå¤§å©é¢å§ï¼æè¦ä¸ä¸ªå¤§ç¢çãâå¤§æäºæ¯å¯¹æå¡åè¯´ï¼âè¦ä¸¤ä¸ªå¤§ç¢çç¸é±æå¤§å©é¢ï¼ç»ææ¿ä¸¤å¤´èãâ</p>\n<p>ç¶åå¤§æè½¬å¤´å¯¹å°æè¯´éï¼âä»å¤©çæ¯è§¦éå¤´ï¼å¥½ç¹çé¥­åºç«ç¶é½è¢«å©ç¤¼ç»ç¬å äºãâå°æä¾¿è¯´ï¼âæ²¡å³ç³»ï¼èªæéåï¼é½æ¯äºæ¥çï¼ä»ä»¬å äºï¼æä»¬å°±è¿ä¸å»ï¼ä¸è¿æä»¬å°±ä¸ç­äºï¼ç´æ¥æ¢ä¸å®¶åï¼æçç¸é±æå¤§å©é¢ä¹ä¸éãâ</p>\n<p>å¤§æè¯´éï¼âè¯´å°è¿éï¼æä»¬ä¸å¦¨åä»ç»ä¸ä¸PostgreSQLä¸­çè½»ééï¼è¿æ¯ä¸ç§æå±äº«ç²¾ç¥çéãâ</p>\n<p>âè½»ééï¼è®©ææ³æ³ï¼æå¥½æ³å¬è¯´è¿è¿ç§ç±»åçéï¼å®åèªæéä¸åï¼å®ä¸è¬ç¨äºä¿æ¤PostgreSQLä¸­å¯¹å±äº«åå­çæä½å§ï¼å®æ¯ä¸ç§è¯»åéå§ï¼â</p>\n<p><strong>è¯»åé</strong></p>\n<p>âæ¯çãâå¤§æè¾¹ç¹å¤´ä¾¿è¯´ï¼âè½»ééæéåæäºè¯»éååéï¼è¯»éåªè¯»åè®¿é®èµæºï¼å æ­¤æ¯å¯ä»¥å±äº«çï¼ä¹å°±æ¯è¯´å¯ä»¥æå¤ä¸ªè¿ç¨åæ¶è¯»å±äº«èµæºï¼èåéåæ¯æå®çï¼å ä¸ºåéçææèè¦ä¿®æ¹å±äº«èµæºä¸­çåå®¹ï¼å®çéç¸å®¹ç©éµæ¯è¿æ ·çãâè¯´çï¼å¤§æè¸äºç¹è¶æ°´ï¼å¨æ¡é¢ä¸ç»åºäºè½»ééçç¸å®¹ç©éµã</p>\n<table>\n<thead>\n<tr>\n<th>éç±»å</th>\n<th align=\"right\">è¯»é</th>\n<th align=\"center\">åé</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è¯»é</td>\n<td align=\"right\">O</td>\n<td align=\"center\">X</td>\n</tr>\n<tr>\n<td>åé</td>\n<td align=\"right\">X</td>\n<td align=\"center\">X</td>\n</tr>\n</tbody></table>\n<p>âä½ çï¼è¿å¶ä¸­Oå°±ä»£è¡¨ç¸å®¹ï¼Xå°±ä»£è¡¨äºæ¥ãâå¤§æè¾¹ç»è¾¹è¯´ã<br>å°æççæ¡é¢ä¸æ¸æ¸æ·¡å»çæ°´çï¼è¥æææçè¯´éï¼âè¿ç§éçåºç°å°±æ¯ä¸ºäºæé«å¹¶ååº¦ï¼å ä¸ºè¯»åè¯»æ¯ç¸å®¹çãå®åèªæéæ¯çä¸åå¨äºï¼èªæéæ¯äºæ¥éï¼ä¸æ¦éå®äºä¸´çåºï¼å¶ä»è®¿é®èå°±åªè½ç­äºãå®æ¯æ²¡æç­çº§æ¦å¿µçï¼å°±åªæäºæ¥ä¸ç§æåµï¼èè½»ééæå¯¹å±äº«èµæºçè®¿é®ååæäº2ä¸ªç­çº§ï¼ä¸ä¸ªç­çº§æ¯è¯»ï¼ä¸ä¸ªç­çº§æ¯åï¼è¿æ ·éçç²åº¦å°±æ´ç»äºãâ</p>\n<p>å¤§æç¹äºç¹å¤´è¯´éï¼âè¯´å¾å¥½ï¼ä½æä»¬è¿æ¯å°½éä¸è¦æè½»ééåèªæéæ··ä¸ºä¸è°ï¼å®ä»¬çç®çä¸åï¼å®éä¸å¨æ©æçPostgreSQLä¸­ï¼è½»ééæ¯åå©èªæéå®ç°çãâ</p>\n<p>å°ææå¥éï¼âåå©èªæéå®ç°ç?â</p>\n<p>âå¯ï¼æä»¬å¨å®ç°èªæéçæ¶åï¼åå©CPUæä¾çåè¯­å®ç°äºå¯¹ä¸ä¸ªå±äº«åéçåå­æä½ï¼æä»¥æä»¬å°±å¯ä»¥æ ¹æ®è¿ä¸ªå±äº«åéçç¶ææ¥å³å®æä»¬æ¯ä¸æ¯å¯ä»¥è¿å¥ä¸´çåºãâå¤§æåé¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´ï¼âè½»ééçå®ç°ä¹æ å¤ä¹å¦æ­¤ï¼åªä¸è¿å®çç¶æå¤äºï¼ç¨ä¸ä¸ªåéä¸å¥½ä¿å­ï¼äºæ¯å°±ç¨èªæéæ¥å®ç°å¯¹è¿äºåéçä¿æ¤ãâ</p>\n<p>å°æç¹ç¹å¤´è¯´éï¼âå¯ï¼å¨è®²è§£èªæéçæ¶åä½ æ¾ç»è¯´è¿ï¼èªæéä¸è¬åªä¿æ¤å¾å°çä¸´çåºï¼æä»¥å¯ä»¥å¿ç­ï¼ä¹å°±æ¯è¯´ç¨èªæéæ¥å®ç°è½»ééçæ¶åï¼ä¿æ¤å±äº«ç¶æçä¸´çåºä¹ä¸å®éå¸¸å°ï¼ä¸ç¶å°±æ²¡æåæ³ç¨èªæéæ¥å®ç°è½»ééäºå§ãâ</p>\n<p><strong>äºæåçäºåå</strong></p>\n<p>å¤§æç±äºç±çè¯´éï¼âæ¯çï¼ä¹æ­£å ä¸ºå¦æ­¤ï¼äºæå·²ç»åçååï¼æä»¬ä»¥åå¯ä»¥è¯´PostgreSQLç¨èªæéæ¥å®ç°äºè½»ééï¼ä½æ¯ç°å¨ä¸è½è¿ä¹è¯´äºãâ</p>\n<p>âä¸ºä»ä¹ï¼â</p>\n<p>âå¨ä¹åçPostgreSQLçæ¬ä¸­ï¼è½»ééçéç»æä¸­æå ä¸ªåéç¨æ¥è®°å½å½åéçç¶æï¼æ¯å¦ï¼å±äº«éå¯ä»¥ç±å¤ä¸ªè®¿é®èå±äº«ï¼æä»¬å°±å¯ä»¥ç¨ä¸ä¸ªåéæ¥è®°å½ç®åæå¤å°ä¸ªè®¿é®èå±äº«è¿ä¸ªéï¼æ¯å¦æå®éå·æäºæ¥æ§ï¼æä»¬å°±éç¨ä¸ä¸ªåéæ¥æ è¯å½åè°è·å¾äºæå®éãæç»æ ¹æ®è¿äºç¶æå°±å¯ä»¥å¤æ­æ°çè®¿é®èæ¯å¦å¯ä»¥è·å¾éï¼ä½è¿éæä¸¤ä¸ªé®é¢ãâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âä¸ä¸ªé®é¢æ¯è½»ééçè·ååéæ¾ç¹å«é¢ç¹ï¼å¦ä¸ä¸ªé®é¢æ¯è¿æ¬¡èªæéä¿æ¤çä¸´çåºæç¹å¤§äºï¼æè¿ä¸¤ä¸ªé®é¢ç»¼åå°ä¸èµ·å°±æ¯ï¼è¿éç¨èªæéä¿æ¤ä¸´çåºï¼éä½äºPostgreSQLçæ§è½ãâ</p>\n<p>âæå¬ä½ åæè¯´çï¼å¥½åæ¯æç¹æµªè´¹ï¼æ¯å¦æå®éçç¶æå§ï¼æä»¬åªéè¦ä¸ä¸ª0å1çç¶æå°±å¯ä»¥äºï¼ç¨ä¸ä¸ªå­èæ¥æ è¯é½å«å¤ï¼èå±äº«éçè®¡æ°ææ³ä¹ä¸ä¼è¾¾å°2^32æ¬¡æ¹ï¼æä»¥ç¨ä¸ä¸ª4å­èçintæ¥è¡¨ç¤ºï¼ä¹å®å¨æ¯ä¸ç§æµªè´¹ï¼æçå¯ä»¥æè¿äºç¶æç¨bitä½æ¥æ è¯ï¼å®å¨å°±å¯ä»¥äºãâå°æç¥æææçè¯´éã</p>\n<p>å¤§æèµèµçè¯´ï¼âå®å¨æ­£ç¡®ãâ</p>\n<p>è¿æ¶åæå¡åæç¸é±æå¤§å©é¢å·²ç»ç«¯ä¸æ¥äºï¼ä¸¤ä¸ªäººé¡¾ä¸ä¸åæ¥çè¯´è½»ééï¼å¼å§åèµ·æ¥ï¼å°æä¸è¾¹åä¸è¾¹æ³æä¹åççåéè½»ééç¶æçbitä½ï¼å¯¹äºæå®éèè¨ï¼åªéè¦ä¸ä¸ªbitå°±å¤äºï¼èå±äº«éçè®¡æ°å¢ï¼éè¦åéå¤å°ä¸ªå¢ï¼</p>\n<p>å¤§æå¿«éçåäºå å£é¢ï¼ç¶åç¨è¸çæ°´å¨æ¡å­ä¸ç»äºèµ·æ¥ï¼âç®åè½»ééç¶æçå¸å±æ¯è¿æ ·çãâ</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/lockstate.jpg\"> </p>\n<p>å°æèµè®¸çè¯´ï¼âå¯ï¼ç¨24ä¸ªbitä½åè®¡æ°ï¼åºè¯¥æ¯å¤å¤äºãç°å¨é½åæ¬¢ç¨æ éç¼ç¨ï¼é£ä¹è¿ä¹ä¸ä¸ªåéçä¿æ¤ä¹å°±æ²¡æå¿è¦åä½¿ç¨èªæéæ¥ä¿æ¤äºï¼åªè¦èªå·±å®ç°ä¸ä¸ªCASçåè¯­å°±å¤äºãâ</p>\n<p>âå¯¹ï¼æ­£æ¯è¿æ ·å®ç°çï¼è¿æ ·å°±è§£å³äºå¹¶åçé®é¢ãâ</p>\n<p><strong>ä¿æ¤çä¹ä¸å¤§</strong></p>\n<p>å°ææ³äºæ³ï¼ç»§ç»­è¯´éï¼âé£æ¢ç¶å·²ç»ä¸ç¨èªæéå®ç°è½»ééäºï¼é£èªæéæ¯ä¸æ¯å°±å¿«è¦éä¼äºå¢ï¼â</p>\n<p>å¤§æåäºä¸å£å¤§èç¶åè¯´éï¼âæè®¸å§ï¼ä½ç®åèªæéè¿æ¯æäºç¨å¤çï¼ç°å¨è¯´è¦éä¼è¿ä¸ºæ¶å°æ©ãèè½»ééå¢ï¼ä¹æå®èªå·±çé®é¢ï¼å®ä¹æä»¥å«è½»ééï¼åå å°±æ¯å®ä¹ææèªå·±ä¿æ¤çä¸´çåºä¸å¤ªâå¤§âï¼è½ç¶æªå¿å¦èªæéé£æ ·ï¼åªéè¦å¾å°çCPUæ¶éå¨æï¼ä½å¦æè½»ééä¿æ¤çä¸´çåºå¤ªå¤æï¼ä»ç¶å¯è½å¸¦æ¥æ§è½é®é¢ãæå°±æ¾ç»ç¯è¿ä¸ä¸ªéè¯¯ï¼å¨è½»ééä¿æ¤çä¸´çåºä¸­å å¥äºå¤ªå¤çæ°ä»£ç ï¼æç»å¯¼è´æ°æ®åºè¿æ¥ä¸ä¸ãããâ</p>\n<p>âå¯æ¯ï¼è½»ééä¸­ä¸æ¯æè¯»éåï¼é£è¿ä¸å¤åï¼â</p>\n<p>âPostgreSQLä¸­åå±äº«åå­ç¶æçæåµä¹ä¸å°ï¼å æ­¤å¹¶ä¸æ¯æéçç¶æåç¦»æä¸¤ä¸ªç­çº§ä¹åå°±è½è§£å³ä¸åé®é¢ï¼å-åä¹é´ãå-è¯»ä¹é´ä»ç¶æ¯äºæ¥çï¼æä»¥ä½¿ç¨è½»ééçæ¶åä»ç¶è¦è°¨è®°ï¼è½»ééä¿æ¤çåºé´ä¸è½å¤ªå¤§ãè¿å°±å¥½åææ¸¸åºçå¬åä¸æ ·ï¼è½ç¶ä½ ç¬å äºé©¬æ¡¶ï¼ä½æ¯è¯·å¿«éè§£å³é®é¢ï¼ä¸ç¶å¤è¾¹çç­å¾éåå¤ªé¿ï¼ä¹ä¼é ææ¥å µãâ</p>\n<p>å¬å¤§æè¯´èµ·äºææ¸¸åºçé©¬æ¡¶ï¼å°æé¡¿æ¶è§å¾å£ä¸­çé¢é¾ä»¥ä¸å½ï¼äºæ¯é®éï¼âå¯ï¼è½»ééè¿ä¼æéï¼çæ¥è¿åèªæéä¸ä¸æ ·ï¼èªæéå¥½åæ²¡æç­å¾éåå³ï¼â</p>\n<p><strong>ç­å¾éå</strong></p>\n<p>å¤§æåäºä¸å£é¢ç»§ç»­è¯´éï¼âå¯ï¼ç¡®å®æ¯è¿æ ·ï¼èªæéæ¯æ²¡æéåçï¼ä½æ¯è½»ééæç­å¾éåãæ¯å¦ï¼ç°å¨æè¿ç¨å·²ç»ä»¥å±äº«ç¶æææäºä¸ä¸ªè½»ééï¼é£ä¹æ³è¦ææäºæ¥éçè¿ç¨è¯å®æ¯åªè½è¿ç­å¾éåäºãâ</p>\n<p>âå¦æè¿æ¶ååæ¥ä¸ä¸ªè¿ç¨æ³è¦ææå±äº«éå¢ï¼æ¯è®²ç©¶åæ¥åå°çè¿å¥ç­å¾éåï¼è¿æ¯ç´æ¥è·å¾å±äº«éï¼â</p>\n<p>âå¯ï¼å¥½é®é¢ï¼è¿å°±æ¯è½»ééåå¸¸è§éçä¸åãâ</p>\n<p>âå¸¸è§éï¼â</p>\n<p>âå°±æ¯è¡¨çº§éåï¼è½»ééå¨è¿ç§æåµä¸ï¼å±äº«éå°±å¯ä»¥ç´æ¥è·åäºï¼ä½æ¯å¸¸è§éå¯è½å°±éè¦è¿ç­å¾éåå½ï¼â</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/sxlock.jpg\"> </p>\n<p><strong>å¤é</strong></p>\n<p>è¿æ¶åºå¤è¿æ¥ä¸ä¸ªé«å¤§çèº«å½±ï¼è¡è¬ååï¼æ ¼å­è¡¬è¡£ï¼å°æè¿è¿çå»ä¼¼æ¾ç¸è¯ï¼äºæ¯åå¤§æé®éï¼âé£åè¿æ¥çäººå¯æ¯çäºå¥ï¼âå¤§æè½¬å¤´ä¸çï¼æç¶æ¯çäºå¥ï¼äºæ¯èµ·èº«æå¼éï¼âèçï¼ä½ æä¹ä¹å°è¿éæåé¢äºï¼è¿æ¥æä»¬ååä¸æ¡å§ãâçäºå¥çæ¯å¤§æåå°æï¼éå¸¸é«å´ï¼äºæ¯åå°æé®éï¼âå°åå¼ï¼ä¸æ¬¡æåå¤§æç»ä½ è®²çæ¥è¯¢ä¼åä½ è¿è®°å¾å§ï¼â</p>\n<p>å°æå¿è¯´ï¼âè®°å¾è®°å¾ï¼æç°å¨å·²ç»è·å¾äºæä»¬å®¿èçâä¼åå¨å°è½æâç§°å·ï¼ææå¤©å°±å»ä¹°ä¸ªå¥ç¶æèµ·æ¥ãä¸è¿ä»å¤©å¤§æå¥æ­£ç»æè®²è½»ééå¢ï¼çäºå¥æ¥å§ï¼å±ä»¬3ä¸ªé½æ¯ç³è¯·è¯»éçï¼å¯ä»¥ååä¸æ¡ãâ</p>\n<p>çäºå¥ç¬çåå¨å°ææè¾¹ï¼å¯¹æå¡åè¯´ï¼âç»æä¸ç¢ååæå¤§å©é¢ãâç¶åè½¬è¿å¤´è¯´ï¼âæåæå¨åä¸è¡è½¬äºå ä¸ªåï¼ä¸ä¸ªç©ºä½é½æ²¡æ¾å°ï¼å°±æ³èµ·æ¥è¿éæä¸ªé¢é¦ï¼äºæ¯å°±è¿æ¥äºãâ</p>\n<p>å°æè¯´ï¼âå¯ï¼çæ¥è¿æ¯è½»ééå¥½ï¼è¯»éå¯ä»¥ç¸å®¹ï¼ä¸åèªæéï¼èªå·±å çCPUåå°æè½¬ãâå°æä¸è¾¹è¯´ä¸è¾¹ç¨æå¨æ¡ä¸ç»äºå ä¸ªåã</p>\n<p>çäºå¥è¯´ï¼âå¯ï¼ä¸è¿æä»¬è¿äºè¯»éå·²ç»å é¢äºè¿ä¸ªæ¡å­ï¼å¦ææåéæ³æ¥ç¬å ï¼ä¹éè¦ç­æä»¬èµ°äºæè¡ï¼æä»¬åä»ä»¬ä¸ç¸å®¹åãâ<br>å°ææ³äºæ³é¡¿æ¶é¢æï¼å¦ææ­¤æ¶æäººä»¥è¯»éç³è¯·è½»ééï¼èæä»¬ç³è¯·çä¹æ¯è¯»éï¼èªç¶æ¯å¯ä»¥ç´æ¥è·å¾éçï¼èå¦ææä»¬ç³è¯·çæ¯åéï¼é£ä¹å°±è¯å®åªè½ç­å¾äºãä½æ¯å¦æç°å¨æäººä»¥åéææè½»ééï¼é£ä¹æ è®ºæ¯æ°æ¥çè¯»éè¿æ¯åéï¼é½éè¦è¿å¥ç­å¾éåï¼æ³å°æ­¤å¤å°æä¸ç¦åé®éï¼âé£å¦æææéçäººéæ¾äºéï¼æä»¬åºè¯¥ä»¥ä»ä¹é¡ºåºå¤éç­å¾éåéçéå¢ï¼â</p>\n<p>çäºå¥æ³äºæ³ï¼è¯´ï¼âå¯ï¼é£è¦çæå¨ç¬¬ä¸ä¸ªçæ¯ä»ä¹éï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯åéï¼é£ä¹å°±ç´æ¥å¤éè¿ä¸ªåéï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯è¯»éï¼é£ä¹å°±å¤éç­å¾éåä¸­ææçè¯»éï¼èå¿½ç¥ç­å¾éåä¸­çåéï¼å°±åè¿æ ·ãããâè¯´çï¼çäºå¥å¨æ¡ä¸ç»äºèµ·æ¥ã</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/waitqueue.jpg\"> </p>\n<p><strong>å°ç»</strong></p>\n<p>çççäºå¥å¨æ¡ä¸çç­å¾éåå¤éå¾ï¼å°æè§å¾åºè¯¥å¯¹è½»ééæäºä¸ä¸ªåºæ¬çäºè§£ï¼ä½æ¯çªç¶èåäºä¸ä¸ªæ³æ³ï¼åæå¤§æè¯´è¿å¸¸è§éï¼é£åæ¯ææ ·å®ç°çå¢ï¼äºæ¯ä¾¿é®çäºå¥ï¼âé£å¸¸è§éææ²¡æç­å¾éåï¼âçäºå¥æ£äºä¸ä¸ï¼çªç¶å¤§ç¬éï¼âä¸æ¥ä¸æ¥ï¼æè¿ææ¬æ°ä¹¦ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãå·²ç»ä¸å¸äºï¼éé¢å¥é½æï¼æä»¬åå®å»ä¹¦åºççå§ãâ<br>å¤§æåå°æç¹å¤´éï¼âæ­£ææ­¤æï¼åå»åå»ãâ</p>\n<p>è¿æ¶æå¡åæçäºå¥çé¢å·²ç»ç«¯ä¸æ¥äºï¼äºæ¯ä¸ä¸ªäººåå¼å§è¾¹åè¾¹èä¸äºä¸åçå«å¦ï¼èçº¦ç¿°ç¸é±é¢é¦ä¸­åæ¢å¤äºæ´»æ³¼çæ°æ°ã</p>\n","site":{"data":{}},"excerpt":"<p>å¤§æä¸å°æèå®äºèªæéï¼å·²æ¯ä¸­åæ¶åï¼å¤§æçªç¶æ³å°æè¿æä¸æ¬è®²è§£äºå¡å¤ççæ°ä¹¦è¦ä¸å¸ï¼æ­£å¥½åå«è¦è®²ç»å°æçèªæéãè½»ééãå¸¸è§éç­åå®¹ï¼äºæ¯å¯¹å°æè¯´ï¼âæè¿ä¸å¸äºä¸æ¬æ°ä¹¦ï¼å«<strong>ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ã</strong>ï¼æ¯<strong>ãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ã</strong>çå§å¦¹ç¯ï¼æ°å¥½æä½ æ³è¦å­¦ä¹ çåå®¹ï¼æä»¬ä¸å¦¨å»éè¿çä¹¦åºççãâ</p>\n<p>ç»è¿ä¸ä¸åçè®²è§£ï¼å°æå·²ç»ç²¾ç²åå°½ï¼è¹ä¸­ééä½åï¼å¤§æä¸ç±ç¬éï¼âå±ä»¬è¿æ¯åé¥±é¤æé¥­ï¼ç¶ååå»ä¹¦åºå§ãâ</p>\n<p>å°æææèå­ï¼ç¡®å®å·²ç»æ¯é¥¥è è¾è¾ï¼ä¾¿ç¬éï¼âåä¸äºåè®©ä½ ç ´è´¹ãâ</p>","more":"<p>å¤§æä»æ²åä¸å¼¹èµ·èº«å­ï¼è¾¹ç©¿å¤è¡£è¾¹éï¼âéè¿ç¾é£é¢å¤ï¼æ²å¿æçãæé½ä¸æéåºé½ä¸éï¼æä»¬è¿æ¯è¾¹èµ°è¾¹çå§ãâ</p>\n<p>å¤§æå®¶éè¿ä¸è¿æ°æä¸æ¡åä¸è¡ï¼å¨æ«æ¶é´çä¸­åï¼åä¸è¡ä¸ççææï¼äººæµç©¿æ¢­ï¼éè¿çéåºç«ç¶çº·çº·æèµ·éæ¥ï¼è¿æä¸äºéåºå·²ç»è¢«å©ç¤¼ååºï¼å é¿çå©è½¦è·¯è¿åä¸è¡ï¼èªæ¯ç­é¹éå¸¸ãå¤§æåå°æåæ¯æ¥å°æ²å¿æçï¼åç°å·²è¢«å©ç¤¼ååºï¼ç¶ååå°äºæé½ä¸æéåºï¼ç»æåºå¤æéç­åçå®¾å®¢èªè§å°æèµ·äºä¸æ¡é¿é¾ï¼ä¸åæäºæ«å´ã</p>\n<p>å¤§ææè®®éï¼âæç¥éæ­¤å¤è§è½æä¸å®¶å°åï¼åºå®¶è½å°ï¼ä½å³éä¸éï¼ä¸å¦åå»ä¸è¯ãâäºæ¯äºäººç©¿æ¢­è¿åä¸è¡è§è½çä¸ä¸ªå°å··ï¼ä¸æå«æï¼ç»äºæ¥å°ä¸å®¶å°åºé¨åï¼åºé¢è½å°ï¼ä½çä¸å»æ´æ´å¹²åï¼è£ä¿®å¤æ´ï¼å¤§å¤§çæçä¸åçééççåºåï¼èçº¦ç¿°ç¸é±é¢é¦ãä¸è¿åºé¢å¨åä¸è¡å¤çè§è½ä¸­ï¼åºä¸­çå®¢äººä¸å¤ï¼ä»æä½ä½ï¼äºäººä¾¿æ¾äºä¸ä¸ªä¸éçä½ç½®åä¸äºã</p>\n<p>å°ææ¿èµ·èåç¬éï¼âæ²¡æ³å°è¿å°å°çè§è½ä¸­ç«å§èèé¾ï¼ä¸å¦å°±åä»ä»¬è¿éçæçå¥é¤ï¼ç¸é±æå¤§å©é¢å§ï¼æè¦ä¸ä¸ªå¤§ç¢çãâå¤§æäºæ¯å¯¹æå¡åè¯´ï¼âè¦ä¸¤ä¸ªå¤§ç¢çç¸é±æå¤§å©é¢ï¼ç»ææ¿ä¸¤å¤´èãâ</p>\n<p>ç¶åå¤§æè½¬å¤´å¯¹å°æè¯´éï¼âä»å¤©çæ¯è§¦éå¤´ï¼å¥½ç¹çé¥­åºç«ç¶é½è¢«å©ç¤¼ç»ç¬å äºãâå°æä¾¿è¯´ï¼âæ²¡å³ç³»ï¼èªæéåï¼é½æ¯äºæ¥çï¼ä»ä»¬å äºï¼æä»¬å°±è¿ä¸å»ï¼ä¸è¿æä»¬å°±ä¸ç­äºï¼ç´æ¥æ¢ä¸å®¶åï¼æçç¸é±æå¤§å©é¢ä¹ä¸éãâ</p>\n<p>å¤§æè¯´éï¼âè¯´å°è¿éï¼æä»¬ä¸å¦¨åä»ç»ä¸ä¸PostgreSQLä¸­çè½»ééï¼è¿æ¯ä¸ç§æå±äº«ç²¾ç¥çéãâ</p>\n<p>âè½»ééï¼è®©ææ³æ³ï¼æå¥½æ³å¬è¯´è¿è¿ç§ç±»åçéï¼å®åèªæéä¸åï¼å®ä¸è¬ç¨äºä¿æ¤PostgreSQLä¸­å¯¹å±äº«åå­çæä½å§ï¼å®æ¯ä¸ç§è¯»åéå§ï¼â</p>\n<p><strong>è¯»åé</strong></p>\n<p>âæ¯çãâå¤§æè¾¹ç¹å¤´ä¾¿è¯´ï¼âè½»ééæéåæäºè¯»éååéï¼è¯»éåªè¯»åè®¿é®èµæºï¼å æ­¤æ¯å¯ä»¥å±äº«çï¼ä¹å°±æ¯è¯´å¯ä»¥æå¤ä¸ªè¿ç¨åæ¶è¯»å±äº«èµæºï¼èåéåæ¯æå®çï¼å ä¸ºåéçææèè¦ä¿®æ¹å±äº«èµæºä¸­çåå®¹ï¼å®çéç¸å®¹ç©éµæ¯è¿æ ·çãâè¯´çï¼å¤§æè¸äºç¹è¶æ°´ï¼å¨æ¡é¢ä¸ç»åºäºè½»ééçç¸å®¹ç©éµã</p>\n<table>\n<thead>\n<tr>\n<th>éç±»å</th>\n<th align=\"right\">è¯»é</th>\n<th align=\"center\">åé</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>è¯»é</td>\n<td align=\"right\">O</td>\n<td align=\"center\">X</td>\n</tr>\n<tr>\n<td>åé</td>\n<td align=\"right\">X</td>\n<td align=\"center\">X</td>\n</tr>\n</tbody></table>\n<p>âä½ çï¼è¿å¶ä¸­Oå°±ä»£è¡¨ç¸å®¹ï¼Xå°±ä»£è¡¨äºæ¥ãâå¤§æè¾¹ç»è¾¹è¯´ã<br>å°æççæ¡é¢ä¸æ¸æ¸æ·¡å»çæ°´çï¼è¥æææçè¯´éï¼âè¿ç§éçåºç°å°±æ¯ä¸ºäºæé«å¹¶ååº¦ï¼å ä¸ºè¯»åè¯»æ¯ç¸å®¹çãå®åèªæéæ¯çä¸åå¨äºï¼èªæéæ¯äºæ¥éï¼ä¸æ¦éå®äºä¸´çåºï¼å¶ä»è®¿é®èå°±åªè½ç­äºãå®æ¯æ²¡æç­çº§æ¦å¿µçï¼å°±åªæäºæ¥ä¸ç§æåµï¼èè½»ééæå¯¹å±äº«èµæºçè®¿é®ååæäº2ä¸ªç­çº§ï¼ä¸ä¸ªç­çº§æ¯è¯»ï¼ä¸ä¸ªç­çº§æ¯åï¼è¿æ ·éçç²åº¦å°±æ´ç»äºãâ</p>\n<p>å¤§æç¹äºç¹å¤´è¯´éï¼âè¯´å¾å¥½ï¼ä½æä»¬è¿æ¯å°½éä¸è¦æè½»ééåèªæéæ··ä¸ºä¸è°ï¼å®ä»¬çç®çä¸åï¼å®éä¸å¨æ©æçPostgreSQLä¸­ï¼è½»ééæ¯åå©èªæéå®ç°çãâ</p>\n<p>å°ææå¥éï¼âåå©èªæéå®ç°ç?â</p>\n<p>âå¯ï¼æä»¬å¨å®ç°èªæéçæ¶åï¼åå©CPUæä¾çåè¯­å®ç°äºå¯¹ä¸ä¸ªå±äº«åéçåå­æä½ï¼æä»¥æä»¬å°±å¯ä»¥æ ¹æ®è¿ä¸ªå±äº«åéçç¶ææ¥å³å®æä»¬æ¯ä¸æ¯å¯ä»¥è¿å¥ä¸´çåºãâå¤§æåé¡¿äºä¸ä¸ï¼ç¶åç»§ç»­è¯´ï¼âè½»ééçå®ç°ä¹æ å¤ä¹å¦æ­¤ï¼åªä¸è¿å®çç¶æå¤äºï¼ç¨ä¸ä¸ªåéä¸å¥½ä¿å­ï¼äºæ¯å°±ç¨èªæéæ¥å®ç°å¯¹è¿äºåéçä¿æ¤ãâ</p>\n<p>å°æç¹ç¹å¤´è¯´éï¼âå¯ï¼å¨è®²è§£èªæéçæ¶åä½ æ¾ç»è¯´è¿ï¼èªæéä¸è¬åªä¿æ¤å¾å°çä¸´çåºï¼æä»¥å¯ä»¥å¿ç­ï¼ä¹å°±æ¯è¯´ç¨èªæéæ¥å®ç°è½»ééçæ¶åï¼ä¿æ¤å±äº«ç¶æçä¸´çåºä¹ä¸å®éå¸¸å°ï¼ä¸ç¶å°±æ²¡æåæ³ç¨èªæéæ¥å®ç°è½»ééäºå§ãâ</p>\n<p><strong>äºæåçäºåå</strong></p>\n<p>å¤§æç±äºç±çè¯´éï¼âæ¯çï¼ä¹æ­£å ä¸ºå¦æ­¤ï¼äºæå·²ç»åçååï¼æä»¬ä»¥åå¯ä»¥è¯´PostgreSQLç¨èªæéæ¥å®ç°äºè½»ééï¼ä½æ¯ç°å¨ä¸è½è¿ä¹è¯´äºãâ</p>\n<p>âä¸ºä»ä¹ï¼â</p>\n<p>âå¨ä¹åçPostgreSQLçæ¬ä¸­ï¼è½»ééçéç»æä¸­æå ä¸ªåéç¨æ¥è®°å½å½åéçç¶æï¼æ¯å¦ï¼å±äº«éå¯ä»¥ç±å¤ä¸ªè®¿é®èå±äº«ï¼æä»¬å°±å¯ä»¥ç¨ä¸ä¸ªåéæ¥è®°å½ç®åæå¤å°ä¸ªè®¿é®èå±äº«è¿ä¸ªéï¼æ¯å¦æå®éå·æäºæ¥æ§ï¼æä»¬å°±éç¨ä¸ä¸ªåéæ¥æ è¯å½åè°è·å¾äºæå®éãæç»æ ¹æ®è¿äºç¶æå°±å¯ä»¥å¤æ­æ°çè®¿é®èæ¯å¦å¯ä»¥è·å¾éï¼ä½è¿éæä¸¤ä¸ªé®é¢ãâå¤§æåé¡¿äºä¸ä¸ï¼ç»§ç»­è¯´éï¼âä¸ä¸ªé®é¢æ¯è½»ééçè·ååéæ¾ç¹å«é¢ç¹ï¼å¦ä¸ä¸ªé®é¢æ¯è¿æ¬¡èªæéä¿æ¤çä¸´çåºæç¹å¤§äºï¼æè¿ä¸¤ä¸ªé®é¢ç»¼åå°ä¸èµ·å°±æ¯ï¼è¿éç¨èªæéä¿æ¤ä¸´çåºï¼éä½äºPostgreSQLçæ§è½ãâ</p>\n<p>âæå¬ä½ åæè¯´çï¼å¥½åæ¯æç¹æµªè´¹ï¼æ¯å¦æå®éçç¶æå§ï¼æä»¬åªéè¦ä¸ä¸ª0å1çç¶æå°±å¯ä»¥äºï¼ç¨ä¸ä¸ªå­èæ¥æ è¯é½å«å¤ï¼èå±äº«éçè®¡æ°ææ³ä¹ä¸ä¼è¾¾å°2^32æ¬¡æ¹ï¼æä»¥ç¨ä¸ä¸ª4å­èçintæ¥è¡¨ç¤ºï¼ä¹å®å¨æ¯ä¸ç§æµªè´¹ï¼æçå¯ä»¥æè¿äºç¶æç¨bitä½æ¥æ è¯ï¼å®å¨å°±å¯ä»¥äºãâå°æç¥æææçè¯´éã</p>\n<p>å¤§æèµèµçè¯´ï¼âå®å¨æ­£ç¡®ãâ</p>\n<p>è¿æ¶åæå¡åæç¸é±æå¤§å©é¢å·²ç»ç«¯ä¸æ¥äºï¼ä¸¤ä¸ªäººé¡¾ä¸ä¸åæ¥çè¯´è½»ééï¼å¼å§åèµ·æ¥ï¼å°æä¸è¾¹åä¸è¾¹æ³æä¹åççåéè½»ééç¶æçbitä½ï¼å¯¹äºæå®éèè¨ï¼åªéè¦ä¸ä¸ªbitå°±å¤äºï¼èå±äº«éçè®¡æ°å¢ï¼éè¦åéå¤å°ä¸ªå¢ï¼</p>\n<p>å¤§æå¿«éçåäºå å£é¢ï¼ç¶åç¨è¸çæ°´å¨æ¡å­ä¸ç»äºèµ·æ¥ï¼âç®åè½»ééç¶æçå¸å±æ¯è¿æ ·çãâ</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/lockstate.jpg\"> </p>\n<p>å°æèµè®¸çè¯´ï¼âå¯ï¼ç¨24ä¸ªbitä½åè®¡æ°ï¼åºè¯¥æ¯å¤å¤äºãç°å¨é½åæ¬¢ç¨æ éç¼ç¨ï¼é£ä¹è¿ä¹ä¸ä¸ªåéçä¿æ¤ä¹å°±æ²¡æå¿è¦åä½¿ç¨èªæéæ¥ä¿æ¤äºï¼åªè¦èªå·±å®ç°ä¸ä¸ªCASçåè¯­å°±å¤äºãâ</p>\n<p>âå¯¹ï¼æ­£æ¯è¿æ ·å®ç°çï¼è¿æ ·å°±è§£å³äºå¹¶åçé®é¢ãâ</p>\n<p><strong>ä¿æ¤çä¹ä¸å¤§</strong></p>\n<p>å°ææ³äºæ³ï¼ç»§ç»­è¯´éï¼âé£æ¢ç¶å·²ç»ä¸ç¨èªæéå®ç°è½»ééäºï¼é£èªæéæ¯ä¸æ¯å°±å¿«è¦éä¼äºå¢ï¼â</p>\n<p>å¤§æåäºä¸å£å¤§èç¶åè¯´éï¼âæè®¸å§ï¼ä½ç®åèªæéè¿æ¯æäºç¨å¤çï¼ç°å¨è¯´è¦éä¼è¿ä¸ºæ¶å°æ©ãèè½»ééå¢ï¼ä¹æå®èªå·±çé®é¢ï¼å®ä¹æä»¥å«è½»ééï¼åå å°±æ¯å®ä¹ææèªå·±ä¿æ¤çä¸´çåºä¸å¤ªâå¤§âï¼è½ç¶æªå¿å¦èªæéé£æ ·ï¼åªéè¦å¾å°çCPUæ¶éå¨æï¼ä½å¦æè½»ééä¿æ¤çä¸´çåºå¤ªå¤æï¼ä»ç¶å¯è½å¸¦æ¥æ§è½é®é¢ãæå°±æ¾ç»ç¯è¿ä¸ä¸ªéè¯¯ï¼å¨è½»ééä¿æ¤çä¸´çåºä¸­å å¥äºå¤ªå¤çæ°ä»£ç ï¼æç»å¯¼è´æ°æ®åºè¿æ¥ä¸ä¸ãããâ</p>\n<p>âå¯æ¯ï¼è½»ééä¸­ä¸æ¯æè¯»éåï¼é£è¿ä¸å¤åï¼â</p>\n<p>âPostgreSQLä¸­åå±äº«åå­ç¶æçæåµä¹ä¸å°ï¼å æ­¤å¹¶ä¸æ¯æéçç¶æåç¦»æä¸¤ä¸ªç­çº§ä¹åå°±è½è§£å³ä¸åé®é¢ï¼å-åä¹é´ãå-è¯»ä¹é´ä»ç¶æ¯äºæ¥çï¼æä»¥ä½¿ç¨è½»ééçæ¶åä»ç¶è¦è°¨è®°ï¼è½»ééä¿æ¤çåºé´ä¸è½å¤ªå¤§ãè¿å°±å¥½åææ¸¸åºçå¬åä¸æ ·ï¼è½ç¶ä½ ç¬å äºé©¬æ¡¶ï¼ä½æ¯è¯·å¿«éè§£å³é®é¢ï¼ä¸ç¶å¤è¾¹çç­å¾éåå¤ªé¿ï¼ä¹ä¼é ææ¥å µãâ</p>\n<p>å¬å¤§æè¯´èµ·äºææ¸¸åºçé©¬æ¡¶ï¼å°æé¡¿æ¶è§å¾å£ä¸­çé¢é¾ä»¥ä¸å½ï¼äºæ¯é®éï¼âå¯ï¼è½»ééè¿ä¼æéï¼çæ¥è¿åèªæéä¸ä¸æ ·ï¼èªæéå¥½åæ²¡æç­å¾éåå³ï¼â</p>\n<p><strong>ç­å¾éå</strong></p>\n<p>å¤§æåäºä¸å£é¢ç»§ç»­è¯´éï¼âå¯ï¼ç¡®å®æ¯è¿æ ·ï¼èªæéæ¯æ²¡æéåçï¼ä½æ¯è½»ééæç­å¾éåãæ¯å¦ï¼ç°å¨æè¿ç¨å·²ç»ä»¥å±äº«ç¶æææäºä¸ä¸ªè½»ééï¼é£ä¹æ³è¦ææäºæ¥éçè¿ç¨è¯å®æ¯åªè½è¿ç­å¾éåäºãâ</p>\n<p>âå¦æè¿æ¶ååæ¥ä¸ä¸ªè¿ç¨æ³è¦ææå±äº«éå¢ï¼æ¯è®²ç©¶åæ¥åå°çè¿å¥ç­å¾éåï¼è¿æ¯ç´æ¥è·å¾å±äº«éï¼â</p>\n<p>âå¯ï¼å¥½é®é¢ï¼è¿å°±æ¯è½»ééåå¸¸è§éçä¸åãâ</p>\n<p>âå¸¸è§éï¼â</p>\n<p>âå°±æ¯è¡¨çº§éåï¼è½»ééå¨è¿ç§æåµä¸ï¼å±äº«éå°±å¯ä»¥ç´æ¥è·åäºï¼ä½æ¯å¸¸è§éå¯è½å°±éè¦è¿ç­å¾éåå½ï¼â</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/sxlock.jpg\"> </p>\n<p><strong>å¤é</strong></p>\n<p>è¿æ¶åºå¤è¿æ¥ä¸ä¸ªé«å¤§çèº«å½±ï¼è¡è¬ååï¼æ ¼å­è¡¬è¡£ï¼å°æè¿è¿çå»ä¼¼æ¾ç¸è¯ï¼äºæ¯åå¤§æé®éï¼âé£åè¿æ¥çäººå¯æ¯çäºå¥ï¼âå¤§æè½¬å¤´ä¸çï¼æç¶æ¯çäºå¥ï¼äºæ¯èµ·èº«æå¼éï¼âèçï¼ä½ æä¹ä¹å°è¿éæåé¢äºï¼è¿æ¥æä»¬ååä¸æ¡å§ãâçäºå¥çæ¯å¤§æåå°æï¼éå¸¸é«å´ï¼äºæ¯åå°æé®éï¼âå°åå¼ï¼ä¸æ¬¡æåå¤§æç»ä½ è®²çæ¥è¯¢ä¼åä½ è¿è®°å¾å§ï¼â</p>\n<p>å°æå¿è¯´ï¼âè®°å¾è®°å¾ï¼æç°å¨å·²ç»è·å¾äºæä»¬å®¿èçâä¼åå¨å°è½æâç§°å·ï¼ææå¤©å°±å»ä¹°ä¸ªå¥ç¶æèµ·æ¥ãä¸è¿ä»å¤©å¤§æå¥æ­£ç»æè®²è½»ééå¢ï¼çäºå¥æ¥å§ï¼å±ä»¬3ä¸ªé½æ¯ç³è¯·è¯»éçï¼å¯ä»¥ååä¸æ¡ãâ</p>\n<p>çäºå¥ç¬çåå¨å°ææè¾¹ï¼å¯¹æå¡åè¯´ï¼âç»æä¸ç¢ååæå¤§å©é¢ãâç¶åè½¬è¿å¤´è¯´ï¼âæåæå¨åä¸è¡è½¬äºå ä¸ªåï¼ä¸ä¸ªç©ºä½é½æ²¡æ¾å°ï¼å°±æ³èµ·æ¥è¿éæä¸ªé¢é¦ï¼äºæ¯å°±è¿æ¥äºãâ</p>\n<p>å°æè¯´ï¼âå¯ï¼çæ¥è¿æ¯è½»ééå¥½ï¼è¯»éå¯ä»¥ç¸å®¹ï¼ä¸åèªæéï¼èªå·±å çCPUåå°æè½¬ãâå°æä¸è¾¹è¯´ä¸è¾¹ç¨æå¨æ¡ä¸ç»äºå ä¸ªåã</p>\n<p>çäºå¥è¯´ï¼âå¯ï¼ä¸è¿æä»¬è¿äºè¯»éå·²ç»å é¢äºè¿ä¸ªæ¡å­ï¼å¦ææåéæ³æ¥ç¬å ï¼ä¹éè¦ç­æä»¬èµ°äºæè¡ï¼æä»¬åä»ä»¬ä¸ç¸å®¹åãâ<br>å°ææ³äºæ³é¡¿æ¶é¢æï¼å¦ææ­¤æ¶æäººä»¥è¯»éç³è¯·è½»ééï¼èæä»¬ç³è¯·çä¹æ¯è¯»éï¼èªç¶æ¯å¯ä»¥ç´æ¥è·å¾éçï¼èå¦ææä»¬ç³è¯·çæ¯åéï¼é£ä¹å°±è¯å®åªè½ç­å¾äºãä½æ¯å¦æç°å¨æäººä»¥åéææè½»ééï¼é£ä¹æ è®ºæ¯æ°æ¥çè¯»éè¿æ¯åéï¼é½éè¦è¿å¥ç­å¾éåï¼æ³å°æ­¤å¤å°æä¸ç¦åé®éï¼âé£å¦æææéçäººéæ¾äºéï¼æä»¬åºè¯¥ä»¥ä»ä¹é¡ºåºå¤éç­å¾éåéçéå¢ï¼â</p>\n<p>çäºå¥æ³äºæ³ï¼è¯´ï¼âå¯ï¼é£è¦çæå¨ç¬¬ä¸ä¸ªçæ¯ä»ä¹éï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯åéï¼é£ä¹å°±ç´æ¥å¤éè¿ä¸ªåéï¼å¦ææå¨ç¬¬ä¸ä¸ªçæ¯è¯»éï¼é£ä¹å°±å¤éç­å¾éåä¸­ææçè¯»éï¼èå¿½ç¥ç­å¾éåä¸­çåéï¼å°±åè¿æ ·ãããâè¯´çï¼çäºå¥å¨æ¡ä¸ç»äºèµ·æ¥ã</p>\n<p><img src=\"/2021/07/20/postgresql-lock-lwlock-implement/waitqueue.jpg\"> </p>\n<p><strong>å°ç»</strong></p>\n<p>çççäºå¥å¨æ¡ä¸çç­å¾éåå¤éå¾ï¼å°æè§å¾åºè¯¥å¯¹è½»ééæäºä¸ä¸ªåºæ¬çäºè§£ï¼ä½æ¯çªç¶èåäºä¸ä¸ªæ³æ³ï¼åæå¤§æè¯´è¿å¸¸è§éï¼é£åæ¯ææ ·å®ç°çå¢ï¼äºæ¯ä¾¿é®çäºå¥ï¼âé£å¸¸è§éææ²¡æç­å¾éåï¼âçäºå¥æ£äºä¸ä¸ï¼çªç¶å¤§ç¬éï¼âä¸æ¥ä¸æ¥ï¼æè¿ææ¬æ°ä¹¦ãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãå·²ç»ä¸å¸äºï¼éé¢å¥é½æï¼æä»¬åå®å»ä¹¦åºççå§ãâ<br>å¤§æåå°æç¹å¤´éï¼âæ­£ææ­¤æï¼åå»åå»ãâ</p>\n<p>è¿æ¶æå¡åæçäºå¥çé¢å·²ç»ç«¯ä¸æ¥äºï¼äºæ¯ä¸ä¸ªäººåå¼å§è¾¹åè¾¹èä¸äºä¸åçå«å¦ï¼èçº¦ç¿°ç¸é±é¢é¦ä¸­åæ¢å¤äºæ´»æ³¼çæ°æ°ã</p>"},{"title":"ãç½®é¡¶ããPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¸å¸äºï¼","date":"2021-08-02T13:40:29.000Z","top":1,"_content":"\n\n\n[äº¬ä¸å°å](https://item.jd.com/12898593.html)  \n[å½å½å°å](http://product.dangdang.com/29277465.html)  \n[æ·å®å°å](https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1) \n\n![](./postgresql-transaction-internals-introduce/introduce.jpg) \n\n<!--more-->\n\n**ä¸ºä»ä¹åè¿æ¬ä¹¦ï¼**\n\nè¿å¹´æ¥ï¼æä¸ç´ä»äºä¸PostgreSQLç¸å³çæ°æ®åºåæ ¸å¼åå·¥ä½ï¼ä¸»æ»æ¹åæ¯SQLå¼æä¸­çæ¥è¯¢ä¼åï¼å¯¹äºå¡çäºè§£ä»åçå¨çè®ºå±é¢ï¼è½ç¶å¯¹äºå¡çæ§è´¨ãéç¦»çº§å«ä¹è½è®²ä¸çªå¤§éçï¼ä½ç»ç©¶åèä¸å®ï¼äºæ¢ç©¶äºå¡çæ¬è´¨æ çãæè°âçº¸ä¸å¾æ¥ç»è§æµï¼ç»ç¥æ­¤äºè¦èº¬è¡âï¼å¨å®æäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ä¹åï¼æå°±å¼å§äºäºå¡çæ¢ç´¢ä¹æã\n\næ¢ç´¢çè¿ç¨å¹¶éä¸å¸é£é¡ºãäºå¡ççè®ºå·²ç»é¢ä¸ºå¤æï¼å¨å½¢ææºä»£ç ä¹åæ´æ¯ææ°åä¸è¡ä¹å¤ï¼å¯¹è¿äºæºä»£ç åéè¡åæçå·¥ä½ééå¸¸å¤§ï¼ä¸æ¦éå°ä¸è§£çé®é¢ï¼è¿éæ¥éèµæãç¿»éè®¨è®ºç»ä¸­çé®ä»¶ãå¥ä¹ææ·±ï¼å¶è¿æé¾ï¼åå¶è§æå¥ãä»¥åæ ¹æ®äºå¡çè®ºæ³å½ç¶çä¸äºçè§£ä¼è¢«å·ä½å®ç°ä¸­çç²¾å·§è®¾è®¡æç ´ï¼èå¯¹è¿äºè®¾è®¡ç»èçæ·±å»çè§£è½å¸®å©æä»¬å¿«éå°è§£å³å·¥ä½ä¸­éå°çé®é¢ï¼å æ­¤ï¼æåäº§çäºåç¬¬äºæ¬ä¹¦çæ³æ³ï¼å¸æå¯¹èªå·±å¨æ¢ç´¢è¿ç¨ä¸­éå°çç¥è¯ç¹åä¸ä¸ªæ»ç»ä¸åäº«ã\n\n\n**ä¸ºä»ä¹éè¯»è¿æ¬ä¹¦ï¼**\n\näºå¡æ¯å³ç³»æ°æ®åºä¸­æéè¦çåå®¹ä¹ä¸ï¼æ è®ºæ¯å¯¹æ°æ®åºåæ ¸è¿è¡å¼åï¼è¿æ¯å¨æ°æ®åºçåºç¡ä¸è¿è¡åºç¨ç¨åºçå¼åï¼é½éè¦å¯¹äºå¡ææ·±å¥çäºè§£ãæ¬ä¹¦ç»è´å°è§£è¯»äºPostgreSQL æ°æ®åºä¸­ä¸äºå¡ç¸å³çå¤§é¨åæºç ï¼å¯¹å¶ä¸­æ¯è¾éè¦ççè®ºç»åºäºè¯´æï¼ç¸ä¿¡å·²ç»è¶³ä»¥è®©è¯»èäºè§£PostgreSQLä¸­äºå¡çå¨è²ã\n\n\n\n**æ¬ä¹¦çç»ç»ç»æ**\n\næ¬ä¹¦å¨ç« èçæå¸ä¸å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\nâ¢åºç¡ç¯ï¼ç¬¬1~4ç« ï¼ï¼ä¸»è¦ä»ç»äºäºå¡çåºæ¬æ¦å¿µãå¹¶åæ§å¶çå®ç°æ¹æ³åæéæ¢å¤çå®ç°æ¹æ³ï¼\n\nâ¢è¿é¶ç¯ï¼ç¬¬5~9ç« ï¼ï¼å¨äºå¡çè®ºçåºç¡ä¸ï¼å¯¹ç©çå¤å¶ãé»è¾å¤å¶ãSSIå®ç°ãæ°åZheapå¼æã2PCåäºæ·±å¥çè§£è¯»ã\n\nç±äºäºå¡å¼æåå­å¨å¼æå³ç³»å¯åï¼æ¬ä¹¦å¨éå½ä¸­å¯¹å­å¨å¼æçä¸äºç¥è¯ç¹ä¹åäºç¸å³ä»ç»ï¼æ¹ä¾¿è¯»èå æ·±çè§£ã\n\n**çº é**\n\nå¨åä½çè¿ç¨ä¸­ï¼æå°è¯å°½éå¤å°æ¥éç¸å³èµæï¼ä½éäºä½èçè½åï¼ä¹¦ä¸­é¾ååºç°ä¸äºéè¯¯ï¼æ¬¢è¿å¹¿å¤§è¯»èå¯¹æ¬ä¹¦æåºæ¹è¯åæè§ï¼è¿ä¹æçäºä½èæ¬èº«è½åçæåã\n\n**è´è°¢**\n\nå­åºéåå£«åå¨åç¦åå£«éè¿è§é¢ä¼è®®çæ¹å¼éå­éå¥å°å®¡éäºä¹¦ç¨¿ï¼å¤æ¬¡æ¹æ¹ä¹¦ç¨¿å°æ·±å¤ï¼æåºäºå¾å¤æççæè§ï¼æè°¢äºä½è¾è¦çä»åºã\n\næ¬ä¹¦æ¯ç¬¬äºæ¬¡åè£è±ç¼è¾åä½ï¼å¾å°äºè£è±ç¼è¾çå¤§åæ¯æï¼å¨æ­¤è¡¨ç¤ºæè°¢ã\n  \næç§æ¢ç¼è¾æ¯æ¬ä¹¦çè´£ä»»ç¼è¾ï¼å¨ä¹¦ç¨¿åä½è¿ç¨ä¸­ï¼ç§æ¢ç¼è¾ä¸åå¶ç¦å°è§£ç­äºæå¾å¤é®é¢ï¼å¯¹æçæç¨¿è¡ä¸ºä¹ç»äºäºæå¤§ççè§£ï¼æè°¢ç§æ¢ç¼è¾ã\n\næè°¢æçç¶æ¯ãå¦»å­ï¼ä¹¦ç¨¿çåä½è¿ç¨æ¯ç¥èåé¿ï¼å ç¨äºå¾å¤çæ´»çæ¶é´ï¼ä»ä»¬æ¿æäºææçå®¶å¡ï¼ä¸ºææä¾äºæå¥½çåä½ç¯å¢ã\n\næçä¸¤ä¸ªå¿å­ä¹éå¸¸å³å¿æçåä½è¿åº¦ï¼ç»å¸¸è¯¢é®æä»ä¹æ¶åå®æåä½ï¼å¹¶å¨æåä½çè¿ç¨ä¸­çº æ­£äºä¸äºéå«å­ï¼å¨æ­¤ä¸å¹¶è¡¨ç¤ºæè°¢ã\n\n","source":"_posts/postgresql-transaction-internals-introduce.md","raw":"---\ntitle: ãç½®é¡¶ããPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¸å¸äºï¼\ndate: 2021-08-02 21:40:29\ntop: 1\ntags: transaction äºå¡ æ°ä¹¦ ææ¯åå¹ PostgreSQL\n---\n\n\n\n[äº¬ä¸å°å](https://item.jd.com/12898593.html)  \n[å½å½å°å](http://product.dangdang.com/29277465.html)  \n[æ·å®å°å](https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1) \n\n![](./postgresql-transaction-internals-introduce/introduce.jpg) \n\n<!--more-->\n\n**ä¸ºä»ä¹åè¿æ¬ä¹¦ï¼**\n\nè¿å¹´æ¥ï¼æä¸ç´ä»äºä¸PostgreSQLç¸å³çæ°æ®åºåæ ¸å¼åå·¥ä½ï¼ä¸»æ»æ¹åæ¯SQLå¼æä¸­çæ¥è¯¢ä¼åï¼å¯¹äºå¡çäºè§£ä»åçå¨çè®ºå±é¢ï¼è½ç¶å¯¹äºå¡çæ§è´¨ãéç¦»çº§å«ä¹è½è®²ä¸çªå¤§éçï¼ä½ç»ç©¶åèä¸å®ï¼äºæ¢ç©¶äºå¡çæ¬è´¨æ çãæè°âçº¸ä¸å¾æ¥ç»è§æµï¼ç»ç¥æ­¤äºè¦èº¬è¡âï¼å¨å®æäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ä¹åï¼æå°±å¼å§äºäºå¡çæ¢ç´¢ä¹æã\n\næ¢ç´¢çè¿ç¨å¹¶éä¸å¸é£é¡ºãäºå¡ççè®ºå·²ç»é¢ä¸ºå¤æï¼å¨å½¢ææºä»£ç ä¹åæ´æ¯ææ°åä¸è¡ä¹å¤ï¼å¯¹è¿äºæºä»£ç åéè¡åæçå·¥ä½ééå¸¸å¤§ï¼ä¸æ¦éå°ä¸è§£çé®é¢ï¼è¿éæ¥éèµæãç¿»éè®¨è®ºç»ä¸­çé®ä»¶ãå¥ä¹ææ·±ï¼å¶è¿æé¾ï¼åå¶è§æå¥ãä»¥åæ ¹æ®äºå¡çè®ºæ³å½ç¶çä¸äºçè§£ä¼è¢«å·ä½å®ç°ä¸­çç²¾å·§è®¾è®¡æç ´ï¼èå¯¹è¿äºè®¾è®¡ç»èçæ·±å»çè§£è½å¸®å©æä»¬å¿«éå°è§£å³å·¥ä½ä¸­éå°çé®é¢ï¼å æ­¤ï¼æåäº§çäºåç¬¬äºæ¬ä¹¦çæ³æ³ï¼å¸æå¯¹èªå·±å¨æ¢ç´¢è¿ç¨ä¸­éå°çç¥è¯ç¹åä¸ä¸ªæ»ç»ä¸åäº«ã\n\n\n**ä¸ºä»ä¹éè¯»è¿æ¬ä¹¦ï¼**\n\näºå¡æ¯å³ç³»æ°æ®åºä¸­æéè¦çåå®¹ä¹ä¸ï¼æ è®ºæ¯å¯¹æ°æ®åºåæ ¸è¿è¡å¼åï¼è¿æ¯å¨æ°æ®åºçåºç¡ä¸è¿è¡åºç¨ç¨åºçå¼åï¼é½éè¦å¯¹äºå¡ææ·±å¥çäºè§£ãæ¬ä¹¦ç»è´å°è§£è¯»äºPostgreSQL æ°æ®åºä¸­ä¸äºå¡ç¸å³çå¤§é¨åæºç ï¼å¯¹å¶ä¸­æ¯è¾éè¦ççè®ºç»åºäºè¯´æï¼ç¸ä¿¡å·²ç»è¶³ä»¥è®©è¯»èäºè§£PostgreSQLä¸­äºå¡çå¨è²ã\n\n\n\n**æ¬ä¹¦çç»ç»ç»æ**\n\næ¬ä¹¦å¨ç« èçæå¸ä¸å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼\n\nâ¢åºç¡ç¯ï¼ç¬¬1~4ç« ï¼ï¼ä¸»è¦ä»ç»äºäºå¡çåºæ¬æ¦å¿µãå¹¶åæ§å¶çå®ç°æ¹æ³åæéæ¢å¤çå®ç°æ¹æ³ï¼\n\nâ¢è¿é¶ç¯ï¼ç¬¬5~9ç« ï¼ï¼å¨äºå¡çè®ºçåºç¡ä¸ï¼å¯¹ç©çå¤å¶ãé»è¾å¤å¶ãSSIå®ç°ãæ°åZheapå¼æã2PCåäºæ·±å¥çè§£è¯»ã\n\nç±äºäºå¡å¼æåå­å¨å¼æå³ç³»å¯åï¼æ¬ä¹¦å¨éå½ä¸­å¯¹å­å¨å¼æçä¸äºç¥è¯ç¹ä¹åäºç¸å³ä»ç»ï¼æ¹ä¾¿è¯»èå æ·±çè§£ã\n\n**çº é**\n\nå¨åä½çè¿ç¨ä¸­ï¼æå°è¯å°½éå¤å°æ¥éç¸å³èµæï¼ä½éäºä½èçè½åï¼ä¹¦ä¸­é¾ååºç°ä¸äºéè¯¯ï¼æ¬¢è¿å¹¿å¤§è¯»èå¯¹æ¬ä¹¦æåºæ¹è¯åæè§ï¼è¿ä¹æçäºä½èæ¬èº«è½åçæåã\n\n**è´è°¢**\n\nå­åºéåå£«åå¨åç¦åå£«éè¿è§é¢ä¼è®®çæ¹å¼éå­éå¥å°å®¡éäºä¹¦ç¨¿ï¼å¤æ¬¡æ¹æ¹ä¹¦ç¨¿å°æ·±å¤ï¼æåºäºå¾å¤æççæè§ï¼æè°¢äºä½è¾è¦çä»åºã\n\næ¬ä¹¦æ¯ç¬¬äºæ¬¡åè£è±ç¼è¾åä½ï¼å¾å°äºè£è±ç¼è¾çå¤§åæ¯æï¼å¨æ­¤è¡¨ç¤ºæè°¢ã\n  \næç§æ¢ç¼è¾æ¯æ¬ä¹¦çè´£ä»»ç¼è¾ï¼å¨ä¹¦ç¨¿åä½è¿ç¨ä¸­ï¼ç§æ¢ç¼è¾ä¸åå¶ç¦å°è§£ç­äºæå¾å¤é®é¢ï¼å¯¹æçæç¨¿è¡ä¸ºä¹ç»äºäºæå¤§ççè§£ï¼æè°¢ç§æ¢ç¼è¾ã\n\næè°¢æçç¶æ¯ãå¦»å­ï¼ä¹¦ç¨¿çåä½è¿ç¨æ¯ç¥èåé¿ï¼å ç¨äºå¾å¤çæ´»çæ¶é´ï¼ä»ä»¬æ¿æäºææçå®¶å¡ï¼ä¸ºææä¾äºæå¥½çåä½ç¯å¢ã\n\næçä¸¤ä¸ªå¿å­ä¹éå¸¸å³å¿æçåä½è¿åº¦ï¼ç»å¸¸è¯¢é®æä»ä¹æ¶åå®æåä½ï¼å¹¶å¨æåä½çè¿ç¨ä¸­çº æ­£äºä¸äºéå«å­ï¼å¨æ­¤ä¸å¹¶è¡¨ç¤ºæè°¢ã\n\n","slug":"postgresql-transaction-internals-introduce","published":1,"updated":"2021-08-05T15:58:35.000Z","_id":"ckruplv2w0000yu9k1vls2joj","comments":1,"layout":"post","photos":[],"link":"","content":"<p><a href=\"https://item.jd.com/12898593.html\">äº¬ä¸å°å</a><br><a href=\"http://product.dangdang.com/29277465.html\">å½å½å°å</a><br><a href=\"https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1\">æ·å®å°å</a> </p>\n<p><img src=\"/2021/08/02/postgresql-transaction-internals-introduce/introduce.jpg\"> </p>\n<a id=\"more\"></a>\n\n<p><strong>ä¸ºä»ä¹åè¿æ¬ä¹¦ï¼</strong></p>\n<p>è¿å¹´æ¥ï¼æä¸ç´ä»äºä¸PostgreSQLç¸å³çæ°æ®åºåæ ¸å¼åå·¥ä½ï¼ä¸»æ»æ¹åæ¯SQLå¼æä¸­çæ¥è¯¢ä¼åï¼å¯¹äºå¡çäºè§£ä»åçå¨çè®ºå±é¢ï¼è½ç¶å¯¹äºå¡çæ§è´¨ãéç¦»çº§å«ä¹è½è®²ä¸çªå¤§éçï¼ä½ç»ç©¶åèä¸å®ï¼äºæ¢ç©¶äºå¡çæ¬è´¨æ çãæè°âçº¸ä¸å¾æ¥ç»è§æµï¼ç»ç¥æ­¤äºè¦èº¬è¡âï¼å¨å®æäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ä¹åï¼æå°±å¼å§äºäºå¡çæ¢ç´¢ä¹æã</p>\n<p>æ¢ç´¢çè¿ç¨å¹¶éä¸å¸é£é¡ºãäºå¡ççè®ºå·²ç»é¢ä¸ºå¤æï¼å¨å½¢ææºä»£ç ä¹åæ´æ¯ææ°åä¸è¡ä¹å¤ï¼å¯¹è¿äºæºä»£ç åéè¡åæçå·¥ä½ééå¸¸å¤§ï¼ä¸æ¦éå°ä¸è§£çé®é¢ï¼è¿éæ¥éèµæãç¿»éè®¨è®ºç»ä¸­çé®ä»¶ãå¥ä¹ææ·±ï¼å¶è¿æé¾ï¼åå¶è§æå¥ãä»¥åæ ¹æ®äºå¡çè®ºæ³å½ç¶çä¸äºçè§£ä¼è¢«å·ä½å®ç°ä¸­çç²¾å·§è®¾è®¡æç ´ï¼èå¯¹è¿äºè®¾è®¡ç»èçæ·±å»çè§£è½å¸®å©æä»¬å¿«éå°è§£å³å·¥ä½ä¸­éå°çé®é¢ï¼å æ­¤ï¼æåäº§çäºåç¬¬äºæ¬ä¹¦çæ³æ³ï¼å¸æå¯¹èªå·±å¨æ¢ç´¢è¿ç¨ä¸­éå°çç¥è¯ç¹åä¸ä¸ªæ»ç»ä¸åäº«ã</p>\n<p><strong>ä¸ºä»ä¹éè¯»è¿æ¬ä¹¦ï¼</strong></p>\n<p>äºå¡æ¯å³ç³»æ°æ®åºä¸­æéè¦çåå®¹ä¹ä¸ï¼æ è®ºæ¯å¯¹æ°æ®åºåæ ¸è¿è¡å¼åï¼è¿æ¯å¨æ°æ®åºçåºç¡ä¸è¿è¡åºç¨ç¨åºçå¼åï¼é½éè¦å¯¹äºå¡ææ·±å¥çäºè§£ãæ¬ä¹¦ç»è´å°è§£è¯»äºPostgreSQL æ°æ®åºä¸­ä¸äºå¡ç¸å³çå¤§é¨åæºç ï¼å¯¹å¶ä¸­æ¯è¾éè¦ççè®ºç»åºäºè¯´æï¼ç¸ä¿¡å·²ç»è¶³ä»¥è®©è¯»èäºè§£PostgreSQLä¸­äºå¡çå¨è²ã</p>\n<p><strong>æ¬ä¹¦çç»ç»ç»æ</strong></p>\n<p>æ¬ä¹¦å¨ç« èçæå¸ä¸å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼</p>\n<p>â¢åºç¡ç¯ï¼ç¬¬1~4ç« ï¼ï¼ä¸»è¦ä»ç»äºäºå¡çåºæ¬æ¦å¿µãå¹¶åæ§å¶çå®ç°æ¹æ³åæéæ¢å¤çå®ç°æ¹æ³ï¼</p>\n<p>â¢è¿é¶ç¯ï¼ç¬¬5~9ç« ï¼ï¼å¨äºå¡çè®ºçåºç¡ä¸ï¼å¯¹ç©çå¤å¶ãé»è¾å¤å¶ãSSIå®ç°ãæ°åZheapå¼æã2PCåäºæ·±å¥çè§£è¯»ã</p>\n<p>ç±äºäºå¡å¼æåå­å¨å¼æå³ç³»å¯åï¼æ¬ä¹¦å¨éå½ä¸­å¯¹å­å¨å¼æçä¸äºç¥è¯ç¹ä¹åäºç¸å³ä»ç»ï¼æ¹ä¾¿è¯»èå æ·±çè§£ã</p>\n<p><strong>çº é</strong></p>\n<p>å¨åä½çè¿ç¨ä¸­ï¼æå°è¯å°½éå¤å°æ¥éç¸å³èµæï¼ä½éäºä½èçè½åï¼ä¹¦ä¸­é¾ååºç°ä¸äºéè¯¯ï¼æ¬¢è¿å¹¿å¤§è¯»èå¯¹æ¬ä¹¦æåºæ¹è¯åæè§ï¼è¿ä¹æçäºä½èæ¬èº«è½åçæåã</p>\n<p><strong>è´è°¢</strong></p>\n<p>å­åºéåå£«åå¨åç¦åå£«éè¿è§é¢ä¼è®®çæ¹å¼éå­éå¥å°å®¡éäºä¹¦ç¨¿ï¼å¤æ¬¡æ¹æ¹ä¹¦ç¨¿å°æ·±å¤ï¼æåºäºå¾å¤æççæè§ï¼æè°¢äºä½è¾è¦çä»åºã</p>\n<p>æ¬ä¹¦æ¯ç¬¬äºæ¬¡åè£è±ç¼è¾åä½ï¼å¾å°äºè£è±ç¼è¾çå¤§åæ¯æï¼å¨æ­¤è¡¨ç¤ºæè°¢ã</p>\n<p>æç§æ¢ç¼è¾æ¯æ¬ä¹¦çè´£ä»»ç¼è¾ï¼å¨ä¹¦ç¨¿åä½è¿ç¨ä¸­ï¼ç§æ¢ç¼è¾ä¸åå¶ç¦å°è§£ç­äºæå¾å¤é®é¢ï¼å¯¹æçæç¨¿è¡ä¸ºä¹ç»äºäºæå¤§ççè§£ï¼æè°¢ç§æ¢ç¼è¾ã</p>\n<p>æè°¢æçç¶æ¯ãå¦»å­ï¼ä¹¦ç¨¿çåä½è¿ç¨æ¯ç¥èåé¿ï¼å ç¨äºå¾å¤çæ´»çæ¶é´ï¼ä»ä»¬æ¿æäºææçå®¶å¡ï¼ä¸ºææä¾äºæå¥½çåä½ç¯å¢ã</p>\n<p>æçä¸¤ä¸ªå¿å­ä¹éå¸¸å³å¿æçåä½è¿åº¦ï¼ç»å¸¸è¯¢é®æä»ä¹æ¶åå®æåä½ï¼å¹¶å¨æåä½çè¿ç¨ä¸­çº æ­£äºä¸äºéå«å­ï¼å¨æ­¤ä¸å¹¶è¡¨ç¤ºæè°¢ã</p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://item.jd.com/12898593.html\">äº¬ä¸å°å</a><br><a href=\"http://product.dangdang.com/29277465.html\">å½å½å°å</a><br><a href=\"https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1\">æ·å®å°å</a> </p>\n<p><img src=\"/2021/08/02/postgresql-transaction-internals-introduce/introduce.jpg\"> </p>","more":"<p><strong>ä¸ºä»ä¹åè¿æ¬ä¹¦ï¼</strong></p>\n<p>è¿å¹´æ¥ï¼æä¸ç´ä»äºä¸PostgreSQLç¸å³çæ°æ®åºåæ ¸å¼åå·¥ä½ï¼ä¸»æ»æ¹åæ¯SQLå¼æä¸­çæ¥è¯¢ä¼åï¼å¯¹äºå¡çäºè§£ä»åçå¨çè®ºå±é¢ï¼è½ç¶å¯¹äºå¡çæ§è´¨ãéç¦»çº§å«ä¹è½è®²ä¸çªå¤§éçï¼ä½ç»ç©¶åèä¸å®ï¼äºæ¢ç©¶äºå¡çæ¬è´¨æ çãæè°âçº¸ä¸å¾æ¥ç»è§æµï¼ç»ç¥æ­¤äºè¦èº¬è¡âï¼å¨å®æäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ä¹åï¼æå°±å¼å§äºäºå¡çæ¢ç´¢ä¹æã</p>\n<p>æ¢ç´¢çè¿ç¨å¹¶éä¸å¸é£é¡ºãäºå¡ççè®ºå·²ç»é¢ä¸ºå¤æï¼å¨å½¢ææºä»£ç ä¹åæ´æ¯ææ°åä¸è¡ä¹å¤ï¼å¯¹è¿äºæºä»£ç åéè¡åæçå·¥ä½ééå¸¸å¤§ï¼ä¸æ¦éå°ä¸è§£çé®é¢ï¼è¿éæ¥éèµæãç¿»éè®¨è®ºç»ä¸­çé®ä»¶ãå¥ä¹ææ·±ï¼å¶è¿æé¾ï¼åå¶è§æå¥ãä»¥åæ ¹æ®äºå¡çè®ºæ³å½ç¶çä¸äºçè§£ä¼è¢«å·ä½å®ç°ä¸­çç²¾å·§è®¾è®¡æç ´ï¼èå¯¹è¿äºè®¾è®¡ç»èçæ·±å»çè§£è½å¸®å©æä»¬å¿«éå°è§£å³å·¥ä½ä¸­éå°çé®é¢ï¼å æ­¤ï¼æåäº§çäºåç¬¬äºæ¬ä¹¦çæ³æ³ï¼å¸æå¯¹èªå·±å¨æ¢ç´¢è¿ç¨ä¸­éå°çç¥è¯ç¹åä¸ä¸ªæ»ç»ä¸åäº«ã</p>\n<p><strong>ä¸ºä»ä¹éè¯»è¿æ¬ä¹¦ï¼</strong></p>\n<p>äºå¡æ¯å³ç³»æ°æ®åºä¸­æéè¦çåå®¹ä¹ä¸ï¼æ è®ºæ¯å¯¹æ°æ®åºåæ ¸è¿è¡å¼åï¼è¿æ¯å¨æ°æ®åºçåºç¡ä¸è¿è¡åºç¨ç¨åºçå¼åï¼é½éè¦å¯¹äºå¡ææ·±å¥çäºè§£ãæ¬ä¹¦ç»è´å°è§£è¯»äºPostgreSQL æ°æ®åºä¸­ä¸äºå¡ç¸å³çå¤§é¨åæºç ï¼å¯¹å¶ä¸­æ¯è¾éè¦ççè®ºç»åºäºè¯´æï¼ç¸ä¿¡å·²ç»è¶³ä»¥è®©è¯»èäºè§£PostgreSQLä¸­äºå¡çå¨è²ã</p>\n<p><strong>æ¬ä¹¦çç»ç»ç»æ</strong></p>\n<p>æ¬ä¹¦å¨ç« èçæå¸ä¸å¯ä»¥åä¸ºä¸¤ä¸ªé¨åï¼</p>\n<p>â¢åºç¡ç¯ï¼ç¬¬1~4ç« ï¼ï¼ä¸»è¦ä»ç»äºäºå¡çåºæ¬æ¦å¿µãå¹¶åæ§å¶çå®ç°æ¹æ³åæéæ¢å¤çå®ç°æ¹æ³ï¼</p>\n<p>â¢è¿é¶ç¯ï¼ç¬¬5~9ç« ï¼ï¼å¨äºå¡çè®ºçåºç¡ä¸ï¼å¯¹ç©çå¤å¶ãé»è¾å¤å¶ãSSIå®ç°ãæ°åZheapå¼æã2PCåäºæ·±å¥çè§£è¯»ã</p>\n<p>ç±äºäºå¡å¼æåå­å¨å¼æå³ç³»å¯åï¼æ¬ä¹¦å¨éå½ä¸­å¯¹å­å¨å¼æçä¸äºç¥è¯ç¹ä¹åäºç¸å³ä»ç»ï¼æ¹ä¾¿è¯»èå æ·±çè§£ã</p>\n<p><strong>çº é</strong></p>\n<p>å¨åä½çè¿ç¨ä¸­ï¼æå°è¯å°½éå¤å°æ¥éç¸å³èµæï¼ä½éäºä½èçè½åï¼ä¹¦ä¸­é¾ååºç°ä¸äºéè¯¯ï¼æ¬¢è¿å¹¿å¤§è¯»èå¯¹æ¬ä¹¦æåºæ¹è¯åæè§ï¼è¿ä¹æçäºä½èæ¬èº«è½åçæåã</p>\n<p><strong>è´è°¢</strong></p>\n<p>å­åºéåå£«åå¨åç¦åå£«éè¿è§é¢ä¼è®®çæ¹å¼éå­éå¥å°å®¡éäºä¹¦ç¨¿ï¼å¤æ¬¡æ¹æ¹ä¹¦ç¨¿å°æ·±å¤ï¼æåºäºå¾å¤æççæè§ï¼æè°¢äºä½è¾è¦çä»åºã</p>\n<p>æ¬ä¹¦æ¯ç¬¬äºæ¬¡åè£è±ç¼è¾åä½ï¼å¾å°äºè£è±ç¼è¾çå¤§åæ¯æï¼å¨æ­¤è¡¨ç¤ºæè°¢ã</p>\n<p>æç§æ¢ç¼è¾æ¯æ¬ä¹¦çè´£ä»»ç¼è¾ï¼å¨ä¹¦ç¨¿åä½è¿ç¨ä¸­ï¼ç§æ¢ç¼è¾ä¸åå¶ç¦å°è§£ç­äºæå¾å¤é®é¢ï¼å¯¹æçæç¨¿è¡ä¸ºä¹ç»äºäºæå¤§ççè§£ï¼æè°¢ç§æ¢ç¼è¾ã</p>\n<p>æè°¢æçç¶æ¯ãå¦»å­ï¼ä¹¦ç¨¿çåä½è¿ç¨æ¯ç¥èåé¿ï¼å ç¨äºå¾å¤çæ´»çæ¶é´ï¼ä»ä»¬æ¿æäºææçå®¶å¡ï¼ä¸ºææä¾äºæå¥½çåä½ç¯å¢ã</p>\n<p>æçä¸¤ä¸ªå¿å­ä¹éå¸¸å³å¿æçåä½è¿åº¦ï¼ç»å¸¸è¯¢é®æä»ä¹æ¶åå®æåä½ï¼å¹¶å¨æåä½çè¿ç¨ä¸­çº æ­£äºä¸äºéå«å­ï¼å¨æ­¤ä¸å¹¶è¡¨ç¤ºæè°¢ã</p>"},{"title":"è®©æ°æ®åºä»ä¸èä»å®åçå°ä½åºåå¯¹ç¾å½è¯´ä¸ï¼","date":"2021-08-05T15:31:43.000Z","_content":"\n[äº¬ä¸å°å](https://item.jd.com/12898593.html)  \n[å½å½å°å](http://product.dangdang.com/29277465.html)  \n[æ·å®å°å](https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1) \n\n![](./database-developer-say-no-to-us/buy_link.jpeg) \n\nå åå¹´æ¥ï¼å½å¤æ°æ®åºå·¨å¤´å­åååä¼å¿å½¢æçææ¯å£ååçè®ºå£ååæ­äºæ°æ®åºå¸åºï¼å¡ä½äºä¸­å½ä¹è³ä¸ççèå­ï¼ãç§ææ¥æ¥ãæ¾æ¨åºç³»åæç« æ¥éå¶çº¦æå½å·¥ä¸åå±ç35é¡¹âå¡èå­âææ¯ï¼æ°æ®åºç®¡çç³»ç»å°±æ¯å¶ä¸­çä¸é¡¹ãè½ç¶å½äº§æ°æ®åºè¿äºå¹´è¬ååå±ï¼ä½åªè½å¨å¨å¨è¾¹é¢åæè½¬ï¼å¨éèå³é®æ ¸å¿ç³»ç»ä¸åå±¡è´¥å±¡æï¼æªå°ä¸èã\n\n**è¿å¶ä¸­çå³é®åå ä¸é¾çè§£ï¼ææ¯ä¸è¡ã**\n\n<img src=\"./database-developer-say-no-to-us/have_no_tech.jpeg\" width=\"200\">\n \n<!--more-->\n \næ°æ®åºçä¸¤ä¸ªå³é®ææ æ¯**âå¿«â**å**âç¨³â**ãå¶ä¸­âå¿«âç±ä¼åå¨è´è´£ï¼å®éè¿å¯¹ç¨æ·è¾å¥æ¥è¯¢è¿è¡ä»£æ°ä¼åãä»£ä»·ä¼åä»èéæ©å¤å¿«å¥½ççæ§è¡è·¯å¾ï¼èâç¨³âåä¸»è¦ç±äºå¡è´è´£ï¼å®éè¿å¹¶åæ§å¶åæéæ¢å¤çè®ºä¿è¯æ°æ®åºå¨æ§è¡çè¿ç¨ä¸­æ»¡è¶³åå­æ§ãä¸è´æ§ãéç¦»æ§ãæä¹æ§ï¼ä¿è¯æ°æ®çä¸éä¸ä¸¢ã\n\næ è®ºæ¯æ¥è¯¢ä¼åææ¯ï¼è¿æ¯äºå¡å¤çææ¯ï¼å½äº§æ°æ®åºåå½å¤æ°æ®åºå·¨å¤´ä¹é´é½æä¸å°çå·®è·ï¼ç°å¨ä»å¤äºæ¨¡ä»¿ä¸­çææ¯åæ°é¶æ®µï¼å°æçæ­£ååçæ ¸å¿ææ¯ãä¸æ¹é¢ï¼éçäºè®¡ç®ãå¤§æ°æ®ãäºèç½éèç­ä¿¡æ¯ææ¯çä¸æ­åå±ï¼å¯¹æ°æ®åºç­åºç¡æ ¸å¿è½¯ä»¶çè¦æ±è¶æ¥è¶é«ï¼å¦ä¸æ¹é¢ï¼å½äº§æ°æ®åºååå²ä¹åãç¼ºä¹ç§¯æè¿åçç²¾ç¥ï¼è½è½åäºä¸çä½ä»æ²¾æ²¾èªåã\n\nå æ­¤ï¼å½åæ°æ®åºåå±çä¸»è¦çç¾å°±åæï¼**æ ¸å¿åºç¨è½¯ä»¶å¯¹æ°æ®åºæ¥çæé«çæ§è½ãç¨³å®ãå®å¨çéæ±åè½åçå½äº§æ°æ®åºææ¯ä¹é´ççç¾ã**\n\n2019å¹´å§ï¼ä»¥ç¾å½ä¸ºé¦çä¸äºåè¾¾å½å®¶å¼å§äºå¯¹ä¸­å½åå±çå´è¿½å µæªï¼ä¸­åæ°æåå°äºæå±é©çæ¶åï¼æ­¤è¯å±æ¥å­äº¡ä¹ç§ä¹ãä½ä¸ºæ°æ®åºçä»ä¸èèªç¶ä¹åºè¯¥è©è´è´£ä»»ãå¥åå¾å¼ºãè¿å¤´èµ¶ä¸ï¼æ¸èµ·è¢å­å æ²¹å¹²ã\n\nPostgreSQLæ°æ®åºä½ä¸ºä¸çä¸æåè¿çå¼æºæ°æ®åºï¼ç§æ¿äºå¼æºçå¼æ¾å¥ç®ãè¿½æ±è¿æ­¥çç²¾ç¥ï¼ä¸åæ§äºä»»ä½å¬å¸ãå½å®¶ï¼æ¯æä»¬è¯å¸çåï¼å¨é¢çææ¡PostgreSQLåæå©äºæä»¬çåå±åè¿æ­¥ã\n\n2018å¹´ï¼çµå­å·¥ä¸åºçç¤¾åºçäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ï¼å·²ç»å¯¹æ°æ®åºä¸­çâå¿«âææ¯åäºæ·±åº¦çåæï¼å¸®å©å¤§éçæ°æ®åºç±å¥½èæ´æ·±å¥çäºè§£äºæ°æ®åºæ¥è¯¢ä¼åå¨çææ¯å®ç°æ¹æ³ï¼è®©å¾å¤äººå¯¹ä¼åå¨æäºæ´æ·±å±æ¬¡çäºè§£ã\n\n2021å¹´ï¼åºå¯¹æ°æ®åºâç¨³âææ¯çãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¹å°ä¸å¸ï¼ä¸ºæ°æ®åºçä»ä¸èæä¾ååçè¡¥ç»ãæ¬ä¹¦åæäºPostgreSQLæ°æ®åºäºå¡çå®ç°æºå¶ï¼åæ¬äºå¡çåºæ¬æ¦å¿µãä¸¤é¶æ®µéçåçåå®ç°æ¹æ³ãå¤çæ¬å¹¶åæ§å¶çåçåå®ç°æ¹æ³ãæéæ¢å¤çå®ç°æ¹æ³ç­ï¼ç¶åéè¿ä»ç»ç©çå¤å¶ãé»è¾å¤å¶ãZheapå¼æçåçåå®ç°ãSSIçå®ç°ãä¸¤é¶æ®µæäº¤çåçåå®ç°å¢å¼ºè¯»èå¯¹äºå¡æ´æ·±å¥ççè§£ï¼ä»èä½¿è¯»èæ¢è½äºè§£äºå¡çåçï¼ä¹è½æ¸æ¥äºå¡çå®ç°ç»èã\n\n\n\nç¸ä¿¡ãPostgreSQLææ¯åå¹ãç³»åä¸ä¹¦è½å¤æç å¼çï¼è®©è¶æ¥è¶å¤çä¸­åå¿å¥³æèº«å°æ°æ®åºåæ ¸äºä¸ä¸­æ¥ï¼è®©è¶æ¥è¶å¤çæ°æ®åºä»ä¸èåäº«åºèªå·±çå¿å¾åçè§£ï¼è®©è¶æ¥è¶å¤çå½äº§æ°æ®åºè½å¤å±¹ç«äºä¸çä¹æã\n\n**ç·å¿ä¸å±é£äºå¿ï¼ç©ºè´å¤©çå«å°ºèº¯ï¼æ°æ®åºä»ä¸èä»¬ï¼å¥æå§ã**\n","source":"_posts/database-developer-say-no-to-us.md","raw":"---\ntitle: è®©æ°æ®åºä»ä¸èä»å®åçå°ä½åºåå¯¹ç¾å½è¯´ä¸ï¼\ndate: 2021-08-05 23:31:43\ntags: database transaction\n---\n\n[äº¬ä¸å°å](https://item.jd.com/12898593.html)  \n[å½å½å°å](http://product.dangdang.com/29277465.html)  \n[æ·å®å°å](https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1) \n\n![](./database-developer-say-no-to-us/buy_link.jpeg) \n\nå åå¹´æ¥ï¼å½å¤æ°æ®åºå·¨å¤´å­åååä¼å¿å½¢æçææ¯å£ååçè®ºå£ååæ­äºæ°æ®åºå¸åºï¼å¡ä½äºä¸­å½ä¹è³ä¸ççèå­ï¼ãç§ææ¥æ¥ãæ¾æ¨åºç³»åæç« æ¥éå¶çº¦æå½å·¥ä¸åå±ç35é¡¹âå¡èå­âææ¯ï¼æ°æ®åºç®¡çç³»ç»å°±æ¯å¶ä¸­çä¸é¡¹ãè½ç¶å½äº§æ°æ®åºè¿äºå¹´è¬ååå±ï¼ä½åªè½å¨å¨å¨è¾¹é¢åæè½¬ï¼å¨éèå³é®æ ¸å¿ç³»ç»ä¸åå±¡è´¥å±¡æï¼æªå°ä¸èã\n\n**è¿å¶ä¸­çå³é®åå ä¸é¾çè§£ï¼ææ¯ä¸è¡ã**\n\n<img src=\"./database-developer-say-no-to-us/have_no_tech.jpeg\" width=\"200\">\n \n<!--more-->\n \næ°æ®åºçä¸¤ä¸ªå³é®ææ æ¯**âå¿«â**å**âç¨³â**ãå¶ä¸­âå¿«âç±ä¼åå¨è´è´£ï¼å®éè¿å¯¹ç¨æ·è¾å¥æ¥è¯¢è¿è¡ä»£æ°ä¼åãä»£ä»·ä¼åä»èéæ©å¤å¿«å¥½ççæ§è¡è·¯å¾ï¼èâç¨³âåä¸»è¦ç±äºå¡è´è´£ï¼å®éè¿å¹¶åæ§å¶åæéæ¢å¤çè®ºä¿è¯æ°æ®åºå¨æ§è¡çè¿ç¨ä¸­æ»¡è¶³åå­æ§ãä¸è´æ§ãéç¦»æ§ãæä¹æ§ï¼ä¿è¯æ°æ®çä¸éä¸ä¸¢ã\n\næ è®ºæ¯æ¥è¯¢ä¼åææ¯ï¼è¿æ¯äºå¡å¤çææ¯ï¼å½äº§æ°æ®åºåå½å¤æ°æ®åºå·¨å¤´ä¹é´é½æä¸å°çå·®è·ï¼ç°å¨ä»å¤äºæ¨¡ä»¿ä¸­çææ¯åæ°é¶æ®µï¼å°æçæ­£ååçæ ¸å¿ææ¯ãä¸æ¹é¢ï¼éçäºè®¡ç®ãå¤§æ°æ®ãäºèç½éèç­ä¿¡æ¯ææ¯çä¸æ­åå±ï¼å¯¹æ°æ®åºç­åºç¡æ ¸å¿è½¯ä»¶çè¦æ±è¶æ¥è¶é«ï¼å¦ä¸æ¹é¢ï¼å½äº§æ°æ®åºååå²ä¹åãç¼ºä¹ç§¯æè¿åçç²¾ç¥ï¼è½è½åäºä¸çä½ä»æ²¾æ²¾èªåã\n\nå æ­¤ï¼å½åæ°æ®åºåå±çä¸»è¦çç¾å°±åæï¼**æ ¸å¿åºç¨è½¯ä»¶å¯¹æ°æ®åºæ¥çæé«çæ§è½ãç¨³å®ãå®å¨çéæ±åè½åçå½äº§æ°æ®åºææ¯ä¹é´ççç¾ã**\n\n2019å¹´å§ï¼ä»¥ç¾å½ä¸ºé¦çä¸äºåè¾¾å½å®¶å¼å§äºå¯¹ä¸­å½åå±çå´è¿½å µæªï¼ä¸­åæ°æåå°äºæå±é©çæ¶åï¼æ­¤è¯å±æ¥å­äº¡ä¹ç§ä¹ãä½ä¸ºæ°æ®åºçä»ä¸èèªç¶ä¹åºè¯¥è©è´è´£ä»»ãå¥åå¾å¼ºãè¿å¤´èµ¶ä¸ï¼æ¸èµ·è¢å­å æ²¹å¹²ã\n\nPostgreSQLæ°æ®åºä½ä¸ºä¸çä¸æåè¿çå¼æºæ°æ®åºï¼ç§æ¿äºå¼æºçå¼æ¾å¥ç®ãè¿½æ±è¿æ­¥çç²¾ç¥ï¼ä¸åæ§äºä»»ä½å¬å¸ãå½å®¶ï¼æ¯æä»¬è¯å¸çåï¼å¨é¢çææ¡PostgreSQLåæå©äºæä»¬çåå±åè¿æ­¥ã\n\n2018å¹´ï¼çµå­å·¥ä¸åºçç¤¾åºçäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ï¼å·²ç»å¯¹æ°æ®åºä¸­çâå¿«âææ¯åäºæ·±åº¦çåæï¼å¸®å©å¤§éçæ°æ®åºç±å¥½èæ´æ·±å¥çäºè§£äºæ°æ®åºæ¥è¯¢ä¼åå¨çææ¯å®ç°æ¹æ³ï¼è®©å¾å¤äººå¯¹ä¼åå¨æäºæ´æ·±å±æ¬¡çäºè§£ã\n\n2021å¹´ï¼åºå¯¹æ°æ®åºâç¨³âææ¯çãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¹å°ä¸å¸ï¼ä¸ºæ°æ®åºçä»ä¸èæä¾ååçè¡¥ç»ãæ¬ä¹¦åæäºPostgreSQLæ°æ®åºäºå¡çå®ç°æºå¶ï¼åæ¬äºå¡çåºæ¬æ¦å¿µãä¸¤é¶æ®µéçåçåå®ç°æ¹æ³ãå¤çæ¬å¹¶åæ§å¶çåçåå®ç°æ¹æ³ãæéæ¢å¤çå®ç°æ¹æ³ç­ï¼ç¶åéè¿ä»ç»ç©çå¤å¶ãé»è¾å¤å¶ãZheapå¼æçåçåå®ç°ãSSIçå®ç°ãä¸¤é¶æ®µæäº¤çåçåå®ç°å¢å¼ºè¯»èå¯¹äºå¡æ´æ·±å¥ççè§£ï¼ä»èä½¿è¯»èæ¢è½äºè§£äºå¡çåçï¼ä¹è½æ¸æ¥äºå¡çå®ç°ç»èã\n\n\n\nç¸ä¿¡ãPostgreSQLææ¯åå¹ãç³»åä¸ä¹¦è½å¤æç å¼çï¼è®©è¶æ¥è¶å¤çä¸­åå¿å¥³æèº«å°æ°æ®åºåæ ¸äºä¸ä¸­æ¥ï¼è®©è¶æ¥è¶å¤çæ°æ®åºä»ä¸èåäº«åºèªå·±çå¿å¾åçè§£ï¼è®©è¶æ¥è¶å¤çå½äº§æ°æ®åºè½å¤å±¹ç«äºä¸çä¹æã\n\n**ç·å¿ä¸å±é£äºå¿ï¼ç©ºè´å¤©çå«å°ºèº¯ï¼æ°æ®åºä»ä¸èä»¬ï¼å¥æå§ã**\n","slug":"database-developer-say-no-to-us","published":1,"updated":"2021-08-05T16:01:00.000Z","_id":"ckrz3bn0k0000wx9k0u1o0cuc","comments":1,"layout":"post","photos":[],"link":"","content":"<p><a href=\"https://item.jd.com/12898593.html\">äº¬ä¸å°å</a><br><a href=\"http://product.dangdang.com/29277465.html\">å½å½å°å</a><br><a href=\"https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1\">æ·å®å°å</a> </p>\n<p><img src=\"/2021/08/05/database-developer-say-no-to-us/buy_link.jpeg\"> </p>\n<p>å åå¹´æ¥ï¼å½å¤æ°æ®åºå·¨å¤´å­åååä¼å¿å½¢æçææ¯å£ååçè®ºå£ååæ­äºæ°æ®åºå¸åºï¼å¡ä½äºä¸­å½ä¹è³ä¸ççèå­ï¼ãç§ææ¥æ¥ãæ¾æ¨åºç³»åæç« æ¥éå¶çº¦æå½å·¥ä¸åå±ç35é¡¹âå¡èå­âææ¯ï¼æ°æ®åºç®¡çç³»ç»å°±æ¯å¶ä¸­çä¸é¡¹ãè½ç¶å½äº§æ°æ®åºè¿äºå¹´è¬ååå±ï¼ä½åªè½å¨å¨å¨è¾¹é¢åæè½¬ï¼å¨éèå³é®æ ¸å¿ç³»ç»ä¸åå±¡è´¥å±¡æï¼æªå°ä¸èã</p>\n<p><strong>è¿å¶ä¸­çå³é®åå ä¸é¾çè§£ï¼ææ¯ä¸è¡ã</strong></p>\n<img src=\"/2021/08/05/database-developer-say-no-to-us/have_no_tech.jpeg\" width=\"200\">\n\n<a id=\"more\"></a>\n\n<p>æ°æ®åºçä¸¤ä¸ªå³é®ææ æ¯<strong>âå¿«â</strong>å<strong>âç¨³â</strong>ãå¶ä¸­âå¿«âç±ä¼åå¨è´è´£ï¼å®éè¿å¯¹ç¨æ·è¾å¥æ¥è¯¢è¿è¡ä»£æ°ä¼åãä»£ä»·ä¼åä»èéæ©å¤å¿«å¥½ççæ§è¡è·¯å¾ï¼èâç¨³âåä¸»è¦ç±äºå¡è´è´£ï¼å®éè¿å¹¶åæ§å¶åæéæ¢å¤çè®ºä¿è¯æ°æ®åºå¨æ§è¡çè¿ç¨ä¸­æ»¡è¶³åå­æ§ãä¸è´æ§ãéç¦»æ§ãæä¹æ§ï¼ä¿è¯æ°æ®çä¸éä¸ä¸¢ã</p>\n<p>æ è®ºæ¯æ¥è¯¢ä¼åææ¯ï¼è¿æ¯äºå¡å¤çææ¯ï¼å½äº§æ°æ®åºåå½å¤æ°æ®åºå·¨å¤´ä¹é´é½æä¸å°çå·®è·ï¼ç°å¨ä»å¤äºæ¨¡ä»¿ä¸­çææ¯åæ°é¶æ®µï¼å°æçæ­£ååçæ ¸å¿ææ¯ãä¸æ¹é¢ï¼éçäºè®¡ç®ãå¤§æ°æ®ãäºèç½éèç­ä¿¡æ¯ææ¯çä¸æ­åå±ï¼å¯¹æ°æ®åºç­åºç¡æ ¸å¿è½¯ä»¶çè¦æ±è¶æ¥è¶é«ï¼å¦ä¸æ¹é¢ï¼å½äº§æ°æ®åºååå²ä¹åãç¼ºä¹ç§¯æè¿åçç²¾ç¥ï¼è½è½åäºä¸çä½ä»æ²¾æ²¾èªåã</p>\n<p>å æ­¤ï¼å½åæ°æ®åºåå±çä¸»è¦çç¾å°±åæï¼<strong>æ ¸å¿åºç¨è½¯ä»¶å¯¹æ°æ®åºæ¥çæé«çæ§è½ãç¨³å®ãå®å¨çéæ±åè½åçå½äº§æ°æ®åºææ¯ä¹é´ççç¾ã</strong></p>\n<p>2019å¹´å§ï¼ä»¥ç¾å½ä¸ºé¦çä¸äºåè¾¾å½å®¶å¼å§äºå¯¹ä¸­å½åå±çå´è¿½å µæªï¼ä¸­åæ°æåå°äºæå±é©çæ¶åï¼æ­¤è¯å±æ¥å­äº¡ä¹ç§ä¹ãä½ä¸ºæ°æ®åºçä»ä¸èèªç¶ä¹åºè¯¥è©è´è´£ä»»ãå¥åå¾å¼ºãè¿å¤´èµ¶ä¸ï¼æ¸èµ·è¢å­å æ²¹å¹²ã</p>\n<p>PostgreSQLæ°æ®åºä½ä¸ºä¸çä¸æåè¿çå¼æºæ°æ®åºï¼ç§æ¿äºå¼æºçå¼æ¾å¥ç®ãè¿½æ±è¿æ­¥çç²¾ç¥ï¼ä¸åæ§äºä»»ä½å¬å¸ãå½å®¶ï¼æ¯æä»¬è¯å¸çåï¼å¨é¢çææ¡PostgreSQLåæå©äºæä»¬çåå±åè¿æ­¥ã</p>\n<p>2018å¹´ï¼çµå­å·¥ä¸åºçç¤¾åºçäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ï¼å·²ç»å¯¹æ°æ®åºä¸­çâå¿«âææ¯åäºæ·±åº¦çåæï¼å¸®å©å¤§éçæ°æ®åºç±å¥½èæ´æ·±å¥çäºè§£äºæ°æ®åºæ¥è¯¢ä¼åå¨çææ¯å®ç°æ¹æ³ï¼è®©å¾å¤äººå¯¹ä¼åå¨æäºæ´æ·±å±æ¬¡çäºè§£ã</p>\n<p>2021å¹´ï¼åºå¯¹æ°æ®åºâç¨³âææ¯çãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¹å°ä¸å¸ï¼ä¸ºæ°æ®åºçä»ä¸èæä¾ååçè¡¥ç»ãæ¬ä¹¦åæäºPostgreSQLæ°æ®åºäºå¡çå®ç°æºå¶ï¼åæ¬äºå¡çåºæ¬æ¦å¿µãä¸¤é¶æ®µéçåçåå®ç°æ¹æ³ãå¤çæ¬å¹¶åæ§å¶çåçåå®ç°æ¹æ³ãæéæ¢å¤çå®ç°æ¹æ³ç­ï¼ç¶åéè¿ä»ç»ç©çå¤å¶ãé»è¾å¤å¶ãZheapå¼æçåçåå®ç°ãSSIçå®ç°ãä¸¤é¶æ®µæäº¤çåçåå®ç°å¢å¼ºè¯»èå¯¹äºå¡æ´æ·±å¥ççè§£ï¼ä»èä½¿è¯»èæ¢è½äºè§£äºå¡çåçï¼ä¹è½æ¸æ¥äºå¡çå®ç°ç»èã</p>\n<p>ç¸ä¿¡ãPostgreSQLææ¯åå¹ãç³»åä¸ä¹¦è½å¤æç å¼çï¼è®©è¶æ¥è¶å¤çä¸­åå¿å¥³æèº«å°æ°æ®åºåæ ¸äºä¸ä¸­æ¥ï¼è®©è¶æ¥è¶å¤çæ°æ®åºä»ä¸èåäº«åºèªå·±çå¿å¾åçè§£ï¼è®©è¶æ¥è¶å¤çå½äº§æ°æ®åºè½å¤å±¹ç«äºä¸çä¹æã</p>\n<p><strong>ç·å¿ä¸å±é£äºå¿ï¼ç©ºè´å¤©çå«å°ºèº¯ï¼æ°æ®åºä»ä¸èä»¬ï¼å¥æå§ã</strong></p>\n","site":{"data":{}},"excerpt":"<p><a href=\"https://item.jd.com/12898593.html\">äº¬ä¸å°å</a><br><a href=\"http://product.dangdang.com/29277465.html\">å½å½å°å</a><br><a href=\"https://detail.tmall.com/item.htm?spm=a1z10.3-b-s.w4011-22119638442.37.798d1b8b6TlJDS&id=651820819927&rn=215b8c029b06d654c30a5777273c979e&abbucket=1\">æ·å®å°å</a> </p>\n<p><img src=\"/2021/08/05/database-developer-say-no-to-us/buy_link.jpeg\"> </p>\n<p>å åå¹´æ¥ï¼å½å¤æ°æ®åºå·¨å¤´å­åååä¼å¿å½¢æçææ¯å£ååçè®ºå£ååæ­äºæ°æ®åºå¸åºï¼å¡ä½äºä¸­å½ä¹è³ä¸ççèå­ï¼ãç§ææ¥æ¥ãæ¾æ¨åºç³»åæç« æ¥éå¶çº¦æå½å·¥ä¸åå±ç35é¡¹âå¡èå­âææ¯ï¼æ°æ®åºç®¡çç³»ç»å°±æ¯å¶ä¸­çä¸é¡¹ãè½ç¶å½äº§æ°æ®åºè¿äºå¹´è¬ååå±ï¼ä½åªè½å¨å¨å¨è¾¹é¢åæè½¬ï¼å¨éèå³é®æ ¸å¿ç³»ç»ä¸åå±¡è´¥å±¡æï¼æªå°ä¸èã</p>\n<p><strong>è¿å¶ä¸­çå³é®åå ä¸é¾çè§£ï¼ææ¯ä¸è¡ã</strong></p>\n<img src=\"/2021/08/05/database-developer-say-no-to-us/have_no_tech.jpeg\" width=\"200\">","more":"<p>æ°æ®åºçä¸¤ä¸ªå³é®ææ æ¯<strong>âå¿«â</strong>å<strong>âç¨³â</strong>ãå¶ä¸­âå¿«âç±ä¼åå¨è´è´£ï¼å®éè¿å¯¹ç¨æ·è¾å¥æ¥è¯¢è¿è¡ä»£æ°ä¼åãä»£ä»·ä¼åä»èéæ©å¤å¿«å¥½ççæ§è¡è·¯å¾ï¼èâç¨³âåä¸»è¦ç±äºå¡è´è´£ï¼å®éè¿å¹¶åæ§å¶åæéæ¢å¤çè®ºä¿è¯æ°æ®åºå¨æ§è¡çè¿ç¨ä¸­æ»¡è¶³åå­æ§ãä¸è´æ§ãéç¦»æ§ãæä¹æ§ï¼ä¿è¯æ°æ®çä¸éä¸ä¸¢ã</p>\n<p>æ è®ºæ¯æ¥è¯¢ä¼åææ¯ï¼è¿æ¯äºå¡å¤çææ¯ï¼å½äº§æ°æ®åºåå½å¤æ°æ®åºå·¨å¤´ä¹é´é½æä¸å°çå·®è·ï¼ç°å¨ä»å¤äºæ¨¡ä»¿ä¸­çææ¯åæ°é¶æ®µï¼å°æçæ­£ååçæ ¸å¿ææ¯ãä¸æ¹é¢ï¼éçäºè®¡ç®ãå¤§æ°æ®ãäºèç½éèç­ä¿¡æ¯ææ¯çä¸æ­åå±ï¼å¯¹æ°æ®åºç­åºç¡æ ¸å¿è½¯ä»¶çè¦æ±è¶æ¥è¶é«ï¼å¦ä¸æ¹é¢ï¼å½äº§æ°æ®åºååå²ä¹åãç¼ºä¹ç§¯æè¿åçç²¾ç¥ï¼è½è½åäºä¸çä½ä»æ²¾æ²¾èªåã</p>\n<p>å æ­¤ï¼å½åæ°æ®åºåå±çä¸»è¦çç¾å°±åæï¼<strong>æ ¸å¿åºç¨è½¯ä»¶å¯¹æ°æ®åºæ¥çæé«çæ§è½ãç¨³å®ãå®å¨çéæ±åè½åçå½äº§æ°æ®åºææ¯ä¹é´ççç¾ã</strong></p>\n<p>2019å¹´å§ï¼ä»¥ç¾å½ä¸ºé¦çä¸äºåè¾¾å½å®¶å¼å§äºå¯¹ä¸­å½åå±çå´è¿½å µæªï¼ä¸­åæ°æåå°äºæå±é©çæ¶åï¼æ­¤è¯å±æ¥å­äº¡ä¹ç§ä¹ãä½ä¸ºæ°æ®åºçä»ä¸èèªç¶ä¹åºè¯¥è©è´è´£ä»»ãå¥åå¾å¼ºãè¿å¤´èµ¶ä¸ï¼æ¸èµ·è¢å­å æ²¹å¹²ã</p>\n<p>PostgreSQLæ°æ®åºä½ä¸ºä¸çä¸æåè¿çå¼æºæ°æ®åºï¼ç§æ¿äºå¼æºçå¼æ¾å¥ç®ãè¿½æ±è¿æ­¥çç²¾ç¥ï¼ä¸åæ§äºä»»ä½å¬å¸ãå½å®¶ï¼æ¯æä»¬è¯å¸çåï¼å¨é¢çææ¡PostgreSQLåæå©äºæä»¬çåå±åè¿æ­¥ã</p>\n<p>2018å¹´ï¼çµå­å·¥ä¸åºçç¤¾åºçäºãPostgreSQLææ¯åå¹ï¼æ¥è¯¢ä¼åæ·±åº¦æ¢ç´¢ãä¸ä¹¦ï¼å·²ç»å¯¹æ°æ®åºä¸­çâå¿«âææ¯åäºæ·±åº¦çåæï¼å¸®å©å¤§éçæ°æ®åºç±å¥½èæ´æ·±å¥çäºè§£äºæ°æ®åºæ¥è¯¢ä¼åå¨çææ¯å®ç°æ¹æ³ï¼è®©å¾å¤äººå¯¹ä¼åå¨æäºæ´æ·±å±æ¬¡çäºè§£ã</p>\n<p>2021å¹´ï¼åºå¯¹æ°æ®åºâç¨³âææ¯çãPostgreSQLææ¯åå¹ï¼äºå¡å¤çæ·±åº¦æ¢ç´¢ãä¹å°ä¸å¸ï¼ä¸ºæ°æ®åºçä»ä¸èæä¾ååçè¡¥ç»ãæ¬ä¹¦åæäºPostgreSQLæ°æ®åºäºå¡çå®ç°æºå¶ï¼åæ¬äºå¡çåºæ¬æ¦å¿µãä¸¤é¶æ®µéçåçåå®ç°æ¹æ³ãå¤çæ¬å¹¶åæ§å¶çåçåå®ç°æ¹æ³ãæéæ¢å¤çå®ç°æ¹æ³ç­ï¼ç¶åéè¿ä»ç»ç©çå¤å¶ãé»è¾å¤å¶ãZheapå¼æçåçåå®ç°ãSSIçå®ç°ãä¸¤é¶æ®µæäº¤çåçåå®ç°å¢å¼ºè¯»èå¯¹äºå¡æ´æ·±å¥ççè§£ï¼ä»èä½¿è¯»èæ¢è½äºè§£äºå¡çåçï¼ä¹è½æ¸æ¥äºå¡çå®ç°ç»èã</p>\n<p>ç¸ä¿¡ãPostgreSQLææ¯åå¹ãç³»åä¸ä¹¦è½å¤æç å¼çï¼è®©è¶æ¥è¶å¤çä¸­åå¿å¥³æèº«å°æ°æ®åºåæ ¸äºä¸ä¸­æ¥ï¼è®©è¶æ¥è¶å¤çæ°æ®åºä»ä¸èåäº«åºèªå·±çå¿å¾åçè§£ï¼è®©è¶æ¥è¶å¤çå½äº§æ°æ®åºè½å¤å±¹ç«äºä¸çä¹æã</p>\n<p><strong>ç·å¿ä¸å±é£äºå¿ï¼ç©ºè´å¤©çå«å°ºèº¯ï¼æ°æ®åºä»ä¸èä»¬ï¼å¥æå§ã</strong></p>"},{"title":"ãè§é¢ãPostgreSQLä¸­çé","date":"2021-10-07T01:01:40.000Z","_content":"\nPostgreSQLä¸­çéæ¯æ°æ®åºäºå¡ä¸­çæ ¸å¿åå®¹ï¼æ¬æ¬¡æä»¬å°½éæå¼æºä»£ç å®ç°ï¼ä»DBAçè§åº¦æ¥åæéççº§å«åPostgreSQLçéçå®ç°æºå¶ã\n\n{% raw %}\n<iframe src=\"//player.bilibili.com/player.html?aid=548425121&bvid=BV1nq4y1V7fs&cid=421451468&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n{% endraw %}\n\n","source":"_posts/postgresql-lock-vedio.md","raw":"\n---\ntitle: ãè§é¢ãPostgreSQLä¸­çé\ndate: 2021-10-07 09:01:40\ntags: PostgreSQL äºå¡ é æ°æ®åº\n---\n\nPostgreSQLä¸­çéæ¯æ°æ®åºäºå¡ä¸­çæ ¸å¿åå®¹ï¼æ¬æ¬¡æä»¬å°½éæå¼æºä»£ç å®ç°ï¼ä»DBAçè§åº¦æ¥åæéççº§å«åPostgreSQLçéçå®ç°æºå¶ã\n\n{% raw %}\n<iframe src=\"//player.bilibili.com/player.html?aid=548425121&bvid=BV1nq4y1V7fs&cid=421451468&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n{% endraw %}\n\n","slug":"postgresql-lock-vedio","published":1,"updated":"2021-10-07T13:42:25.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckugzp4fo0000n19ka2f9dsyd","content":"<p>PostgreSQLä¸­çéæ¯æ°æ®åºäºå¡ä¸­çæ ¸å¿åå®¹ï¼æ¬æ¬¡æä»¬å°½éæå¼æºä»£ç å®ç°ï¼ä»DBAçè§åº¦æ¥åæéççº§å«åPostgreSQLçéçå®ç°æºå¶ã</p>\n\n<iframe src=\"//player.bilibili.com/player.html?aid=548425121&bvid=BV1nq4y1V7fs&cid=421451468&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n\n\n","site":{"data":{}},"excerpt":"","more":"<p>PostgreSQLä¸­çéæ¯æ°æ®åºäºå¡ä¸­çæ ¸å¿åå®¹ï¼æ¬æ¬¡æä»¬å°½éæå¼æºä»£ç å®ç°ï¼ä»DBAçè§åº¦æ¥åæéççº§å«åPostgreSQLçéçå®ç°æºå¶ã</p>\n\n<iframe src=\"//player.bilibili.com/player.html?aid=548425121&bvid=BV1nq4y1V7fs&cid=421451468&page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"> </iframe>\n\n\n"}],"PostAsset":[{"_id":"source/_posts/postgresql-optimizer-outline-2/1.jpg","slug":"1.jpg","post":"ckdchg8je0002r2s686meddyz","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-2/2.jpg","slug":"2.jpg","post":"ckdchg8je0002r2s686meddyz","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-4/1.png","slug":"1.png","post":"ckdgkb6d30000mvs61pjfd9kp","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-4/2.png","slug":"2.png","post":"ckdgkb6d30000mvs61pjfd9kp","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/1.jpg","slug":"1.jpg","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/2.png","slug":"2.png","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/3.png","slug":"3.png","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/4.png","slug":"4.png","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/5.png","slug":"5.png","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-7/6.png","slug":"6.png","post":"ckfszbzyj0000ro9kgeuy15hy","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-9/1.png","slug":"1.png","post":"ckfszbzyo0003ro9k3ejk08ql","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-9/2.png","slug":"2.png","post":"ckfszbzyo0003ro9k3ejk08ql","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-9/3.png","slug":"3.png","post":"ckfszbzyo0003ro9k3ejk08ql","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-optimizer-outline-9/4.png","slug":"4.png","post":"ckfszbzyo0003ro9k3ejk08ql","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-lock-lwlock-implement/lockstate.jpg","slug":"lockstate.jpg","post":"ckrb9w1k70000g29khng9fbev","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-lock-lwlock-implement/sxlock.jpg","slug":"sxlock.jpg","post":"ckrb9w1k70000g29khng9fbev","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-lock-lwlock-implement/waitqueue.jpg","slug":"waitqueue.jpg","post":"ckrb9w1k70000g29khng9fbev","modified":0,"renderable":0},{"_id":"source/_posts/postgresql-transaction-internals-introduce/introduce.jpg","slug":"introduce.jpg","post":"ckruplv2w0000yu9k1vls2joj","modified":0,"renderable":0},{"_id":"source/_posts/database-developer-say-no-to-us/buy_link.jpeg","slug":"buy_link.jpeg","post":"ckrz3bn0k0000wx9k0u1o0cuc","modified":0,"renderable":0},{"_id":"source/_posts/database-developer-say-no-to-us/have_no_tech.jpeg","slug":"have_no_tech.jpeg","post":"ckrz3bn0k0000wx9k0u1o0cuc","modified":0,"renderable":0}],"PostCategory":[],"PostTag":[{"post_id":"ckfszbzyj0000ro9kgeuy15hy","tag_id":"ckfszbzyl0002ro9kanjefekl","_id":"ckfszbzyp0005ro9kggb76qu5"},{"post_id":"ckfszbzyk0001ro9kakdf920l","tag_id":"ckfszbzyp0004ro9k9lae9crw","_id":"ckfszbzyq0007ro9keajgbmig"},{"post_id":"ckfszbzyo0003ro9k3ejk08ql","tag_id":"ckfszbzyp0006ro9k9jwea22m","_id":"ckfszbzyq0008ro9k7gra9xwm"},{"post_id":"ckktgdw790000nj9k0mucc72m","tag_id":"ckktgdw7g0001nj9k7nue1o09","_id":"ckktgdw7l0002nj9kbinpaqe8"},{"post_id":"ckrb9w1k70000g29khng9fbev","tag_id":"ckrb9w1ke0001g29k7jpv9tik","_id":"ckrb9w1ki0002g29kbttg55wv"},{"post_id":"ckruplv2w0000yu9k1vls2joj","tag_id":"ckruplv360001yu9kf5qjeaym","_id":"ckruplv3c0002yu9k1bt7bdle"},{"post_id":"ckrz3bn0k0000wx9k0u1o0cuc","tag_id":"ckrz3bn0o0001wx9khd7x12ze","_id":"ckrz3bn0s0002wx9k39zthtvo"},{"post_id":"ckugzp4fo0000n19ka2f9dsyd","tag_id":"ckugzp4fu0001n19k6xk0e9yu","_id":"ckugzp4fx0002n19k9xtgh82c"}],"Tag":[{"name":"è·¯å¾ Path é¡ºåºæ«æ ç´¢å¼æ«æ ä½å¾æ«æ Join","_id":"ckfszbzyl0002ro9kanjefekl"},{"name":"ä»£ä»· å¯å¨ä»£ä»· IOä»£ä»· CPUä»£ä»·","_id":"ckfszbzyp0004ro9k9lae9crw"},{"name":"å¨æè§å èªåºåä¸ èªé¡¶åä¸","_id":"ckfszbzyp0006ro9k9jwea22m"},{"name":"lock spinlock transaction postgresql","_id":"ckktgdw7g0001nj9k7nue1o09"},{"name":"lock lwlock transaction postgresql","_id":"ckrb9w1ke0001g29k7jpv9tik"},{"name":"transaction äºå¡ æ°ä¹¦ ææ¯åå¹ PostgreSQL","_id":"ckruplv360001yu9kf5qjeaym"},{"name":"database transaction","_id":"ckrz3bn0o0001wx9khd7x12ze"},{"name":"PostgreSQL äºå¡ é æ°æ®åº","_id":"ckugzp4fu0001n19k6xk0e9yu"}]}}